"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[42067],{715:(e,t,o)=>{var n;o.d(t,{x:()=>n}),function(e){e.Rating="Question.Rating",e.Date="Question.DateTime",e.FileUpload="Question.FileUpload",e.Choice="Question.Choice",e.Text="Question.TextField",e.Ranking="Question.Ranking",e.MatrixChoiceGroup="Question.MatrixChoiceGroup",e.MatrixChoice="Question.MatrixChoice",e.NetPromoterScore="Question.NPS"}(n||(n={}))},29610:(e,t,o)=>{o.r(t),o.d(t,{FormResponseViewDialog:()=>y});var n=o(27051),r=o(65043),i=o(20751),a=o(27663),s=o(9442),l=o(52342),c=o(40520),d=o(62264),p=o(715),m=o(61035),u=o(77508),h=o(56415),g=o(8736),x=o(66783),b=o(52195),f=o(66151);const T=(0,x.J9)((e,t)=>{const o=[(0,f.aS)(e),(0,f.dg)(e),{boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{width:g.B.MainDialogWidth,maxWidth:g.B.MainDialogMaxWidth,minWidth:g.B.MainDialogMinWidth},button:[{width:"fit-content",height:"30px",backgroundColor:"transparent",padding:"5px 12px 5px 12px",":hover":{backgroundColor:"transparent !important"}}]},e===u.Sx.TeamsContrast&&{border:"1px solid "+h.z.White}],n=[(0,f._D)(e),{display:"flex",gap:"5px"}],r=[(0,f.gS)("column"),f.cc,(0,f.aS)(e),{textAlign:"center",fontSize:b.s.large,height:"250px",fontWeight:b.BO.semibold}],i={table:{borderCollapse:"separate",borderSpacing:0,padding:"0px 20px",width:"100%"},"table tr th, table tr td":{borderRight:"1px solid ".concat(h.z.NeutralLightGrey82),borderBottom:"1px solid ".concat(h.z.NeutralLightGrey82),padding:"8px 16px"},"table tr th:first-child, table tr td:first-child":{borderLeft:"1px solid ".concat(h.z.NeutralLightGrey82)},"table tr th":{borderTop:"1px solid ".concat(h.z.NeutralLightGrey82),textAlign:"left"},"table tr:first-child th:first-child":{borderTopLeftRadius:"8px"},"table tr:first-child th:last-child":{borderTopRightRadius:"8px"},"table tr:last-child td:first-child":{borderBottomLeftRadius:"8px"},"table tr:last-child td:last-child":{borderBottomRightRadius:"8px"}},a=[e===u.Sx.TeamsContrast?{color:h.z.HighContrastBlackSelectedTextBackground}:(0,f._D)(e),{fontSize:b.s.medium,margin:"15px 10px",border:"none",cursor:"pointer"}],s=[(0,f.gS)("row"),{padding:"30px 20px",gap:"15px"}],l=[(0,f.$Z)("32px"),{height:"32px",width:"32px"}],c=[(0,f.$Z)("40px"),(0,f.i9)(e),{height:"40px",width:"40px",alignItems:"center",padding:"8px 0px 0px 8px",borderRadius:"2px",pointerEvents:"none"}],d=[(0,f.gS)("column"),{".primaryTextSection":{height:"28px"}}],p=[(0,f.gS)("column"),{gap:"15px",minWidth:"200px",".ms-Image-image":{maxWidth:"300px"}}];return(0,b.TW)({dialogContainer:o,loadingSpinner:r,dialogTopButton:[{right:"auto",padding:"15px 15px 0px"}],questionAnswerTable:i,backButton:n,submitAnotherResponseButton:a,formsHeaderSection:s,formsLogoIcon:l,formsMetadataSection:d,iconSection:c,fileUpload:p,tableColumn:{minWidth:"200px"}},t)}),S=("".concat(h.z.TeamsAppBrand00," ").concat(h.z.TeamsDarkPurple," ").concat(h.z.TeamsDarkPurple),(0,x.J9)(e=>({topButton:e.dialogTopButton}))),R=(0,x.J9)(e=>({dialogContainer:(0,b.Zq)("dialogContainer",e.dialogContainer),loadingSpinner:(0,b.Zq)("loadingSpinner",e.loadingSpinner),dialogTopButton:(0,b.Zq)("dialogTopButton",e.dialogTopButton),questionAnswerTable:(0,b.Zq)("questionAnswerTable",e.questionAnswerTable),backButton:(0,b.Zq)("backButton",e.backButton),submitAnotherResponseButton:(0,b.Zq)("submitAnotherResponseButton",e.submitAnotherResponseButton),formsHeaderSection:(0,b.Zq)("formsHeaderSection",e.formsHeaderSection),formsLogoIcon:(0,b.Zq)("formsLogoIcon",e.formsLogoIcon),formsMetadataSection:(0,b.Zq)("formsMetadataSection",e.formsMetadataSection),iconSection:(0,b.Zq)("iconSection",e.iconSection),fileUpload:(0,b.Zq)("fileUpload",e.fileUpload),tableColumn:(0,b.Zq)("tableColumn",e.tableColumn)}));var C=o(59846),w=o(4648),B=o(86053),N=o(21382),k=o(54052),E=o.n(k);const y=e=>{const{onDismiss:t,theme:o,contentStyles:u,getThumbnail:h,dialogContentClassName:g,dialogClassName:x,dialogContainerClassName:b,formWithQA:f,onSubmitAnotherResponseClick:k}=e,y=R(T(o,u)),q=r.useCallback((e,t)=>{var o,n;if(!t)return null;return null!==(o=null===(n=m.V.getLatestResponseAnswers(t).find(t=>t.questionId===e.id))||void 0===n?void 0:n.answer1)&&void 0!==o?o:null},[]),v=()=>{if(!f)return null;const e=m.V.getLatestResponse(f),t=e?new Date(e.submitDate):"",a=null===e||void 0===e?void 0:e.responderName;return r.createElement("div",{className:y.formsHeaderSection},r.createElement("div",{className:y.iconSection},r.createElement(i.I,(0,n.A)((0,n.A)({},C.U3),{},{className:(0,w.A)(C.U3.className,y.formsLogoIcon)}))),r.createElement("div",{className:y.formsMetadataSection},r.createElement(d.g,{titleText:f.displayName,theme:o}),t&&a&&N.G(B.p.Strings.FormResponseViewDialog_SubmissionMetadataText,a,t.toLocaleDateString(),t.toLocaleTimeString())))},A=()=>r.createElement("button",{className:y.submitAnotherResponseButton,type:"button",onClick:()=>k()},B.p.Strings.FormResponseViewDialog_SubmitAnotherResponseButtonText),D=()=>{if(!f)return null;const e=f.questions.sort((e,t)=>e.order-t.order).map(e=>L(e));return r.createElement("div",{className:y.questionAnswerTable},r.createElement("table",null,r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,r.createElement(d.g,{titleText:B.p.Strings.FormResponseViewDialog_QuestionColumnHeaderText,theme:o})),r.createElement("th",null,r.createElement(d.g,{titleText:B.p.Strings.FormResponseViewDialog_AnswerColumnHeaderText,theme:o})))),r.createElement("tbody",null,...e)))},L=e=>{const t=I(e);return r.createElement("tr",null,r.createElement("td",null,r.createElement("div",{className:y.tableColumn},e.title)),r.createElement("td",null,t))},I=e=>{var t;const o=q(e,f);if(!o)return null;let n=o;switch(e.questionType){case p.x.Ranking:n=o.sort((e,t)=>e.answerOrder-t.answerOrder).map(e=>e.displayText).join(", ");break;case p.x.MatrixChoice:n=null!==(t=o.displayText)&&void 0!==t?t:"";break;case p.x.FileUpload:const e=m.V.getImageUrls(o);return r.createElement("div",{className:y.fileUpload},e.map(e=>{const t=h(e);return t?r.createElement(a._,{key:e,src:t}):r.createElement(s.N,{key:e,href:e,target:"_blank",rel:"noopener noreferrer"},B.p.Strings.FormResponseViewDialog_OpenFileInSharepointLinkText)}));case p.x.Choice:try{const e=JSON.parse(o);n=E()(e)?e.join(", "):o}catch(i){n=o}break;case p.x.Text:case p.x.Rating:case p.x.Date:case p.x.NetPromoterScore:case p.x.MatrixChoiceGroup:default:n=o}return r.createElement("div",{className:y.tableColumn},n)};return r.createElement(l.l,{hidden:!1,onDismiss:t,dialogContentProps:{className:g,closeButtonAriaLabel:B.p.Strings.AddFormRequirementDialog_CloseDialogAriaLabel,styles:S(T(o,u)),type:c.h.normal,topButtonsProps:[{onRenderIcon:()=>r.createElement("div",{className:y.backButton,onClick:t},r.createElement(i.I,C.qb),B.p.Strings.FormResponseViewDialog_DialogHeaderBackButtonLabel)}]},modalProps:{className:x,containerClassName:(0,w.A)(b,y.dialogContainer),isBlocking:!1}},r.createElement("div",null,v(),D(),A()))}},61035:(e,t,o)=>{o.d(t,{V:()=>r});class n{constructor(e){this.id=e.id,this.order=e.order,this.title=e.title,this.titleRT=e.titleRT,this.subtitle=e.subtitle,this.subtitleRT=e.subtitleRT,this.questionType=e.questionType}}n.fromWebResource=e=>new n({id:e.id,order:e.order,title:e.title,titleRT:e.formsProRTQuestionTitle,subtitle:e.subtitle,subtitleRT:e.formsProRTSubtitle,questionType:e.type});class r{static getLatestResponse(e){return e.responses[0]}static getLatestResponseAnswers(e){let t=[];const o=this.getLatestResponse(e);if(null!==o&&void 0!==o&&o.answers)try{t=JSON.parse(o.answers)}catch(n){throw new Error("Failed to parse form response answers: ".concat(o.answers,", Error: ").concat(n))}return t}constructor(e){this.formId=e.formId,this.displayName=e.displayName,this.questions=e.questions,this.responses=e.responses,this.formWebUrl=e.formWebUrl,this.formResponse=e.formResponse}}r.getImageUrls=e=>{try{return JSON.parse(e).map(e=>e.link)}catch(t){throw new Error("Failed to parse form response file upload answer: ".concat(e,", Error: ").concat(t))}},r.fromWebResource=e=>new r({formId:e.formId,displayName:e.displayName,questions:e.questions.map(e=>n.fromWebResource(e)),responses:e.responses,formWebUrl:e.formWebUrl,formResponse:e.formResponse})},62264:(e,t,o)=>{o.d(t,{g:()=>m});var n=o(65043),r=o(16112),i=o(66783),a=o(52195),s=o(66151),l=o(56415);const c="34px",d=(0,i.J9)(e=>({root:[(0,s.q0)("ellipsis"),(0,s.aS)(e),{height:c,cursor:"default","> button":[s.xK,(0,s.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:"2px solid ".concat(l.z.ThemeSecondary)}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:a.BO.semibold,lineHeight:c,margin:"auto"}}]})),p=(0,i.J9)(e=>({root:(0,a.Zq)("primaryTextSection",e.root)}));class m extends r.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:o}=this.props,r=this.getClassNames();return n.createElement("div",{className:r.root,title:e},null!=t?n.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":o,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},n.createElement("span",null,e)):n.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return p(d(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=n.createRef(),this.onTitleClick=()=>{var e,t,o;null===(e=(t=this.props).onClickTitleButton)||void 0===e||e.call(t,null!==(o=this.titleButtonRef.current)&&void 0!==o?o:void 0)}}}}}]);
//# sourceMappingURL=formresponseviewdialog.b43d3a49.chunk.js.map