"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[82689],{1720:(e,t,n)=>{n.d(t,{u:()=>i});var a=n(81536),o=n(28144),r=n(48612);const i=(e,t,n,i,l,c,s,d,u,m)=>p=>{switch((0,a.v)(e,t,i)){case"Full":"openUrl"===p.type&&(0,o.X)(n,p.value,l,c,u);break;case"None":case"Limited":(0,r.l)(n,e,i,c,s,d,m)}}},26901:(e,t,n)=>{n.d(t,{Al:()=>r,Iq:()=>l,Md:()=>d,WK:()=>i,gy:()=>c});var a=n(82381);const o="medium";function r(e,t){try{const n=/^\/l\/stage\/([^/]+)\/([^/]+)$/,a=e.pathname.match(n);if(3!==(null===a||void 0===a?void 0:a.length)||!a[1]||a[1]!==t){const e=new Error("Invalid StageView deep link");throw e.name="StageViewDeepLinkParseError",e}const o=t,r=e.searchParams.get("context"),i=decodeURIComponent(null!==r&&void 0!==r?r:"");return{appId:t,deepLinkAppId:o,stageInfo:JSON.parse(i)}}catch(n){const e=new Error((0,a.r)(n,"Unable to parse StageView deep link"));throw e.name="StageViewDeepLinkParseError",e}}function i(e,t){try{var n,r,i,l,c,d;const a=/^\/l\/task\/([^/]+)$/,u=e.pathname.match(a);if(2!==(null===u||void 0===u?void 0:u.length)||!u[1]||u[1]!==t){const e=new Error("Invalid TaskModule deep link");throw e.name="TaskModuleDeepLinkParseError",e}const m=e.searchParams.get("card");return{appId:t,taskInfo:{title:null!==(n=e.searchParams.get("title"))&&void 0!==n?n:void 0,width:s(null!==(r=e.searchParams.get("width"))&&void 0!==r?r:o),height:s(null!==(i=e.searchParams.get("width"))&&void 0!==i?i:o),url:null!==(l=e.searchParams.get("url"))&&void 0!==l?l:void 0,card:m?JSON.parse(m):void 0,fallbackUrl:null!==(c=e.searchParams.get("fallbackUrl"))&&void 0!==c?c:void 0,completionBotId:null!==(d=e.searchParams.get("completionBotId"))&&void 0!==d?d:void 0}}}catch(u){const e=new Error((0,a.r)(u,"Unable to parse TaskModule deep link"));throw e.name="TaskModuleDeepLinkParseError",e}}function l(e){return e.startsWith("https://teams.microsoft.com/l/stage")}function c(e){return e.startsWith("https://teams.microsoft.com/l/task")}function s(e){let t="medium";if("string"===typeof e)switch(e=e.toLowerCase()){case"small":case"medium":case"large":t=e;break;default:t=o}else"number"===typeof e&&(t=e);return t}function d(e,t){let n;var a;if("StageView"===t)n=null===e||void 0===e||null===(a=e.stageInfo)||void 0===a?void 0:a.websiteUrl;else if("TaskModule"===t){var o;n=null===e||void 0===e||null===(o=e.taskInfo)||void 0===o?void 0:o.fallbackUrl}if(!n){const e=new Error("Fallback url is empty");throw e.name="OpenUrlActionError",e}return new URL(n)}},28144:(e,t,n)=>{n.d(t,{X:()=>c});var a=n(82381),o=n(26901);const r="noopener noreferrer";function i(e){return"http:"===e.protocol.toLowerCase()||"https:"===e.protocol.toLowerCase()?(window.open(e,"_blank",r),Promise.resolve(!0)):Promise.resolve(!1)}var l=n(46675);function c(e,t,n,r,c,s,d){let u="OpenUrl";try{if(!t||!(0,l.A)(t)){const e=new Error("Action url is empty or invalid");throw e.name="OpenUrlActionError",e}let a=new URL(t);if((0,o.Iq)(t)){u="StageView",c.logEvent("info","OpenUrlActionClicked",{actionType:u});const t=null===s||void 0===s?void 0:s.getCustomProperty("deepLinkPayload"),n=null!==t&&void 0!==t?t:(0,o.Al)(a,e);if(!n){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}var m;if("function"===typeof r.openStageView)return n.onDismiss=()=>{null===d||void 0===d||d.refreshCard()},void(null===(m=r.openStageView)||void 0===m||m.call(r,n));c.logEvent("error","MetaOSHandlerNotImplemented",{message:"Handler: openStageView; OpenUrlActionType: ".concat(u)}),a=(0,o.Md)(n,u)}else if((0,o.gy)(t)){u="TaskModule",c.logEvent("info","OpenUrlActionClicked",{actionType:u});const t=null===s||void 0===s?void 0:s.getCustomProperty("deepLinkPayload"),n=null!==t&&void 0!==t?t:(0,o.WK)(a,e);if(!n){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}var p;if("function"===typeof r.launchTaskModule)return n.onDismiss=()=>{null===d||void 0===d||d.refreshCard()},void(null===(p=r.launchTaskModule)||void 0===p||p.call(r,n));c.logEvent("error","MetaOSHandlerNotImplemented",{message:"Handler: launchTaskModule; OpenUrlActionType: ".concat(u)}),a=(0,o.Md)(n,u)}c.logEvent("info","OpenUrlActionClicked",{actionType:u}),n?n.onClick(a).then(e=>{e||i(a)}):i(a)}catch(v){c.logEvent("error","OpenUrlActionExecutionError",{actionType:u,message:(0,a.r)(v,"Error while executing OpenUrl action")})}}},35427:(e,t,n)=>{n.d(t,{r:()=>r});var a=n(11638),o=n(65043);const r=o.memo(e=>{const t=o.useRef(!1),{action:n,className:r,onClick:i}=e,[l,c]=o.useState(!1),s=o.useCallback(e=>t.current&&c(e),[]);o.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]);const d=o.useCallback(e=>{try{e.stopPropagation(),s(!0),i(n)}catch(t){}finally{s(!1)}},[i,n,s]);return o.createElement(a.Y,{className:r,text:n.title,disabled:l,onClick:d})});r.displayName="CardButton"},46675:(e,t,n)=>{function a(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every(e=>e)}catch(t){return!1}}n.d(t,{A:()=>a})},47137:(e,t,n)=>{n.d(t,{V:()=>r});var a=n(27051),o=n(48612);const r=async(e,t,n,r,i,l,c,s,d,u)=>{const{verificationStatus:m}=n;if(t&&"Unknown"===m&&"Installed"===e&&n.signature)try{if(!n.updateExtension)throw l.logEvent("error","NoUpdateExtensionFound",{message:"No update extension found while verifying cards"}),new Error("No update extension found");const t={cardId:n.cardId,metaOSAppId:n.appId,signature:n.signature,content:JSON.stringify(n.payload),verificationStatus:n.verificationStatus,extension:{updateExtendedProps:{type:"updateExtendedProps",data:(0,a.A)((0,a.A)({},n.updateExtension.data),{},{contentType:n.cardType})}}};if("function"===typeof r.cardVerify){const a=function(e){return e.cards[0].verificationStatus}(await r.cardVerify(t));c(a),(0,o.l)(n.appId,e,a,i,d,s,u)}}catch(p){}}},50317:(e,t,n)=>{function a(e){return Array.isArray(e)&&(null===e||void 0===e?void 0:e.length)>0}n.d(t,{u:()=>a})},81536:(e,t,n)=>{n.d(t,{v:()=>a});const a=(e,t,n)=>t?"Installed"===e&&"Success"===n?"Full":"None":"Full"},85226:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a=n(41851),o=n(94308),r=n(24720),i=n(64867),l=n(92964),c=n(47137),s=n(50317),d=n(1720),u=n(13569),m=n(25055),p=n(15357),v=n(65043),f=(0,p.m)({lookupString:function(e){return function(){return e}}},"LocalizationComponentsStringProvider");f.Provider;var y,h=n(17122);!function(e){e.activityImage="o365-connector-card-activity-image",e.activityTitle="o365-connector-card-activity-title",e.buttons="o365-connector-card-buttons",e.facts="o365-connector-card-fact",e.images="o365-connector-card-images",e.sectionTitle="o365-connector-card-section-title",e.title="o365-connector-card-title"}(y||(y={}));var g,k,E=n(35427);!function(e){e.Android="android",e.Default="default",e.IOS="iOS",e.Windows="windows"}(g||(g={})),function(e){e.OpenUri="OpenUri",e.ViewAction="ViewAction",e.HttpPOST="HttpPOST",e.ActionCard="ActionCard"}(k||(k={}));const w=e=>{switch(e["@type"]){case k.OpenUri:return{type:"openUrl",title:e.name,value:C(e)};case k.ViewAction:return{type:"openUrl",title:e.name,value:null===e||void 0===e?void 0:e.target[0]};case k.ActionCard:case k.HttpPOST:default:return{type:"unknown",title:e.name,value:""}}},C=e=>{var t;const n=null===e||void 0===e||null===(t=e.targets)||void 0===t?void 0:t.find(e=>e.os===g.Default);return(null===n||void 0===n?void 0:n.uri)||""},S=v.memo(e=>{let{actions:t,buttonClassName:n,containerClassName:a,onClick:o,payload:r}=e;return v.createElement(h.B,{horizontal:!0,wrap:!0,tokens:{childrenGap:20},className:a},t.map((e,t)=>v.createElement(h.B.Item,{key:t},v.createElement(E.r,{className:n,"data-tid":y.buttons,action:w(e),onClick:o,key:t,payload:r}))))});S.displayName="O365ConnectorCardButtonContainer";var N=n(27051),A=n(27663),I=n(97972),T=n(10615);const P=v.memo(e=>{const{fact:t,factClassName:n,textClassName:a}=e;return v.createElement(h.B,{horizontal:!0,tokens:{childrenGap:10}},v.createElement(T.E,{"data-tid":y.facts,className:n},v.createElement(I.I,{content:null===t||void 0===t?void 0:t.name})),v.createElement(m.F,{className:a,content:null===t||void 0===t?void 0:t.value}))});P.displayName="O365ConnectorCardFactRenderer";const O=v.memo(e=>{var t,n,a,o;const{section:r,styles:i,payload:l,onCardAction:c}=e,d=(0,s.u)(r.images)?null===(t=r.images)||void 0===t?void 0:t.map((e,t)=>v.createElement(h.B.Item,{key:t},v.createElement("div",null,e.image?v.createElement(A._,{key:t.toString(),src:e.image,"data-tid":y.images,height:160,width:160}):null))):null,u=(0,s.u)(r.facts)?null===(n=r.facts)||void 0===n?void 0:n.map((e,t)=>v.createElement(h.B.Item,{key:t},v.createElement(P,{factClassName:i.factName,textClassName:i.cardText,fact:e}))):null,p=r.potentialAction&&v.createElement(S,{actions:r.potentialAction,buttonClassName:i.cardButton,containerClassName:i.buttonStack,onClick:c,payload:l});return v.createElement(h.B,{tokens:{childrenGap:10}},v.createElement(m.F,{className:i.cardSubTitle,content:null===e||void 0===e||null===(a=e.section)||void 0===a?void 0:a.title,datatid:y.sectionTitle}),v.createElement(U,(0,N.A)({},e)),v.createElement(m.F,{className:i.cardText,content:null===e||void 0===e||null===(o=e.section)||void 0===o?void 0:o.text}),u,v.createElement(h.B,{horizontal:!0,tokens:{childrenGap:10},wrap:!0},d),p)});O.displayName="O365ConnectorCardSectionRenderer";const U=e=>{const{section:t,styles:n}=e;return v.createElement(h.B,{horizontal:!0,tokens:{childrenGap:10}},t.activityImage?v.createElement(A._,{key:t.activityImage,src:t.activityImage,"data-tid":y.activityImage,height:52,width:52}):null,v.createElement(h.B,{tokens:{childrenGap:10}},v.createElement(m.F,{className:n.cardSubTitle,content:null===t||void 0===t?void 0:t.activityTitle,datatid:y.activityTitle}),v.createElement(m.F,{className:n.cardSubTitle,content:t.activitySubtitle}),v.createElement(m.F,{className:n.cardText,content:t.activityText})))},b=()=>{const{cardData:e,isVerificationRequired:t,appStatus:n}=(0,a.f)(),{baseCardPerfMarker:p,logger:g}=(0,o.g)(),{cardChannelProvider:k,metaOSProvider:E,urlHandlerProvider:w}=(0,r.g)(),{setAppStatus:C,setMessageData:N,setVerificationStatus:A}=(0,i.t)(),{theme:I}=(0,l.d)(),T=v.useContext(f),P=e.payload,U=P.potentialAction,b=(0,d.u)(n,t,e.appId,e.verificationStatus,w,E,C,N,g,T),x=(0,u.O)(I),V=(0,s.u)(P.sections)?P.sections.map((e,t)=>v.createElement(h.B.Item,{key:t},v.createElement(O,{section:e,styles:x,onCardAction:b,payload:P}))):null;return v.useEffect(()=>{p.end(!0)},[p]),v.useEffect(()=>{(0,c.V)(n,t,e,k,E,g,A,N,C,T)},[n,k,e,t,E,C,N,A,T]),v.createElement(h.B,{tokens:{childrenGap:10},className:x.cardStack},v.createElement(m.F,{className:x.cardTitle,content:null===P||void 0===P?void 0:P.title,datatid:y.title}),v.createElement(m.F,{className:x.cardText,content:null===P||void 0===P?void 0:P.text}),V,U&&v.createElement(S,{actions:U,buttonClassName:x.cardButton,containerClassName:x.buttonStack,onClick:b,payload:P}))}}}]);
//# sourceMappingURL=card-loop-o365connectorscardview.275133f7.chunk.js.map