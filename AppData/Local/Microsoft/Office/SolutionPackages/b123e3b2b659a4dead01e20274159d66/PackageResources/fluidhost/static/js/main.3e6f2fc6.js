/*! For license information please see main.3e6f2fc6.js.LICENSE.txt */
(()=>{var e={488:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});const o={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},899:(e,t,r)=>{"use strict";r.d(t,{Mg:()=>n,qn:()=>o,u0:()=>i,xE:()=>s});const o=window.external;function n(){return o.GetContext?o.GetContext().GetAppUILocale():void 0}function i(){var e;return(null===(e=o.GetContext())||void 0===e?void 0:e.GetCorrelationId())||""}function s(){const e=null===o||void 0===o?void 0:o.GetHostInfo(),[,t]=e.split("="),[r,n]=t.split("$"),i="string"===typeof n?n:"";return{appName:"string"===typeof r?r:"Unknown",appVersion:(null===o||void 0===o?void 0:o.GetContext().GetHostFullVersion())||"",platform:i}}},2875:(e,t,r)=>{"use strict";r.d(t,{AH:()=>n,O0:()=>i});var o=r(26631);const n=e=>o.Ss.from(e,"base64").toString("utf8"),i=e=>o.Ss.from(e,"utf8").toString("base64")},3503:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});const o=new URLSearchParams("undefined"!==typeof location?location.search:"")},3542:(e,t,r)=>{"use strict";r.d(t,{DU:()=>i,Iy:()=>a});var o,n=r(96752);function i(e){o!==e&&(o=e)}function s(){return void 0===o&&(o="undefined"!==typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),o}function a(){return{rtl:s(),shadowConfig:n.ou}}o=s()},4041:(e,t,r)=>{"use strict";r.d(t,{$6:()=>o,Z_:()=>s});var o,n=r(15217);!function(e){e.wait="wait",e.viaHandle="viaHandle",e.payloadPending="payloadPending"}(o||(o={}));const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ(abcdefghijklmnopqrstuvwxyz)0123456789";function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"===typeof e)return e;(0,n.vA)(Number.isInteger(e)&&e>=0,2304);let r="",o=e;do{r=i[o%64]+r,o=Math.floor(o/64)-1}while(-1!==o);return t+r}},4311:(e,t,r)=>{"use strict";r.d(t,{RG:()=>u,ZQ:()=>h,fZ:()=>l});var o=r(69235),n=r(18206),i=r(40635),s=r(60138),a=r(56142),c=r(6971);const d=new s.z;async function l(){var e;const t=null!==(e=(await(0,c.E)()).graphEndpoint)&&void 0!==e?e:"https://graph.microsoft.com/",r=new URL(t+"v1.0/me/drive"),i=r.origin,s=await(0,n.z$)(e=>d.getTokenWithRetries([i],e),r.href);if(s.ok){const e=await s.json(),t=null===e||void 0===e?void 0:e.webUrl,r=t?t.split("/").slice(0,-1).join("/"):t;return{id:(null===e||void 0===e?void 0:e.id)||"",siteUrl:r||""}}throw new o.uV("Unable to get the Sharepoint drive info. [".concat(s.status," ").concat(s.statusText,"]"))}async function u(e){"string"===typeof e&&(e=new URL(e));const t=e.origin,r="".concat(t,"/_api/v2.0/shares/").concat(function(e){return"u!"+btoa(e).replace(/=+$/,"").replace("/","_").replace("+","-")}(e.href));(0,a.Rm)("Getting file name from Sharepoint...");const n=(await(0,i.y)({url:r,getToken:e=>d.getTokenWithRetries([t],e)})).result;if(n.ok){const e=await n.json();return(null===e||void 0===e?void 0:e.name)||""}throw new o.uV("Unable to get filename from Sharepoint. [".concat(n.status," ").concat(n.statusText,"]"))}async function h(e){var t;const r=null!==(t=(await(0,c.E)()).graphEndpoint)&&void 0!==t?t:"https://graph.microsoft.com/",i=new URL(r+"v1.0/me/drive/special/".concat(e)),s=i.origin,a=await(0,n.z$)(e=>d.getTokenWithRetries([s],e),i.href);if(a.ok){const e=await a.json();return(null===e||void 0===e?void 0:e.name)||""}throw new o.uV("Unable to get special folder name. [".concat(a.status," ").concat(a.statusText,"]"))}},4563:(e,t,r)=>{"use strict";function o(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var o=0,i=t;o<i.length;o++){n(e||{},i[o])}return e}function n(e,t,r){for(var o in void 0===r&&(r=[]),r.push(t),t)if(t.hasOwnProperty(o)&&"__proto__"!==o&&"constructor"!==o&&"prototype"!==o){var i=t[o];if("object"!==typeof i||null===i||Array.isArray(i))e[o]=i;else{var s=r.indexOf(i)>-1;e[o]=s?i:n(e[o]||{},i,r)}}return r.pop(),e}r.d(t,{z:()=>s});var i=r(40695);function s(e,t){var r,n,s;void 0===t&&(t={});var a=o({},e,t,{semanticColors:(0,i.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(r=t.palette)||void 0===r?void 0:r.themePrimary)&&!(null===(n=t.palette)||void 0===n?void 0:n.accent)&&(a.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var c=0,d=Object.keys(a.fonts);c<d.length;c++){var l=d[c];a.fonts[l]=o(a.fonts[l],t.defaultFontStyle,null===(s=null===t||void 0===t?void 0:t.fonts)||void 0===s?void 0:s[l])}return a}},5482:(e,t,r)=>{"use strict";r.d(t,{M4:()=>m,ZY:()=>p.ZY,qb:()=>p.qb,v6:()=>f});var o=r(18731),n=r(11582),i=r(89092),s=r(81793),a=r(56142),c=r(90293),d=r(94115),l=r(27377),u=r(64580),h=r(58443),g=r(69235),p=r(53783);const f="unknownError";function m(e,t,r){var p;let f;if(e instanceof g.uV)f=e.hydrateResult;else{const t=function(e){return(0,o.kN)(e)||(0,n.$T)(e)||(0,i.FX)(e)||(0,s.N2)(e)}(e);f=(0,u.G)(t)}var m;((0,a.vV)("Unable to load the Fluid container or component. ".concat(e)),null===(p=r.LoadPerfTracker)||void 0===p||p.setFailure(e),r.sendTelemetryForFailure(d.y.LoadComponentError,f,e),(0,l._)(),t)&&(null===(m=document.getElementById(h.L0))||void 0===m||m.focus());c.ux&&(c.ux.notify=!0)}},5667:(e,t,r)=>{"use strict";r.d(t,{n:()=>l});var o=r(78796),n=r(48116),i=r(26308),s=r(87416),a=r(63990),c=r(25532);const d=new Set;function l(e,t){const r=new URL(e);if([o.i,n.t].includes(r.origin.toLowerCase()))return"consumers";const l=r.hostname.toLowerCase(),u=(0,i.v6)(l);return null!==u&&void 0!==u&&u.guid?u.guid:u?u.hostname:(function(e,t){const r=new URL(e).hostname.toLowerCase();d.has(r)||(d.add(r),(0,a.l)(()=>{(0,c.J)(e,t).catch(()=>{}).finally(()=>d.delete(r))},{ensureExecution:!1}))}(e,t),(0,s.Xd)(e))}},6385:(e,t,r)=>{"use strict";r.d(t,{h:()=>$s});var o=r(69235),n=r(27051),i=r(23989),s=r(25045);function a(e){let{documentServiceFactory:t,createDocumentRequest:r}=e;return{get FluidDocumentServiceFactoryProvider(){return this},documentServiceFactory:t,getCreateDocumentRequest:r,get Disposable(){return this},dispose:()=>{}}}var c=r(53986),d=r(83125),l=r(75335);const u="16.8.2";var h=r(95720);const g=["logger"];function p(e){const t=Date.now(),r=(0,l.yb)(),{logger:o}=e,n=(0,c.A)(e,g);return{logger:o&&new d.p(h.Ak,o,{owhVersion:u}),newConfig:n,perfMetadata:{fluidBootstrapperStartTime:t},documentHiddenTrackerId:r}}const f="fluid";function m(e){return e===f||"fluid-odsp"===e||"fluid-odsp-extended"===e||"fluid-odsp-expansive"===e}var v=r(33788),y=r(47373);const b={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"},{dataCorruptionError:S,dataProcessingError:C}=b,k=(0,c.A)(b,["dataCorruptionError","dataProcessingError"]),w=(0,n.A)((0,n.A)({},k),{},{genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"}),P=()=>globalThis.performance.now(),T=10,E=20,I=30;Symbol.toStringTag;const N=new class{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}(()=>F(L())),A={getRawConfig:()=>{}},F=e=>void 0!==e&&null!==e?new O(void 0,{getRawConfig:t=>{try{var r,o;return null===(r=B(null!==(o=e.getItem(t))&&void 0!==o?o:void 0))||void 0===r?void 0:r.raw}catch(n){return}}}):A;function D(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function B(e){let t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch(i){}if(void 0===r)return t;const o=typeof r;if(D(o))return(0,n.A)((0,n.A)({},t),{},{raw:e,[o]:r});if(Array.isArray(r)){const o=typeof r[0];if(!D(o))return t;for(const e of r)if(typeof e!==o)return t;return(0,n.A)((0,n.A)({},t),{},{raw:e,["".concat(o,"[]")]:r})}return t}const L=()=>{try{var e;return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(t){return}};class O{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=[...o];for(;i.length>0;){const e=i.shift();void 0!==e&&_(e)&&!t.has(e)&&(t.add(e),e instanceof O?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}getStringArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const r of this.orderedBaseProviders){const o=B(null===r||void 0===r?void 0:r.getRawConfig(e));var t;if(void 0!==o)return this.configCache.set(e,o),null===(t=this.logger)||void 0===t||t.send((0,n.A)({category:"generic",eventName:"ConfigRead"},ve({configName:e,configValue:JSON.stringify(o)}))),o}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function x(e){const t=e;return _(null===t||void 0===t?void 0:t.config)&&void 0!==(null===t||void 0===t?void 0:t.logger)}function M(e){return x(e)?e:R(e,N.value)}function R(e){if(x(e))throw new Error("Logger is already a monitoring context");const t=e;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return t.config=new O(e,...o),t.logger=e,t}function _(e){return"function"===typeof(null===e||void 0===e?void 0:e.getRawConfig)}function H(e){return M(ue(e))}const U={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let j;const q=new Uint8Array(16);function V(){if(!j&&(j="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!j))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return j(q)}const z=[];for(let Zs=0;Zs<256;++Zs)z.push((Zs+256).toString(16).slice(1));function G(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return z[e[t+0]]+z[e[t+1]]+z[e[t+2]]+z[e[t+3]]+"-"+z[e[t+4]]+z[e[t+5]]+"-"+z[e[t+6]]+z[e[t+7]]+"-"+z[e[t+8]]+z[e[t+9]]+"-"+z[e[t+10]]+z[e[t+11]]+z[e[t+12]]+z[e[t+13]]+z[e[t+14]]+z[e[t+15]]}const W=function(e,t,r){if(U.randomUUID&&!t&&!e)return U.randomUUID();const o=(e=e||{}).random||(e.rng||V)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return G(o)},J=e=>"string"===typeof(null===e||void 0===e?void 0:e.errorInstanceId);function K(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&J(e)&&("function"===typeof(null===(t=e)||void 0===t?void 0:t.getTelemetryProperties)&&"function"===typeof(null===t||void 0===t?void 0:t.addTelemetryProperties));var t}const Q=e=>null!==e&&!Array.isArray(e)&&"object"===typeof e;function $(e,t){const r={message:"string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:String(e)};if(Q(e)){const{errorType:o,stack:n,name:i}=e;if("string"===typeof o&&(r.errorType=o),"string"===typeof n){const e="string"===typeof i?i:void 0;r.stack=((e,r)=>{if(!t)return e;const o=e.split("\n");return o.shift(),void 0!==r&&o.unshift(r),o.join("\n")})(n,e)}}return r}const Z=e=>"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties);function Y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;if(K(e))return e.addTelemetryProperties(null!==(r=t.props)&&void 0!==r?r:{}),e;const{message:o,stack:i}=$(e,!1),s=new se({message:o,stack:i});if("object"===typeof e&&null!==e){const t=e;let r;"canRetry"in e&&(null!==r&&void 0!==r||(r={}),r.canRetry=t.canRetry),"retryAfterSeconds"in e&&(null!==r&&void 0!==r||(r={}),r.retryAfterSeconds=t.retryAfterSeconds),void 0!==r&&Object.assign(s,r)}"object"!==typeof e&&s.addTelemetryProperties({typeofError:typeof e});const a=ne.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return s.addTelemetryProperties((0,n.A)((0,n.A)({},a),t.props)),s}let X;function ee(e){return function(e){const t=Error,r=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const o=new Error("<<generated stack>>");if(void 0===X&&(X=void 0!==o.stack),X)return t.stackTraceLimit=r,o;try{throw o}catch(n){return t.stackTraceLimit=r,n}}(e).stack}function te(e,t){const{message:r,stack:o}=$(e,!1),n=t(r);return void 0!==o&&re(n,o),oe(e)&&n.addTelemetryProperties({untrustedOrigin:1}),J(e)&&(n.overwriteErrorInstanceId(e.errorInstanceId),n.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),Z(e)&&n.addTelemetryProperties(e.getTelemetryProperties()),n}function re(e,t){try{Object.assign(e,{stack:t})}catch(r){e.addTelemetryProperties({stack2:t})}}function oe(e){if(ne.typeCheck(e)){if(e.errorType===ie){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}class ne extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=r,this._errorInstanceId=W(),r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[r,o]of Object.entries(t))void 0===e[r]&&(e[r]=o)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const r=this[t];e[t]=fe(r)}return(0,n.A)((0,n.A)({},e),{},{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}}const ie="genericError";class se extends ne{constructor(e){super(e.message),this.errorType=ie,void 0!==e.stack&&re(this,e.stack)}}const ae=["category","eventName"];var ce;function de(e){return Math.floor(e)}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(ce||(ce={}));class le{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,r){const{message:o,errorType:n,stack:i}=$(t,!0);if(e.stack=i,e.error=o,e.errorType=n,Z(t)){const r=t.getTelemetryProperties();for(const t of Object.keys(r))void 0===e[t]&&(e[t]=r[t])}void 0===e.stack&&r&&(e.stack=ee())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E;this.sendTelemetryEventCore((0,n.A)((0,n.A)({},e),{},{category:null!==(r=e.category)&&void 0!==r?r:"generic"}),t,"error"===e.category?I:o)}sendTelemetryEventCore(e,t,r){const o=function(e){let{category:t,eventName:r}=e,o=(0,c.A)(e,ae);const n={category:t,eventName:r};for(const i of Object.keys(o))n[i]=fe(o[i]);return n}(e);void 0!==t&&le.prepareErrorObject(o,t,!1),"number"===typeof o.duration&&(o.duration=de(o.duration)),this.send(o,r)}sendErrorEvent(e,t){this.sendTelemetryEventCore((0,n.A)((0,n.A)({error:e.eventName},e),{},{category:"error"}),t,I)}sendPerformanceEvent(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E;const i=(0,n.A)((0,n.A)({},e),{},{category:null!==(r=e.category)&&void 0!==r?r:"performance"});this.sendTelemetryEventCore(i,t,"error"===i.category?I:o)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,r=(0,n.A)({},e);return void 0!==this.namespace&&(r.eventName="".concat(this.namespace).concat(le.eventNamespaceSeparator).concat(r.eventName)),this.extendProperties(r,t)}extendProperties(e,t){const r=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,o]of Object.entries(t)){if(void 0!==r[e])continue;const t="function"===typeof o?o():o;void 0!==t&&(r[e]=t)}}return e}}le.eventNamespaceSeparator=":";function ue(e){return he.create(null===e||void 0===e?void 0:e.logger,null===e||void 0===e?void 0:e.namespace,null===e||void 0===e?void 0:e.properties)}class he extends le{static create(e,t,r){if(e instanceof he){const o={};for(const t of[e.properties,r])void 0!==t&&(void 0!==t.all&&(o.all=(0,n.A)((0,n.A)({},o.all),t.all)),void 0!==t.error&&(o.error=(0,n.A)((0,n.A)({},o.error),t.error)));const i=void 0===e.namespace?t:void 0===t?e.namespace:"".concat(e.namespace).concat(le.eventNamespaceSeparator).concat(t),s=new he(e.baseLogger,i,o);return!x(s)&&x(e)&&R(s,e.config),s}return new he(null!==e&&void 0!==e?e:{send(){}},t,r)}constructor(e,t,r){super(t,r),this.baseLogger=e,x(e)&&R(this,new O(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){var r;return(null!==t&&void 0!==t?t:E)<(null!==(r=this.baseLogger.minLogLevel)&&void 0!==r?r:E)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}class ge extends le{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0,i=void 0===t?void 0:(0,n.A)({},t);if(!0===o){const e=null!==i&&void 0!==i?i:i={};r.filter(e=>e instanceof le).map(e=>{var t;return null!==(t=e.properties)&&void 0!==t?t:{}}).forEach(t=>{Object.keys(t).forEach(r=>{e[r]=(0,n.A)((0,n.A)({},t[r]),null===e||void 0===e?void 0:e[r])})})}super(e,i),this.loggers=r,this._minLogLevelOfAllLoggers=E,this.calculateMinLogLevel()}get minLogLevel(){return this._minLogLevelOfAllLoggers}calculateMinLogLevel(){if(this.loggers.length>0){const t=[];for(const r of this.loggers){var e;t.push(null!==(e=r.minLogLevel)&&void 0!==e?e:E)}this._minLogLevelOfAllLoggers=Math.min(...t)}}addLogger(e){void 0!==e&&null!==e&&(this.loggers.push(e),this.calculateMinLogLevel())}send(e){const t=this.prepareEvent(e);for(const r of this.loggers)r.send(t)}}class pe{static start(e,t,r){return new pe(e,t,r,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}static timedExec(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=pe.start(e,t,o,pe.shouldReport(t,n));try{const e=r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}static async timedExecAsync(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=pe.start(e,t,o,pe.shouldReport(t,n));try{const e=await r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}get duration(){return P()-this.startTime}constructor(e,t){var r,o;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.logger=e,this.markers=i,this.emitLogs=s,this.startTime=P(),this.event=(0,n.A)({},t),this.markers.start&&this.reportEvent("start"),"object"===typeof window&&void 0!==(null===(r=window)||void 0===r||null===(r=r.performance)||void 0===r?void 0:r.mark)&&null!==(null===(o=window)||void 0===o||null===(o=o.performance)||void 0===o?void 0:o.mark)&&(this.startMark="".concat(t.eventName,"-start"),window.performance.mark(this.startMark))}reportProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e="".concat(this.event.eventName,"-end");window.performance.mark(e),window.performance.measure("".concat(this.event.eventName),this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",(0,n.A)({category:this.markers.cancel},e),t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;if(!this.emitLogs)return;const o=(0,n.A)((0,n.A)({},this.event),t);o.eventName="".concat(o.eventName,"_").concat(e),"start"!==e&&(o.duration=this.duration),this.logger.sendPerformanceEvent(o,r)}static shouldReport(e,t){var r;const o=".".concat(e.category,".").concat(e.eventName),n=null!==(r=pe.eventHits.get(o))&&void 0!==r?r:0;return pe.eventHits.set(o,n>=t?1:n+1),n%t===0}}function fe(e){return function(e){return"string"===typeof(null===e||void 0===e?void 0:e.tag)}(e)?{value:me(e.value),tag:e.tag}:me(e)}function me(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error("convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ".concat(typeof e,")")),"INVALID PROPERTY (typed as ".concat(typeof e,")")}}pe.eventHits=new Map;const ve=e=>((e,t)=>Object.entries(t).filter(e=>void 0!==e[1]).reduce((t,r)=>{const[o,n]=r;return t[o]="function"===typeof n?()=>({tag:e,value:n()}):{tag:e,value:n},t},{}))(ce.CodeArtifact,e);function ye(e){return"object"===typeof e&&null!==e&&e.errorType===w.locationRedirection}async function be(e,t,r,o){let n=t;const i=ue({logger:o,namespace:"LocationRedirection"});for(;;)try{return await e(n)}catch(s){if(!ye(s))throw s;i.sendTelemetryEvent({eventName:"LocationRedirectionError"});const e=s.redirectUrl;n={url:await r.getAbsoluteUrl(e,"",void 0),headers:n.headers}}}var Se=r(53783);function Ce(e){if("object"!==typeof(t=e)||null===t)return!1;var t;const r=e.errorType,o=e.statusCode;return"fileNotFoundOrAccessDeniedError"===r&&404===o}var ke=r(75460),we=r(52563),Pe=r(76899);var Te,Ee=r(60257);!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(Te||(Te={}));var Ie=r(78632);const Ne="Open",Ae="PostBoot",Fe="FileOpenFailed",De="ComponentLoadError",Be="ContainerConnectedTimeout",Le="ContainerLoadError";var Oe=r(87804),xe=r(93586);const Me="Loading chunk\\s[a-zA-Z0-9_-]+\\sfailed";function Re(e,t,r,o,i,s,a){const c=new d.p("QoS",e);(0,y.hO)(c,(0,n.A)({eventName:t,pillar:r,veto:o,errorType:i,isAce:!_e(a)},s),a)}function _e(e){if(!e)return!1;const t=e;return!(!t.errorType||![Oe.a.offlineError,Oe.a.fileNotFoundOrAccessDeniedError,Oe.a.authorizationError,xe.E.snapshotTooBig,xe.E.invalidFileNameError,Oe.a.fileOverwrittenInStorage,Be].some(e=>e===t.errorType))||!(!t.message||!new RegExp(Me).test(t.message))}const He=(e,t,r)=>{(0,Ie.t)(6e4,[r]).then(r=>{if(r&&!e.closed){const e=Be;Re(t,h.Qk,Ae,"ContainerConnectFailed",e,{},{message:"Timed out while connecting the container",errorType:e}),(0,y.hO)(t,{eventName:h.Qk,errorType:e,isUserImpacting:!0},{message:"Timed out while connecting the container",errorType:e})}}).catch(()=>{})},Ue=(e,t)=>{var r;const o={},n=e.resolvedUrl;n&&"id"in n&&(o.docId=n.id),null===(r=t.PersistedProperties)||void 0===r||r.addPersistedProperties(o)},je=(e,t)=>{const r=new ke.c;e.attachState!==Te.Attached?e.once("attached",()=>{Ue(e,t),He(e,t,r)}):(Ue(e,t),He(e,t,r)),e.once("closed",r=>{r&&(Re(t,h.Qk,Ae,"PostBootContainerClosed",r.errorType,{},r),(0,y.hO)(t,{eventName:h.Qk,errorType:r.errorType||h.Qk,isUserImpacting:!0,isExpected:Ce(r),isDirty:e.isDirty},r))}),e.once("connected",()=>{r.resolve()})};var qe,Ve=r(65317);class ze{get Disposable(){return this}get NamespaceLogger(){return this}sendWithNamespace(e,t){this.runtimeLogger.sendWithNamespace(e,t)}send(e){let t=e;if("performance"===e.category){const r=e.duration,o=Date.now(),i="number"===typeof r?o-r:void 0;t=(0,n.A)((0,n.A)({},this.perfMetadata),{},{startTime:i,documentEverHidden:this.documentHiddenTrackerId&&(0,l.xl)(this.documentHiddenTrackerId)>-1},t)}void 0===t.opMessageAgeMs&&"number"===typeof t.messageTimestamp&&(t=(0,n.A)({opMessageAgeMs:Date.now()-t.messageTimestamp},t)),t.message&&(t.message=(0,Ve.ku)(t.message.toString())),t.stack&&(t.stack=(0,Ve.ku)(t.stack.toString())),t.error&&(t.error=(0,Ve.ku)(t.error.toString())),t.errorMessage&&(t.errorMessage=(0,Ve.ku)(t.errorMessage.toString())),t.responseMessage&&(t.responseMessage=(0,Ve.ku)(t.responseMessage.toString())),this.runtimeLogger.send(t)}dispose(){this.runtimeLogger.Disposable.dispose()}constructor(e,t,r,o){this.perfMetadata=t,this.documentHiddenTrackerId=r,this.runtimeLogger=new d.p("FluidRuntime",e,o)}}function Ge(e){e.closed||e.attachState!==Te.Attached&&void 0!==e.attachState||e.connect()}!function(e){e[e.Disconnected=0]="Disconnected",e[e.EstablishingConnection=3]="EstablishingConnection",e[e.CatchingUp=1]="CatchingUp",e[e.Connected=2]="Connected"}(qe||(qe={}));var We,Je=r(13760);class Ke extends Je.b{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}!function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(We||(We={}));const Qe=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid),$e=e=>{const t=e;return"object"===typeof t&&("string"===typeof(null===t||void 0===t?void 0:t.package)||Qe(null===t||void 0===t?void 0:t.package))&&(void 0===(null===t||void 0===t?void 0:t.config)||"object"===typeof(null===t||void 0===t?void 0:t.config))};function Ze(e,t){e||function(e){throw new Error("number"===typeof e?"0x".concat(e.toString(16).padStart(3,"0")):e)}(t)}const Ye=e=>"object"===typeof e&&null!==e;function Xe(e){throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case")}var et,tt,rt,ot;!function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(et||(et={})),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(tt||(tt={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(rt||(rt={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(ot||(ot={}));const nt=async e=>new Promise(t=>setTimeout(()=>t(),e));var it;function st(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?it.Online:it.Offline:it.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(it||(it={}));class at extends ne{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=w.genericNetworkError}}class ct extends ne{constructor(e,t,r){super(e,(0,n.A)((0,n.A)({},t),{},{statusCode:400})),this.errorType=ct.errorType,this.canRetry=!1,this.storageOnlyReason=r}}ct.errorType=w.deltaStreamConnectionForbidden;class dt extends ne{constructor(e,t,r,o){super(e,o),this.errorType=t,this.canRetry=r}}class lt extends dt{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}}class ut extends ne{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=w.throttlingError,this.canRetry=!0}}const ht=e=>!0===(null===e||void 0===e?void 0:e.canRetry),gt=e=>void 0!==(null===e||void 0===e?void 0:e.retryAfterSeconds)?1e3*e.retryAfterSeconds:void 0;async function pt(e,t,r,o){let n,i=!1,s=500,a=0;const c=P();let d;do{try{n=await e(o.cancel),i=!0}catch(u){var l;if(!ht(u))throw r.sendTelemetryEvent({eventName:"".concat(t,"_cancel"),retry:a,duration:P()-c,fetchCallName:t},u),u;if(!0===(null===(l=o.cancel)||void 0===l?void 0:l.aborted))throw r.sendTelemetryEvent({eventName:"".concat(t,"_runWithRetryAborted"),retry:a,duration:P()-c,fetchCallName:t,reason:o.cancel.reason},u),new lt("runWithRetry was Aborted",w.genericError,{driverVersion:"2.23.0",fetchCallName:t,reason:o.cancel.reason});0===a&&r.sendTelemetryEvent({eventName:"".concat(t,"_firstFailed"),duration:P()-c,fetchCallName:t},u),a++,d=u,s=vt(s,u),o.onRetry&&o.onRetry(s,u),await nt(s)}}while(!i);return a>0&&r.sendTelemetryEvent({eventName:"".concat(t,"_lastError"),retry:a,duration:P()-c,fetchCallName:t},d),n}const ft=6e4,mt=8e3;function vt(e,t){const r=gt(t);let o=Math.max(null!==r&&void 0!==r?r:0,2*e);return o=Math.min(o,K(t)&&!0===t.getTelemetryProperties().endpointReached?ft:mt),o}function yt(e){for(var t,r,o=arguments.length,n=new Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];if(void 0===(null===e||void 0===e?void 0:e.tree)||(null===(t=e.tree)||void 0===t||null===(t=t[".app"])||void 0===t?void 0:t.type)!==et.Tree||(null===(r=e.tree)||void 0===r||null===(r=r[".protocol"])||void 0===r?void 0:r.type)!==et.Tree)return!1;return 2===Object.keys(e.tree).filter(e=>!n.includes(e)).length}function bt(e){return void 0!==e&&"snapshotFormatV"in e&&1===e.snapshotFormatV}function St(e){return bt(e)?e.snapshotTree:e}var Ct=r(34445);function kt(e,t){switch(t){case"base64":return Ct.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const wt=(e,t)=>Et.from(e,t).buffer,Pt=(e,t)=>Et.from(e).toString(t);function Tt(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class Et extends Uint8Array{toString(e){return kt(this,e)}static from(e,t,r){if("string"===typeof e)return Et.fromString(e,t);if(null!==e&&"object"===typeof e&&Tt(e.buffer))return Et.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(Tt(e))return Et.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const o=null!==t&&void 0!==t?t:0,n=null!==r&&void 0!==r?r:e.byteLength-o;if(o<0||o>e.byteLength||n<0||n+o>e.byteLength)throw new RangeError("Invalid range specified.");return new Et(e,o,n)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=Ct.toByteArray(t);return new Et(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new Et(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}async function It(e,t){const r=await e.readBlob(t),o=Pt(r,"utf8");return JSON.parse(o)}class Nt extends ne{constructor(e,t,r){super(e,r,new Set(["error"])),this.error=t,this.errorType=b.genericError}}class At extends ne{constructor(e,t){super(e,(0,n.A)((0,n.A)({},t),{},{usageError:!0})),this.errorType=b.usageError}}class Ft extends ne{constructor(e,t){super(e,(0,n.A)((0,n.A)({},t),{},{dataProcessingError:1})),this.errorType=b.dataCorruptionError,this.canRetry=!1}}class Dt extends ne{constructor(e,t){super(e,t),this.errorType=b.dataProcessingError,this.canRetry=!1}static create(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=Dt.wrapIfUnrecognized(e,t,r);return n.addTelemetryProperties(o),n}static wrapIfUnrecognized(e,t,r){const o=Y(e,{props:(0,n.A)({dataProcessingError:1,dataProcessingCodepath:t},void 0===r?void 0:Bt(r))});if(oe(o)||o.errorType===ie){const e=te(o,e=>new Dt(e));return e.addTelemetryProperties(o.getTelemetryProperties()),e}return o}}const Bt=e=>({messageClientId:null===e.clientId?"null":e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp}),Lt="connected";class Ot extends Ke{constructor(e){super(),this.errorHandler=e}emit(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}catch(n){return this.errorHandler(e,n),!0}}}const xt="object"===typeof self?self:globalThis,Mt=e=>((e,t)=>{const r=(t,r)=>(e.set(r,t),t),o=n=>{if(e.has(n))return e.get(n);const[i,s]=t[n];switch(i){case 0:case-1:return r(s,n);case 1:{const e=r([],n);for(const t of s)e.push(o(t));return e}case 2:{const e=r({},n);for(const[t,r]of s)e[o(t)]=o(r);return e}case 3:return r(new Date(s),n);case 4:{const{source:e,flags:t}=s;return r(new RegExp(e,t),n)}case 5:{const e=r(new Map,n);for(const[t,r]of s)e.set(o(t),o(r));return e}case 6:{const e=r(new Set,n);for(const t of s)e.add(o(t));return e}case 7:{const{name:e,message:t}=s;return r(new xt[e](t),n)}case 8:return r(BigInt(s),n);case"BigInt":return r(Object(BigInt(s)),n);case"ArrayBuffer":return r(new Uint8Array(s).buffer,s);case"DataView":{const{buffer:e}=new Uint8Array(s);return r(new DataView(e),s)}}return r(new xt[i](s),n)};return o})(new Map,e)(0),Rt="",{toString:_t}={},{keys:Ht}=Object,Ut=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const r=_t.call(e).slice(8,-1);switch(r){case"Array":return[1,Rt];case"Object":return[2,Rt];case"Date":return[3,Rt];case"RegExp":return[4,Rt];case"Map":return[5,Rt];case"Set":return[6,Rt];case"DataView":return[1,r]}return r.includes("Array")?[1,r]:r.includes("Error")?[7,r]:[2,r]},jt=e=>{let[t,r]=e;return 0===t&&("function"===r||"symbol"===r)},qt=function(e){let{json:t,lossy:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=[];return((e,t,r,o)=>{const n=(e,t)=>{const n=o.push(e)-1;return r.set(t,n),n},i=o=>{if(r.has(o))return r.get(o);let[s,a]=Ut(o);switch(s){case 0:{let t=o;switch(a){case"bigint":s=8,t=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);t=null;break;case"undefined":return n([-1],o)}return n([s,t],o)}case 1:{if(a){let e=o;return"DataView"===a?e=new Uint8Array(o.buffer):"ArrayBuffer"===a&&(e=new Uint8Array(o)),n([a,[...e]],o)}const e=[],t=n([s,e],o);for(const r of o)e.push(i(r));return t}case 2:{if(a)switch(a){case"BigInt":return n([a,o.toString()],o);case"Boolean":case"Number":case"String":return n([a,o.valueOf()],o)}if(t&&"toJSON"in o)return i(o.toJSON());const r=[],c=n([s,r],o);for(const t of Ht(o))!e&&jt(Ut(o[t]))||r.push([i(t),i(o[t])]);return c}case 3:return n([s,o.toISOString()],o);case 4:{const{source:e,flags:t}=o;return n([s,{source:e,flags:t}],o)}case 5:{const t=[],r=n([s,t],o);for(const[n,s]of o)(e||!jt(Ut(n))&&!jt(Ut(s)))&&t.push([i(n),i(s)]);return r}case 6:{const t=[],r=n([s,t],o);for(const n of o)!e&&jt(Ut(n))||t.push(i(n));return r}}const{message:c}=o;return n([s,{name:a,message:c}],o)};return i})(!(t||r),!!t,new Map,o)(e),o},Vt="function"===typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?Mt(qt(e,t)):structuredClone(e):(e,t)=>Mt(qt(e,t));function zt(e){var t,r;const o=new URL(e);if("string"!==typeof o.pathname)throw new ne("Failed to parse pathname");const n=null!==(t=o.search)&&void 0!==t?t:"",i=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(o.pathname);return 3===(null===i||void 0===i?void 0:i.length)?{id:i[1],path:i[2],query:n,version:null!==(r=o.searchParams.get("version"))&&void 0!==r?r:void 0}:void 0}function Gt(e,t){Ze(!yt(e),1448),Ze(!yt(t),1449);return{type:et.Tree,tree:{".protocol":t,".app":e}}}function Wt(e){let t={};const r={blobs:{},trees:{},id:W(),unreferenced:e.unreferenced,groupId:e.groupId};for(const[o,i]of Object.entries(e.tree))switch(i.type){case et.Tree:{const e=Wt(i);r.trees[o]=e.baseSnapshot,t=(0,n.A)((0,n.A)({},t),e.snapshotBlobs);break}case et.Attachment:r.blobs[o]=i.id;break;case et.Blob:{const e=W();r.blobs[o]=e;const n=i.content instanceof Uint8Array?kt(i.content):i.content;t[e]=n;break}case et.Handle:throw new ne("No handles should be there in summary in detached container!!");default:Xe(i,"Unknown tree type ".concat(i.type))}return{baseSnapshot:r,snapshotBlobs:t}}function Jt(e){Ze(void 0!==e.sequenceNumber,2362);const t={};for(const[r,o]of e.blobContents.entries())t[r]=Pt(o,"utf8");return{baseSnapshot:e.snapshotTree,snapshotBlobs:t,snapshotSequenceNumber:e.sequenceNumber}}function Kt(e,t){const r={type:et.Tree,tree:(0,n.A)({},t.tree)};r.tree[".protocol"]=e;return Wt(r)}const Qt=e=>{Ze(yt(e),2278);return Kt(e.tree[".protocol"],e.tree[".app"])};function $t(e){return".protocol"in e.trees?e.trees[".protocol"]:e}const Zt=(e,t)=>{const r={};for(const[,n]of Object.entries(e.blobs))void 0!==t[n]&&(r[n]=wt(t[n],"utf8"));const o={};for(const[n,i]of Object.entries(e.trees))o[n]=Zt(i,t);return(0,n.A)((0,n.A)({},e),{},{blobsContents:r,trees:o})};function Yt(e){return"object"===typeof e&&null!==e&&(null===e||void 0===e?void 0:e.errorType)===w.deltaStreamConnectionForbidden}const Xt=e=>{let t;return function(){for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return void 0!==t?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>Object.is(e,t);return e===t||e.length===t.length&&e.every((e,o)=>r(e,t[o],o))}(t.args,o)?t.result:Promise.reject(new At("Subsequent calls cannot use different arguments.")):(t={args:o,result:e(...o).finally(()=>t=void 0)},t.result)}};async function er(e,t){if(void 0===t)return{minimumSequenceNumber:0,sequenceNumber:0};const r=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"];return await It(e,r)}class tr extends Ke{constructor(){super(),this.members=new Map,super.setMaxListeners(0)}getSelf(){return void 0===this._currentClientId?void 0:{clientId:this._currentClientId,client:this.getMember(this._currentClientId)}}setCurrentClientId(e){if(this._currentClientId!==e){const t=this._currentClientId;this._currentClientId=e,this.emit("selfChanged",void 0===t?void 0:{clientId:t},{clientId:e,client:this.getMember(e)})}}addMember(e,t){if(this.members.has(e)){const r=this.members.get(e);Ze(JSON.stringify(r)===JSON.stringify(t),1202)}else this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){const t=this.members.get(e);return void 0!==t&&(this.members.delete(e),this.emit("removeMember",e,t),!0)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}}var rr,or;function nr(e,t,r){const o=(0,n.A)({},t),i=null===r||void 0===r?void 0:r.online;if(o.online="string"===typeof i?i:it[st()],"object"===typeof navigator&&null!==navigator){var s,a;const e=navigator,t=null!==(s=null!==(a=e.connection)&&void 0!==a?a:e.mozConnection)&&void 0!==s?s:e.webkitConnection;null!==t&&"object"===typeof t&&(o.connectionType=t.type)}o.category=ht(r)?"generic":"error",e.sendTelemetryEvent(o,r)}function ir(e){return e.type===tt.Operation}!function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(rr||(rr={})),function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(or||(or={}));const sr=e=>({name:Qe(null===e||void 0===e?void 0:e.package)?null===e||void 0===e?void 0:e.package.name:null===e||void 0===e?void 0:e.package});var ar=r(71724);class cr extends Ke{get disposed(){return this.isDisposed}get paused(){return 0!==this.pauseCount}get length(){return this.q.length}get idle(){return void 0===this.processingPromise&&0===this.q.length}async waitTillProcessingDone(){var e;return null!==(e=this.processingPromise)&&void 0!==e?e:{count:0,duration:0}}constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new ar,this.pauseCount=1}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(t){this.emit("error",t)}}async pause(){this.pauseCount++,await this.waitTillProcessingDone()}resume(){Ze(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&void 0===this.processingPromise&&(this.processingPromise=Promise.resolve().then(()=>{Ze(void 0!==this.processingPromise,895);const e=this.processDeltas();return Ze(void 0!==this.processingPromise,896),this.processingPromise=void 0,e}).catch(e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0})),Ze(void 0!==this.processingPromise,897))}anythingToProcess(){return this.q.length>0&&!this.paused&&void 0===this.error}processDeltas(){const e=P();let t=0;for(;this.anythingToProcess();){const e=this.q.shift();t++,this.worker(e),this.emit("op",e)}const r=P()-e;return 0===this.q.length&&this.emit("idle",t,r),{count:t,duration:r}}}var dr=r(87987);const{EventEmitter:lr}=dr;class ur{constructor(e,t,r,o){this.sequenceNumber=e,this.key=t,this.value=r,this.local=o}}class hr extends Ke{get disposed(){return this.isDisposed}constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}snapshot(){var e;return null!==(e=this.snapshotCache)&&void 0!==e||(this.snapshotCache=[...this.members]),this.snapshotCache}addMember(e,t){Ze(!!e,2464),Ze(!this.members.has(e),2465),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}removeMember(e){Ze(!!e,2466),Ze(this.members.has(e),2467),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}}class gr extends Ke{get disposed(){return this.isDisposed}constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new lr,this.proposals=new Map(e.proposals.map(e=>{let[,t]=e;return[t.sequenceNumber,new ur(t.sequenceNumber,t.key,t.value,!1)]})),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}snapshot(){var e,t;return null!==(e=this.proposalsSnapshotCache)&&void 0!==e||(this.proposalsSnapshotCache=[...this.proposals].map(e=>{let[t,r]=e;return[t,{sequenceNumber:t,key:r.key,value:r.value},[]]})),null!==(t=this.valuesSnapshotCache)&&void 0!==t||(this.valuesSnapshotCache=[...this.values]),{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){var t;return null===(t=this.values.get(e))||void 0===t?void 0:t.value}async propose(e,t){const r=this.sendProposal(e,t);if(r<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise((e,t)=>{let o;const n=(e,t)=>{e===r&&(o=t,this.stateEvents.off("localProposalSequenced",n),this.stateEvents.off("disconnected",s),this.stateEvents.on("localProposalApproved",i))},i=t=>{t===o&&(e(),c())},s=()=>{void 0===o&&this.stateEvents.once("connected",()=>{void 0===o&&(t(new Error("Client disconnected without successfully sending proposal")),c())})},a=()=>{t(new Error("QuorumProposals was disposed")),c()},c=()=>{this.stateEvents.off("localProposalSequenced",n),this.stateEvents.off("localProposalApproved",i),this.stateEvents.off("disconnected",s),this.stateEvents.off("disposed",a)};this.stateEvents.on("localProposalSequenced",n),this.stateEvents.on("disconnected",s),this.stateEvents.on("disposed",a)})}addProposal(e,t,r,o,n){Ze(!this.proposals.has(r),2468);const i=new ur(r,e,t,o);this.proposals.set(r,i),this.emit("addProposal",i),o&&this.stateEvents.emit("localProposalSequenced",n,r),this.proposalsSnapshotCache=void 0}updateMinimumSequenceNumber(e){const t=e.minimumSequenceNumber,r=[];for(const[o,n]of this.proposals)o<=t&&r.push(n);r.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);for(const o of r){const t={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:o.key,sequenceNumber:o.sequenceNumber,value:o.value};this.values.set(t.key,t),this.valuesSnapshotCache=void 0;let r=!1,n=!1;for(const[,e]of this.proposals)if(e.key===t.key){if(n){r=!1;break}r=!0,n=!0}this.emit("approveProposal",t.sequenceNumber,t.key,t.value,t.approvalSequenceNumber),r&&this.emit("approveProposalComplete",t.sequenceNumber,t.key,t.value,t.approvalSequenceNumber),this.proposals.delete(o.sequenceNumber),this.proposalsSnapshotCache=void 0,o.local&&this.stateEvents.emit("localProposalApproved",o.sequenceNumber)}}setConnectionState(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}dispose(){this.isDisposed=!0,this.stateEvents.emit("disposed")}}class pr extends Ke{get disposed(){return this.isDisposed}constructor(e,t,r,o){super(),this.isDisposed=!1,this.quorumClients=new hr(e),this.quorumClients.on("addMember",(e,t)=>{this.emit("addMember",e,t)}),this.quorumClients.on("removeMember",e=>{this.emit("removeMember",e)}),this.quorumProposals=new gr({proposals:t,values:r},o),this.quorumProposals.on("addProposal",e=>{this.emit("addProposal",e)}),this.quorumProposals.on("approveProposal",(e,t,r,o)=>{this.emit("approveProposal",e,t,r,o)})}close(){this.removeAllListeners()}snapshot(){const e=this.quorumClients.snapshot(),{proposals:t,values:r}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:r}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(){return this.quorumClients.getMembers()}getMember(e){return this.quorumClients.getMember(e)}async propose(e,t){return this.quorumProposals.propose(e,t)}addProposal(e,t,r,o,n){return this.quorumProposals.addProposal(e,t,r,o,n)}updateMinimumSequenceNumber(e){this.quorumProposals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}class fr{get quorum(){return this._quorum}constructor(e,t,r,o,n,i){this.minimumSequenceNumber=e,this.sequenceNumber=t,this._quorum=new pr(r,o,n,i)}get attributes(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error("Protocol state is not moving sequentially. "+"Current is ".concat(this.sequenceNumber,". Next is ").concat(e.sequenceNumber));this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let r=!1;switch(e.type){case tt.ClientJoin:{const t=e,r=JSON.parse(t.data),o={client:r.detail,sequenceNumber:t.sequenceNumber};this._quorum.addMember(r.clientId,o);break}case tt.ClientLeave:{const t=e,r=JSON.parse(t.data);this._quorum.removeMember(r);break}case tt.Propose:{"string"===typeof e.contents&&(e.contents=JSON.parse(e.contents));const o=e.contents;this._quorum.addProposal(o.key,o.value,e.sequenceNumber,t,e.clientSequenceNumber),r=!0;break}}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:r}}getProtocolState(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this._quorum.snapshot();return e&&(t.members=t.members.map(e=>{let[t,r]=e;return[t,(0,n.A)((0,n.A)({},r),{},{client:(0,n.A)((0,n.A)({},r.client),{},{user:{id:""}})})]})),(0,n.A)({sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber},t)}}var mr;!function(e){e.ClientJoin="join",e.ClientLeave="leave",e.Clear="clear"}(mr||(mr={}));class vr extends fr{constructor(e,t,r,o,n){super(e.minimumSequenceNumber,e.sequenceNumber,t.members,t.proposals,t.values,r),this.audience=o,this.shouldClientHaveLeft=n;for(const[i,s]of this.quorum.getMembers())o.addMember(i,s.client);this.quorum.on("addMember",(e,t)=>o.addMember(e,t.client)),this.quorum.on("removeMember",e=>o.removeMember(e))}processMessage(e,t){if(null!=e.clientId){if(void 0===this.quorum.getMember(e.clientId)&&e.type!==tt.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(this.shouldClientHaveLeft(e.clientId)&&!function(e){return e.type===tt.NoOp||e.type===tt.Accept}(e))throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}processSignal(e){const t=e.content;switch(t.type){case mr.Clear:{const e=this.audience.getMembers();for(const[t,r]of e)"read"===r.mode&&this.audience.removeMember(t);break}case mr.ClientJoin:{const e=t.content;"read"===e.client.mode&&this.audience.addMember(e.clientId,e.client);break}case mr.ClientLeave:{var r;const e=t.content;"read"===(null===(r=this.audience.getMember(e))||void 0===r?void 0:r.mode)&&this.audience.removeMember(e);break}}}}const yr={fatalConnectError:!0};function br(e){return function(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new ut(e,t.retryAfterMs/1e3,r):new at(e,t.canRetry,r)}("Nack (".concat(e.type,"): ").concat(e.message),{canRetry:403!==e.code,retryAfterMs:void 0===e.retryAfter?void 0:1e3*e.retryAfter},{statusCode:e.code,driverVersion:void 0})}const Sr={mode:"read",details:{capabilities:{interactive:!0}},permission:[],user:{id:"storage-only client"},scopes:[]},Cr="storage-only client";class kr extends Ke{constructor(e,t){super(),this.storageOnlyReason=e,this.readonlyConnectionReason=t,this.clientId=Cr,this.claims={scopes:[rr.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[{client:Sr,clientId:Cr}],this.serviceConfiguration={maxMessageSize:0,blockSize:0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map(e=>({operation:e,content:{message:"Cannot submit with storage-only connection",code:403}})))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}}function wr(e){return e instanceof kr}const Pr=async()=>{var e;if(!1===(null===(e=globalThis.navigator)||void 0===e?void 0:e.onLine)&&void 0!==globalThis.addEventListener)return new Promise(e=>{const t=()=>{e(),globalThis.removeEventListener("online",t)};globalThis.addEventListener("online",t)})};class Tr{get connectionVerboseProps(){return this._connectionVerboseProps}get connectionMode(){var e,t;return null!==(e=null===(t=this.connection)||void 0===t?void 0:t.mode)&&void 0!==e?e:"read"}get connected(){return void 0!==this.connection}get clientId(){var e;return null===(e=this.connection)||void 0===e?void 0:e.clientId}get connectionDetails(){return this._connectionDetails}get reconnectMode(){return this._reconnectMode}get maxMessageSize(){var e,t;return null!==(e=null===(t=this.connection)||void 0===t||null===(t=t.serviceConfiguration)||void 0===t?void 0:t.maxMessageSize)&&void 0!==e?e:16384}get version(){if(void 0===this.connection)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){var e;return null===(e=this.connection)||void 0===e?void 0:e.serviceConfiguration}get scopes(){var e;return null===(e=this.connection)||void 0===e?void 0:e.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return void 0===this.connection?(0,n.A)((0,n.A)({},this._connectionProps),{},{sentOps:this.clientSequenceNumber}):this._connectionProps}shouldJoinWrite(){const e=this.clientSequenceNumberObserved<this.clientSequenceNumber-this.localOpsToIgnore,t=this.containerDirty();return e!==t&&this.logger.sendTelemetryEvent({eventName:"DesiredConnectionModeMismatch",details:JSON.stringify({outstandingOps:e,isDirty:t})}),e||t}get readonly(){return this.readOnlyInfo.readonly}get readOnlyInfo(){let e,t=!1;return wr(this.connection)&&(t=!0,e=this.connection.storageOnlyReason),t||this._forceReadonly||!0===this._readonlyPermissions?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:t,storageOnlyReason:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e,t){return{claims:e.claims,clientId:e.clientId,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version,reason:t}}constructor(e,t,r,o,n,i){this.serviceProvider=e,this.containerDirty=t,this.client=r,this.logger=n,this.props=i,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.localOpsToIgnore=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this._disposed=!1,this.opHandler=(e,t)=>{const r=Array.isArray(t)?t:[t];this.props.incomingOpHandler(r,"opHandler")},this.signalHandler=e=>{const t=Array.isArray(e)?e:[e];this.props.signalHandler(t)},this.nackHandler=(e,t)=>{const r=t[0];if(!0===this._readonlyPermissions)return void this.props.closeHandler(((e,t)=>new lt(e,w.writeError,t))("writeOnReadOnlyDocument",{driverVersion:void 0}));const o=br(r.content);o.canRetry?this.reconnectOnError("write",o):this.props.closeHandler(o)},this.disconnectHandlerInternal=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.errorHandler=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=o?or.Enabled:or.Never,this._outbound=new cr(e=>{if(void 0===this.connection)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(e)}),this._outbound.on("error",e=>{this.props.closeHandler(Y(e))})}dispose(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._disposed)return;this._disposed=!0,this._reconnectMode=or.Never,this._outbound.clear();const r={text:"Closing DeltaManager",error:e},o=this.readonly;this.disconnectFromDeltaStream(r),t&&this.set_readonlyPermissions(!0,o,r)}setAutoReconnect(e,t){Ze(e!==or.Never&&this._reconnectMode!==or.Never,632),this._reconnectMode=e,e!==or.Enabled&&this.disconnectFromDeltaStream(t)}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});const t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===or.Never)throw new At("API is not supported for non-connecting or closed container");let e=!1;!0===this.readonly&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),e=this.disconnectFromDeltaStream({text:"Force readonly"})),this.props.readonlyChangeHandler(this.readonly),e&&this.triggerConnect({text:"Force Readonly"},"read")}}set_readonlyPermissions(e,t,r){this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly,r)}connect(e,t){this.connectCore(e,t).catch(e=>{const t=Y(e,{props:yr});this.props.closeHandler(t)})}async connectCore(e,t){var r;Ze(!this._disposed,618);let o=null!==t&&void 0!==t?t:this.defaultReconnectionMode;if(this.shouldJoinWrite()&&(o="write"),void 0!==this.connection||void 0!==this.pendingConnection){var i,s,a;const e=null!==(i=null===(s=this.connection)||void 0===s?void 0:s.mode)&&void 0!==i?i:null===(a=this.pendingConnection)||void 0===a?void 0:a.connectionMode;return void(e!==o&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",connected:void 0!==this.connection,mode:e,requestedMode:o,stack:ee()}))}const c=this.serviceProvider();let d;if(Ze(void 0!==c,679),this.props.establishConnectionHandler(e),!0===(null===(r=c.policies)||void 0===r?void 0:r.storageOnly))return d=new kr,this.setupNewSuccessfulConnection(d,"read",e),void Ze(void 0===this.pendingConnection,691);let l=500,u=0;const h=P();let g;const p=new AbortController,f=p.signal;for(this.pendingConnection={abort:()=>{p.abort()},connectionMode:o};void 0===d;){if(this._disposed)throw new Error("Attempting to connect a closed DeltaManager");if(!0===f.aborted)return void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:u,duration:de(P()-h),connectionEstablished:!1});u++;try{this.client.mode=o,d=await c.connectToDeltaStream((0,n.A)((0,n.A)({},this.client),{},{mode:o})),d.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),d=void 0),this.logger.sendTelemetryEvent({eventName:"ConnectionReceived",connected:void 0!==d&&!1===d.disposed},void 0,T)}catch(v){var m;if(this.logger.sendTelemetryEvent({eventName:"ConnectToDeltaStreamException",connected:void 0!==d&&!1===d.disposed},void 0,T),Yt(v)){d=new kr(v.storageOnlyReason,{text:v.message,error:v}),o="read";break}if(K(v)&&v.errorType===w.outOfStorageError){d=new kr(void 0,{text:v.message,error:v}),o="read";break}if(!ht(v)){const e=Y(v,{props:yr});throw this.props.closeHandler(e),e}if(nr(this.logger,{attempts:u,delay:l,eventName:"DeltaConnectionFailureToConnect",duration:de(P()-h)},v),g=v,this.reconnectMode!==or.Enabled)return;const e=P(),t=gt(v);void 0===t&&!1===(null===(m=globalThis.navigator)||void 0===m?void 0:m.onLine)||(l=vt(l,v)),void 0!==t&&this.props.reconnectionDelayHandler(l,v),await new Promise(e=>{setTimeout(e,l)}),await Pr(),this.logger.sendPerformanceEvent({eventName:"WaitBetweenConnectionAttempts",duration:P()-e,details:JSON.stringify({retryDelayFromError:t,delayMs:l})})}}if(u>1&&nr(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:u,duration:de(P()-h)},g),!0===f.aborted||this._disposed)return d.dispose(),void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:u,duration:de(P()-h),connectionEstablished:!0});this.setupNewSuccessfulConnection(d,o,e)}triggerConnect(e,t){this.reconnectMode===or.Enabled&&this.connect(e,t)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,void 0===this.connection)return void 0!==this.pendingConnection&&(this.cancelConnection(e),!0);Ze(void 0===this.pendingConnection,635);const t=this.connection;return this.connection=void 0,this._connectionDetails=void 0,t.off("op",this.opHandler),t.off("signal",this.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),t.dispose(),this.props.disconnectHandler(e),this._connectionVerboseProps={},!0}cancelConnection(e){Ze(void 0!==this.pendingConnection,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived",reason:e.text}),this.props.cancelConnectionHandler({text:"Cancel Pending Connection due to ".concat(e.text),error:e.error})}setupNewSuccessfulConnection(e,t,r){var o;Ze(void 0===this.connection,230),Ze(!e.disposed,650),this.pendingConnection=void 0;const n=this.readonly;this.connection=e;const i=!e.claims.scopes.includes(rr.DocWrite);if(e.mode!==t&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",requestedMode:t,mode:e.mode}),Ze(!i||"read"===this.connectionMode,232),this.set_readonlyPermissions(i,n,wr(e)?e.readonlyConnectionReason:void 0),this._disposed)return void this.disconnectFromDeltaStream({text:"ConnectionManager already closed"});this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);const s=e.initialMessages.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);let a=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},void 0!==e.relayServiceAgent&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let c=-1;s.length>0&&(this._connectionVerboseProps.connectionInitialOpsFrom=s[0].sequenceNumber,c=s[s.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=c+1,(void 0===a||a<c)&&(a=c)),this.props.incomingOpHandler(s,this.connectFirstConnection?"InitialOps":"ReconnectOps"),this._connectionDetails=Tr.detailsFromConnection(e,r),this._connectionDetails.checkpointSequenceNumber=a,this.props.connectHandler(this._connectionDetails),this.connectFirstConnection=!1;let d=[{clientId:null,content:JSON.stringify({type:mr.Clear})}];const l=(null!==(o=e.initialClients)&&void 0!==o?o:[]).map(e=>({clientId:null,content:JSON.stringify({type:mr.ClientJoin,content:e})}));l.length>0&&(d=[...d,...l]),void 0!==e.initialSignals&&e.initialSignals.length>0&&(d=[...d,...e.initialSignals]),this.props.signalHandler(d)}reconnectOnError(e,t){this.reconnect(e,{text:t.message,error:t}).catch(this.props.closeHandler)}async reconnect(e,t){var r;if(Ze(void 0!==this.connection,235),this.disconnectFromDeltaStream(t),!1===(null===(r=t.error)||void 0===r?void 0:r.canRetry)&&this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},t.error),this.reconnectMode===or.Never&&this.props.closeHandler(),this._disposed||this.reconnectMode!==or.Enabled)return;const o=gt(t.error);void 0!==t.error&&void 0!==o&&(this.props.reconnectionDelayHandler(o,t.error),await new Promise(e=>{setTimeout(e,o)})),await Pr(),this.triggerConnect({text:void 0===t.error?"Reconnecting due to: ".concat(t.text):"Reconnecting due to Error",error:t.error},e)}prepareMessageToSend(e){var t,r;if(!0===this.readonly){Ze(!0===this.readOnlyInfo.readonly,496);const e=new Nt("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly,storageOnlyReason:this.readOnlyInfo.storageOnlyReason});return void this.props.closeHandler(e)}(Ze(!!this.connection,228),this.lastSubmittedClientId!==(null===(t=this.connection)||void 0===t?void 0:t.clientId))&&(this.lastSubmittedClientId=null===(r=this.connection)||void 0===r?void 0:r.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0);return ir(e)?this.localOpsToIgnore=0:this.localOpsToIgnore++,(0,n.A)((0,n.A)({},e),{},{clientSequenceNumber:++this.clientSequenceNumber})}submitSignal(e,t){void 0===this.connection?this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"}):this.connection.submitSignal(e,t)}sendMessages(e){Ze(this.connected,692),"read"!==this.connectionMode?(Ze(!this.pendingReconnect,693),this._outbound.push(e)):this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then(async()=>{this.pendingReconnect&&await this.reconnect("write",{text:"Switch to write"})}).catch(()=>{}))}beforeProcessingIncomingOp(e){if(Ze(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){const t=e.clientSequenceNumber;Ze(this.clientSequenceNumberObserved<t,239),Ze(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}if(e.type===tt.ClientLeave){const t=e;JSON.parse(t.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read",{text:"Switch to read"}).catch(e=>{this.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},e)}))}}}const Er=2147483647;function Ir(e,t,r){let o;if(t>Er){const n=t-Er;o=setTimeout(()=>Ir(e,n,r),Er)}else o=setTimeout(()=>e(),Math.max(t,0));return null===r||void 0===r||r(o),o}class Nr{get hasTimer(){return!!this.runningState}constructor(e,t,r){this.defaultTimeout=e,this.defaultHandler=t,this.exceptionHandler=r,this.getCurrentTick=()=>Date.now()}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultTimeout,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultHandler;this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){if(this.runningState){var r,o;const n=null!==e&&void 0!==e?e:this.runningState.intendedDuration,i=null!==(r=null!==t&&void 0!==t?t:null===(o=this.runningState.restart)||void 0===o?void 0:o.handler)&&void 0!==r?r:this.runningState.handler,s=this.calculateRemainingTime(this.runningState);n<s?this.start(n,i):n===s?(this.runningState.handler=i,this.runningState.restart=void 0,this.runningState.intendedDuration=n):this.runningState.restart={startTick:this.getCurrentTick(),duration:n,handler:i}}else this.start(e,t)}startCore(e,t,r){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:r,handler:t,timeout:Ir(()=>this.handler(),e,e=>{void 0!==this.runningState&&(this.runningState.timeout=e)})}}handler(){Ze(!!this.runningState,1892);const e=this.runningState.restart;if(void 0===e){const e=this.runningState.handler;this.clear();try{e()}catch(t){if(!this.exceptionHandler)throw t;this.exceptionHandler(t)}}else{const t=this.calculateRemainingTime(e);this.startCore(t,()=>e.handler(),e.duration)}}calculateRemainingTime(e){const t=this.getCurrentTick()-e.startTick;return e.duration-t}}class Ar{constructor(e,t){this.deltaManager=e,this.listener=t,this.caughtUp=!1,this.opHandler=e=>{!this.caughtUp&&e.sequenceNumber>=this.targetSeqNumber&&(this.caughtUp=!0,this.listener())},this._disposed=!1,this.targetSeqNumber=this.deltaManager.lastKnownSeqNumber,Ze(this.targetSeqNumber>=this.deltaManager.lastSequenceNumber,892),this.deltaManager.on("op",this.opHandler),this.opHandler({sequenceNumber:this.deltaManager.lastSequenceNumber})}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.deltaManager.off("op",this.opHandler))}}function Fr(e,t,r){const o=e.mc.config;return function(e,t,r,o,n){const i=e=>new Lr(e,t,n);return e?new Br(r,i,o):i(r)}(!0!==o.getBoolean("Fluid.Container.DisableCatchUpBeforeDeclaringConnected"),!0!==o.getBoolean("Fluid.Container.DisableJoinSignalWait"),e,t,r)}class Dr{constructor(e,t){this.inputs=e,this.pimpl=t(this)}get connectionState(){return this.pimpl.connectionState}get pendingClientId(){return this.pimpl.pendingClientId}get clientId(){return this.pimpl.clientId}containerSaved(){return this.pimpl.containerSaved()}dispose(){return this.pimpl.dispose()}initProtocol(e){return this.pimpl.initProtocol(e)}receivedDisconnectEvent(e){return this.pimpl.receivedDisconnectEvent(e)}establishingConnection(e){return this.pimpl.establishingConnection(e)}cancelEstablishingConnection(e){return this.pimpl.cancelEstablishingConnection(e)}receivedConnectEvent(e){return this.pimpl.receivedConnectEvent(e)}get logger(){return this.inputs.logger}get mc(){return this.inputs.mc}connectionStateChanged(e,t,r){return this.inputs.connectionStateChanged(e,t,r)}shouldClientJoinWrite(){return this.inputs.shouldClientJoinWrite()}get maxClientLeaveWaitTime(){return this.inputs.maxClientLeaveWaitTime}logConnectionIssue(e,t,r){return this.inputs.logConnectionIssue(e,t,r)}clientShouldHaveLeft(e){return this.inputs.clientShouldHaveLeft(e)}onCriticalError(e){return this.inputs.onCriticalError(e)}}class Br extends Dr{constructor(e,t,r){super(e,t),this.deltaManager=r,this.transitionToConnectedState=()=>{Ze(this.pimpl.connectionState===qe.Connected,997),Ze(this._connectionState===qe.CatchingUp,998),this._connectionState=qe.Connected,this.inputs.connectionStateChanged(qe.Connected,qe.CatchingUp,{text:"caught up"})},this._connectionState=this.pimpl.connectionState}get connectionState(){return this._connectionState}connectionStateChanged(e,t,r){switch(e){case qe.Connected:return Ze(this._connectionState===qe.CatchingUp,993),Ze(void 0===this.catchUpMonitor,1003),void(this.catchUpMonitor=new Ar(this.deltaManager,this.transitionToConnectedState));case qe.Disconnected:var o;null===(o=this.catchUpMonitor)||void 0===o||o.dispose(),this.catchUpMonitor=void 0;break;case qe.EstablishingConnection:Ze(this._connectionState===qe.Disconnected,1746);break;case qe.CatchingUp:Ze(this._connectionState===qe.EstablishingConnection,995)}this._connectionState=e,this.inputs.connectionStateChanged(e,t,r)}}class Lr{get connectionState(){return this._connectionState}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}constructor(e,t,r){var o;this.handler=e,this.readClientsWaitForJoinSignal=t,this._connectionState=qe.Disconnected,this._clientId=r;const n=e=>this.handler.onCriticalError(e);this.prevClientLeftTimer=new Nr(null!==(o=this.handler.maxClientLeaveWaitTime)&&void 0!==o?o:3e5,()=>{Ze(this.connectionState!==qe.Connected,684),this.applyForConnectedState("timeout")},n),this.joinTimer=new Nr(0,()=>{var e;if(this.connectionState!==qe.CatchingUp)return;const t={protocolInitialized:void 0!==this.protocol,pendingClientId:this.pendingClientId,clientJoined:this.hasMember(this.pendingClientId),waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("read"===(null===(e=this.connection)||void 0===e?void 0:e.mode)?"NoJoinSignal":"NoJoinOp","error",t)},n)}startjoinTimer(){Ze(!this.joinTimer.hasTimer,564),Ze(void 0!==this.connection,1203),this.joinTimer.start("write"===this.connection.mode?45e3:1e4)}stopjoinTimer(){Ze(this.joinTimer.hasTimer,565),this.joinTimer.clear()}get waitingForLeaveOp(){return this.prevClientLeftTimer.hasTimer}dispose(){Ze(!this.joinTimer.hasTimer,677),this.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){if(e===this.pendingClientId){if(this.joinTimer.hasTimer)this.stopjoinTimer();else if(this.shouldWaitForSelf()){var t;this.handler.logConnectionIssue("read"===(null===(t=this.connection)||void 0===t?void 0:t.mode)?"ReceivedJoinSignal":"ReceivedJoinOp","generic")}this.waitingForLeaveOp&&(this.waitEvent=pe.start(this.handler.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent")}}applyForConnectedState(e){if(Ze(void 0!==this.protocol,566),Ze(!this.waitingForLeaveOp||this.hasMember(this.clientId),738),this.pendingClientId!==this.clientId&&this.hasMember(this.pendingClientId)&&!this.waitingForLeaveOp){var t;null===(t=this.waitEvent)||void 0===t||t.end({source:e}),this.setConnectionState(qe.Connected)}else{const t="timeout"===e&&this.connectionState!==qe.Disconnected;this.handler.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:t?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,clientJoined:this.hasMember(this.pendingClientId)})})}}receivedRemoveMemberEvent(e){this.clientId===e&&this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.connection=void 0,this.setConnectionState(qe.Disconnected,e)}cancelEstablishingConnection(e){Ze(this._connectionState===qe.EstablishingConnection,1747),Ze(void 0===this.connection,1748);const t=this._connectionState;this._connectionState=qe.Disconnected,this.handler.connectionStateChanged(qe.Disconnected,t,e)}establishingConnection(e){const t=this._connectionState;this._connectionState=qe.EstablishingConnection,this.handler.connectionStateChanged(qe.EstablishingConnection,t,{text:"Establishing Connection due to ".concat(e.text),error:e.error})}shouldWaitForSelf(){return Ze(void 0!==this.connection,1204),"write"===this.connection.mode||this.readClientsWaitForJoinSignal}receivedConnectEvent(e){this.connection=e;const t=this._connectionState;this._connectionState=qe.CatchingUp,this._pendingClientId=e.clientId,this.handler.connectionStateChanged(qe.CatchingUp,t,e.reason),!this.hasMember(this._pendingClientId)&&this.shouldWaitForSelf()?this.startjoinTimer():this.waitingForLeaveOp||this.setConnectionState(qe.Connected)}setConnectionState(e,t){var r;if(this.connectionState===e)return void this.handler.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});const o=this._connectionState;this._connectionState=e;const n=void 0!==this._clientId&&void 0!==(null===(r=this.protocol)||void 0===r||null===(r=r.quorum)||void 0===r?void 0:r.getMember(this._clientId));e===qe.Connected?(Ze(o===qe.CatchingUp,472),n&&this.handler.clientShouldHaveLeft(this._clientId),this._clientId=this.pendingClientId):e===qe.Disconnected&&(this.joinTimer.hasTimer&&this.stopjoinTimer(),n&&this.handler.shouldClientJoinWrite()&&!this.waitingForLeaveOp?this.prevClientLeftTimer.restart():this.handler.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({clientId:this._clientId,inQuorum:n,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.connectionStateChanged(this._connectionState,o,t),e===qe.Disconnected&&(this._pendingClientId=void 0)}get membership(){var e,t;return this.readClientsWaitForJoinSignal?null===(e=this.protocol)||void 0===e?void 0:e.audience:null===(t=this.protocol)||void 0===t?void 0:t.quorum}initProtocol(e){var t,r,o;this.protocol=e,null===(t=this.membership)||void 0===t||t.on("addMember",(t,r)=>{Ze("read"===r.mode||void 0!==e.quorum.getMember(t),1205),this.receivedAddMemberEvent(t)}),null===(r=this.membership)||void 0===r||r.on("removeMember",t=>{Ze(void 0===e.quorum.getMember(t),1206),this.receivedRemoveMemberEvent(t)}),this.hasMember(this.pendingClientId)&&this.receivedAddMemberEvent(this.pendingClientId),Ze(!this.waitingForLeaveOp,2461),void 0!==this._clientId&&void 0!==(null===(o=e.quorum)||void 0===o?void 0:o.getMember(this._clientId))&&this.prevClientLeftTimer.restart()}hasMember(e){var t;return void 0!==(null===(t=this.membership)||void 0===t?void 0:t.getMember(null!==e&&void 0!==e?e:""))}}const Or={supportedFeatures:new Set,generation:0,pkgVersion:"unknown"};const xr="2.23.0",Mr={pkgVersion:xr,generation:1,supportedFeatures:new Set},Rr={minSupportedGeneration:0,requiredFeatures:[]};function _r(e,t){const r=function(e,t){const r=null!==t&&void 0!==t?t:Or;let o=!0;const n=[];r.generation<e.minSupportedGeneration&&(o=!1);for(const i of e.requiredFeatures)r.supportedFeatures.has(i)||n.push(i);return o&&0===n.length?{isCompatible:!0}:{isCompatible:!1,isGenerationCompatible:o,unsupportedFeatures:n.length>0?n:void 0}}(Rr,e);if(!r.isCompatible){const o=new At("Loader is not compatible with Runtime",{errorDetails:JSON.stringify({loaderVersion:Mr.pkgVersion,runtimeVersion:null===e||void 0===e?void 0:e.pkgVersion,loaderGeneration:Mr.generation,runtimeGeneration:null===e||void 0===e?void 0:e.generation,minSupportedGeneration:Rr.minSupportedGeneration,isGenerationCompatible:r.isGenerationCompatible,unsupportedFeatures:r.unsupportedFeatures})});throw t(o),o}}class Hr{get clientId(){return this._getClientId()}get id(){var e;return null!==(e=this._getContainerDiagnosticId())&&void 0!==e?e:""}get connected(){return this._getConnected()}get ILayerCompatDetails(){return Mr}constructor(e,t,r,o,n,i,s,a,c,d,l,u,h,g,p,f,m,v,y,b,S,C,k,w,P,T){this.options=e,this.scope=t,this.baseSnapshot=r,this._version=o,this.deltaManager=n,this.storage=i,this.quorum=s,this.audience=a,this.loader=c,this.submitFn=d,this.submitSummaryFn=l,this.submitBatchFn=u,this.submitSignalFn=h,this.disposeFn=g,this.closeFn=p,this.updateDirtyContainerState=f,this.getAbsoluteUrl=m,this._getContainerDiagnosticId=v,this._getClientId=y,this._getAttachState=b,this._getConnected=S,this.clientDetails=C,this.existing=k,this.taggedLogger=w,this.pendingLocalState=P,this.snapshotWithContents=T,this.supportedFeatures=new Map([["referenceSequenceNumbers",!0]])}getLoadedFromVersion(){return this._version}get attachState(){return this._getAttachState()}}class Ur extends ne{constructor(e){super(e,{usageError:!0}),this.errorType=w.usageError,this.canRetry=!1}}class jr{constructor(e,t,r){var o;this.internalStorageService=e,this.addProtocolSummaryIfMissing=t,this.shouldSummarizeProtocolTree=r,this.getSnapshotTree=e.getSnapshotTree.bind(e),this.getSnapshot=null===(o=e.getSnapshot)||void 0===o?void 0:o.bind(e),this.getVersions=e.getVersions.bind(e),this.createBlob=e.createBlob.bind(e),this.readBlob=e.readBlob.bind(e),this.downloadSummary=e.downloadSummary.bind(e),this.dispose=e.dispose.bind(e)}get policies(){return this.internalStorageService.policies}get disposed(){return this.internalStorageService.disposed}async uploadSummaryWithContext(e,t){return this.shouldSummarizeProtocolTree()?this.internalStorageService.uploadSummaryWithContext(this.addProtocolSummaryIfMissing(e),t):this.internalStorageService.uploadSummaryWithContext(e,t)}}class qr{constructor(e,t){this.internalStorageServiceP=e,this.logger=t,this._disposed=!1,this.internalStorageServiceP.then(e=>this.internalStorageService=e).catch(()=>{})}get policies(){if(this.internalStorageService)return this.internalStorageService.policies;throw new Error("storage service not yet instantiated")}get disposed(){return this._disposed}dispose(){this._disposed=!0}async getSnapshotTree(e,t){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async r=>r.getSnapshotTree(e,t)),"storage_getSnapshotTree")}async getSnapshot(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>{if(void 0!==t.getSnapshot)return t.getSnapshot(e);throw new At("getSnapshot api should exist on internal storage in RetriableDocStorageService class")}),"storage_getSnapshot")}async readBlob(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>t.readBlob(e)),"storage_readBlob")}async getVersions(e,t,r,o){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async n=>n.getVersions(e,t,r,o)),"storage_getVersions")}async uploadSummaryWithContext(e,t){return Ze(0===t.referenceSequenceNumber===(void 0===t.ackHandle),593),0!==t.referenceSequenceNumber?this.internalStorageServiceP.then(async r=>r.uploadSummaryWithContext(e,t)):this.runWithRetry(async()=>this.internalStorageServiceP.then(async r=>r.uploadSummaryWithContext(e,t)),"storage_uploadSummaryWithContext")}async downloadSummary(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>t.downloadSummary(e)),"storage_downloadSummary")}async createBlob(e){return this.runWithRetry(async()=>this.internalStorageServiceP.then(async t=>t.createBlob(e)),"storage_createBlob")}checkStorageDisposed(e,t){if(this._disposed)throw this.logger.sendTelemetryEvent({eventName:"".concat(e,"_abortedStorageDisposed"),fetchCallName:e},t),new Nt("Storage Service is disposed. Cannot retry",{canRetry:!1})}async runWithRetry(e,t){return pt(e,t,this.logger,{onRetry:(e,r)=>this.checkStorageDisposed(t,r)})}}class Vr{get summarizeProtocolTree(){return!0===this._summarizeProtocolTree}get loadedGroupIdSnapshots(){return this._loadedGroupIdSnapshots}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;this.logger=t,this.blobContents=r,this.loadingGroupIdSnapshotsFromPendingState=o,this.addProtocolSummaryIfMissing=n,this.enableSummarizeProtocolTree=i,this._loadedGroupIdSnapshots={},this.disposed=!1,this._storageService=new zr(e,t)}dispose(e){var t,r;null===(t=this._storageService)||void 0===t||null===(r=t.dispose)||void 0===r||r.call(t,e),this.disposed=!0}connectToService(e){var t=this;if(!(this._storageService instanceof zr))return;const r=e.connectToStorage(),o=this._storageService=new qr(r,this.logger);this._storageService=new jr(o,function(){return t.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),t.addProtocolSummaryIfMissing(...arguments)},()=>{var t,r,o;const n=null!==(t=null!==(r=null===(o=e.policies)||void 0===o?void 0:o.summarizeProtocolTree)&&void 0!==r?r:this.enableSummarizeProtocolTree)&&void 0!==t&&t;return this._summarizeProtocolTree!==n&&this.logger.sendTelemetryEvent({eventName:"isSummarizeProtocolTreeEnabled",details:{value:n}}),this._summarizeProtocolTree=n,this._summarizeProtocolTree})}loadSnapshotFromSnapshotBlobs(e){for(const[t,r]of Object.entries(e))this.blobContents[t]=r}clearPendingState(){this.loadingGroupIdSnapshotsFromPendingState=void 0}get policies(){try{return this._storageService.policies}catch(e){}}async getSnapshotTree(e,t){return this._storageService.getSnapshotTree(e,t)}async getSnapshot(e){let t;if(void 0!==this.loadingGroupIdSnapshotsFromPendingState&&void 0!==(null===e||void 0===e?void 0:e.loadingGroupIds)){const r=this.loadingGroupIdSnapshotsFromPendingState[e.loadingGroupIds[0]];Ze(void 0!==r,2416),t=function(e,t){const r=new Map;for(const[o,n]of Object.entries(e.snapshotBlobs))r.set(o,wt(n,"utf8"));return{snapshotTree:e.baseSnapshot,blobContents:r,ops:[],sequenceNumber:t,latestSequenceNumber:void 0,snapshotFormatV:1}}(r,r.snapshotSequenceNumber)}else{if(void 0===this._storageService.getSnapshot)throw new Ur("getSnapshot api should exist in internal storage in ContainerStorageAdapter");t=await this._storageService.getSnapshot(e)}const r=null===e||void 0===e?void 0:e.loadingGroupIds;if(Ze(void 0!==t.sequenceNumber,2417),void 0!==r)for(const i of r){var o,n;(null!==(o=null===(n=this._loadedGroupIdSnapshots[i])||void 0===n?void 0:n.sequenceNumber)&&void 0!==o?o:-1)<t.sequenceNumber&&(this._loadedGroupIdSnapshots[i]=t)}return t}async readBlob(e){const t=this.blobContents[e];if(void 0!==t){if("string"===typeof t){return wt(t,"utf8")}return t}return this._storageService.readBlob(e)}async getVersions(e,t,r,o){return this._storageService.getVersions(e,t,r,o)}async uploadSummaryWithContext(e,t){return this._storageService.uploadSummaryWithContext(e,t)}async downloadSummary(e){return this._storageService.downloadSummary(e)}async createBlob(e){return this._storageService.createBlob(e)}}class zr{constructor(e,t){this.detachedStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getSnapshot=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}async createBlob(e){return this.verifyStorage().createBlob(e)}async readBlob(e){return this.verifyStorage().readBlob(e)}verifyStorage(){if(void 0===this.detachedStorage)throw new Ur("Real storage calls not allowed in Unattached container");return this.detachedStorage}get policies(){return this.notCalled()}notCalled(){this.verifyStorage();try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendTelemetryEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}}const Gr=".blobs",Wr=".redirectTable";async function Jr(e,t){const r={};if(bt(e)){const t=e.blobContents;for(const[e,o]of t.entries())r[e]=Pt(o,"utf8")}else await Kr(e,r,t);return r}async function Kr(e,t,r){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const n=[];for(const[i,s]of Object.entries(e.trees))o&&i===Gr?n.push(Qr(s,t,r)):n.push(Kr(s,t,r,!1));for(const i of Object.values(e.blobs)){const e=await r.readBlob(i);t[i]=Pt(e,"utf8")}return Promise.all(n)}async function Qr(e,t,r){const o=e.blobs[Wr];Ze(void 0!==o,2510);const n=await r.readBlob(o);t[o]=Pt(n,"utf8")}const $r=(0,n.A)((0,n.A)({},b),{},{clientSessionExpiredError:"clientSessionExpiredError"});class Zr extends ne{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=$r.throttlingError}static wrap(e,t,r){return function(e,t,r){const o=te(e,t),n=o.errorInstanceId,i=n;return r.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:n,wrappedByErrorInstanceId:i},e),o}(e,e=>new Zr(e,t),r)}}function Yr(e){if(ir(e))return!0;switch(e.type){case tt.Propose:case tt.Reject:case tt.NoOp:case tt.Accept:case tt.Summarize:return!0;default:return!1}}class Xr extends Ot{get active(){return this._active()}get disposed(){return this._closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return Ze(this.connectionManager.connected,223),void 0!==this._checkpointSequenceNumber}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>4?arguments[4]:void 0,n=arguments.length>5?arguments[5]:void 0;const i={contents:t,metadata:arguments.length>3?arguments[3]:void 0,referenceSequenceNumber:null!==n&&void 0!==n?n:this.lastProcessedSequenceNumber,type:e,compression:o};r||this.flush();const s=this.connectionManager.prepareMessageToSend(i);return void 0===s?-1:(Ze(Yr(s),1049),void 0!==t&&(this.opsSize+=t.length),this.messageBuffer.push(s),s.type===tt.NoOp&&this.noOpCount++,this.emit("submitOp",s),r||this.flush(),s.clientSequenceNumber)}submitSignal(e,t){return this.connectionManager.submitSignal(e,t)}flush(){const e=this.messageBuffer;if(0!==e.length){var t,r,o;if(this.messageBuffer=[],this.emit("prepareSend",e),1===e.length)Ze(void 0===(null===(t=e[0].metadata)||void 0===t?void 0:t.batch),969);else Ze(!0===(null===(r=e[0].metadata)||void 0===r?void 0:r.batch),970),Ze(!1===(null===(o=e[e.length-1].metadata)||void 0===o?void 0:o.batch),971);this.connectionManager.sendMessages(e),Ze(0===this.messageBuffer.length,972)}}get connectionProps(){return(0,n.A)({sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0,deltaManagerState:this._disposed?"disposed":this._closed?"closed":"open"},this.connectionManager.connectionProps)}logConnectionIssue(e){var t;Ze(this.connectionManager.connected,568);const r=this.pending.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);this.logger.sendTelemetryEvent((0,n.A)((0,n.A)((0,n.A)({},e),{},{fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber},this.connectionManager.connectionVerboseProps),{},{pendingOps:this.pending.length,pendingFirst:null===(t=r[0])||void 0===t?void 0:t.sequenceNumber,haveHandler:void 0!==this.handler,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused}))}constructor(e,t,r,o){super((e,t)=>{this.logger.sendErrorEvent({eventName:"DeltaManagerEventHandlerException",name:"string"===typeof e?e:void 0},t),this.close(Y(t))}),this.serviceProvider=e,this.logger=t,this._active=r,this.pending=[],this.currentlyProcessingOps=!1,this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.noOpCount=0,this.lastClientSequenceNumber=0,this.opsSize=0,this.initSequenceNumber=0,this._closed=!1,this._disposed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new AbortController,this.deltaStorageDelayId=W(),this.deltaStreamDelayId=W(),this.messageBuffer=[];const i={incomingOpHandler:(e,t)=>{try{this.enqueueMessages(e,t)}catch(r){this.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},r),this.close(Y(r))}},signalHandler:e=>{for(const t of e)this._inboundSignal.push(t)},reconnectionDelayHandler:(e,t)=>this.emitDelayInfo(this.deltaStreamDelayId,e,t),closeHandler:e=>this.close(e),disconnectHandler:e=>this.disconnectHandler(e),connectHandler:e=>this.connectHandler(e),pongHandler:e=>this.emit("pong",e),readonlyChangeHandler:(e,t)=>{!function(e,t,r){try{for(var o=arguments.length,n=new Array(o>3?o-3:0),i=3;i<o;i++)n[i-3]=arguments[i];e.emit(r,...n)}catch(s){t.sendErrorEvent({eventName:"RaiseEventError",event:r},s)}}(this,this.logger,"readonly",e,t)},establishConnectionHandler:e=>this.establishingConnection(e),cancelConnectionHandler:e=>this.cancelEstablishingConnection(e)};this.connectionManager=o(i),this._inbound=new cr(e=>{this.processInboundMessage(e)}),this._inbound.on("error",e=>{this.close(Dt.wrapIfUnrecognized(e,"deltaManagerInboundErrorHandler",this.lastMessage))}),this._inboundSignal=new cr(e=>{if(void 0===this.handler)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal((0,n.A)((0,n.A)({},e),{},{content:JSON.parse(e.content)}))}),this._inboundSignal.on("error",e=>{this.close(Y(e))})}cancelEstablishingConnection(e){this.emit("cancelEstablishingConnection",e)}establishingConnection(e){this.emit("establishingConnection",e)}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);const t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;const r=e.checkpointSequenceNumber;this._checkpointSequenceNumber=r,void 0!==r&&this.updateLatestKnownOpSeqNumber(r),Ze(0===this.messageBuffer.length,233),this.opsSize=0,this.noOpCount=0,this.emit("connect",e,void 0===r?void 0:this.lastObservedSeqNumber-this.lastSequenceNumber),void 0!==r?r>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):"read"===e.mode&&this.fetchMissingDeltas("AfterReadConnection")}async attachOpHandler(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t;if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=n,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=n,this.lastObservedSeqNumber=n,Ze(void 0===this.handler,226),this.handler=r,Ze(!!this.handler,227),Ze(void 0===this.fetchReason,616),!this._closed){if(this._inbound.resume(),this._inboundSignal.resume(),"none"!==o){const e="cached"===o;await this.fetchMissingDeltasCore("DocumentOpen_".concat(o),e),e&&this.fetchMissingDeltas("PostDocumentOpen")}Ze(void 0!==this.fetchReason||0===this.pending.length,617)}}connect(e){var t;const r=null===(t=e.fetchOpsFromStorage)||void 0===t||t;!function(e,t,r){if(e)return!0;const o="string"===typeof r?{eventName:r,category:"error"}:(0,n.A)({category:"error"},r);t.send(o)}(void 0!==this.handler||!r,this.logger,"CantFetchWithoutBaseline"),r&&this.fetchMissingDeltas(e.reason.text),this.connectionManager.connect(e.reason,e.mode)}async getDeltas(e,t,r,o,i){const s=this.serviceProvider();if(void 0===s)throw new Error("Delta manager is not attached");let a;if(void 0===this.deltaStorage&&(this.deltaStorage=await s.connectToDeltaStorage()),void 0===t)a=e=>e.sequenceNumber>=this.lastObservedSeqNumber;else{const o=t-1;if(this.lastQueuedSequenceNumber>=o)return void this.logger.sendPerformanceEvent((0,n.A)({reason:r,eventName:"ExtraStorageCall",early:!0,from:e,to:t},this.connectionManager.connectionVerboseProps));a=e=>e.sequenceNumber>=o}const c=new AbortController;let d=!1;const l=e=>{Ze(e.sequenceNumber===this.lastQueuedSequenceNumber,570),!d&&a(e)&&(c.abort("DeltaManager getDeltas fetch cancelled"),this._inbound.off("push",l))};try{this._inbound.on("push",l),Ze(null===this.closeAbortController.signal.onabort,488),this.closeAbortController.signal.addEventListener("abort",()=>c.abort(this.closeAbortController.signal.reason));const n=this.deltaStorage.fetchMessages(e,t,c.signal,i,r);for(;;){const e=await n.read();if(e.done)break;try{d=!0,o(e.value)}finally{d=!1}}}finally{c.signal.aborted&&this.logger.sendTelemetryEvent({eventName:"DeltaManager_GetDeltasAborted",fetchReason:r,reason:c.signal.reason}),this.closeAbortController.signal.onabort=null,this._inbound.off("push",l),Ze(!d,649)}}close(e){this._closed||(this._closed=!0,this.connectionManager.dispose(e,!0),this.clearQueues(),this.emit("closed",e))}dispose(e){if(!this._disposed){if(void 0!==e&&!K(e))throw new At("Error must be a Fluid error");this._disposed=!0,this._closed=!0,this.connectionManager.dispose(e,!1),this.clearQueues(),this.emit("disposed",e),this.removeAllListeners()}}clearQueues(){this.closeAbortController.abort("DeltaManager is closed"),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[]}refreshDelayInfo(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e.text,e.error)}emitDelayInfo(e,t,r){const o=Date.now();if(this.throttlingIdSet.add(e),t>0&&o+t>this.timeTillThrottling){this.timeTillThrottling=o+t;const e=Zr.wrap(r,t/1e3,this.logger);this.emit("throttled",e)}}comparableMessagePayload(e){return"".concat(e.clientId,"-").concat(e.type,"-").concat(e.minimumSequenceNumber,"-").concat(e.referenceSequenceNumber,"-").concat(e.timestamp)}enqueueMessages(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===this.handler)return void(this.pending=[...this.pending,...e]);if(Ze(0===this.pending.length||void 0!==this.fetchReason,489),0===e.length)return;const i=e[0].sequenceNumber,s=e[e.length-1].sequenceNumber;if(s>this.lastQueuedSequenceNumber){let r=i-1;const a=r-this.lastQueuedSequenceNumber;let c,d,l=0,u=0;for(const t of e)t.sequenceNumber===r?l++:t.sequenceNumber!==r+1&&(u++,void 0===c&&(c=r+1)),r=t.sequenceNumber;0!==l||0!==u&&!o||a>0&&void 0===this.fetchReason?d="enqueueMessages":void 0!==this.fetchReason&&this.fetchReason!==t&&i<=this.lastQueuedSequenceNumber+1&&s>this.lastQueuedSequenceNumber&&(d="enqueueMessagesExtraFetch"),void 0!==d&&this.logger.sendPerformanceEvent((0,n.A)({eventName:d,reason:t,previousReason:this.prevEnqueueMessagesReason,from:i,to:s+1,length:e.length,fetchReason:this.fetchReason,duplicate:l>0?l:void 0,initialGap:0===a?void 0:a,gap:u>0?u:void 0,firstMissing:c,dmInitialSeqNumber:this.initialSequenceNumber},this.connectionManager.connectionVerboseProps))}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);const a=null===(r=this.previouslyProcessedMessage)||void 0===r?void 0:r.sequenceNumber;Ze(void 0===a||a===this.lastQueuedSequenceNumber,236);for(const n of e){var c;if(n.sequenceNumber<=this.lastQueuedSequenceNumber){if((null===(c=this.previouslyProcessedMessage)||void 0===c?void 0:c.sequenceNumber)===n.sequenceNumber){const e=this.comparableMessagePayload(this.previouslyProcessedMessage),t=this.comparableMessagePayload(n);if(e!==t){const r=new lt("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",w.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:n.sequenceNumber,message1:e,message2:t,driverVersion:void 0});this.close(r)}}}else n.sequenceNumber===this.lastQueuedSequenceNumber+1?(this.lastQueuedSequenceNumber=n.sequenceNumber,this.previouslyProcessedMessage=n,this._inbound.push(n)):(this.pending.push(n),this.fetchMissingDeltas(t,n.sequenceNumber))}this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){const t=Date.now();Ze(!this.currentlyProcessingOps,943),this.currentlyProcessingOps=!0,this.lastProcessedMessage=e;const r="string"===typeof e.clientId;if(Ze(null===e.clientId||r,1050),!r&&Yr(e)&&e.type!==tt.NoOp)throw new Ft("Mismatch in clientId",(0,n.A)((0,n.A)({},Bt(e)),{},{messageType:e.type}));if(void 0!==this.connectionManager.clientId&&this.connectionManager.clientId===e.clientId){e.type===tt.NoOp&&this.noOpCount--;const t=e.clientSequenceNumber-this.lastClientSequenceNumber-1;if(this.noOpCount-=t,this.noOpCount<0)throw new Error("gap in client sequence number: ".concat(t));this.lastClientSequenceNumber=e.clientSequenceNumber}if(this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw Dt.create("Invalid MinimumSequenceNumber from service - document may have been restored to previous state","DeltaManager.processInboundMessage",e,{clientId:this.connectionManager.clientId});const o=e.sequenceNumber-e.minimumSequenceNumber;if(o<0||0===o&&null!==e.clientId)throw new Ft("MSN has to be lower than sequence #",Bt(e));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new Ft("Found a non-Sequential sequenceNumber",(0,n.A)((0,n.A)({},Bt(e)),{},{clientId:this.connectionManager.clientId}));if(this.lastProcessedSequenceNumber=e.sequenceNumber,Ze(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e),this.currentlyProcessingOps=!1;const i=Date.now();this.emit("op",e,i-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch(e=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},e)})}async fetchMissingDeltasCore(e,t,r){if(void 0===this.fetchReason)if(this._closed)this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});else if(void 0!==this.handler)try{var o;let n=this.lastQueuedSequenceNumber+1;const i=null===(o=this.previouslyProcessedMessage)||void 0===o?void 0:o.sequenceNumber;void 0!==i&&(Ze(i===this.lastQueuedSequenceNumber,242),Ze(n>1,243),n--);const s="".concat(e,"_fetch");this.fetchReason=s,await this.getDeltas(n,r,s,e=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(e,s)},t)}catch(n){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},n),this.close(Y(n))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}else Ze(0===this.lastQueuedSequenceNumber,619)}processPendingOps(e){if(this._closed)return;Ze(void 0!==this.handler,620);const t=this.pending.sort((e,t)=>e.sequenceNumber-t.sequenceNumber);this.pending=[],this.enqueueMessages(t,"".concat(e,"_pending"),!0),void 0===this.fetchReason&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}var eo;!function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(eo||(eo={}));var to=r(76522);const{debug:ro}=to;class oo{static mixinDebugLogger(e,t,r){const o=ro(e),n=ro(e);return n.log=function(){!0===o.enabled?ro.log(...arguments):console.error(...arguments)},n.enabled=!0,function(e){var t;return new ge(e.namespace,e.properties,null===(t=e.loggers)||void 0===t?void 0:t.filter(e=>void 0!==e),e.tryInheritProperties)}({namespace:e,loggers:[t,new oo(o,n)],properties:r,tryInheritProperties:!0})}constructor(e,t){this.debug=e,this.debugErr=t}send(e){var t;const r=(0,n.A)({},e),o="error"===r.category;let i=o?this.debugErr:this.debug;const s=e.eventName.lastIndexOf(":"),a=e.eventName.slice(Math.max(0,s+1));s>0&&(i=i.extend(e.eventName.slice(0,s))),r.eventName=void 0;let c="";c="tick=".concat(de(P()));const d=null!==(t=r.stack)&&void 0!==t?t:"";let l;r.stack=void 0;try{l=JSON.stringify(r)}catch(u){r.error=void 0,l=JSON.stringify(r)}"{}"===l&&(l=""),o&&(i.enabled=!0),i("".concat(a," ").concat(l," ").concat(c," ").concat(d))}}function no(e){if(void 0===e)throw new Error("Object is not a IResolveUrl.")}class io{constructor(e,t){this.container=e,this.loader=t}async resolve(e){if(e.url.startsWith("/")){var t,r,o,i,s;no(this.container.resolvedUrl);return await this.container.clone({resolvedUrl:(0,n.A)({},this.container.resolvedUrl),version:null!==(t=null===(r=e.headers)||void 0===r?void 0:r[eo.version])&&void 0!==t?t:void 0,loadMode:null===(o=e.headers)||void 0===o?void 0:o[eo.loadMode]},{canReconnect:null===(i=e.headers)||void 0===i?void 0:i[eo.reconnect],clientDetailsOverride:null===(s=e.headers)||void 0===s?void 0:s[eo.clientDetails]})}if(void 0===this.loader)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)}}class so{constructor(e){const{urlResolver:t,documentServiceFactory:r,codeLoader:o,options:i,scope:s,logger:a,detachedBlobStorage:c,configProvider:d,protocolHandlerBuilder:l}=e,u={loaderId:W(),loaderVersion:xr},h=R(oo.mixinDebugLogger("fluid:telemetry",a,{all:u}),N.value,d);this.services={urlResolver:t,documentServiceFactory:r,codeLoader:o,options:null!==i&&void 0!==i?i:{},scope:!1===(null===i||void 0===i?void 0:i.provideScopeLoader)?(0,n.A)({},s):(0,n.A)((0,n.A)({},s),{},{ILoader:this}),detachedBlobStorage:c,protocolHandlerBuilder:l,subLogger:h.logger},this.mc=H({logger:this.services.subLogger,namespace:"Loader"})}async createDetachedContainer(e,t){return bo.createDetached((0,n.A)((0,n.A)({},t),this.services),e)}async rehydrateDetachedContainerFromSnapshot(e,t){return bo.rehydrateDetachedFromSnapshot((0,n.A)((0,n.A)({},t),this.services),e)}async resolve(e,t){const r=void 0===t?"Resolve":"ResolveWithPendingState";return pe.timedExecAsync(this.mc.logger,{eventName:r},async()=>{return this.resolveCore(e,void 0===(r=t)?void 0:JSON.parse(r));var r})}async resolveCore(e,t){var r,o;const n=await this.services.urlResolver.resolve(e);no(n);const i=zt(n.url);if(void 0===i)throw new Error("Invalid URL ".concat(n.url));if(void 0!==t){const e=zt(t.url);if((null===e||void 0===e?void 0:e.id)!==i.id||(null===e||void 0===e?void 0:e.path.replace(/\/$/,""))!==i.path.replace(/\/$/,"")){const e="URL ".concat(n.url," does not match pending state URL ").concat(t.url);throw new Error(e)}}return null!==(r=e.headers)&&void 0!==r||(e.headers={}),e.headers[eo.version]=null!==(o=i.version)&&void 0!==o?o:e.headers[eo.version],this.loadContainer(e,n,t)}async loadContainer(e,t,r){var o,i,s,a,c;return bo.load({resolvedUrl:t,version:null!==(o=null===(i=e.headers)||void 0===i?void 0:i[eo.version])&&void 0!==o?o:void 0,loadMode:null===(s=e.headers)||void 0===s?void 0:s[eo.loadMode],pendingLocalState:r},(0,n.A)({canReconnect:null===(a=e.headers)||void 0===a?void 0:a[eo.reconnect],clientDetailsOverride:null===(c=e.headers)||void 0===c?void 0:c[eo.clientDetails]},this.services))}}const ao=Symbol();function co(e){return Ye(e)&&ao in e&&e[ao]===ao}function lo(e){if(void 0!==e&&e.size>0&&co(e))return e.serialize()}class uo extends Ke{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;super(),this.NoopCountFrequency=t,this.opsProcessedSinceOpSent=0,e!==Number.POSITIVE_INFINITY&&(this.timer=new Nr(e,()=>{0!==this.opsProcessedSinceOpSent&&this.emit("wantsNoop")}))}notifyMessageProcessed(e){ir(e)&&(this.opsProcessedSinceOpSent++,this.opsProcessedSinceOpSent===this.NoopCountFrequency&&queueMicrotask(()=>{this.opsProcessedSinceOpSent>=this.NoopCountFrequency&&(this.emit("wantsNoop"),Ze(0===this.opsProcessedSinceOpSent,579))}),void 0!==this.timer&&(1===this.opsProcessedSinceOpSent&&this.timer.restart(),Ze(this.timer.hasTimer,578)))}notifyDisconnect(){this.opsProcessedSinceOpSent=0}notifyMessageSent(){this.opsProcessedSinceOpSent=0}}var ho,go;!function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(ho||(ho={})),function(e){e.default="default",e.noCache="noCache"}(go||(go={}));class po{constructor(e,t,r,o,n,i,s,a){if(this.pendingLocalState=e,this.storageAdapter=r,this._offlineLoadEnabled=o,this.containerDirty=i,this.supportGetSnapshotApi=s,this.processedOps=[],this.lastSavedOpSequenceNumber=0,this.snapshotRefreshTimeoutMs=864e5,this.mc=H({logger:t,namespace:"serializedStateManager"}),this.snapshotRefreshTimeoutMs=null!==a&&void 0!==a?a:this.snapshotRefreshTimeoutMs,this.refreshTimer=new Nr(this.snapshotRefreshTimeoutMs,()=>this.tryRefreshSnapshot()),e&&e.savedOps.length>0){const t=e.savedOps.length;this.lastSavedOpSequenceNumber=e.savedOps[t-1].sequenceNumber}n.on("saved",()=>this.updateSnapshotAndProcessedOpsMaybe())}get offlineLoadEnabled(){return this._offlineLoadEnabled}get refreshSnapshotP(){return this._refreshSnapshotP}addProcessedOp(e){this.offlineLoadEnabled&&(this.processedOps.push(e),this.updateSnapshotAndProcessedOpsMaybe())}async fetchSnapshot(e){if(void 0===this.pendingLocalState){const{baseSnapshot:t,version:r}=await fo(this.mc,this.storageAdapter,this.supportGetSnapshotApi(),e),o=St(t);if(this.offlineLoadEnabled){const e=await Jr(t,this.storageAdapter),r=await er(this.storageAdapter,o);this.snapshot={baseSnapshot:o,snapshotBlobs:e,snapshotSequenceNumber:r.sequenceNumber},this.refreshTimer.start()}return{baseSnapshot:t,version:r}}{const{baseSnapshot:e,snapshotBlobs:t}=this.pendingLocalState,r=await er(this.storageAdapter,e);this.snapshot={baseSnapshot:e,snapshotBlobs:t,snapshotSequenceNumber:r.sequenceNumber},this.tryRefreshSnapshot();const o=new Map;for(const[n,i]of Object.entries(t))o.set(n,wt(i,"utf8"));return{baseSnapshot:{sequenceNumber:this.snapshot.snapshotSequenceNumber,snapshotTree:e,blobContents:o,latestSequenceNumber:void 0,ops:[],snapshotFormatV:1},version:void 0}}}tryRefreshSnapshot(){!0===this.mc.config.getBoolean("Fluid.Container.enableOfflineSnapshotRefresh")&&void 0===this._refreshSnapshotP&&void 0===this.latestSnapshot&&(this._refreshSnapshotP=this.refreshLatestSnapshot(this.supportGetSnapshotApi()),this._refreshSnapshotP.catch(e=>{this.mc.logger.sendTelemetryEvent({eventName:"RefreshLatestSnapshotFailed",error:e})}).finally(()=>{this._refreshSnapshotP=void 0}))}async refreshLatestSnapshot(e){this.latestSnapshot=await async function(e,t,r){return pe.timedExecAsync(e.logger,{eventName:"GetLatestSnapshotInfo"},async()=>{var o;const n=await t.getVersions(null,1,"getLatestSnapshotInfo",go.noCache),{baseSnapshot:i}=await fo(e,t,r,null===(o=n[0])||void 0===o?void 0:o.id),s=St(i),a=Date.now();return{baseSnapshot:s,snapshotBlobs:await Jr(i,t),snapshotSequenceNumber:(await er(t,s)).sequenceNumber,snapshotFetchedTime:a}}).catch(()=>{})}(this.mc,this.storageAdapter,e);const t=Object.keys(this.storageAdapter.loadedGroupIdSnapshots);if(e&&t.length>0){Ze(void 0!==this.storageAdapter.getSnapshot,2418);Ze(void 0!==await this.storageAdapter.getSnapshot({versionId:void 0,scenarioName:"getLatestSnapshotInfo",cacheSnapshot:!1,loadingGroupIds:t,fetchSource:go.noCache}),2419)}return this.updateSnapshotAndProcessedOpsMaybe()}updateSnapshotAndProcessedOpsMaybe(){var e;const t=null===(e=this.latestSnapshot)||void 0===e?void 0:e.snapshotSequenceNumber;if(void 0===t||0===this.processedOps.length||this.processedOps[this.processedOps.length-1].sequenceNumber<this.lastSavedOpSequenceNumber||this.containerDirty())return-1;const r=this.processedOps[0].sequenceNumber,o=this.processedOps[this.processedOps.length-1].sequenceNumber;var n;t<r?(this.mc.logger.sendTelemetryEvent({eventName:"OldSnapshotFetchWhileRefreshing",snapshotSequenceNumber:t,firstProcessedOpSequenceNumber:r,lastProcessedOpSequenceNumber:o,stashedSnapshotSequenceNumber:null===(n=this.snapshot)||void 0===n?void 0:n.snapshotSequenceNumber}),this.latestSnapshot=void 0,this.refreshTimer.restart()):t<=o&&(this.processedOps.splice(0,t-r+1),this.snapshot=this.latestSnapshot,this.latestSnapshot=void 0,this.refreshTimer.restart(),this.mc.logger.sendTelemetryEvent({eventName:"SnapshotRefreshed",snapshotSequenceNumber:t,firstProcessedOpSequenceNumber:r,newFirstProcessedOpSequenceNumber:0===this.processedOps.length?void 0:this.processedOps[0].sequenceNumber}));return t}setInitialSnapshot(e){if(this.offlineLoadEnabled){Ze(void 0===this.snapshot,2359),Ze(void 0!==e,2360);const{baseSnapshot:t,snapshotBlobs:r}=e,o=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"],i=JSON.parse(r[o]);Ze(0===i.sequenceNumber,2361),this.snapshot=(0,n.A)((0,n.A)({},e),{},{snapshotSequenceNumber:i.sequenceNumber}),this.refreshTimer.start()}}async getPendingLocalState(e,t,r,o){return pe.timedExecAsync(this.mc.logger,{eventName:"getPendingLocalState",details:{notifyImminentClosure:e.notifyImminentClosure,sessionExpiryTimerStarted:e.sessionExpiryTimerStarted,snapshotSequenceNumber:e.snapshotSequenceNumber,processedOpsSize:this.processedOps.length},clientId:t},async()=>{if(!this.offlineLoadEnabled)throw new At("Can't get pending local state unless offline load is enabled");Ze(void 0!==this.snapshot,2277);const i=await r.getPendingLocalState((0,n.A)((0,n.A)({},e),{},{snapshotSequenceNumber:this.snapshot.snapshotSequenceNumber,sessionExpiryTimerStarted:this.snapshot.snapshotFetchedTime})),s={};let a=!1;const c=Object.entries(this.storageAdapter.loadedGroupIdSnapshots);if(c.length>0)for(const[e,t]of c)a=!0,s[e]=Jt(t);const d={attached:!0,pendingRuntimeState:i,baseSnapshot:this.snapshot.baseSnapshot,snapshotBlobs:this.snapshot.snapshotBlobs,loadedGroupIdSnapshots:a?s:void 0,savedOps:this.processedOps,url:o.url,clientId:t};return JSON.stringify(d)})}}async function fo(e,t,r,o){const{snapshot:n,version:i}=r?await async function(e,t,r){var o;const n=await(null===(o=t.getSnapshot)||void 0===o?void 0:o.call(t,{versionId:r})),i=void 0===(null===n||void 0===n?void 0:n.snapshotTree.id)?void 0:{id:n.snapshotTree.id,treeId:n.snapshotTree.id};void 0===n&&void 0!==r?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:r}):void 0!==n&&void 0===(null===i||void 0===i?void 0:i.id)&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==i});return{snapshot:n,version:i}}(e,t,o):await async function(e,t,r){var o;const n=await t.getVersions(null!==r&&void 0!==r?r:null,1),i=n[0];void 0===i&&void 0!==r&&e.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:r});const s=null!==(o=await t.getSnapshotTree(i))&&void 0!==o?o:void 0;void 0===s&&void 0!==i?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:i.id}):void 0!==s&&void 0===(null===i||void 0===i?void 0:i.id)&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==i});return{snapshot:s,version:i}}(e,t,o);return Ze(void 0!==n,2276),{baseSnapshot:n,version:i}}const mo="saved";async function vo(e){if(e.closed)throw new At("waitContainerToCatchUp: Container closed");return new Promise((t,r)=>{const o=e.deltaManager,n=t=>{e.off("closed",n);const o="Container closed while waiting to catch up";r(void 0===t?new Nt(o):te(t,e=>new Nt("".concat(o,": ").concat(e))))};e.on("closed",n);const i=()=>{Ze(e.connectionState===qe.CatchingUp||e.connectionState===qe.Connected,205);const r=o.hasCheckpointSequenceNumber,i=o.lastKnownSeqNumber;if(Ze(o.lastSequenceNumber<=i,614),o.lastSequenceNumber===i)return e.off("closed",n),void t(r);const s=a=>{i<=a.sequenceNumber&&(e.off("closed",n),t(r),o.off("op",s))};o.on("op",s)};if(e.connectionState===qe.Connected)return void i();const s=()=>{e.off(Lt,s),i()};e.on(Lt,s),e.connectionState===qe.Disconnected&&e.connect()})}const yo="summarizer";class bo extends Ot{static async load(e,t){const{version:r,pendingLocalState:o,loadMode:i,resolvedUrl:s}=e,a=new bo(t,e);return pe.timedExecAsync(a.mc.logger,(0,n.A)({eventName:"Load"},i),async e=>new Promise((t,c)=>{const d={opsBeforeReturn:"cached"},l=o?(0,n.A)((0,n.A)({},null!==i&&void 0!==i?i:d),{},{opsBeforeReturn:void 0}):null!==i&&void 0!==i?i:d,u=e=>{c(null!==e&&void 0!==e?e:new Nt("Container closed without error during load"))};a.on("closed",u),a.load(r,l,s,o).finally(()=>{a.removeListener("closed",u)}).then(r=>{e.end((0,n.A)({},r)),t(a)},e=>{const t=Y(e);a.close(t),a.dispose(t),u(t)})}),{start:!0,end:!0,cancel:"generic"})}static async createDetached(e,t){const r=new bo(e);return pe.timedExecAsync(r.mc.logger,{eventName:"CreateDetached"},async e=>(await r.createDetached(t),r),{start:!0,end:!0,cancel:"generic"})}static async rehydrateDetachedFromSnapshot(e,t){const r=new bo(e);return pe.timedExecAsync(r.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},async e=>{const o=function(e){const t=JSON.parse(e);if(void 0!==(null===(r=t)||void 0===r?void 0:r.attached)&&void 0!==(null===r||void 0===r?void 0:r.baseSnapshot)&&void 0!==(null===r||void 0===r?void 0:r.snapshotBlobs)&&void 0!==(null===r||void 0===r?void 0:r.hasAttachmentBlobs))return t;if(yt(t)){const{baseSnapshot:e,snapshotBlobs:r}=Qt(t);return{attached:!1,baseSnapshot:e,snapshotBlobs:r,hasAttachmentBlobs:void 0!==t.tree[".hasAttachmentBlobs"]}}throw new At("Cannot rehydrate detached container. Incorrect format");var r}(t);return await r.rehydrateDetachedFromSnapshot(o),r},{start:!0,end:!0,cancel:"generic"})}setLoaded(){if("loading"===this._lifecycleState){var e;this._lifecycleState="loaded",Ze(this.connectionState!==qe.Connected,2409),this.connectionStateHandler.initProtocol(this.protocolHandler);const t=null!==(e=this.readOnlyInfo.readonly)&&void 0!==e&&e;this.setContextConnectedState(!1,t);const r=this._deltaManager.connectionManager;if(r.connected){const e=r.connectionDetails;Ze(void 0!==e,2410),this.connectionStateHandler.receivedConnectEvent(e)}}}get closed(){return"closing"===this._lifecycleState||"closed"===this._lifecycleState||this.disposed}get loaded(){return"loaded"===this._lifecycleState}get disposed(){return"disposing"===this._lifecycleState||"disposed"===this._lifecycleState}get runtime(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get protocolHandler(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get resolvedUrl(){var e;return null===(e=this.service)||void 0===e?void 0:e.resolvedUrl}get readOnlyInfo(){return this._deltaManager.readOnlyInfo}get containerMetadata(){return this._containerMetadata}forceReadonly(e){this._deltaManager.connectionManager.forceReadonly(e)}get deltaManager(){return this._deltaManager}get connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connectionState===qe.Connected}get clientId(){var e;return null===(e=this.protocolHandler.audience.getSelf())||void 0===e?void 0:e.clientId}get isInteractiveClient(){return this.deltaManager.clientDetails.capabilities.interactive}supportGetSnapshotApi(){var e;return!0===this.mc.config.getBoolean("Fluid.Container.UseLoadingGroupIdForSnapshotFetch2")&&!0===(null===(e=this.service)||void 0===e||null===(e=e.policies)||void 0===e?void 0:e.supportGetSnapshotApi)}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){return this._loadedCodeDetails}getContainerPackageInfo(){return sr(this._loadedCodeDetails)}get audience(){return this.protocolHandler.audience}get isDirty(){return this._dirtyContainer}async getEntryPoint(){if(this._disposed)throw new At("The context is already disposed");var e,t;return void 0!==this._runtime?null===(e=(t=this._runtime).getEntryPoint)||void 0===e?void 0:e.call(t):new Promise((e,t)=>{const r=()=>{var t,r;Ze(void 0!==this._runtime,1443),e(null===(t=(r=this._runtime).getEntryPoint)||void 0===t?void 0:t.call(r)),this._lifecycleEvents.off("disposed",o)},o=()=>{t(new Error("ContainerContext was disposed")),this._lifecycleEvents.off("runtimeInstantiated",r)};this._lifecycleEvents.once("runtimeInstantiated",r),this._lifecycleEvents.once("disposed",o)})}constructor(e,t){var r;super((e,t)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:"string"===typeof e?e:void 0},t),this.close(Y(t))}),this._lifecycleState="loading",this.inboundQueuePausedFromInit=!0,this.connectionCount=0,this.connectionTransitionTimes=[],this._dirtyContainer=!1,this.attachmentData={state:We.Detached},this.clientsWhoShouldHaveLeft=new Set,this._containerMetadata={},this.setAutoReconnectTime=P(),this._lifecycleEvents=new Ke,this.verifyClosedAfterCalls=0,this._disposed=!1,this.attach=Xt(async(e,t)=>{await pe.timedExecAsync(this.mc.logger,{eventName:"Attach"},async()=>{if("loaded"!==this._lifecycleState||this.attachmentData.state===We.Attached)throw new At("The Container is not in a valid state for attach [".concat(this._lifecycleState,"] and [").concat(this.attachState,"]"));const r=e=>{var t;const r=Y(e);return this.close(r),r.addTelemetryProperties({resolvedUrl:null===(t=this.service)||void 0===t||null===(t=t.resolvedUrl)||void 0===t?void 0:t.url}),r};let o=(async e=>{let{detachedBlobStorage:t,createOrGetStorageService:r,setAttachmentData:o,createAttachmentSummary:n,offlineLoadEnabled:i,initialAttachmentData:s}=e,a=s;void 0===a.blobs&&(a=void 0!==t&&t.size>0?{state:We.Detached,blobs:"outstanding",redirectTable:new Map}:{state:We.Attaching,summary:n(),blobs:"none"},o(a));const c=await r(a.summary);if("outstanding"===a.blobs){const{redirectTable:e}=a;for(Ze(!!t,590);e.size<t.size;){const r=t.getBlobIds().filter(t=>!e.has(t));for(const o of r){const r=await t.readBlob(o),n=await c.createBlob(r);e.set(o,n.id)}}o(a={state:We.Attaching,summary:n(e),blobs:"done"})}Ze(a.state===We.Attaching,2274),"done"===a.blobs&&await c.uploadSummaryWithContext(a.summary,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0});const d=i?Qt(a.summary):void 0;return o(a={state:We.Attached}),d})({initialAttachmentData:this.attachmentData,offlineLoadEnabled:this.serializedStateManager.offlineLoadEnabled,detachedBlobStorage:this.detachedBlobStorage,setAttachmentData:e=>{const t=this.attachmentData.state;this.attachmentData=e;const o=this.attachmentData.state;if(o!==t&&o!==We.Detached)try{this.runtime.setAttachState(o),this.emit(o.toLocaleLowerCase())}catch(n){throw r(n)}},createAttachmentSummary:e=>{try{return Ze(0===this._deltaManager.inbound.length,214),Gt(this.runtime.createSummary(e),this.captureProtocolSummary())}catch(t){throw r(t)}},createOrGetStorageService:async t=>{if(void 0===this.service){const r=await this.urlResolver.resolve(e);Ze(this.client.details.type!==yo&&void 0!==r,708),this.service=await pt(async()=>this.serviceFactory.createContainer(t,r,this.subLogger,!1),"containerAttach",this.mc.logger,{cancel:this._deltaManager.closeAbortController.signal})}return this.storageAdapter.connectToService(this.service),this.storageAdapter}});!0!==this.mc.config.getBoolean("Fluid.Container.RetryOnAttachFailure")&&(o=o.catch(e=>{throw r(e)}));const n=await o;var i,s;(this.serializedStateManager.setInitialSnapshot(n),this.closed)||(null===(i=this.detachedBlobStorage)||void 0===i||null===(s=i.dispose)||void 0===s||s.call(i),this.handleDeltaConnectionArg(null===t||void 0===t?void 0:t.deltaConnection,{fetchOpsFromStorage:!1,reason:{text:"createDetached"}}))},{start:!0,end:!0,cancel:"generic"})}),this.getAbsoluteUrl=async e=>{if(void 0!==this.resolvedUrl)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,e,sr(this._loadedCodeDetails))},this.metadataUpdateHandler=e=>{this._containerMetadata=(0,n.A)((0,n.A)({},this._containerMetadata),e),this.emit("metadataUpdate",e)},this.updateDirtyContainerState=e=>{this._dirtyContainer!==e&&(this._dirtyContainer=e,this.emit(e?"dirty":mo))};const{canReconnect:o,clientDetailsOverride:i,urlResolver:s,documentServiceFactory:a,codeLoader:c,options:d,scope:l,subLogger:u,detachedBlobStorage:h,protocolHandlerBuilder:g}=e;this.connectionTransitionTimes[qe.Disconnected]=P();const p=null===t||void 0===t?void 0:t.pendingLocalState;this._canReconnect=null===o||void 0===o||o,this.clientDetailsOverride=i,this.urlResolver=s,this.serviceFactory=a,this.codeLoader=c,this.options=(0,n.A)({},d),this.scope=l,this.protocolHandlerBuilder=null!==g&&void 0!==g?g:(e,t,r)=>new vr(e,t,r,new tr,e=>this.clientsWhoShouldHaveLeft.has(e)),this.clone=async(t,r)=>bo.load(t,(0,n.A)((0,n.A)({},e),r)),this._containerId=W(),this.client=bo.setupClient(this._containerId,d.client,this.clientDetailsOverride);const f=this.client.details.type,m=this.client.details.capabilities.interactive,v="".concat(m?"interactive":"noninteractive").concat(void 0!==f&&""!==f?"/".concat(f):"");this.subLogger=ue({logger:u,properties:{all:{clientType:v,containerId:this._containerId,docId:()=>{var e;return null===(e=this.resolvedUrl)||void 0===e?void 0:e.id},containerAttachState:()=>this.attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>qe[this.connectionState],serializedContainer:void 0!==p},error:{dmInitialSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.initialSequenceNumber},dmLastProcessedSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.lastSequenceNumber},dmLastKnownSeqNumber:()=>{var e;return null===(e=this._deltaManager)||void 0===e?void 0:e.lastKnownSeqNumber},containerLoadedFromVersionId:()=>{var e;return null===(e=this._loadedFromVersion)||void 0===e?void 0:e.id},containerLoadedFromVersionDate:()=>{var e;return null===(e=this._loadedFromVersion)||void 0===e?void 0:e.date},dmLastMsqSeqNumber:()=>{var e;return null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.sequenceNumber},dmLastMsqSeqTimestamp:()=>{var e;return null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.timestamp},dmLastMsqSeqClientId:()=>{var e,t;return null===(null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.clientId)?"null":null===(t=this.deltaManager)||void 0===t||null===(t=t.lastMessage)||void 0===t?void 0:t.clientId},dmLastMsgClientSeq:()=>{var e;return null===(e=this.deltaManager)||void 0===e||null===(e=e.lastMessage)||void 0===e?void 0:e.clientSequenceNumber},connectionStateDuration:()=>P()-this.connectionTransitionTimes[this.connectionState]}}}),this.mc=H({logger:this.subLogger,namespace:"Container"}),this._deltaManager=this.createDeltaManager(),this.connectionStateHandler=Fr({logger:this.mc.logger,mc:M(u),connectionStateChanged:(e,t,r)=>{this.logConnectionStateChangeTelemetry(e,t,r),this.loaded&&this.propagateConnectionState(e===qe.Disconnected?r:void 0)},shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:d.maxClientLeaveWaitTime,logConnectionIssue:(e,t,r)=>{const o=this.connectionMode;if(this._deltaManager.logConnectionIssue((0,n.A)({eventName:e,mode:o,category:"loading"===this._lifecycleState?"generic":t,duration:P()-this.connectionTransitionTimes[qe.CatchingUp]},void 0===r?{}:{details:JSON.stringify(r)})),Ze(this.loaded,2411),"read"===o&&"error"===t){const e={text:"NoJoinSignal"};this.disconnectInternal(e),this.connectInternal({reason:e,fetchOpsFromStorage:!1})}},clientShouldHaveLeft:e=>{this.clientsWhoShouldHaveLeft.add(e)},onCriticalError:e=>{this.close(Y(e))}},this.deltaManager,null===p||void 0===p?void 0:p.clientId),this.on(mo,()=>{this.connectionStateHandler.containerSaved()});const y=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree2");this.detachedBlobStorage=null!==h&&void 0!==h?h:!0===this.mc.config.getBoolean("Fluid.Container.MemoryBlobStorageEnabled")?function(){const e=[];return{[ao]:ao,createBlob:async t=>({id:"".concat(e.push(t)-1)}),readBlob:async t=>{var r;return null!==(r=e[Number(t)])&&void 0!==r?r:Promise.reject(new Error("Blob not found: ".concat(t)))},get size(){return e.length},getBlobIds:()=>e.map((e,t)=>"".concat(t)),dispose:()=>e.splice(0),serialize:()=>JSON.stringify(e.map(e=>Pt(e,"utf8"))),initialize:t=>e.push(...t.map(e=>wt(e,"utf8")))}}():void 0,this.storageAdapter=new Vr(this.detachedBlobStorage,this.mc.logger,null===p||void 0===p?void 0:p.snapshotBlobs,null===p||void 0===p?void 0:p.loadedGroupIdSnapshots,e=>!0===yt(e)?e:Gt(e,this.captureProtocolSummary()),y);const b=null!==(r=this.isInteractiveClient&&this.mc.config.getBoolean("Fluid.Container.enableOfflineLoad"))&&void 0!==r?r:!0===d.enableOfflineLoad;this.serializedStateManager=new po(p,this.subLogger,this.storageAdapter,b,this,()=>this._deltaManager.connectionManager.shouldJoinWrite(),()=>this.supportGetSnapshotApi(),this.mc.config.getNumber("Fluid.Container.snapshotRefreshTimeoutMs"));"object"===typeof document&&null!==document&&"function"===typeof document.addEventListener&&null!==document.addEventListener&&m&&(this.lastVisible=document.hidden?P():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=P():setTimeout(()=>{this.lastVisible=void 0},0)},document.addEventListener("visibilitychange",this.visibilityEventHandler))}getQuorum(){return this.protocolHandler.quorum}dispose(e){this.verifyClosedAfter(()=>this._deltaManager.dispose(e))}close(e){this.verifyClosedAfter(()=>this._deltaManager.close(e))}verifyClosedAfter(e){this.verifyClosedAfterCalls++;try{e()}finally{this.verifyClosedAfterCalls--}0===this.verifyClosedAfterCalls&&(Ze(this.connectionState===qe.Disconnected,207),Ze("closed"===this._lifecycleState||"disposed"===this._lifecycleState,788))}closeCore(e){Ze(!this.closed,789);try{try{var t,r,o;if(this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:"loading"!==this._lifecycleState&&void 0!==e?"error":"generic"},e),this._lifecycleState="closing",void 0!==(null===(t=this.service)||void 0===t?void 0:t.off))null===(o=this.service)||void 0===o||o.off("metadataUpdate",this.metadataUpdateHandler);null===(r=this._protocolHandler)||void 0===r||r.close(),this.connectionStateHandler.dispose()}catch(n){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},n)}this.emit("closed",e),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed",this.client.details.type===yo&&this.dispose(e)}}disposeCore(e){Ze(!this._disposed,1356),this._disposed=!0;try{try{var t,r,o;this.mc.logger.sendTelemetryEvent({eventName:"ContainerDispose",category:this.closed||void 0===e?"generic":"error"},e),"closed"!==this._lifecycleState&&(this._lifecycleState="disposing"),null===(t=this._protocolHandler)||void 0===t||t.close(),this.connectionStateHandler.dispose();const n=void 0===e?void 0:new Error(e.message);null===(r=this._runtime)||void 0===r||r.dispose(n),this.storageAdapter.dispose(),null===(o=this.service)||void 0===o||o.dispose(e)}catch(n){this.mc.logger.sendErrorEvent({eventName:"ContainerDisposeException"},n)}this.emit("disposed",e),this.removeAllListeners(),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="disposed",this._lifecycleEvents.emit("disposed")}}async closeAndGetPendingLocalState(e){const t=await this.getPendingLocalStateCore({notifyImminentClosure:!0,stopBlobAttachingSignal:e});return this.close(),t}async getPendingLocalState(){return this.getPendingLocalStateCore({notifyImminentClosure:!1})}async getPendingLocalStateCore(e){if(this.closed||this._disposed)throw new At("Pending state cannot be retried if the container is closed or disposed");Ze(this.attachmentData.state===We.Attached,209),Ze(void 0!==this.resolvedUrl&&"fluid"===this.resolvedUrl.type,210);return await this.serializedStateManager.getPendingLocalState(e,this.clientId,this.runtime,this.resolvedUrl)}get attachState(){return this.attachmentData.state}serialize(){var e;if(this.attachmentData.state===We.Attached||this.closed)throw new At("Container must not be attached or closed.");const t=this.attachmentData.state===We.Attaching?this.attachmentData:void 0,r=null!==(e=null===t||void 0===t?void 0:t.summary)&&void 0!==e?e:Gt(this.runtime.createSummary(),this.captureProtocolSummary()),{baseSnapshot:o,snapshotBlobs:n}=Qt(r),i=void 0===t?void 0:this.runtime.getPendingLocalState();var s;Ze(!(Ye(s=i)&&"then"in s&&"function"===typeof s.then),2275);const a={attached:!1,baseSnapshot:o,snapshotBlobs:n,pendingRuntimeState:i,hasAttachmentBlobs:void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,attachmentBlobs:lo(this.detachedBlobStorage)};return JSON.stringify(a)}setAutoReconnectInternal(e,t){if(this._deltaManager.connectionManager.reconnectMode===e)return;const r=P(),o=r-this.setAutoReconnectTime;this.setAutoReconnectTime=r,this.mc.logger.sendTelemetryEvent({eventName:e===or.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:qe[this.connectionState],duration:o}),this._deltaManager.connectionManager.setAutoReconnect(e,t)}connect(){if(this.closed)throw new At("The Container is closed and cannot be connected");if(this.attachState!==We.Attached)throw new At("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:{text:"DocumentConnect"},fetchOpsFromStorage:!1})}connectInternal(e){Ze(!this.closed,709),Ze(this.attachState===We.Attached,710);const t=or.Enabled;this.setAutoReconnectInternal(t,e.reason),this.resumeInternal(e)}disconnect(){if(this.closed)throw new At("The Container is closed and cannot be disconnected");this.disconnectInternal({text:"DocumentDisconnect"})}disconnectInternal(e){Ze(!this.closed,711);const t=or.Disabled;this.setAutoReconnectInternal(t,e)}resumeInternal(e){Ze(!this.closed,217),this.inboundQueuePausedFromInit&&(Ze(this.loaded,2412),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e)}async proposeCodeDetails(e){if(!$e(e))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){const t=await this.codeLoader.IFluidCodeDetailsComparer.compare(e,this.getCodeDetailsFromQuorum());if(void 0!==t&&t<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",e).then(()=>!0).catch(()=>!1)}async processCodeProposal(){const e=this.getCodeDetailsFromQuorum();if(await Promise.all([this._deltaManager.inbound.pause(),this._deltaManager.inboundSignal.pause()]),!0===await this.satisfies(e))return this._deltaManager.inbound.resume(),void this._deltaManager.inboundSignal.resume();const t=new Nt("Existing context does not satisfy incoming proposal");this.close(t)}async satisfies(e){var t;if(void 0===this._loadedModule)return!1;const r=[],o=this.codeLoader;void 0!==o.IFluidCodeDetailsComparer&&r.push(o.IFluidCodeDetailsComparer);const n=null===(t=this._loadedModule)||void 0===t?void 0:t.module.fluidExport;if(void 0!==(null===n||void 0===n?void 0:n.IFluidCodeDetailsComparer)&&r.push(n.IFluidCodeDetailsComparer),0===r.length)return!1;for(const s of r){var i;if(!1===await s.satisfies(null===(i=this._loadedModule)||void 0===i?void 0:i.details,e))return!1}return!0}connectToDeltaStream(e){this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}async createDocumentService(e){const t=await e();return void 0!==t.on&&t.on("metadataUpdate",this.metadataUpdateHandler),t}async load(e,t,r,o){var i,s,a,c;const d={phase1:P()};this.service=await this.createDocumentService(async()=>this.serviceFactory.createDocumentService(r,this.subLogger,this.client.details.type===yo));const l={reason:{text:"DocumentOpen"},mode:!0===this.mc.config.getBoolean("Fluid.Container.ForceWriteConnection")||(null!==(i=null===o||void 0===o?void 0:o.savedOps.length)&&void 0!==i?i:0)>0?"write":"read",fetchOpsFromStorage:!1};void 0===t.deltaConnection&&this.connectToDeltaStream(l),this.storageAdapter.connectToService(this.service),this.attachmentData={state:We.Attached},d.phase2=P();const{baseSnapshot:u,version:h}=await this.serializedStateManager.fetchSnapshot(e),g=St(u);this._loadedFromVersion=h;const p=await er(this.storageAdapter,g),f=null!==(s=null===o||void 0===o||null===(a=o.savedOps[o.savedOps.length-1])||void 0===a?void 0:a.sequenceNumber)&&void 0!==s?s:p.sequenceNumber;let m;switch(t.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(p,"none"===t.deltaConnection?"none":"all",f);break;case"cached":case"all":m=this.attachDeltaManagerOpHandler(p,t.opsBeforeReturn,f);break;default:Xe(t.opsBeforeReturn)}await this.initializeProtocolStateFromSnapshot(p,this.storageAdapter,g),Ze(void 0===this.clientId,2413),void 0!==(null===o||void 0===o?void 0:o.clientId)&&this.protocolHandler.audience.setCurrentClientId(null===o||void 0===o?void 0:o.clientId),d.phase3=P();const v=this.getCodeDetailsFromQuorum();if(await this.instantiateRuntime(v,g,o?null!==(c=null===o||void 0===o?void 0:o.pendingRuntimeState)&&void 0!==c?c:{}:void 0,bt(u)?u:void 0),o){for(const e of o.savedOps){var y,b;this.processRemoteMessage((0,n.A)((0,n.A)({},e),{},{metadata:(0,n.A)((0,n.A)({},e.metadata),{},{savedOp:!0})})),await(null===(y=(b=this.runtime).notifyOpReplay)||void 0===y?void 0:y.call(b,e))}o.savedOps=[],this.storageAdapter.clearPendingState()}if(this.closed||(void 0!==m&&(this._deltaManager.inbound.resume(),await pe.timedExecAsync(this.mc.logger,{eventName:"WaitOps"},async()=>m),await pe.timedExecAsync(this.mc.logger,{eventName:"WaitOpProcessing"},async()=>this._deltaManager.inbound.waitTillProcessingDone()),this._deltaManager.inbound.pause()),this.setLoaded(),this.handleDeltaConnectionArg(t.deltaConnection)),this.closed)throw new Error("Container was closed while load()");return d.end=P(),this.subLogger.sendTelemetryEvent({eventName:"LoadStagesTimings",details:JSON.stringify(d)},void 0,T),{sequenceNumber:p.sequenceNumber,version:null===h||void 0===h?void 0:h.id,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}}async createDetached(e){const t={sequenceNumber:0,minimumSequenceNumber:0};await this.attachDeltaManagerOpHandler(t);const r=[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]];this.initializeProtocolState(t,{members:[],proposals:[],values:r}),await this.instantiateRuntime(e,void 0),this.setLoaded()}async rehydrateDetachedFromSnapshot(e){let{baseSnapshot:t,snapshotBlobs:r,hasAttachmentBlobs:o,attachmentBlobs:n,pendingRuntimeState:i}=e;o&&(void 0!==n&&function(e,t){if(!co(e))throw new Error("DetachedBlobStorage was not provided to the loader during serialize so cannot be provided during rehydrate.");Ze(0===e.size,2462);const r=JSON.parse(t);Ze(Array.isArray(r),2463),e.initialize(r)}(this.detachedBlobStorage,n),Ze(void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,592));const s=Zt(t,r);this.storageAdapter.loadSnapshotFromSnapshotBlobs(r);const a=await er(this.storageAdapter,s);await this.attachDeltaManagerOpHandler(a);const c=$t(s),d=await It(this.storageAdapter,c.blobs.quorumValues);this.initializeProtocolState(a,{members:[],proposals:[],values:d});const l=this.getCodeDetailsFromQuorum();await this.instantiateRuntime(l,s,i),this.setLoaded()}async initializeProtocolStateFromSnapshot(e,t,r){const o={members:[],proposals:[],values:[]};if(void 0!==r){const e=$t(r);[o.members,o.proposals,o.values]=await Promise.all([It(t,e.blobs.quorumMembers),It(t,e.blobs.quorumProposals),It(t,e.blobs.quorumValues)])}this.initializeProtocolState(e,o)}initializeProtocolState(e,t){const r=this.protocolHandlerBuilder(e,t,(e,t)=>this.submitMessage(tt.Propose,JSON.stringify({key:e,value:t}))),o=ue({logger:this.subLogger,namespace:"ProtocolHandler"});r.quorum.on("error",e=>{o.sendErrorEvent(e)}),r.quorum.on("addProposal",e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)}),r.quorum.on("approveProposal",(e,t,r)=>{"code"!==t&&"code2"!==t||($e(r)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch(e=>{const t=Y(e);throw this.close(t),e}))}),this._protocolHandler=r}captureProtocolSummary(){const e=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:et.Blob},quorumMembers:{content:JSON.stringify(e.members),type:et.Blob},quorumProposals:{content:JSON.stringify(e.proposals),type:et.Blob},quorumValues:{content:JSON.stringify(e.values),type:et.Blob}},type:et.Tree}}getCodeDetailsFromQuorum(){const e=(e=>{var t;return null!==(t=e.get("code"))&&void 0!==t?t:e.get("code2")})(this.protocolHandler.quorum);return e}static setupClient(e,t,r){const o=void 0===t?{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}}:Vt(t);return void 0!==r&&(o.details=(0,n.A)((0,n.A)((0,n.A)({},o.details),r),{},{capabilities:(0,n.A)((0,n.A)({},o.details.capabilities),null===r||void 0===r?void 0:r.capabilities)})),o.details.environment=[o.details.environment," loaderVersion:".concat(xr)," containerId:".concat(e)].join(";"),o}activeConnection(){return this.connectionState===qe.Connected&&"write"===this.connectionMode}createDeltaManager(){const e=()=>this.service,t=new Xr(e,ue({logger:this.subLogger,namespace:"DeltaManager"}),()=>this.activeConnection(),t=>new Tr(e,()=>this.isDirty,this.client,this._canReconnect,ue({logger:this.subLogger,namespace:"ConnectionManager"}),t));return t.inbound.pause(),t.inboundSignal.pause(),t.on("connect",(e,t)=>{Ze(this.connectionMode===e.mode,1207),this.loaded&&this.connectionStateHandler.receivedConnectEvent(e)}),t.on("establishingConnection",e=>{this.connectionStateHandler.establishingConnection(e)}),t.on("cancelEstablishingConnection",e=>{this.connectionStateHandler.cancelEstablishingConnection(e)}),t.on("disconnect",(e,t)=>{var r;null===(r=this.noopHeuristic)||void 0===r||r.notifyDisconnect();const o={text:e,error:t};this.loaded?this.connectionStateHandler.receivedDisconnectEvent(o):this.closed||this.connectionStateHandler.cancelEstablishingConnection(o)}),t.on("throttled",e=>{const t=e;!0!==t.logged&&this.mc.logger.sendTelemetryEvent({eventName:"ContainerWarning"},t),this.emit("warning",t)}),t.on("readonly",e=>{this.loaded&&this.setContextConnectedState(this.connectionState===qe.Connected,e),this.emit("readonly",e)}),t.on("closed",e=>{this.closeCore(e)}),t.on("disposed",e=>{this.disposeCore(e)}),t}async attachDeltaManagerOpHandler(e,t,r){return this._deltaManager.attachOpHandler(e.minimumSequenceNumber,e.sequenceNumber,{process:e=>this.processRemoteMessage(e),processSignal:e=>{this.processSignal(e)}},t,r)}logConnectionStateChangeTelemetry(e,t,r){var o,i;const s=P();this.connectionTransitionTimes[e]=s;const a=s-this.connectionTransitionTimes[t];let c,d,l,u;e===qe.Disconnected?d=this._deltaManager.connectionManager.reconnectMode:e===qe.Connected?(c=s-this.connectionTransitionTimes[qe.Disconnected],c=de(c)):e===qe.CatchingUp&&(l=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&this.loaded&&(u=l-this.deltaManager.lastSequenceNumber)),this.mc.logger.sendPerformanceEvent((0,n.A)({eventName:"ConnectionStateChange_".concat(qe[e]),from:qe[t],duration:a,durationFromDisconnected:c,reason:null===r||void 0===r?void 0:r.text,connectionCount:this.connectionCount,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.connectionStateHandler.clientId,autoReconnect:d,opsBehind:u,online:it[st()],lastVisible:void 0===this.lastVisible?void 0:P()-this.lastVisible,checkpointSequenceNumber:l,quorumSize:null===(o=this._protocolHandler)||void 0===o?void 0:o.quorum.getMembers().size,audienceSize:null===(i=this._protocolHandler)||void 0===i?void 0:i.audience.getMembers().size,isDirty:this.isDirty},this._deltaManager.connectionProps),null===r||void 0===r?void 0:r.error),e===qe.Connected&&this.connectionCount++}propagateConnectionState(e){var t;const r=this.connectionState===qe.Connected;if(r){const e=this.connectionStateHandler.clientId;Ze(void 0!==e,2414),this.protocolHandler.audience.setCurrentClientId(e)}this.connectionState!==qe.Connected&&this.connectionState!==qe.Disconnected||(this.setContextConnectedState(r,null!==(t=this.readOnlyInfo.readonly)&&void 0!==t&&t),this.protocolHandler.setConnectionState(r,this.clientId),function(e,t,r,o,n){try{r?t.emit(Lt,o):t.emit("disconnected",n)}catch(i){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},i)}}(this.mc.logger,this,r,this.clientId,null===e||void 0===e?void 0:e.text))}submitContainerMessage(e,t,r,o){switch(e){case tt.Operation:return this.submitMessage(e,JSON.stringify(t),r,o);case tt.Summarize:return this.submitSummaryMessage(t);default:{const t=new Nt("invalidContainerSubmitOpType",void 0,{messageType:e});return this.close(t),-1}}}submitBatch(e,t){let r=-1;for(const o of e)r=this.submitMessage(tt.Operation,o.contents,!0,o.metadata,o.compression,t);return this._deltaManager.flush(),r}submitSummaryMessage(e,t){return void 0===e.details&&(e.details={}),e.details.includesProtocolTree=this.storageAdapter.summarizeProtocolTree,this.submitMessage(tt.Summarize,JSON.stringify(e),!1,void 0,void 0,t)}submitMessage(e,t,r,o,n,i){var s;return this.connectionState!==qe.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(null===(s=this.noopHeuristic)||void 0===s||s.notifyMessageSent(),this._deltaManager.submit(e,t,r,o,n,i))}processRemoteMessage(e){const t=this.clientId===e.clientId,r=this.protocolHandler.processMessage(e,t);if(this.runtime.process(e,t),this.serializedStateManager.addProcessedOp(e),this.activeConnection()){if(void 0===this.noopHeuristic){const e=this.deltaManager.serviceConfiguration;Ze(void 0!==e,740),this.noopHeuristic=new uo(e.noopTimeFrequency,e.noopCountFrequency),this.noopHeuristic.on("wantsNoop",()=>{Ze(this.activeConnection(),577),this.submitMessage(tt.NoOp)})}this.noopHeuristic.notifyMessageProcessed(e),!0===r.immediateNoOp&&this.submitMessage(tt.Accept)}this.emit("op",e)}submitSignal(e,t){this._deltaManager.submitSignal(JSON.stringify(e),t)}processSignal(e){if(function(e){if(null===e.clientId){const t=e.content;return t.type===mr.Clear||t.type===mr.ClientJoin||t.type===mr.ClientLeave}return!1}(e))this.protocolHandler.processSignal(e);else{const t=this.clientId===e.clientId;this.runtime.processSignal(e,t)}}async instantiateRuntime(e,t,r,o){var n,i;Ze(!1!==(null===(n=this._runtime)||void 0===n?void 0:n.disposed),221);const s=this.scope,a=new io(this,s.ILoader),c=await pe.timedExecAsync(this.subLogger,{eventName:"CodeLoad"},async()=>this.codeLoader.load(e));this._loadedModule={module:c.module,details:null!==(i=c.details)&&void 0!==i?i:e};const d=this._loadedModule.module.fluidExport,l=null===d||void 0===d?void 0:d.IRuntimeFactory;if(void 0===l)throw new Error("Code package does not implement IRuntimeFactory");const u=void 0!==t,h=new Hr(this.options,this.scope,t,this._loadedFromVersion,this._deltaManager,this.storageAdapter,this.protocolHandler.quorum,this.protocolHandler.audience,a,(e,t,r,o)=>this.submitContainerMessage(e,t,r,o),(e,t)=>this.submitSummaryMessage(e,t),(e,t)=>this.submitBatch(e,t),(e,t)=>this.submitSignal(e,t),e=>this.dispose(e),e=>this.close(e),this.updateDirtyContainerState,this.getAbsoluteUrl,()=>{var e;return null===(e=this.resolvedUrl)||void 0===e?void 0:e.id},()=>this.clientId,()=>this.attachState,()=>this.connected,this._deltaManager.clientDetails,u,this.subLogger,r,o),g=await pe.timedExecAsync(this.subLogger,{eventName:"InstantiateRuntime"},async()=>l.instantiateRuntime(h,u));_r(g.ILayerCompatDetails,e=>this.dispose(e)),this._runtime=g,this._lifecycleEvents.emit("runtimeInstantiated"),this._loadedCodeDetails=e}setContextConnectedState(e,t){var r;!1===(null===(r=this._runtime)||void 0===r?void 0:r.disposed)&&this.loaded&&this.runtime.setConnectionState(e&&!t,this.clientId)}handleDeltaConnectionArg(e,t){switch(Ze(this.loaded,2415),e){case void 0:t&&this.connectToDeltaStream(t);case"delayed":Ze(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:Xe(e)}}}var So=r(60835),Co=r(27284);class ko extends Co.EventEmitter{emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}trackContainerEvents(){this.container.audience.on("addMember",this.addMemberEventHandler),this.container.audience.on("removeMember",this.removeMemberEventHandler),this.container.on("connected",this.connectedEventHandler),this.container.on("disconnected",this.disconnectedEventHandler),this.container.on("dirty",this.dirtyEventHandler),this.container.on("saved",this.savedEventHandler),this.container.on("readonly",this.readonlyEventHandler),this.container.on("closed",this.closedEventHandler),this.container.on("disposed",this.disposedEventHandler),this.container.on("warning",this.waringEventHandler)}trackComponentEvents(){var e;const t=null!==(e=this.component.Lifecycle)&&void 0!==e?e:this.component.ComponentLifecycle;null===t||void 0===t||t.on("dirty",this.dirtyEventHandler),null===t||void 0===t||t.on("readonlyChanged",this.readonlyEventHandler)}removeContainerListeners(){this.container.audience.off("addMember",this.addMemberEventHandler),this.container.audience.off("removeMember",this.removeMemberEventHandler),this.container.off("connected",this.connectedEventHandler),this.container.off("disconnected",this.disconnectedEventHandler),this.container.off("dirty",this.dirtyEventHandler),this.container.off("saved",this.savedEventHandler),this.container.off("readonly",this.readonlyEventHandler),this.container.off("closed",this.closedEventHandler),this.container.off("disposed",this.disposedEventHandler),this.container.off("warning",this.waringEventHandler)}removeComponentListeners(){var e;const t=null!==(e=this.component.Lifecycle)&&void 0!==e?e:this.component.ComponentLifecycle;null===t||void 0===t||t.off("dirty",this.dirtyEventHandler),null===t||void 0===t||t.off("readonlyChanged",this.readonlyEventHandler)}get ComponentLifecycle(){return this}get disposed(){return this.container.disposed||this._disposed}get isDirty(){var e;return void 0!==(null===(e=this.component.Lifecycle)||void 0===e?void 0:e.isDirty)?this.container.isDirty||this.component.Lifecycle.isDirty:this.container.isDirty}get isReadOnly(){var e,t;const r=null!==(e=this.component.Lifecycle)&&void 0!==e?e:this.component.ComponentLifecycle;return null!==(t=this.container.readOnlyInfo.readonly||(null===r||void 0===r?void 0:r.isReadOnly))&&void 0!==t&&t}getReadonly(){var e,t,r;const o=null!==(e=this.component.Lifecycle)&&void 0!==e?e:this.component.ComponentLifecycle;return null!==(t=null===o||void 0===o||null===(r=o.getReadonly)||void 0===r?void 0:r.call(o))&&void 0!==t?t:{isReadOnly:this.isReadOnly}}get Lifecycle(){return this}async waitForAllData(){await vo(this.container)}get Disposable(){return this}dispose(){var e;this._disposed=!0,null===(e=this.component.Disposable)||void 0===e||e.dispose(),this.container.dispose()}get ConnectionManager(){return this}get isConnected(){return this.container.connectionState===qe.Connected}connect(){this.container.connect()}disconnect(){this.container.disconnect()}get CollaboratorInfo(){return this}get clientId(){return this.container.clientId}getMembers(){const e=new Map;return this.container.audience.getMembers().forEach((t,r)=>{const o=t.user;e.set(r,{id:o.id,name:o.name,email:o.email,joinTime:t.timestamp,isGuest:o.isGuest,mode:t.mode})}),e}get FluidMetadataProvider(){return this}getCodeDetails(){return this.container.getLoadedCodeDetails()}getSnapshot(){return this.container.serialize()}get LoopComponentUrl(){return this}async initializeLoopComponentUrl(e){if(!e)throw new Error("File name is required to initialize component url.");const t=await this.documentServiceFactoryProviderPromise;if(null===t||void 0===t||!t.getCreateDocumentRequest)throw new Error("FluidDocumentServiceFactoryProvider.getCreateDocumentRequest is required to initialize component url");const r=await t.getCreateDocumentRequest(e);await this.container.attach(r)}async getLoopComponentUrl(){const e=this.documentUrl?this.documentUrl:await this.container.getAbsoluteUrl("/");if(e)return new URL(e)}get FluidShareLinkInfo(){return this}getShareLink(){const e=this.container.resolvedUrl;if(e&&(0,So.g2)(e))return e.shareLinkInfo}constructor(e,t,r,o){super(),this.container=e,this.documentUrl=t,this.documentServiceFactoryProviderPromise=r,this.component=o,this.addMemberEventHandler=()=>{this.emit("membersChanged",!0)},this.removeMemberEventHandler=()=>{this.emit("membersChanged",!1)},this.connectedEventHandler=()=>{this.emit("connected")},this.disconnectedEventHandler=e=>{this.emit("disconnected",e)},this.dirtyEventHandler=()=>{this.emit("dirty")},this.savedEventHandler=()=>{this.emit("saved")},this.readonlyEventHandler=()=>{this.emit("readonlyChanged",this.getReadonly().isReadOnly)},this.closedEventHandler=e=>{this.emit("error",e)},this.disposedEventHandler=()=>{this.removeContainerListeners(),this.removeComponentListeners(),this.removeAllListeners(),this._disposed=!0,this.emit("disposed")},this.waringEventHandler=e=>{this.emit("warning",e)},this.trackContainerEvents(),this.trackComponentEvents(),this.container.forceReadonly&&(this.setReadonly=(e,t)=>{var r,o;if(t){var n,i;const t=null!==(n=this.component.Lifecycle)&&void 0!==n?n:this.component.ComponentLifecycle;null===t||void 0===t||null===(i=t.setReadonly)||void 0===i||i.call(t,e,!0)}else null===(r=(o=this.container).forceReadonly)||void 0===r||r.call(o,e)}),this._disposed=!1}}const wo={ComponentLifecycle:"ComponentLifecycle",ConnectionManager:"ConnectionManager",CollaboratorInfo:"CollaboratorInfo",FluidMetadataProvider:"FluidMetadataProvider",LoopComponentUrl:"LoopComponentUrl",Disposable:"Disposable",FluidShareLinkInfo:"FluidShareLinkInfo",Lifecycle:"Lifecycle"};function Po(e,t,r,o,n){const i={};let s;t&&function(e){return Object.keys(wo).some(t=>t in e)}(r)&&(s=new ko(t,n,o,e));for(const a of Object.keys(r)){const t=s&&a in s?{value:s[a]}:{value:e[a]};Object.defineProperty(i,a,t)}return i}class To{static getPathParts(e){const t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce((e,t)=>(void 0!==t&&t.length>0&&e.push(decodeURIComponent(t)),e),[])}static create(e){return e instanceof To?e:new To(e)}constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.substring(t):"",void 0!==e.headers&&(this.headers=e.headers)}get url(){return this.request.url}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=To.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:"/".concat(this.query),headers:this.headers};const r="/".concat(this.pathParts.slice(e).join("/"));return{url:""===this.query?r:"".concat(r,"/").concat(this.query),headers:this.headers}}}async function Eo(e,t,r,o){var n,i;let s="/";if(o){const e=await t.resolve({url:o.url});if(!e)throw new Error("Get undefined for resolvedUrl with ".concat(o.url));const r=zt(function(e){try{const t=new URL(e);if("fluid-odsp:"===t.protocol)return t.protocol="https",t.href}catch(t){}return e}(e.url));void 0!==r&&(s="".concat(r.path).concat(r.query))}const a={url:s,headers:r},c=await(null===(n=e.getEntryPoint)||void 0===n?void 0:n.call(e));if(c){var d,l;const e={status:200,mimeType:"fluid/object",value:c};if("/"===a.url||""===a.url)return e;const t=await(null===(d=c.UrlRouterFetcher)||void 0===d?void 0:d.getUrlRouter());return null!==(l=await(null===t||void 0===t?void 0:t.request(To.create(a))))&&void 0!==l?l:e}const u=null===(i=e.runtime)||void 0===i?void 0:i.request;if(u&&"function"===typeof u)return u(a);throw new Error("Could not invoke the request via the legacy back-compat path: `container.runtime.request` not found.")}const Io="IFluidHandle",No=Symbol.for("FluidHandle-3978c7cf-4675-49ba-a20c-bf35efbf43da"),Ao=!0;function Fo(e){if(!(No in e)||!(No in e[No])){if(Ao&&Io in e)return e[Io];throw new TypeError("Invalid IFluidHandle")}return e[No]}async function Do(e,t,r,o,i,s,a,c,d){var u;const g=v.m.start(h.a$,o,{addUserTiming:!0,isAPerformanceMetric:!0}),p=(0,l.yb)();let f;try{f=await async function(e,t,r,o,i,s,a){const c=v.m.start(h.ol,o,{addUserTiming:!0});let d;if(i){const o=(0,n.A)((0,n.A)({},null===r||void 0===r?void 0:r.headers),{},{wait:!1,externalRequest:!1});if(d=await Eo(e,t,o,r),404===d.status){Ge(e);const o=(0,n.A)((0,n.A)({},null===r||void 0===r?void 0:r.headers),{},{externalRequest:!1});d=await Eo(e,t,o,r)}}else{const o=(0,n.A)((0,n.A)({},null===r||void 0===r?void 0:r.headers),{},{externalRequest:!1});d=await Eo(e,t,o,r)}if(200!==d.status||"fluid/component"!==d.mimeType&&"fluid/object"!==d.mimeType||!d.value){const e=new Se.vU("Component not found: status=".concat(d.status,", value=").concat(d.value),void 0,d.status,d.stack),t={externalRequest:!1,mimeType:d.mimeType};throw c.setResult(!1,t,e),e}const l=d.value;if(c.setResult(!0),a){const t=null===s||void 0===s?void 0:s.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Po(l,e,a,null===t||void 0===t?void 0:t.FluidDocumentServiceFactoryProvider,null===r||void 0===r?void 0:r.url)}return l}(e,t,r,o,a,c)}catch(k){return function(e){(0,l.WN)(p),g.setResult(!1,void 0,e)}(k),Promise.reject(k)}const m=f.ComponentTelemetryMetadata,y=null===m||void 0===m?void 0:m.entityName,b=void 0===(null===(u=f.IFluidLoadable)||void 0===u?void 0:u.handle)?void 0:Fo(f.IFluidLoadable.handle).absolutePath,S=(0,l.xl)(p,!0),C=(0,l.xl)(s);if(g.setResult(!0,(0,n.A)((0,n.A)({},i),{},{componentType:y,componentUrl:b,documentEverHidden:C>-1,documentHidden:S>-1})),a&&function(e,t,r){void 0===r||r<=0?Ge(e):Promise.race([(0,Ie.c)(r),t]).then(()=>{setTimeout(()=>{Ge(e)},50)}).catch(()=>{})}(e,void 0,0),d){const t=null===c||void 0===c?void 0:c.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Po(f,e,d,null===t||void 0===t?void 0:t.FluidDocumentServiceFactoryProvider,null===r||void 0===r?void 0:r.url)}return f}var Bo=r(92756),Lo=r(16135),Oo=r(52841),xo=r(82963);const Mo="@ms/office-fluid-container",Ro="@ms/onenote-meetings",_o="@ms/whiteboard-container",Ho="@fluidx/loop-page-container",Uo="@fluidx/copilot-board-container";var jo=r(74411),qo=r(93537),Vo=r(37805),zo=r(75812);const Go={maxRetries:3,filter:(0,qo.sC)([429,503,709,710]),backoffFn:(0,Vo.Ed)(500)};function Wo(e,t){var r;return t?(0,zo.R)(e,{method:"GET"},t.eventName,t.logger,t.doNotLogOnSuccess,Go,null!==(r=t.timeoutMs)&&void 0!==r?r:0,t.getAdditionalProps):(0,qo.J5)(e,{method:"GET"},Go)}var Jo=r(69649);const Ko="codeLoaderStorage";function Qo(){return(0,Jo.P2)("fluidCodeLoaderCache",1,{async upgrade(e,t){e.createObjectStore(Ko).createIndex("lastUpdatedTime","lastUpdatedTime")},blocked:()=>{throw new Error("Could not open code loader cache DB since it is blocked by an older client that has the DB open")}})}function $o(e){return"".concat(e.packageName,"_").concat(e.ring)}function Zo(e,t){if(t.length>0&&"string"===typeof t[0]){const r=e.find(e=>!function(e,t){const r=new URL(e);return t.includes(r.origin)}(e,t));return void 0===r}return Yo(e,t)}function Yo(e,t){const r=function(e){const t=new Map;for(const r of e)for(const e of r.origin)if(void 0===r.paths)t.set(e,"ALL");else{const o=t.get(e);"ALL"===o||(void 0===o?t.set(e,r.paths.map(Xo)):t.set(e,o.concat(r.paths.map(Xo))))}return t}(t);return e.every(e=>{const t=new URL(e);if(t.pathname!==decodeURIComponent(t.pathname))return!1;const o=r.get(t.origin);if("ALL"===o)return!0;if(void 0===o)return!1;{const e=Xo(t.pathname);return o.some(t=>t.every((t,r)=>t===e[r]))}})}function Xo(e){return e.split("/").filter(e=>""!==e)}async function en(e,t,r){try{const r=await Qo();await r.delete(Ko,$o({packageName:e,ring:t})),r.close()}catch(o){r&&(0,y.hO)(r,{eventName:"DeleteContainerDetailsFromCacheFailed",message:"DeleteContainerDetailsFromCache failed to delete container details from cache"},o)}}let tn=24192e5;async function rn(e,t,r,o,n){try{const i=await Qo(),s=await i.get(Ko,$o({packageName:e,ring:t}));if(i.close(),s){const i=Date.now()-s.lastUpdatedTime;return i>tn?{metadata:{cacheStatus:"expired",cacheAge:i},codeDetailsPackage:void 0}:Zo(o(s.codeDetailsPackage),r)?{metadata:{cacheStatus:"hit",cacheAge:i},codeDetailsPackage:s.codeDetailsPackage}:(en(e,t,n).catch(()=>{}),{metadata:{cacheStatus:"unsafe"},codeDetailsPackage:void 0})}}catch(i){n&&(0,y.hO)(n,{eventName:"GetCodeDetailsPackageFromCacheFailed",message:"GetCodeDetailsPackageFromCacheFailed failed return response"},i)}return{metadata:{cacheStatus:"miss"},codeDetailsPackage:void 0}}function on(e,t,r,o,i){const{getLatestContainerCodeDetails:s,upgradeNeeded:a,preCacheContainerCode:c}=r,d=r=>function(e,t,r,o,i,s,a,c,d){const l=o(r),u=l.then(async o=>{const n=await Qo(),a=$o({packageName:t,ring:r}),d=await n.get(Ko,a);d&&d.codeDetailsPackage.version===s(o).version||i(e,o,c),await n.put(Ko,{codeDetailsPackage:s(o),lastUpdatedTime:Date.now()},a),n.close()}).catch(e=>{d&&(0,y.hO)(d,{eventName:"CodeDetailsFromNetworkAndUpdateCacheFailed",message:"Failed to update cache and return code details for ".concat(t)},e)});return{codePackagePromise:l.then(e=>{const t=a?a(e):void 0;return(0,n.A)((0,n.A)({},s(e)),{},{maxUnsupportedVersion:t})}),cacheUpdatePromise:u}}(e,t,r,s,c,e=>e.fluidCodeDetailsOverride.package,e=>e.maxUnsupportedContainerScriptVersion,i,o);return{getCodeDetailsPackage:(e,r)=>async function(e,t,r,o,i,s){var a;const c=(0,l.yb)(),d=v.m.start("GetCodeDetailsPackage",s,{addUserTiming:!0}),u=rn(e,t,r,i,s).then(e=>({method:"cache",cacheDetails:e})),h=o(t,r).then(e=>({method:"network",codeDetails:e})),g=await Promise.race([u,h]);let p={documentEverHidden:(0,l.xl)(c,!0)>-1,packageVersion:"cache"===g.method?null===(a=g.cacheDetails.codeDetailsPackage)||void 0===a?void 0:a.version:g.codeDetails.version,deploymentRing:t};if("cache"===g.method){const{cacheDetails:e}=g;if(p=(0,n.A)((0,n.A)({},p),e.metadata),e.codeDetailsPackage)return d.setResult(!0,(0,n.A)({method:"cache"},p)),e.codeDetailsPackage}return h.then(e=>(d.setResult(!0,(0,n.A)({method:"network"},p)),e.codeDetails))}(t,e,r,e=>d(e).codePackagePromise,e=>e.fluid.browser.umd.files,o),upgradeNeeded:async(e,r)=>{if(!a)return!1;const n=await a(e,r);return n&&(await en(t,e,o),d(e)),n},preCacheLatestContainerCode:async e=>await d(e).cacheUpdatePromise}}function nn(e,t,r){const o=e.document,n=o.createDocumentFragment();t.forEach(e=>{const t=o.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",n.appendChild(t)):e.endsWith(".css")?(t.as="style",n.appendChild(t)):r&&(0,y.hO)(r,{eventName:"FluidXPrefetchAssetFailed",message:"Unsupported asset type for prefetching: ".concat(e)})}),o.head.appendChild(n)}function sn(e,t,r,o){const n=t.preload.manifest,i=[...n.assets];if(n.localizedAssets){const e=(0,we.rv)(r),t=n.localizedAssets[e];t&&i.push(...t)}nn(e,i.map(e=>"".concat(t.preload.jsBaseUrl,"/").concat(e)),o)}async function an(e,t){const r=t?{logger:t,eventName:"GetCodeLoadDetailsFromNetwork",doNotLogOnSuccess:!0}:void 0,o=await Wo(e,r);if(o.result.ok)return o.result.json();throw new Error("getCodeLoadDetailsFromNetwork: Failed to fetch: ".concat(e,"; StatusCode: ").concat(o.result.status))}function cn(e){return!isNaN(e)&&isFinite(e)}function dn(e,t,r){const o=parseFloat(e);if(!cn(o))return!1;const n=parseFloat(t);return!!cn(n)&&(o<=n||function(e){try{return JSON.parse(e)}catch(t){return[]}}(r).includes(o))}const ln=(e,t,r,o,n)=>on(e,t,{getLatestContainerCodeDetails:r,preCacheContainerCode:sn,upgradeNeeded:async(e,t)=>{try{const o=await r(e);return dn(t,o.maxUnsupportedContainerScriptVersion,o.unsupportedContainerScriptVersions)}catch(o){return!1}}},o,n),un={Automation:"https://whiteboard.office.com",Development:"https://dev.whiteboard.microsoft.com",Dogfood:"https://whiteboard.office.com",DoD:"https://whiteboard.apps.mil",GCC:"https://whiteboard.office.com","GCC-High":"https://whiteboard.office365.us",Local:"https://whiteboard.office.com",Microsoft:"https://whiteboard.office.com",Preview:"https://whiteboard.office.com",Production:"https://whiteboard.office.com",Staging:"https://app.int.whiteboard.microsoft.com",SyntheticTraffic:"https://whiteboard.office.com",USNat:"https://whiteboard.eaglex.ic.gov",USSec:"https://whiteboard.microsoft.scloud",Gallatin:"",Bleu:"",Delos:""};const hn=(e,t,r,o)=>ln(e,Mo,e=>async function(e,t,r){return an(r?"".concat((0,jo.V)(e),"/container/versionless/_1cdn_bucketedcontent/officeContainerCodeLoadDetails.json"):"".concat((0,jo.o)(e),"/container/versionless/officeContainerCodeLoadDetails.json"),t)}(e,t,o),t,r);const gn=(e,t,r)=>ln(e,Ho,e=>async function(e,t){return an("".concat((0,jo.o)(e),"/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json"),t)}(e,t),t,r),pn=(e,t,r)=>ln(e,Uo,e=>async function(e,t){return an("".concat((0,jo.o)(e),"/copilot-board-container/versionless/copilotBoardContainerCodeLoadDetails.json"),t)}(e,t),t,r),fn=e=>{const t=(0,Lo.mo)(null!==e&&void 0!==e?e:"Prod");return r=t.audience,un[r];var r},mn=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid),vn=e=>{var t,r;return mn(e)&&"string"===typeof(null===e||void 0===e||null===(t=e.fluid)||void 0===t||null===(t=t.browser)||void 0===t||null===(t=t.umd)||void 0===t?void 0:t.library)&&Array.isArray(null===e||void 0===e||null===(r=e.fluid)||void 0===r||null===(r=r.browser)||void 0===r||null===(r=r.umd)||void 0===r?void 0:r.files)};var yn=r(32896);const bn=e=>{switch(e){case Ro:case Mo:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case _o:case Ho:case Uo:return e;default:return"(redacted)"}},Sn="NPM",Cn="CDN";function kn(e,t){return new Promise((r,o)=>{const n=e.document,i=n.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=t,i.onload=()=>{r()},i.onerror=()=>o(new Error("Failed to download the style sheet at url: ".concat(t,", isUserDefinitelyOffline: ").concat(!e.navigator.onLine))),n.head.appendChild(i),i})}let wn=new WeakMap;const Pn=e=>"string"===typeof e.package?e.package:e.package.name,Tn="0.0.1",En=e=>!Number.isNaN(e)&&Number.isFinite(e),In=e=>{return"string"!==typeof e.package&&(t=e.package,vn(t)&&(t.version===Tn||En(Number(t.version))))?{name:e.package.name,version:e.package.version===Tn?Tn:Number(e.package.version)}:void 0;var t};class Nn{get IRuntimeFactory(){return this}constructor(e,t){this.wrappedFactory=e,this.config=t}instantiateRuntime(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}}class An{get IFluidCodeDetailsComparer(){return this}tryFormActualCodeDetailsMapKey(e){const t=In(e);if(void 0!==t)return"".concat(t.version,"|").concat(t.name)}getActualCodeDetails(e){const t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}constructor(e){this.config=e,this.actualCodeDetailsMap=new Map,this.logger=e.logger}async load(e){const t=Pn(e),r=e.config,o=v.m.start("SimpleCodeLoaderLoad",this.logger,{addUserTiming:!0});try{var n;const{windowContext:i,getBundledPackageFactoryOverride:s,disableCdnCodeLoadingFallback:a}=this.config;let c=a?void 0:wn.get(i);const d=null===(n=c)||void 0===n?void 0:n.get(t);if(void 0!==d){const t=await d,n=t.fluidExport.ConfigurableRuntimeFactory,i=void 0!==n?{module:{fluidExport:new Nn(n,r)},details:e}:{module:t,details:e};return o.setResult(!0,{source:"InMemoryCache"}),i}let l=null===s||void 0===s?void 0:s(t);const u=l?"Bundled":"CDN";if(l)l.then(e=>{var r;const o=null===(r=e.fluidExport.CodeVersionDetailsProvider)||void 0===r||null===(r=r.codeVersionDetails)||void 0===r?void 0:r.version;Fn(this.logger,{packageName:t,deliveryType:Sn,codeVersion:o})}).catch(()=>{this.logger&&(0,y.hO)(this.logger,{eventName:"NpmCodeLoaderOverrideFailed",packageName:bn(t)})});else{if(a)throw new Error("CDN code loading fallback set to false but no factory provided by host for container named ".concat(bn(t)));this.logger&&(0,y.Ot)(this.logger,{eventName:"CodeLoaderFallbackToCDN",containerType:bn(t)}),l=this.loadInternal(e,this.logger)}a||(c||(c=new Map,wn.set(i,c),i!==window&&i.addEventListener("pagehide",e=>{e.persisted||wn.delete(i)})),c.set(t,l),l.catch(()=>{var e;return null===(e=c)||void 0===e?void 0:e.delete(t)}));const h=await l,g=h.fluidExport.ConfigurableRuntimeFactory,p=void 0!==g?{module:{fluidExport:new Nn(g,r)},details:e}:{module:h,details:e};return o.setResult(!0,{source:u}),p}catch(i){throw o.setResult(!1,void 0,i),i}}async loadInternal(e,t){const{windowContext:r,trustedTypesPolicy:o,getFluidCodeVersionDetails:i}=this.config;let s;s="allowedCodeOrigins"in this.config?this.config.allowedCodeOrigins:this.config.allowedCodeSources.flatMap(e=>e.origin);const a=await this.getEffectiveFluidCodeDetailsPackage(e);if(Fn(t,{packageName:Pn(e),deliveryType:Cn,codeVersion:a.version}),void 0===a)throw new Error("Failed to get Fluid Package. Trying to load ContainerType: ".concat(bn(e.package.name)));const c=a.fluid.browser.umd;if(!this.shouldLoad(c.files))throw new Error("Unsupported container files, check that CDN is on allow list");const d=this.tryFormActualCodeDetailsMapKey(e);if(void 0!==d&&"string"!==typeof e.package){const t=(0,n.A)((0,n.A)({},e),{},{package:(0,n.A)((0,n.A)({},e.package),a)});this.actualCodeDetailsMap.set(d,t)}const l=o&&{trustedTypesPolicy:await o,allowedOrigins:s};await Promise.all(c.files.map(e=>{const t=e.toLowerCase();if(t.endsWith(".js"))return(0,yn.a)(r,e,l,"high");if(t.endsWith(".css"))return((e,t)=>{let r=3;return function o(){return kn(e,t).catch(()=>(r-=1,0===r?kn(e,t):o()))}()})(r,e);throw new Error("Codeloader does not know how to load: ".concat(e))}));const u=r[c.library];if(void 0===u)throw new Error("Entry point of loaded package not a Fluid module. Trying to load ContainerType: ".concat(bn(e.package.name)));const{CodeVersionDetailsProvider:h}=u.fluidExport;if(h){const e=null===i||void 0===i?void 0:i(a);e&&h.setCodeVersionDetails(e)}return u}async preCache(e){const{getFluidCodeDetailsPackageOverride:t,windowContext:r}=this.config;if(t){const o=await t(e);if(o){const e=o.fluid.browser.umd;if(!this.shouldLoad(e.files))throw new Error("Unsupported container files, check that CDN is on allow list");nn(r,e.files,this.logger)}}}async getEffectiveFluidCodeDetailsPackage(e){var t,r;const o="string"===typeof e.package?e.package:e.package.name,n=await(null===(t=(r=this.config).getFluidCodeDetailsPackageOverride)||void 0===t?void 0:t.call(r,o))||e.package;if("string"===typeof n)throw new Error("Codeloader does not know how to load from this source");return function(e){if(!vn(e)||void 0===e.version)throw new Error("Codeloader does not know how to load from this source")}(n),n}shouldLoad(e){return"allowedCodeOrigins"in this.config?Zo(e,this.config.allowedCodeOrigins):Yo(e,this.config.allowedCodeSources)}async satisfies(e,t){const r=this.getActualCodeDetails(e);if(void 0===r)return!0;if("string"===typeof t.package||"string"===typeof r.package)return!0;const o=(e=>{const t=Number(e.maxUnsupportedVersion);return En(t)?t:void 0})(t.package);if(void 0!==o){var n;const e=null===(n=In(r))||void 0===n?void 0:n.version;if(void 0!==e)return e===Tn||e>o}return!0}async compare(e,t){const r=In(e);if(void 0===r)return;const o=In(t);return void 0!==o&&r.name===o.name?r.version===o.version?0:r.version===Tn?-1:o.version===Tn?1:r.version-o.version:void 0}}function Fn(e,t){let{packageName:r,deliveryType:o,codeVersion:n}=t;if(!e)return;const i={eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:bn(r),deliveryType:o};n&&(i.codeVersion=n),(0,y.Ot)(e,i)}function Dn(e){var t;const r=null===(t=(0,Oo.Ar)())||void 0===t?void 0:t.AllowListOverride;return r?(e&&(0,y.Ot)(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(r)):[]}class Bn{get IFluidCodeDetailsComparer(){return this.simpleCodeLoader}getActualCodeDetails(e){return this.simpleCodeLoader.getActualCodeDetails(e)}constructor(e){var t,r;this.config=e;const o=null!==(t=e.additionalAllowedCodeOrigins)&&void 0!==t?t:[],{windowContext:i,logger:s,localeHint:a,sdpEnabled:c}=this.config,l=null!==s&&void 0!==s&&s.NamespaceLogger?new d.p("OfficeWebHost",s.NamespaceLogger):s;this.settingsProvider=e.settingsProvider;const u=hn(i,l,a,c),h=gn(i,l,a),g=pn(i,l,a),p={getCodeDetailsPackage:e=>{const t=fn(e),r={name:_o,version:"0.0.1",fluid:{browser:{umd:{files:["".concat(t,"/root/index.fluid.js")],library:"microsoftWhiteboard"}}}};return Promise.resolve(r)}};this.containerCodeDetailsProviderMap=new Map([[Mo,u],[Ro,u],[Ho,h],[Uo,g],[_o,p]]),null===(r=e.additionalCodeDetailsProviders)||void 0===r||r.forEach(e=>{let[t,r]=e;return this.containerCodeDetailsProviderMap.set(t,r)});const f=[...Dn(l),...o],m=[...(0,xo.M)(this.config.containerEnvironment,this.settingsProvider),{origin:f,paths:void 0}],v={windowContext:e.windowContext,trustedTypesPolicy:e.trustedTypesPolicy,logger:l,getBundledPackageFactoryOverride:t=>{var r;const o=null===(r=e.locallyBundledPackageFactories)||void 0===r?void 0:r.get(t);return o?Promise.resolve(o):void 0},disableCdnCodeLoadingFallback:e.disableCdnCodeLoadingFallback,getFluidCodeDetailsPackageOverride:async t=>{const r=this.containerCodeDetailsProviderMap.get(t);if(r)return r.getCodeDetailsPackage(e.containerEnvironment,m)},getFluidCodeVersionDetails:t=>{var r;const{containerEnvironment:o}=e,n=t.version,i=null===(r=this.containerCodeDetailsProviderMap.get(t.name))||void 0===r?void 0:r.upgradeNeeded;return{version:n,containerEnvironment:o||"Local",needUpgrade:i?()=>i(o,n):async()=>!1}}};this.simpleCodeLoader=new An((0,n.A)((0,n.A)({},v),{},{allowedCodeSources:m}))}async preCache(e){var t;if(null!==(t=this.config.locallyBundledPackageFactories)&&void 0!==t&&t.has(e))return;const r=this.containerCodeDetailsProviderMap.get(e);return null!==r&&void 0!==r&&r.preCacheLatestContainerCode?r.preCacheLatestContainerCode(this.config.containerEnvironment):this.simpleCodeLoader.preCache(e)}async load(e){return this.simpleCodeLoader.load(e)}}class Ln{constructor(e){this.bohemiaConfig=e,this.instantiateFluidCodeLoader=async e=>{const t=e.dependencySynthesizer.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider"},void 0),[r,o,i]=await Promise.all([t.LoopTrustedTypesPolicy,t.SettingsProvider,t.NamespaceLogger]);return new Bn((0,n.A)((0,n.A)({},this.bohemiaConfig),{},{windowContext:e.windowContext,trustedTypesPolicy:r,settingsProvider:o,logger:i}))}}get FluidCodeLoaderFactory(){return this}get Disposable(){return this}dispose(){}}var On=r(48680);class xn{getRawConfig(e){const t=(0,On.AU)(e,null,this.settingsProvider);return null===t?void 0:t}constructor(e){this.settingsProvider=e}}var Mn=r(72376);async function Rn(e,t){let r;const o=v.m.start(h.A8,t),n=new URL(e);try{const e=await(0,zo.R)("".concat(n),{method:"GET"},"ContainerManifestFetch",t,!1,Mn._9,3e3);if(!e.result.ok)throw new Error("Component manifest fetch returned an error response. status: ".concat(e.result.status,": ").concat(e.result.statusText,"."));r=await e.result.json()}catch(i){return void o.setResult(!1,{errorType:h.ps},i,{sampleEvent:!0})}return o.setResult(!0,void 0,void 0,{sampleEvent:!0}),r}const _n="manifest",Hn="json";function Un(e,t,r){const o=(0,Lo.Rs)(e);if(r){const e="string"===typeof r?r:function(e,t){const r="http://localhost:8081",o="Staging"===e?"stg":"Dogfood"===e?"df":"prod";return"".concat(r,"/").concat(o,"/").concat(_n,".").concat(t,".").concat(Hn)}(o,t);return e}const n=(0,jo.o)(o);return i=t,"".concat(n,"/generic-loader/versionless/").concat(_n,".").concat(i,".").concat(Hn);var i}async function jn(e,t){const r=t?{logger:t,eventName:"GetLoopComponentsManifestFromNetwork",doNotLogOnSuccess:!1}:void 0;return(await Wo(e,r)).result}const qn="LoadManifestFromCache",Vn="LoadManifestFromNetwork",zn="DownloadGLManifestError",Gn="glManifest";function Wn(e,t,r,o,n){return async function(e,t,r){var o;let n,i;r.markSubActivityStart(qn);try{n=await caches.open(Gn),i=await n.match(e)}catch(a){r.markSubActivityEnd(qn),r.addAdditionalProps({cacheError:Jn(a)})}if(null!==(o=i)&&void 0!==o&&o.ok){const o=await i.text();return r.markSubActivityEnd(qn),jn(e,t).then(t=>{var r;return t.ok?null===(r=n)||void 0===r?void 0:r.put(e,t):void 0}).catch(e=>{(0,y.hO)(t,{eventName:zn,isBackground:!0},e)}),[o,!0]}if(r.markSubActivityEnd(qn),r.markSubActivityStart(Vn),i=await jn(e,t),r.markSubActivityEnd(Vn),i.ok){var s;null===(s=n)||void 0===s||s.put(e,i.clone()).catch(()=>{});return[await i.text(),!1]}throw new Error("Failed to fetch manifest. Status code ".concat(i.status))}(Un(e,t,n),r,o)}function Jn(e){return"string"===typeof e?e:e instanceof Error?e.message:e&&"object"===typeof e?e.toString():void 0}async function Kn(e,t,r){const o=r&&new d.p(h.Ak,r),n=v.m.start("GetContainerManifestEntries",o),i=(0,we.Zd)(e)?(0,we.rv)(e):we.q;try{const[e,r]=await Wn(null!==t&&void 0!==t?t:{audience:"Production"},i,null!==o&&void 0!==o?o:new Qn,n),s=function(e){return JSON.parse(e,(e,t)=>{if("urlRegexes"===e||"pathAndQueryParamRegexes"===e){if(Array.isArray(t))return t.map(e=>new RegExp(e));throw new Error('Invalid value for urlRegexes: "'.concat(t,'"'))}return t})}(e),a=function(e,t){const r="@ms/office-fluid-container",o=e.components.find(e=>e.registrationId===r);if(!o)return t&&(0,y.hO)(t,{eventName:"LpcRegistrationNotFound"}),[];const{createEntries:n,fluidCodeDetails:i}=o;if(!n)return t&&(0,y.hO)(t,{eventName:"LpcCreateEntriesNotFound"}),[];if(!i)return t&&(0,y.hO)(t,{eventName:"LpcFluidCodeDetailsNotFound"}),[];return n.map(e=>{const{displayName:t,description:r,keywords:o,icons:n,id:s,creationData:a}=e;return{codeDetails:{package:i,config:a},queryableData:{id:s,displayName:t,description:r,keywords:null!==o&&void 0!==o?o:[],icon:n.default}}})}(s,o);return n.setResult(!0,{fromCache:r}),a}catch(s){throw n.setResult(!1,void 0,s),s}}class Qn{get NamespaceLogger(){return this}send(){}sendWithNamespace(){}dispose(){}}const $n="{locale}",Zn=[{genericUrl:"/officeContainerManifest.json",localizableUrl:"/officeContainerManifest.".concat($n,".json")}];async function Yn(e,t,r,o,n){const i=r&&new d.p(h.Ak,r);if(o)return Kn(e,t,i);const s=await async function(e,t,r,o){const n=(0,we.Zd)(e)?(0,we.rv)(e):void 0,i=(0,Lo.Rs)(t);return Promise.all(Zn.map(async e=>{const t="SDP"===o?(0,jo.V)(i)+"container/versionless/_1cdn_bucketedcontent/":(0,jo.o)(i)+"/container/versionless",s=t+e.genericUrl,a=t+e.localizableUrl;if(void 0!==n&&a){const e=await Rn(a.replace($n,n),r);if(void 0!==e)return e}return Rn(s,r)}))}(e,t,i,n);return function(e){const t=[];return e.forEach(e=>{if(void 0!==e){const r=e.fluidCodeDetailsPackage;e.configurations.forEach(e=>t.push({codeDetails:{package:r,config:e.config},queryableData:e.queryableData,heroConfiguration:e.heroConfiguration}))}}),t}(s)}const Xn=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);function ei(e){if("string"!==typeof e.package&&Xn(e.package))return e.package.name}var ti=r(78945),ri=r(78702);const oi="function"===typeof FinalizationRegistry;class ni{constructor(e,t,r,o){this.loggingDelay=e,this.subcategory=r,this.trackedObjectsGcTime=new Map,this.trackedObjects=new Set,oi?(this.logger=new d.p("MemoryLeakTracker",t,o),this.finalizationRegistry=new FinalizationRegistry(e=>{this.trackedObjectsGcTime.set(e,globalThis.performance.now()),this.trackedObjectsGcTime.size===this.trackedObjects.size&&this.closeAndSendTelemetry()})):this.isDisposed=!0}get Disposable(){return this}dispose(){var e;this.isDisposed=!0,this.loggingTimeout&&clearTimeout(this.loggingTimeout),null===(e=this.logger)||void 0===e||e.Disposable.dispose(),this.logger=void 0}trackObject(e,t){var r;this.isDisposed||(this.trackedObjects.add(e),null===(r=this.finalizationRegistry)||void 0===r||r.register(t,e))}markParentAsClosed(){this.isDisposed||(this.parentClosedTime=globalThis.performance.now(),this.loggingTimeout=setTimeout(()=>this.closeAndSendTelemetry(),this.loggingDelay))}closeAndSendTelemetry(){var e;const t={};for(const o of this.trackedObjects){const e=this.trackedObjectsGcTime.get(o);t[o]="number"===typeof e&&(!this.parentClosedTime||e-this.parentClosedTime)}const r=this.trackedObjects.size>0?this.trackedObjectsGcTime.size>0&&(!this.parentClosedTime||Math.max(...this.trackedObjectsGcTime.values())-this.parentClosedTime):void 0;null===(e=this.logger)||void 0===e||e.send({category:ri.hB.Generic,subCategory:this.subcategory,eventName:"MemoryCleanup",gcTimes:JSON.stringify(t),finalObjectGcTime:r,loggingDelay:this.loggingDelay}),this.Disposable.dispose()}}var ii=r(14818);function si(e){return e?Object.keys(e).sort().join(","):""}class ai{constructor(){this.providers=new Map,this.memo=new Map,this.resolveLocalProvider=e=>{const t=this.providers.get(e);if(t)return"function"===typeof t?{get:()=>{if("function"===typeof t)return Promise.resolve(this.IFluidDependencySynthesizer).then(async e=>t(e)).then(t=>null===t||void 0===t?void 0:t[e])}}:{get:()=>new ti.I(async()=>Promise.resolve(t).then(t=>{if(t)return t[e]}))}};for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.parents=t.filter(e=>void 0!==e)}get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.clearMemo(),this.providers.set(e,t)}unregister(e){this.providers.has(e)&&(this.providers.delete(e),this.clearMemo())}clearMemo(){this.memo.clear()}synthesize(e,t){const r="required:".concat(si(t),",optional:").concat(si(e));if(this.memo.has(r))return this.memo.get(r);const o={};return this.generateRequired(o,t),this.generateOptional(o,e),Object.defineProperty(o,ii.x,{get:()=>this}),this.memo.set(r,o),o}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some(t=>t.has(e))}generateRequired(e,t){if(void 0===t)return;const r=this.generate(e,t);if(0!==r.size){const e=Array.from(r).join(", ");throw new Error("Object attempted to be created without registered required providers ".concat(e))}}generateOptional(e,t){if(void 0===t)return;const r=this.generate(e,t);for(const o of r){const t={get:async()=>{}};Object.defineProperty(e,o,t)}}generate(e,t){const r=new Set(Object.keys(t));for(const o of r){const t=this.resolveLocalProvider(o);t&&(r.delete(o),Object.defineProperty(e,o,t))}for(const o of this.parents){const t={};for(const e of r)t[e]=e;const n=o.synthesize(t,void 0);for(const o of r){const t=Object.getOwnPropertyDescriptor(n,o);t&&(r.delete(o),Object.defineProperty(e,o,t))}}return r}}class ci{constructor(e,t){var r;this.synthDependencies=new Map,this.dependencySynthesizer=new ai(e);const o=null===e||void 0===e?void 0:e.synthesize({NamespaceLogger:"NamespaceLogger"},void 0);null===o||void 0===o||null===(r=o.NamespaceLogger)||void 0===r||r.then(e=>{var r;e&&(this.memoryLeakTracker=new ni(null!==(r=null===t||void 0===t?void 0:t.memoryLeakDetectionWaitTime)&&void 0!==r?r:3e5,e,"LoopDependencyContainer"))}).catch(()=>{})}get IFluidDependencySynthesizer(){return this}register(e,t){let r;this.dependencySynthesizer.has("DataConnector")&&(r=this.dependencySynthesizer.synthesize({DataConnector:"DataConnector"},void 0)),this.dependencySynthesizer.register(e,new ti.I(async()=>{var o;const n=await Promise.resolve(t);if("DataConnector"!==e){var i;const e=await(null===(i=r)||void 0===i?void 0:i.DataConnector);null===e||void 0===e||e.addComponentTracking(n)}return this.synthDependencies.set(e,n),null===(o=this.memoryLeakTracker)||void 0===o||o.trackObject(e,n),n}))}registerIfNotAlreadyExists(e,t){this.dependencySynthesizer.has(e)||this.register(e,t)}synthesize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.dependencySynthesizer.synthesize(e,t)}has(e){return this.dependencySynthesizer.has(e)}unregister(e){return this.dependencySynthesizer.unregister(e)}dispose(){var e;for(const[t,r]of this.synthDependencies)r.Disposable.dispose(),this.unregister(t);this.synthDependencies.clear(),null===(e=this.memoryLeakTracker)||void 0===e||e.markParentAsClosed()}}function di(e,t){var r;if(!t)return;const o=e?bn(e):"Unknown",n={};n.containerCodeDetailsName=o,null===(r=t.PersistedProperties)||void 0===r||r.addPersistedProperties(n)}const li="FluidCodeLoaderFactory";function ui(e,t){(async()=>{const r=function(e){var t;if(void 0!==e.getSpecifiedCodeDetails)return e.getSpecifiedCodeDetails();const r=e.getQuorum();return null!==(t=r.getMember("code"))&&void 0!==t?t:r.getMember("code2")}(e);if(r){var o;const n=null===(o=t.getActualCodeDetails)||void 0===o?void 0:o.call(t,r);if(n&&t.IFluidCodeDetailsComparer){const o=await t.IFluidCodeDetailsComparer.compare(r,n);void 0!==o&&o<0&&await e.proposeCodeDetails(n)}}})().catch(()=>{})}function hi(){const e=function(){var e;return null===(e=(0,Oo.Ar)())||void 0===e?void 0:e.FluidCodeDetailsOverride}();if(void 0!==e)return JSON.parse(e)}async function gi(e,t,r,o,n,i,s,a){const c=new ci(n);s&&!c.has("NamespaceLogger")&&c.register("NamespaceLogger",new d.p(h.BN,s));const l={SettingsProvider:"SettingsProvider",FluidCodeLoaderFactory:li},u=c.synthesize(l,void 0);let[g,p]=await Promise.all([u.SettingsProvider,u.FluidCodeLoaderFactory]);if(!p){const e=await async function(e){let{hostConfig:t,dependencySynthesizer:r}=e;const o=r.synthesize({SettingsProvider:"SettingsProvider",InternationalizationContext:"InternationalizationContext"},void 0),[n,i]=await Promise.all([o.SettingsProvider,o.InternationalizationContext]),s=(0,Lo.H9)(t.environment,null===n||void 0===n?void 0:n.audience),a=(null===i||void 0===i?void 0:i.uiLocale)||we.q;return new Ln({containerEnvironment:s,localeHint:a})}({hostConfig:r,dependencySynthesizer:c});c.registerIfNotAlreadyExists(li,e),p=e}const f=await p.instantiateFluidCodeLoader({windowContext:e,dependencySynthesizer:c});let m,b;if("Existing"===t.type&&(m=t.containerCodeHint),m){if(s&&(0,y.Ot)(s,{eventName:h.Ug}),void 0===r.loadCodeFromHint||r.loadCodeFromHint){const e=v.m.start(h.Qn,s,{addUserTiming:!0});f.load({package:m}).then(()=>{e.setResult(!0)}).catch(t=>{e.setResult(!1,void 0,t)})}(function(e){return"preCache"in e&&!!e.preCache})(f)&&(null===a||void 0===a||a.addAdditionalProps({precachedContainerPackageName:bn(m)}),f.preCache(m).catch(e=>{s&&(0,y.hO)(s,{eventName:h.TK},e)}))}g&&(b=new xn(g));const S={urlResolver:await o.urlResolver,documentServiceFactory:await o.documentServiceFactory,options:r.loaderOptions,scope:{IFluidDependencySynthesizer:c},codeLoader:f,logger:i,configProvider:b};return new so(S)}async function pi(e,t,r,o,i){const s={[Bo.d.loadMode]:{opsBeforeReturn:"cached",deltaConnection:r.startContainerInPausedState?"none":"delayed"}};let a,c;const d=e.services.codeLoader;switch(t.type){case"Existing":{const o=t.containerRequest,i={url:o.url,headers:(0,n.A)((0,n.A)({},s),o.headers)};c=t.containerCodeHint,a=e.resolve(i,r.pendingLocalState);break}case"DetachedFromCode":{const r=hi()||t.codeDetails;c=ei(r),a=e.createDetachedContainer(r);break}case"DetachedFromSnapshot":a=e.rehydrateDetachedContainerFromSnapshot(t.snapshot);break;default:throw new Error("loadContainerProps type is invalid")}return di(c,i),a.then(async e=>{!0===r.closeBeforeDisposing&&e.once("closed",t=>e.dispose(t)),r.startContainerInPausedState||Ge(e);const n=e.getSpecifiedCodeDetails(),s=n&&ei(n);if("DetachedFromSnapshot"===t.type&&di(s,i),null===o||void 0===o||o.addAdditionalProps({containerPackageMatchedCodeHint:c===s}),e.deltaManager.active)ui(e,d);else{const t=()=>{e.deltaManager.active&&(ui(e,d),e.off("connected",t))};e.on("connected",t)}}).catch(()=>{}),a}const fi="ContainerLoadFailed",mi="ComponentLoadFailedOnContainerBoot";class vi extends Error{constructor(){super("The container could not be loaded because its hosting window has already been unloaded."),this.name=h._H,this.errorType=h._H}}function yi(e){switch(e){case"Automation":return 0;case"Local":return 1;case"Staging":return 2;case"Dogfood":return 3;case"Preview":return 4;case"Microsoft":case"SyntheticTraffic":return 5;case"Production":return 6;case"GCC":return 7;case"GCC-High":case"DoD":return 8;default:return}}const bi=e=>(0,On.AU)("owh.handleLocationRedirection",!0,e),Si=e=>{const t=function(e,t){const r=yi(e),o=yi(null!==t&&void 0!==t?t:"Production");return void 0!==r&&void 0!==o&&o<=r}("Automation",null===e||void 0===e?void 0:e.audience);return(0,On.AU)("useNestedDependencyContainer",t,e)};var Ci=r(83397);class ki{constructor(e,t){this.settingsProvider=t,this.defaultIntervalInMin=60,this.heartbeatSendTimerId=void 0,this.heartbeatIntervalMs=60*this.defaultIntervalInMin*1e3,this.onUserActivityStateChanged=e=>{e?this.resume():this.stop()},this.stop=()=>{this.clearHeartbeatSendTimer()},this.resume=()=>{this.sendHeartbeatAndReQueue()},this.queueHeartbeat=()=>{this.heartbeatSendTimerId=window.setTimeout(()=>{this.sendHeartbeatAndReQueue()},this.heartbeatIntervalMs)},this.sendHeartbeatAndReQueue=()=>{this.heartbeatLogger&&(0,y.Ot)(this.heartbeatLogger,{eventName:"Heartbeat"}),this.queueHeartbeat()},this.clearHeartbeatSendTimer=()=>{window.clearTimeout(this.heartbeatSendTimerId),this.heartbeatSendTimerId=void 0},this.dispose=()=>{this.stop(),this.userActivityTracker.dispose(),this.heartbeatLogger=void 0},this.heartbeatLogger=new d.p("Heartbeat",e),this.heartbeatIntervalMs=60*(e=>(0,On.AU)("owh.HeartbeatIntervalInMin",60,e))(this.settingsProvider)*1e3,this.sendHeartbeatAndReQueue(),this.userActivityTracker=new Ci.N(this.heartbeatIntervalMs,this.onUserActivityStateChanged)}}function wi(e){let{windowContextForLoader:t,dependencySynthesizer:r,hostConfig:o,logger:n,perfMetadata:i,documentEverHiddenTrackerID:s,containerRequest:a,driver:c,preCheckInfo:d,requiredProviderTypes:l}=e;Ai(c,o,r);const u={type:"Existing",containerRequest:a,containerCodeHint:null===d||void 0===d?void 0:d.codeDetailsHint},{containerPromise:h,componentPromise:g}=c?Ii(t,u,c,a,r,o,n,i,s,l,void 0):Ei(t,u,a,r,o,n,i,s,l,void 0);return{container:h,component:g}}function Pi(e,t,r,o,n,i,s){Ai(r,o,t.dependencySynthesizer);const{componentPromise:a,containerPromise:c}=r?Ii(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},r,void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,t.loadTemplateProps):Ei(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,t.loadTemplateProps);return{component:a,container:c}}function Ti(e,t,r,o,n,i,s){Ai(r,o,t.dependencySynthesizer);const{componentPromise:a,containerPromise:c}=r?Ii(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},r,void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,void 0):Ei(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},void 0,t.dependencySynthesizer,o,n,i,s,t.requiredProviderTypes,void 0);return{component:a,container:c}}function Ei(e,t,r,o,i,s,a,c,d,u){const g=new ke.c,p=new ke.c;return async function(){const e=v.m.start(h.ih,s,{addUserTiming:!0}),t=(0,n.A)((0,n.A)({},a),{},{documentEverHidden:(0,l.xl)(c)>-1}),{driverImplementationOverride:r}=i;if(r)return e.setResult(!0,(0,n.A)((0,n.A)({},t),{},{driverType:"Override"})),r;const{DriverImplementation:d,FluidDocumentServiceFactoryProvider:u,FluidUrlResolverProvider:g}=o.synthesize({DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider",FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0),[p,f,m]=await Promise.all([d,null===g||void 0===g?void 0:g.then(e=>null===e||void 0===e?void 0:e.urlResolver),null===u||void 0===u?void 0:u.then(e=>null===e||void 0===e?void 0:e.documentServiceFactory)]);if(p)return e.setResult(!0,(0,n.A)((0,n.A)({},t),{},{driverType:"SynthesizedLegacy"})),p;if(f&&m)return e.setResult(!0,(0,n.A)((0,n.A)({},t),{},{driverType:"Synthesized"})),{documentServiceFactory:m,urlResolver:f};const y=new Error("Driver unavailable");throw e.setResult(!1,t,y),y}().then(async n=>{const l=Ii(e,t,n,r,o,i,s,a,c,d,u);g.resolve(l.containerPromise),p.resolve(l.componentPromise)}).catch(e=>{g.reject(e),p.reject(e)}),{containerPromise:g,componentPromise:p}}function Ii(e,t,r,o,i,s,a,c,d,u,g){const p=c.fluidBootstrapperStartTime,f="Existing"!==t.type&&{createNew:"DetachedFromCode"===t.type?"DetachedContainer":t.type};let m=o;const b=f&&{additionalPropsToLog:f}||void 0,S=i.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider"},void 0);Promise.resolve(S.InternationalizationContext).then(e=>{a&&(0,y.Ot)(a,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:(null===e||void 0===e?void 0:e.uiLocale)||we.q})}).catch(()=>{});const C=v.m.start(h.bU,a,(0,n.A)({addUserTiming:!0},b));a&&function(e){var t;const r=null===(t=navigator)||void 0===t?void 0:t.connection;(0,y.Ot)(e,{eventName:"Metadata",subCategory:"browserMetadata",doNotTrack:navigator.doNotTrack?navigator.doNotTrack:"false",documentHidden:document.hidden,networkType:null===r||void 0===r?void 0:r.effectiveType,networkRoundTripTime:null===r||void 0===r?void 0:r.rtt,cpuCoreCount:navigator.hardwareConcurrency,isMobile:(0,Pe.Fr)(),timeStamp:Date.now()})}(a);const k=a&&new ze(a,c,d),w=v.m.start(h.tR,a,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:t.type},isAPerformanceMetric:!0}),P=gi(e,t,s,r,i,k,a,w),T=Promise.all([P,S.SettingsProvider]).then(e=>{let[r,o]=e;return bi(o)&&"Existing"===t.type?Promise.all([be(async e=>(t.containerRequest=e,m=e,pi(r,t,s,w,a)),t.containerRequest,r.services.urlResolver,k),o]):Promise.all([pi(r,t,s,w,a),o])}).then(t=>{let[r,o]=t;if(e.closed)throw function(e,t){t&&e.close(),e.dispose()}(r,!0===s.closeBeforeDisposing),new vi;if(!r.closed&&!r.disposed)try{const e=a&&new ki(a,o);r.once("disposed",()=>{null===e||void 0===e||e.dispose()})}catch(n){a&&(0,y.hO)(a,{eventName:"FailedToStartHeartbeat"},Object.assign({errorType:"SettingsProviderFetchFailed"},n))}return r});T.then(e=>{a&&je(e,a);const t=(0,l.xl)(d),r=w.startTimeSinceEpoch;w.setResult(!0,(0,n.A)((0,n.A)({},c),{},{offsetFromFluidBootstrapperStartTime:(0,Ee.q)(r,p),documentEverHidden:t>-1}))}).catch(e=>{w.setResult(!1,{errorType:e.errorType},e),C.setResult(!1,{errorType:e.errorType||fi,isUserImpacting:!0},e),a&&Re(a,h.bU,Ne,Fe,e.errorType||De,{},e)});const E=T.then(e=>{if(!e)throw C.setResult(!1),a&&Re(a,h.bU,Ne,Fe,Le),new Error("Failed to Load Container");const t=P.then(t=>Do(e,t.services.urlResolver,m,a,c,d,s.startContainerInPausedState,i));let r=t;if(null!==g&&void 0!==g&&g.fromExistingTemplateUrl){const e=async function(e,t,r,o,n,i){const s=v.m.start(h.F7,o,{addUserTiming:!0});return t.then(async t=>{s.markSubActivityStart("TemplateLoadContainer");const a=await pi(t,{type:"Existing",containerRequest:{url:e.fromExistingTemplateUrl,headers:e.loadTemplateRequestHeaders}},r,void 0,o);return s.markSubActivityEnd("TemplateLoadContainer"),await vo(a),s.markSubActivityStart("TemplateLoadComponent"),Do(a,t.services.urlResolver,{url:e.fromExistingTemplateUrl},o,n,i,r.startContainerInPausedState).then(async e=>{if(s.markSubActivityEnd("TemplateLoadComponent"),null===e||void 0===e||!e.ComponentSerializable)throw new Se.Ej("Component doesn't implement ComponentSerializable",h.ul);try{const t=await e.ComponentSerializable.serialize();return s.setResult(!0),t}catch(t){throw new Se.Ej("Component serialization failed",h.ii,t)}}).finally(()=>{a.dispose()})}).catch(e=>{throw s.setResult(!1,void 0,e),e.name=e.name||h.uT,e})}(g,P,s,a,c,d);r=t.then(t=>{const r=t.ComponentSerializable;if(!r)throw new Se.Ej("Component doesn't implement ComponentSerializable",h.ul);let o;return e.then(async e=>{if(o=v.m.start(h.P,a,{addUserTiming:!0}),void 0===e)throw new Error(h.md);return await r.rehydrate(e),o.setResult(!0),t}).catch(e=>{var t;throw null===(t=o)||void 0===t||t.setResult(!1,void 0,e),e})})}return r=r.then(t=>{if(u){var r;const o=i.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Po(t,e,u,o.FluidDocumentServiceFactoryProvider,null===(r=m)||void 0===r?void 0:r.url)}return t}),r.then(()=>{C.setResult(!0)}).catch(t=>{let r;t&&"errorType"in t&&"message"in t&&(r=t),e.dispose(r),C.setResult(!1,{errorType:t.errorType||"Error"!==t.name?t.name:mi,isUserImpacting:!0,isExpected:Ce(t)},t),a&&Re(a,h.bU,Ne,Fe,t.errorType||t.name||De,{},t)}),r});return{containerPromise:T,componentPromise:E}}const Ni=new Error("Invalid configuration for driver. Please provide either a driver or \u0430 driverImplementationOverride.");function Ai(e,t,r){const o=e||t.driverImplementationOverride||function(e){return e.has("DriverImplementation")||["FluidUrlResolverProvider","FluidDocumentServiceFactoryProvider"].every(t=>e.has(t))}(r);if(!o)throw Ni}var Fi=r(11137),Di=r(25418),Bi=r(50349);async function Li(e,t){if("Data"!==e.type||"URL"!==e.dataType)return;const r=e.data.url,o=await t;if(!o||o instanceof Fi.Y||o instanceof Di.s)return function(e){const t=(0,Bi.Mh)(e);if(!t)return;let r;try{null!==t&&void 0!==t&&t.siteUrl&&(r=new URL(null===t||void 0===t?void 0:t.siteUrl).origin)}catch(o){}return{codeDetailsHint:null===t||void 0===t?void 0:t.containerPackageName,criticalBootDomains:r?[r]:void 0}}(r);try{const e=await o.resolve({url:r.href});if("fluid"===(null===e||void 0===e?void 0:e.type))return{}}catch(n){}}class Oi{async instantiateLoopComponent(e){const{loopCodeLoader:t,dependencySynthesizer:r}=this.props,{registrationId:o}=e;if(!o)throw new Error("registrationId is required.");const n=await t.load({packageName:o}),i=new ci(r);this.logger&&i.register("NamespaceLogger",this.logger);const s="Data"===e.type?{creationData:e,manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:"Creation"===e.type?{creationData:{},manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:e;return n.module.loopExport.instantiateLoopComponent(s,i)}constructor(e){this.props=e,e.logger&&(this.logger=new d.p("LoopLoader",e.logger))}}async function xi(e){const{loopComponentRouterInput:t,windowContextForLoader:r,dependencySynthesizer:o,config:i,logger:s,loopCodeLoaderFactory:a,requiredProviderTypes:c}=e,d=await async function(e,t,r,o,i){const{environment:s}=e,a=r.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),[c,d,l,u]=await Promise.all([a.InternationalizationContext,a.SettingsProvider,a.TokenProvider,a.LoopTrustedTypesPolicy]),h=null===c||void 0===c?void 0:c.uiLocale,g=(0,n.A)({audience:(null===s||void 0===s?void 0:s.audience)||"Production",localeHint:h||we.q,settingsProvider:d,windowContext:t,trustedTypesPolicy:u,tokenProvider:l,dependencySynthesizer:r},{logger:o}),p=await i.instantiateLoopCodeLoader(g);return new Oi({loopCodeLoader:p,dependencySynthesizer:r,logger:o})}(i,r,o,s,a),l=await d.instantiateLoopComponent(t);if(c){return Po(l,void 0,c,o.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0).FluidDocumentServiceFactoryProvider,void 0)}return l}async function Mi(e){const{windowContextForLoader:t,loopComponentRouterInput:r,dependencySynthesizer:o,config:n={},logger:i,perfMetadata:s,documentHiddenTrackerId:a,fluidRequestHeaders:c}=e,{registrationId:d,manifestData:l}=r;if(d&&!m(d)){const e={LoopCodeLoaderFactoryProvider:"LoopCodeLoaderFactoryProvider"},{LoopCodeLoaderFactoryProvider:s}=o.synthesize(e,void 0),a=await s,c=await(null===a||void 0===a?void 0:a.getLoopCodeLoaderFactory());if(!c)throw new Error("loopCodeLoaderFactory is required for non-fluid components.");return{component:xi({loopComponentRouterInput:r,windowContextForLoader:t,dependencySynthesizer:o,config:n,logger:i,loopCodeLoaderFactory:c}),container:Promise.resolve(void 0)}}if("Data"===r.type&&"URL"===r.dataType){let e;if(d&&m(d)&&(e=l&&"object"===typeof l?l:void 0),e||(e=await Li(r,async function(e){var t;const{dependencySynthesizer:r,config:o}=e;if(null!==o&&void 0!==o&&o.driverImplementationOverride)return o.driverImplementationOverride.urlResolver;const n={DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider"},{DriverImplementation:i,FluidUrlResolverProvider:s}=r.synthesize(n,void 0),[a,c]=await Promise.all([i,s]);return null!==(t=null===a||void 0===a?void 0:a.urlResolver)&&void 0!==t?t:null===c||void 0===c?void 0:c.urlResolver}({dependencySynthesizer:o,config:n}))),!e)throw new Error("Failed to create Fluid component from the provided url.");di(e.codeDetailsHint,i);return wi({windowContextForLoader:t,dependencySynthesizer:o,hostConfig:n,logger:i,perfMetadata:s,documentEverHiddenTrackerID:a,containerRequest:{url:r.data.url.href,headers:c},driver:void 0,preCheckInfo:e})}throw new Error("Failed to create component.")}function Ri(e){const{windowContextForLoader:t,loopComponentRouterInput:r,dependencySynthesizer:o,config:i,logger:s,perfMetadata:a,documentHiddenTrackerId:c,requiredProviderTypes:d}=e,u=(0,n.A)({},i),g=u.driverImplementationOverride,p=v.m.start(h.m1,s,{addUserTiming:!0});if("Fluid"===r.type){if(null!==s&&void 0!==s&&s.PersistedProperties){const e={isFluid:!0};s.PersistedProperties.addPersistedProperties(e)}const e=ei(r.codeDetails);di(e,s);try{if(r.pendingLocalState){const n=Ti(t,{dependencySynthesizer:o,snapshot:r.pendingLocalState,requiredProviderTypes:d},g,u,s,a,c);return p.setResult(!0,{packageName:e}),n}const n=Pi(t,{dependencySynthesizer:o,codeDetails:r.codeDetails,loadTemplateProps:r.templateProps,requiredProviderTypes:d},g,u,s,a,c);return p.setResult(!0,{packageName:e}),n}catch(b){throw p.setResult(!1,{packageName:e},b),b}}const f=Mi((0,n.A)((0,n.A)({},e),{},{loopComponentRouterInput:r}));if(null!==s&&void 0!==s&&s.PersistedProperties){const{registrationId:e}=r,t=!e||m(e),o=(0,l.xl)(c),n=t?{isFluid:!0,documentEverHidden:o}:{isFluid:!1,loopRegistrationId:e,documentEverHidden:o};s.PersistedProperties.addPersistedProperties(n)}return{component:f.then(async e=>{const[t,n]=await Promise.all([e.container,e.component]);await async function(e,t){e.ComponentInitializer&&(t.markSubActivityStart("ComponentInitialize"),await e.ComponentInitializer.initialize(),t.markSubActivityEnd("ComponentInitialize"))}(n,p);const i=Hi(n);null!==s&&void 0!==s&&s.PersistedProperties&&i&&s.PersistedProperties.addPersistedProperties({identityName:i}),p.setResult(!0),s&&function(e,t,r){const o=Hi(e);o&&!_i.has(o)&&((0,y.Ot)(r,{eventName:"LoadComponentMetadata",identityName:o,source:t}),_i.add(o))}(n,"owh-getLoopComponentInternal",s);const a=t&&"Data"===r.type&&"URL"===r.dataType?r.data.url.href:void 0;if(d){const e=o.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Po(n,t,d,e.FluidDocumentServiceFactoryProvider,a)}return n}).catch(e=>{throw p.setResult(!1,void 0,e),e}),container:f.then(e=>e.container).catch(e=>{throw p.setResult(!1,void 0,e),e})}}const _i=new Set;function Hi(e){var t;return null===(t=e.ComponentTelemetryMetadata)||void 0===t?void 0:t.entityName}var Ui=r(20258);const ji=new Map;function qi(e,t){t.then(async t=>{t?(t.attachState!==Te.Attached&&await new Promise(e=>{t.once("attached",e)}),e.resolve(t.resolvedUrl)):e.resolve(void 0)}).catch(()=>{e.resolve(void 0)})}function Vi(e,t){const r="LoopComponentLoader";if(e.has(r)&&window===t.windowContextForLoader)return e;const o=new ci(e);var n;return o.register(r,(n=t.windowContextForLoader,new Gi(n))),o}function zi(e,t,o){const n=new ci(e);return n.register("NestedLoopComponentHosting",async function(e,t,o){var n,i,s;const c="NestedLoopComponentHosting",d="NestedLoopComponentLoader",l=e.synthesize({SettingsProvider:"SettingsProvider",NestedLoopComponentHosting:c,NestedLoopComponentLoader:d},void 0),u=await l.NestedLoopComponentHosting,h=await l.NestedLoopComponentLoader,g=null!==(n=null===u||void 0===u||null===(i=u.getNestedDependencyContainer)||void 0===i?void 0:i.bind(u))&&void 0!==n?n:null===h||void 0===h||null===(s=h.getNestedDependencyContainer)||void 0===s?void 0:s.bind(h),p=Si(await l.SettingsProvider)?function(e,t,o){return n=>{var i,s;if(!n.has("FluidDocumentServiceFactoryProvider"))return o&&(0,y.Ot)(o,{eventName:"NoFluidDocumentServiceFactoryForNestedDependencyContainer"}),null!==(s=null===t||void 0===t?void 0:t(n))&&void 0!==s?s:n;const c={SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",UserContext:"UserContext"},d=n.synthesize(c,{FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"}),l=new ci(n),u=e.then(e=>{if(e&&(0,So.g2)(e))return function(e,t,o){return new Ui.I(async()=>{const[n,i,s,a]=await Promise.all([e.FluidDocumentServiceFactoryProvider,e.SettingsProvider,e.TokenProvider,e.UserContext]);return Promise.all([r.e(8088),r.e(97160)]).then(r.bind(r,67866)).then(e=>new e.OdspFluidDocumentServiceFactory({hostDocumentServiceFactory:n,settingsProvider:i,tokenProvider:s,userContext:a},t,ji,o))})}({FluidDocumentServiceFactoryProvider:d.FluidDocumentServiceFactoryProvider,SettingsProvider:d.SettingsProvider,TokenProvider:d.TokenProvider,UserContext:d.UserContext},e,o);{const t=e?"ResolvedUrlNotOdsp":"ResolvedUrlUndefined";return(0,y.A$)(ri.hB.Generic,o,{eventName:t}),d.FluidDocumentServiceFactoryProvider.then(e=>a({documentServiceFactory:e.documentServiceFactory,createDocumentRequest:e.getCreateDocumentRequest}))}});return l.register("FluidDocumentServiceFactoryProvider",u),null!==(i=null===t||void 0===t?void 0:t(l))&&void 0!==i?i:l}}(t,g,o):g;return new Wi(p)}(e,t,o)),n}class Gi{dispose(){}get LoopComponentLoader(){return this}get Disposable(){return this}async getLoopComponent(e){let{loopComponentRouterInput:t,dependencySynthesizer:r,fluidRequestHeaders:o,requiredProviderTypes:n}=e;const{logger:i,perfMetadata:s,documentHiddenTrackerId:a}=p({logger:await r.synthesize({NamespaceLogger:"NamespaceLogger"},void 0).NamespaceLogger}),c=new ke.c,d=Ri({windowContextForLoader:this.windowContextForLoader,loopComponentRouterInput:t,dependencySynthesizer:zi(r,c,i),logger:i,perfMetadata:s,documentHiddenTrackerId:a,fluidRequestHeaders:o,requiredProviderTypes:n});return qi(c,d.container),Promise.all([d.container,d.component]).then(e=>{let[t,r]=e;return r})}constructor(e){this.windowContextForLoader=e}}class Wi{get NestedLoopComponentHosting(){return this}getNestedDependencyContainer(e){return this.getNestedDependencyContainerImpl?this.getNestedDependencyContainerImpl(e):e}dispose(){}get Disposable(){return this}constructor(e){this.getNestedDependencyContainerImpl=e}}function Ji(e){let{loopComponentRouterInput:t,dependencySynthesizer:r,config:o,fluidRequestHeaders:n,requiredProviderTypes:i}=e;const{logger:s,newConfig:a,perfMetadata:c,documentHiddenTrackerId:d}=p(o||{}),l=window;let u=Vi(r,{windowContextForLoader:l});const h=new ke.c;u=zi(u,h,s);const g=Ri({windowContextForLoader:l,loopComponentRouterInput:t,dependencySynthesizer:u,config:a,logger:s,perfMetadata:c,documentHiddenTrackerId:d,fluidRequestHeaders:n,requiredProviderTypes:i});return qi(h,g.container),Promise.all([g.container,g.component]).then(e=>{let[t,r]=e;return r})}var Ki=r(58443),Qi=r(13296),$i=r(56142),Zi=r(16460),Yi=r(91947);class Xi{constructor(e,t){this.isProvidingDataToSave=void 0,this.hasDataToSave=void 0,this.component=void 0,this.isProvidingDataToSave=!1,this.hasDataToSave=e,this.component=t}async startProvidingDataToSave(){this.isProvidingDataToSave||((0,$i.Rm)("Will start providing data to save..."),(0,Zi.tM)(e=>{(0,$i.Rm)("RequestDataToSave event"),this.onDataToSaveRequest(e)}),(0,Zi.U4)(()=>{(0,$i.Rm)("FluidComponentSaved event"),this.onFluidComponentDataSaved()}),await(0,Yi.UT)(!0),this.isProvidingDataToSave=!0,this.hasDataToSave||this.detectWhenFluidComponentIsEdited())}async stopProvidingDataToSave(){this.isProvidingDataToSave&&((0,$i.Rm)("Will stop providing data to save..."),await(0,Yi.UT)(!1),(0,Zi.DS)(this.onDataToSaveRequest),(0,Zi.Yz)(this.onFluidComponentDataSaved),this.isProvidingDataToSave=!1)}async onDataToSaveRequest(e){var t;const r=e.detail.requestId;let n=!1,i="";const s=await(null===(t=this.component.LoopComponentUrl)||void 0===t?void 0:t.getLoopComponentUrl());let a=!1;var c,d;if(s&&(a=!0),a)n=null!==(c=null===(d=this.component.ComponentLifecycle)||void 0===d?void 0:d.isDirty)&&void 0!==c&&c;else try{this.component.LoopComponentUrl&&this.component.FluidMetadataProvider&&(i=this.component.FluidMetadataProvider.getSnapshot()),n=i.length>0}catch(l){(0,o.c2)("DataToSaveProvider.onDataToSaveRequest()",new o.uV("Unable to get data to save from the container.",l))}(0,Yi.a7)(r,a,n,i).then(()=>{(0,$i.Rm)("Provided data to save. (Request: ".concat(r,", isAttached: ").concat(a,", hasDataToSave: ").concat(n,")"))}).catch(e=>{(0,$i.vV)("Unable to provide data to save. (Request: ".concat(r,") ").concat(e))})}onFluidComponentDataSaved(){(0,$i.Rm)("Fluid component was saved."),this.hasDataToSave=!1,this.detectWhenFluidComponentIsEdited()}fluidComponentEdited(){this.hasDataToSave||((0,$i.Rm)("Fluid component was edited, so there is now data to save."),this.hasDataToSave=!0,(0,Yi.nA)())}detectWhenFluidComponentIsEdited(){const e=t=>{t.defaultPrevented||(0,Qi.wP)(t)&&(document.removeEventListener("keydown",e),document.removeEventListener("mousedown",e),this.fluidComponentEdited())};document.addEventListener("keydown",e),document.addEventListener("mousedown",e)}}var es=r(51492),ts=r(64643),rs=r(33829),os=r(90293),ns=r(98123),is=r(6971);class ss{constructor(e,t,r,o){this.component=e,this.loopInfo=t,this.isFluidLoop=r,this.officeFluidLogger=o,this.loopInfoChangedEventListeners=new Set,this.hasBeenUpdated=!1,this.currentLinkScope=void 0}determineLinkText(e,t,r){return e?r?r+Ki.Ct:t:r||t}off(e,t){this.loopInfoChangedEventListeners.delete(t)}on(e,t){this.loopInfoChangedEventListeners.add(t)}async onLinkUrlChanged(e,t){if((0,$i.Rm)("Received native event LinkUrlChanged"),e!==this.loopInfo.linkUrl){if("@fluidx/video-playback"===this.loopInfo.registrationId){const t=await(0,is.E)();e=(0,ns.addReferralParamsToStreamUrl)(e,t.hydrateScenarioEntryPoint)}(0,$i.Rm)("Link url: ".concat(e)),this.loopInfo.linkUrl=e,this.onLoopInfoChanged({linkUrl:e})}if(t&&t!==this.currentLinkScope){const e=void 0!==this.currentLinkScope;if(this.currentLinkScope=t,(0,$i.Rm)("link scope: ".concat(t,", isUpdate: ").concat(e)),this.officeFluidLogger){i._.startActivity(this.officeFluidLogger,s.G.CreateShareLink).setSuccess({linkScope:t,isUpdate:e})}}}onLoopInfoChanged(e){Object.keys(e).length&&(this.loopInfoChangedEventListeners.forEach(t=>{t(new CustomEvent("LoopInfoChanged",{detail:e}))}),(0,Yi.a5)(e))}onTitleChanged(e){const t={};(0,$i.Rm)("LoopComponentProperties.onTitleChanged() called."),e&&e!==this.loopInfo.loopTitle&&((0,$i.Rm)("Loop title: ".concat(e)),this.loopInfo.loopTitle=e,t.loopTitle=e);const r=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle);r&&r!==this.loopInfo.linkText&&((0,$i.Rm)("Link text: ".concat(r)),this.loopInfo.linkText=r,t.linkText=r),this.onLoopInfoChanged(t)}async updateFluidFilename(){if(!this.isFluidLoop||!this.loopInfo.linkUrl)return;const e=await(0,os.Wu)(this.loopInfo.linkUrl,this.loopInfo.linkText||null),t=(0,os.$r)(e||"");this.onTitleChanged(t)}async update(){const e=this.component.ComponentProperties,t=this.component.ComponentTitle,o=this.component.ComponentWithTitle,n=this.component.ContentURL,i={};if(n)try{const e=await n.getContentURL();e.href&&e.href!==this.loopInfo.linkUrl&&((0,$i.Rm)("Link url: ".concat(e.href)),this.loopInfo.linkUrl=e.href,i.linkUrl=e.href)}catch(d){(0,$i.vV)("Unable to get the content url for the Loop component.")}if(e){try{let t;if("@fluidx/video-playback"===this.loopInfo.registrationId){if(await(0,es.PA)(es.u.OEP,"ChangeGate.FluidHost.UseClipChampLogo")){t=(await r.e(82440).then(r.bind(r,82440))).ClipchampLogo}else{t=(await r.e(27443).then(r.bind(r,27443))).StreamLogo}}else{var s;t=e.iconUrl||await(null===(s=e.getIconUrl)||void 0===s?void 0:s.call(e))}t&&t!==this.loopInfo.loopIconUrl&&((0,$i.Rm)("Loop icon url: ".concat(t)),this.loopInfo.loopIconUrl=t,i.loopIconUrl=t)}catch(d){(0,$i.vV)("Unable to get the icon url of the Loop component.")}try{var a;const t=e.name||await(null===(a=e.getName)||void 0===a?void 0:a.call(e));t&&t!==this.loopInfo.loopName&&((0,$i.Rm)("Loop name: ".concat(t)),this.loopInfo.loopName=t,i.loopName=t)}catch(d){(0,$i.vV)("Unable to get the name of the Loop component.")}}if((t||o)&&(void 0===t&&((0,$i.Rm)("Component does not provide ComponentTitle."),o&&(0,$i.Rm)("Using ComponentWithTitle instead.")),!this.isFluidLoop))try{const e=(null===t||void 0===t?void 0:t.title)||await(null===o||void 0===o?void 0:o.getTitleText());e&&e!==this.loopInfo.loopTitle&&((0,$i.Rm)("Loop title: ".concat(e)),this.loopInfo.loopTitle=e,i.loopTitle=e)}catch(d){(0,$i.vV)("Unable to get the title of the Loop component.")}const c=this.determineLinkText(this.isFluidLoop,this.loopInfo.loopName,this.loopInfo.loopTitle);c&&c!==this.loopInfo.linkText&&((0,$i.Rm)("Link text: ".concat(c)),this.loopInfo.linkText=c,i.linkText=c),this.onLoopInfoChanged(i),this.hasBeenUpdated||((0,rs.As)(this.onLinkUrlChanged.bind(this)),null===t||void 0===t||t.on("titleChanged",e=>{(0,$i.Rm)("Received event ComponentTitle.titleChanged"),this.onTitleChanged(e)})),this.hasBeenUpdated=!0}}var as=r(4311),cs=r(24921),ds=r(53450),ls=r(51655);let us=function(e){return e[e.Success=0]="Success",e[e.Failure=1]="Failure",e}({});class hs extends ds.r{constructor(e){super("CreateDocument",e),this.AttachDocumentPerfTracker=void 0,this.CreateDocumentPerfTracker=void 0,this.setAttachDocumentPerfTracker()}setAttachDocumentPerfTracker(){const e=ls.q.startNew();this.AttachDocumentPerfTracker=e}setCreateDocumentPerfTracker(){const e=ls.q.startNew();this.CreateDocumentPerfTracker=e}sendTelemetryForSuccess(){this.endActivity(!0,us.Success)}sendTelemetryForFailure(e){this.endActivity(!1,e)}async addDataFieldsToActivity(e,t){var r,o,n,i;(null===(r=this.AttachDocumentPerfTracker)||void 0===r?void 0:r.startTime)&&this.addInt64DataField("AttachDocumentStartTime",this.AttachDocumentPerfTracker.startTime),(null===(o=this.AttachDocumentPerfTracker)||void 0===o?void 0:o.getDuration)&&this.addInt64DataField("AttachDocumentDuration",this.AttachDocumentPerfTracker.getDuration()),this.AttachDocumentPerfTracker&&this.addBooleanDataField("AttachDocumentSuccess",this.AttachDocumentPerfTracker.isSuccess),(null===(n=this.CreateDocumentPerfTracker)||void 0===n?void 0:n.startTime)&&this.addInt64DataField("CreateDocumentStartTime",this.CreateDocumentPerfTracker.startTime),(null===(i=this.CreateDocumentPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("CreateDocumentDuration",this.CreateDocumentPerfTracker.getDuration()),this.CreateDocumentPerfTracker&&this.addBooleanDataField("CreateDocumentSuccess",this.CreateDocumentPerfTracker.isSuccess),this.addStringDataField("ResultType",us[e]),t&&this.addStringDataField("ErrorMessage",t)}}var gs,ps=r(97232);!function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(gs||(gs={}));var fs,ms=r(20310),vs=r(37513),ys=r(95663);function bs(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?fs.Online:fs.Offline:fs.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(fs||(fs={}));class Ss extends ys.iq{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=vs.a.genericNetworkError}}class Cs extends ys.iq{constructor(e,t){super(e,t),this.errorType=vs.a.fluidInvalidSchema,this.canRetry=!1}}class ks extends ys.iq{constructor(e,t,r){super(e,(0,n.A)((0,n.A)({},t),{},{statusCode:400})),this.errorType=ks.errorType,this.canRetry=!1,this.storageOnlyReason=r}}ks.errorType=vs.a.deltaStreamConnectionForbidden;class ws extends ys.iq{constructor(e,t,r,o){void 0!==t&&(o.claims=t),void 0!==r&&(o.tenantId=r),super(e,o,new Set(["claims","tenantId"])),this.errorType=vs.a.authorizationError,this.canRetry=!1}}ys.iq;class Ps extends ys.iq{constructor(e,t,r,o){super(e,o),this.errorType=t,this.canRetry=r}}class Ts extends Ps{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}}class Es extends Ps{constructor(e,t,r){super(e,t,!0,r),this.errorType=t}}class Is extends ys.iq{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=vs.a.throttlingError,this.canRetry=!0}}var Ns=r(41395),As=r(50178);var Fs=r(2875);const Ds="Bearer";function Bs(e){const t={sprequestduration:(0,As.ZK)(e.get("sprequestduration")),contentsize:(0,As.ZK)(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach(r=>{const o=e.get(r.headerName);void 0!==o&&null!==o&&(t[r.logName]=o)});const r=e.get("x-fluid-telemetry");if(void 0!==r&&null!==r){t.xFluidTelemetry=r;const e=r.split(",").map(e=>e.split("="));for(const[r,o]of e)if("Origin"===r.trim()){let e;switch(null===o||void 0===o?void 0:o.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=null===o||void 0===o?void 0:o.trim()}t["responseOrigin"]=e;break}}return t}class Ls extends ys.iq{constructor(e,t,r){super(e,r,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=vs.a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function Os(e,t,r,o,i){var s;let a,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const d=function(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=null===e||void 0===e?void 0:e.error;return"string"===typeof(null===t||void 0===t?void 0:t.message)&&(void 0===(null===t||void 0===t?void 0:t.code)||"string"===typeof(null===t||void 0===t?void 0:t.code))}(t))return{success:!0,errorResponse:t}}}catch(t){}return{success:!1}}(i);let l,u,h;if(d.success){const e=d.errorResponse;c.responseMessage=e.error.message,l=function(e){const t=[];let r=e.error;for(;"object"===typeof r&&null!==r;)void 0!==r.code&&t.unshift(r.code),r=r.innerError;return t}(e),void 0!==l&&(u=l[0],c.innerMostErrorCode=u)}const g=(0,n.A)({driverVersion:"2.43.0",statusCode:t},c);switch(t){case 301:case 302:case 303:case 307:case 308:if(h=null!==(s=null===o||void 0===o?void 0:o.headers.get("Location"))&&void 0!==s?s:void 0,void 0!==h){a=new Ls(e,h,g);break}case 400:if("fluidInvalidSchema"===u){a=new Cs(e,g);break}a=new Ts(e,vs.a.genericNetworkError,g);break;case 401:case 403:if("serviceReadOnly"===u)a=new Es(e,Ns.E.serviceReadOnly,g);else if("blockedIPAddress"===u||"conditionalAccessPolicyEnforced"===u)a=new Ts("IP Address is blocked",Ns.E.blockedIPAddress,g);else{const t=null!==o&&void 0!==o&&o.headers?function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;return t.split(",").map(e=>{const t=e.split("=");t.length>=2&&(o||"error"!==t[0].trim().toLowerCase()?r||"claims"!==t[0].trim().toLowerCase()||(r=(0,Fs.AH)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):o="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))}),o?r:void 0}(o.headers):void 0,r=null!==o&&void 0!==o&&o.headers?function(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(Ds);if(r<0)return;let o;return t.substring(r+6).split(",").map(e=>{if(!o){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(o=JSON.parse(t[1].trim()))}}),o}(o.headers):void 0;a=new ws(e,t,r,g)}break;case 404:if(d.success){var p;const t=null===d||void 0===d||null===(p=d.errorResponse)||void 0===p?void 0:p.error;if(h=null===t||void 0===t?void 0:t["@error.redirectLocation"],void 0!==h){a=new Ls(e,h,g);break}}a=new Ts(e,vs.a.fileNotFoundOrAccessDeniedError,g);break;case 406:a=new Ts(e,vs.a.unsupportedClientProtocolVersion,g);break;case 410:a=new Ts(e,Ns.E.cannotCatchUp,g);break;case 409:a=new Ts(e,vs.a.fileOverwrittenInStorage,g);break;case 412:a=new Ts(e,vs.a.genericNetworkError,g);break;case 413:a=new Ts(e,Ns.E.snapshotTooBig,g);break;case 414:a=new Ts(e,Ns.E.invalidFileNameError,g);break;case 423:if("resourceLocked"===u||"resourceCheckedOut"===u){a=new Ts(e,vs.a.fileIsLocked,g);break}case 500:a=new Es(e,vs.a.genericNetworkError,g);break;case 501:a=new Ts(e,Ns.E.fluidNotEnabled,g);break;case 507:a=new Ts(e,vs.a.outOfStorageError,g);break;case 712:a=new Ts(e,vs.a.incorrectServerResponse,g);break;default:a=function(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new Is(e,t.retryAfterMs/1e3,r):new Ss(e,t.canRetry,r)}(e,{canRetry:!0,retryAfterMs:void 0!==r?1e3*r:void 0},g)}return a.addTelemetryProperties({endpointReached:!0}),function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.online=fs[bs()],void 0!==r&&(e.facetCodes=r);if(t&&(o.responseType=t.type,t.headers)){var n;const r=Bs(t.headers);for(const e of Object.keys(r))o[e]=r[e];e.serverEpoch=null!==(n=t.headers.get("x-fluid-epoch"))&&void 0!==n?n:void 0}e.addTelemetryProperties(o)}(a,o,l,void 0),a}function xs(e,t,r,o,n){const i=Os(e,t,function(e){if(null===e)return;const t=Number(e);if(Number.isNaN(t))return;return t}(r.headers.get("retry-after")),r,o,n);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}const Ms="2.43.0";async function Rs(e,t){const r=(0,ms.l)();return fetch(e,t).then(async e=>{const t=e;if(!t)throw new Ts("No response from ODSP fetch call",Ns.E.incorrectServerResponse,{driverVersion:Ms});(!t.ok||t.status<200||t.status>=300)&&xs("ODSP fetch error [".concat(t.status,"]"),t.status,t,await t.text());const o=function(e){const t=new Map;for(const[r,o]of e.entries())t.set(r,o);return t}(t.headers);return{content:t,headers:o,propsToLog:Bs(o),duration:(0,ms.l)()-r}},e=>{const t=bs(),r={value:"".concat(e),tag:As.mc.UserData},o=r.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new Es("Fetch Timeout (AbortError)",Ns.E.fetchTimeout,{driverVersion:Ms});if(o.includes("ETIMEDOUT"))throw new Es("Fetch Timeout (ETIMEDOUT)",Ns.E.fetchTimeout,{driverVersion:Ms});throw t===fs.Offline?new Es("ODSP fetch failure (Offline): ".concat(o),Ns.E.offlineError,{driverVersion:Ms,rawErrorMessage:r}):new Es("ODSP fetch failure: ".concat(o),Ns.E.fetchFailure,{driverVersion:Ms,rawErrorMessage:r})})}Rs.fetch=fetch;const _s=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);function Hs(e){let t;return t=e&&"name"in e?e.name:_s(null===e||void 0===e?void 0:e.package)?null===e||void 0===e?void 0:e.package.name:null===e||void 0===e?void 0:e.package,t}const Us={KeyboardShortcutEmitter:"KeyboardShortcutEmitter",ConsumeLayout:"ConsumeLayout",ContentPlayable:"ContentPlayable",Disposable:"Disposable",Focusable:"Focusable",FocusableV2:"FocusableV2",HTMLView:"HTMLView",ComponentProduceCommands:"ComponentProduceCommands",DeepLinking:"DeepLinking",ComponentClipboardProvider:"ComponentClipboardProvider",ComponentFocusable:"ComponentFocusable",ComponentHasTransaction:"ComponentHasTransaction",ComponentHighlight:"ComponentHighlight",ComponentProvidesPlaceholder:"ComponentProvidesPlaceholder",ComponentSelection:"ComponentSelection",IFluidHTMLView:"IFluidHTMLView",ComponentCanvasProvider:"ComponentCanvasProvider",HTMLViewable:"HTMLViewable",ComponentWithTitle:"ComponentWithTitle",ComponentTitle:"ComponentTitle",ComponentProperties:"ComponentProperties",MessageBannerProvider:"MessageBannerProvider",LoopState:"LoopState",IComponentLastEditedTracker:"IComponentLastEditedTracker",PresenceAwayStatusTrackerFetcher:"PresenceAwayStatusTrackerFetcher",IFluidLoadable:"IFluidLoadable",ComponentLifecycle:"ComponentLifecycle",Lifecycle:"Lifecycle",ConnectionManager:"ConnectionManager",CollaboratorInfo:"CollaboratorInfo",ContentURL:"ContentURL",LoopComponentUrl:"LoopComponentUrl",Presence:"Presence",ComponentInitializer:"ComponentInitializer",ComponentMeetingInformationProvider:"ComponentMeetingInformationProvider",FluidMetadataProvider:"FluidMetadataProvider",ComponentTelemetryMetadata:"ComponentTelemetryMetadata",SharePointDocumentInfo:"SharePointDocumentInfo",FoundInPlacesInfo:"FoundInPlacesInfo",InformationProtectionLabelService:"InformationProtectionLabelService"};async function js(e,t,r,n,a,c){(0,$i.Rm)("Attaching document..."),await async function(e,t,r,o){var n,a;const c=(0,es.n_)(es.u.OEP,"FluidHost.AttachDelay",0),d=r?i._.startActivity(r,s.G.AttachContainer):void 0,l=await c;l>0&&await(0,cs.y)(l);const u=o;null!==(n=u.LoopComponentUrl)&&void 0!==n&&n.initializeLoopComponentUrl&&await u.LoopComponentUrl.initializeLoopComponentUrl(e).catch(e=>{var r,o;throw null===(r=u.Disposable)||void 0===r||r.dispose(),null===(o=t.AttachDocumentPerfTracker)||void 0===o||o.setFailure(e),null===d||void 0===d||d.setFailure(e),new Error("Unable to attach document.")}),null===(a=t.AttachDocumentPerfTracker)||void 0===a||a.setSuccess(),null===d||void 0===d||d.setSuccess()}(t,n,r,e),(0,$i.Rm)("Document attached."),n.setCreateDocumentPerfTracker();try{const d=await async function(e,t,r){var n,a;const c=r?i._.startActivity(r,s.G.GetFileLink):void 0,d=await(null===(n=e.LoopComponentUrl)||void 0===n?void 0:n.getLoopComponentUrl().catch(r=>{var n,i;throw null===(n=e.Disposable)||void 0===n||n.dispose(),null===(i=t.CreateDocumentPerfTracker)||void 0===i||i.setFailure(r),null===c||void 0===c||c.setFailure(r),new Error("Unable to get the url of the new Fluid component. ".concat((0,o.u1)(r)))}));if(!d){var l,u;null===(l=e.Disposable)||void 0===l||l.dispose();const r=new Error("Unable to get the absolute url from the component.");throw null===c||void 0===c||c.setFailure(r),null===(u=t.CreateDocumentPerfTracker)||void 0===u||u.setFailure(r),r}return null===(a=t.CreateDocumentPerfTracker)||void 0===a||a.setSuccess(),null===c||void 0===c||c.setSuccess(),d}(e,n,r);let u="";try{u=await(0,as.RG)(d)}catch(l){(0,$i.vV)("Unable to get file name from Sharepoint.")}u||(u=t),(0,$i.Rm)('Document created.\nFile name: "'.concat(u,'"\nUrl: ').concat(d));const h=null===a||void 0===a?void 0:a.resolve({url:d.href,headers:c.headers}),g={linkText:u,linkUrl:d.toString()},p=new ss(e,g,!0,r);await p.update();return{loopComponentProperties:p,createDocumentActivity:n,resolvedUrlPromise:h}}catch(l){var d;throw null===n||void 0===n||null===(d=n.CreateDocumentPerfTracker)||void 0===d||d.setFailure(l),new Error("Unable to create document.")}}async function qs(e,t,r,c,d,l,u,h,g,f,m,v){var y,b;let S;const C=function(e){if(e===Ki.l1)return!1;return!0}(e),k=await(0,es.xB)(),w=await es.LM,P=!C||await(0,es.qF)();let T,E,I;const N=new hs(c||"");if(!k){const e=h?i._.startActivity(h,s.G.GetDriveInfo):void 0;E=await(0,as.fZ)().catch(t=>{var r;throw null===(r=N.AttachDocumentPerfTracker)||void 0===r||r.setFailure(t),null===e||void 0===e||e.setFailure(t),new Error("Unable to get driver info.")}),null===e||void 0===e||e.setSuccess(),I=await t.catch(e=>{var t;throw null===(t=N.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get special folder name.")})}if(f){const e=await f;if(k){const e=h?i._.startActivity(h,s.G.GetDriveInfo):void 0;T=(0,as.fZ)(),T.then(()=>{null===e||void 0===e||e.setSuccess()}).catch(t=>{null===e||void 0===e||e.setFailure(t)})}u.register("FluidDocumentServiceFactoryProvider",a({documentServiceFactory:e,createDocumentRequest:async e=>(k&&(E=await T.catch(e=>{var t;throw null===(t=N.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get driver info.")}),I=await t.catch(e=>{var t;throw null===(t=N.AttachDocumentPerfTracker)||void 0===t||t.setFailure(e),new Error("Unable to get special folder name.")})),function(e,t,r,o,n,i){const s=function(e){if(!e)return;const t=e.scope;let r="createLinkScope=".concat(t);const o=e.role;return r=o?"".concat(r,"&createLinkRole=").concat(o):r,r}(n);return{url:"".concat(e,"?driveId=").concat(encodeURIComponent(t),"&path=").concat(encodeURIComponent(r)).concat(i?"&containerPackageName=".concat(Hs(i)):"").concat(s?"&".concat(s):""),headers:{[gs.createNew]:{fileName:o}}}}(E.siteUrl,E.id,I,e))}))}const A=d.environment,F=l.uiLanguage;if(P){const t=function(e){if(e===Ki.l1)return"@ms/forms-loop";return""}(e),r=await Gs(),o=await async function(e,t,r,o,n,i,s){const a=!o||"@ms/office-fluid-container"==o;if(a){return{type:"Fluid",codeDetails:await Vs(e,t,r,n,i),pendingLocalState:s}}return{type:"Creation",registrationId:o}}(e,A,F,t,h,g,r);S=Ji({config:d,dependencySynthesizer:u,loopComponentRouterInput:o,fluidRequestHeaders:v.headers,requiredProviderTypes:w?(0,n.A)((0,n.A)({},Us),{},{ComponentLifecycle:"ComponentLifecycle"}):void 0})}else if(e){S=function(e){const{logger:t,newConfig:r,perfMetadata:o,documentHiddenTrackerId:n}=p(e.config||{}),i=window;di(ei(e.codeDetails),t);const s=Pi(i,e,void 0,r,t,o,n);return Promise.all([s.container,s.component]).then(e=>{let[t,r]=e;return r})}({codeDetails:await Vs(e,A,F,h,g),config:d,dependencySynthesizer:u,requiredProviderTypes:w?(0,n.A)((0,n.A)({},Us),{},{ComponentLifecycle:"ComponentLifecycle"}):void 0})}else{S=function(e){const{logger:t,newConfig:r,perfMetadata:o,documentHiddenTrackerId:n}=p(e.config||{}),i=Ti(window,e,void 0,r,t,o,n);return Promise.all([i.container,i.component]).then(e=>{let[t,r]=e;return r})}({config:d,dependencySynthesizer:u,snapshot:await Gs(),requiredProviderTypes:w?(0,n.A)((0,n.A)({},Us),{},{ComponentLifecycle:"ComponentLifecycle"}):void 0})}const D=await S,B=null===(y=D.FluidMetadataProvider)||void 0===y?void 0:y.getCodeDetails();let L,O;if(void 0===D)throw new o.uV("Unable to create Fluid component. The component is undefined.");if(C){const t=(await(0,ts.q)()).NewLoopComponentFileName,n=function(e,t){const r=e.replace(/[~#%&*{}\\:<>?/+|".]/g,"").trim();return t?function(e,t,r){switch(ei(e)){case"@ms/whiteboard-container":return"".concat(t,".whiteboard");case"@fluidx/copilot-frames":return"".concat(t,".loopsug");default:return"".concat(t,r?".fluid":".loop")}}(t,r):((0,o.c2)("toFullSharepointFileName()",new o.uV("Using default extension since no code details provided.")),"".concat(r,".fluid"))}(r.trim()||t,B);if(void 0===m)throw new o.uV("url resolver must be defined for fluid loop");L=js(D,n,h,N,m,v);O=new Xi(!!e,D),O.startProvidingDataToSave().catch(()=>{(0,o.c2)("createFluidComponent()",new o.uV("Unable to start providing data to save."))})}else L=async function(e,t){const r=new ss(e,{},!1,t);await r.update();return{loopComponentProperties:r}}(D,h);null===(b=L)||void 0===b||b.then(async e=>{var t;null===(t=O)||void 0===t||t.stopProvidingDataToSave(),(0,Yi.sQ)(e.loopComponentProperties.loopInfo.linkUrl||"",e.loopComponentProperties.loopInfo.linkText||"")});return{component:D,createDocumentPromise:L,componentPromise:S}}async function Vs(e,t,r,n,i){const s=await async function(e,t,r){const n="containerManifests",i=await(0,es.x$)(es.u.OEP,"FluidHost.ManifestUpgradeParameterFeature")?Yn(t,e,r,!0):Yn(t,e,r);i.then(e=>{localStorage.setItem(n,JSON.stringify(e))}).catch(e=>{(0,o.c2)("fetchAndCacheContainerManifestEntries()",new o.uV("failed to fetch container manifest.",e))});const s=localStorage.getItem(n);if(s)try{return JSON.parse(s)}catch(a){(0,o.c2)("fetchAndCacheContainerManifestEntries()",new o.uV("cannot parse from cache.",a)),localStorage.removeItem(n)}return i}(t,r,n);if(0==s.length){if(await(0,es.PA)(es.u.OEP,"FluidHost.UseFallbackCodeDetails")){const t=function(e){var t;const r=null!==(t={"FFX-BulletedList":"bulletedList","FFX-Checklist":"checklist","FFX-NumberedList":"numberedList","FFX-Paragraph":"paragraph","FFX-QuestionAnswer":"questionAnswer","FFX-Table":"tableInCanvas","FFX-TaskList":"taskListHostedInScriptorCanvas","FFX-CodeBlock":"codeBlock"}[e])&&void 0!==t?t:"paragraph";return{config:{blueprintId:r},package:{fluid:{browser:{umd:{files:["DynamicallyGeneratedWithCodeLoaderLogic"],library:"officeContainer"}}},name:"@ms/office-fluid-container",version:"0.0.1"}}}(e);return i.addBooleanDataField("FallbackCodeDetailsUsed",!0),(0,$i.Rm)("Using fallback codedetails for ".concat(e)),t}throw new o.uV("failed to get any manifests",void 0,ps.d.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest)}let a=zs(s,e);if(a||(a=zs(s,"FFX-Paragraph"),(0,o.c2)("createFluidComponent()",new o.uV('No container manifest entry with id "'.concat(e,'".')))),!a)throw new o.uV("Unable to create a Fluid component of type: ".concat(e,". There is no container manifest entry for this type."));return a.codeDetails}function zs(e,t){return e.find(e=>{var r;return(null===e||void 0===e||null===(r=e.queryableData)||void 0===r?void 0:r.id)==t})}async function Gs(){return await(0,Yi.Y0)()}async function Ws(e,t,r,o){return function(e){let{dependencySynthesizer:t,containerRequest:r,preCheckInfo:o,config:n,requiredProviderTypes:i}=e;const{logger:s,newConfig:a,perfMetadata:c,documentHiddenTrackerId:d}=p(n||{}),l=wi({windowContextForLoader:window,dependencySynthesizer:t,hostConfig:a,logger:s,perfMetadata:c,documentEverHiddenTrackerID:d,containerRequest:r,driver:void 0,preCheckInfo:o,requiredProviderTypes:i});return Promise.all([l.container,l.component]).then(e=>{let[t,r]=e;return r})}({config:e,containerRequest:t,preCheckInfo:r,dependencySynthesizer:o,requiredProviderTypes:(0,n.A)((0,n.A)({},Us),{},{ComponentLifecycle:"ComponentLifecycle"})})}var Js=r(34805),Ks=r(99671);let Qs;async function $s(e,t,r,i,s,a,c,d,l,u,h,g,p,f){if(e)return await qs(t,r,i,d,a,c,u,h,g,p,f,l);{var m,v;let e;const t=await(0,es.qF)(),r=!s.registrationId||"@fluidx/office-fluid-container"===s.registrationId;if(t){const t=function(e){let t,r;if(e.linkUrl)try{t=new URL(e.linkUrl)}catch(s){throw new o.uV("LoopInfo.loopLinkUrl is not a valid URL.")}if(e.manifestData)try{r=JSON.parse(e.manifestData)}catch(s){throw new o.uV("Manifest data is not valid JSON.",s)}if(e.loopData){if(e.registrationId===Js.B2){let t;try{var n,i;t=JSON.parse(e.loopData),t.updateExtension={type:"updateExtendedProps",data:{appIcon:null!==(n=t.appIcon)&&void 0!==n?n:"",appName:null!==(i=t.appName)&&void 0!==i?i:"",cardId:t.cardId,contentType:t.cardType,mailId:""}}}catch(s){throw new o.uV("Loop data is not valid JSON.",s)}return{type:"Data",dataType:"Card",data:t,manifestData:r,registrationId:e.registrationId}}throw new o.uV("Cannot provide loop data for registration id: ".concat(e.registrationId))}if(!t)throw new o.uV("A url is required.");return{type:"Data",dataType:"URL",data:{url:t},manifestData:r,registrationId:"@fluidx/office-fluid-container"==e.registrationId?void 0:e.registrationId}}(s);e=async function(e,t,r,o){return(0,$i.Rm)("Loading Loop component..."),Ji({fluidRequestHeaders:o.headers,config:e,dependencySynthesizer:t,loopComponentRouterInput:r,requiredProviderTypes:(0,n.A)((0,n.A)({},Us),{},{ComponentLifecycle:"ComponentLifecycle"})})}(a,u,t,l)}else Qs=await async function(e){const t=function(e){const t=(0,Ks.Mh)(e);if(!t)return;let r;try{null!==t&&void 0!==t&&t.siteUrl&&(r=new URL(null===t||void 0===t?void 0:t.siteUrl).origin)}catch(o){}return{codeDetailsHint:null===t||void 0===t?void 0:t.containerPackageName,criticalBootDomains:r?[r]:void 0}}(new URL(e));return t||{}}(l.url),e=Ws(a,l,Qs,u);const i=await e;null===i||void 0===i||null===(m=i.EmbedCardData)||void 0===m||m.getData().then(e=>{const t=JSON.stringify(e);(0,Yi.KJ)(t),(0,$i.Rm)("Saved embedded data: ".concat(t))}).catch(()=>{});const c=new ss(i,s,r,h);let d;await c.update(),c.updateFluidFilename();const g=await(null===(v=i.LoopComponentUrl)||void 0===v?void 0:v.getLoopComponentUrl());g&&(d=null===f||void 0===f?void 0:f.resolve({url:g.href,headers:l.headers}));return{component:i,loopComponentProperties:c,componentPromise:e,resolvedUrlPromise:d}}}},6390:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});const o={success:"green",warning:"orange",danger:"cranberry"}},6971:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var o=r(91947);let n;async function i(){return n||(n=(0,o.KE)()),n}},7428:(e,t,r)=>{"use strict";r.d(t,{xX:()=>o});const o=".gcdata"},7621:(e,t,r)=>{"use strict";r.d(t,{SC:()=>n,wJ:()=>o});const o=(e,t)=>i(new Map,e,t),n=(e,t)=>i(new WeakMap,e,t);function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return arguments.length<=0?void 0:arguments[0]};const o=function(o){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];const a=r(...i);if(!o){const t=e.get(a);if(t)return t.then()}const c=t(...i);return e.set(a,c),c.catch(()=>{e.delete(a)}),c.then()};return{get:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o(!1,...t)},forceFetch:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o(!0,...t)},delete(){const t=r(...arguments);e.delete(t)}}}},8018:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});class o{constructor(){this.completed=!1,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}},9580:(e,t,r)=>{"use strict";function o(e,t){const r=t.keyboardShortcutDescription;return r.type===e.type&&r.key===e.key&&!!r.altKey===e.altKey&&!!r.ctrlKey===e.ctrlKey&&!!r.metaKey===e.metaKey&&!!r.shiftKey===e.shiftKey}r.d(t,{X:()=>o})},11137:(e,t,r)=>{"use strict";r.d(t,{Y:()=>C});var o=r(27051),n=r(85038),i=r(48219),s=r(54813),a=r(93586),c=r(93220),d=r(57471),l=r(41818),u=r(34445);async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";if(void 0===crypto.subtle)return r.e(13482).then(r.bind(r,94668)).then(async r=>r.hashFile(e,t,o));const n=await async function(e,t){const r=await crypto.subtle.digest(t,e);return new Uint8Array(r)}(e,t);return function(e,t){switch(t){case"hex":return Array.prototype.map.call(e,e=>e.toString(16).padStart(2,"0")).join("");case"base64":return u.fromByteArray(e)}}(n,o)}var g=r(27015),p=r(70530),f=r(27612);function m(e,t,r,o){const n=o?"versions/".concat(o,"/"):"";return"".concat((0,g.lA)(new URL(e)),"/drives/").concat(t,"/items/").concat(r,"/").concat(n)}function v(e,t,r,o){const n=m(e,t,r,o);return"".concat(n,"opStream/snapshots")}function y(e,t,r,o){const n=m(e,t,r,o);return"".concat(n,"opStream/attachment")}function b(e,t,r,o){const n=m(e,t,r,o);return"".concat(n,"opStream/attachments")}function S(e,t,r,o){const n=m(e,t,r,o);return"".concat(n,"opStream")}class C{constructor(){}async resolve(e){var t,r,o;if(null!==(t=e.headers)&&void 0!==t&&t[i.U.createNew]){var d;const[t,r]=e.url.split("?"),o=new URLSearchParams(r),n=e.headers[i.U.createNew].fileName,l=o.get("driveId"),u=o.get("path"),h=o.get("containerPackageName");if(!(n&&t&&l&&null!==u&&void 0!==u))throw new s.OI("Proper new file params should be there",a.E.genericError,{driverVersion:f.z});return{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:"https://".concat(t,"?").concat(r,"&version=null"),siteUrl:t,hashedDocumentId:"",driveId:l,itemId:"",fileName:n,summarizer:!1,codeHint:{containerPackageName:null!==h&&void 0!==h?h:void 0},fileVersion:void 0,shareLinkInfo:void 0,isClpCompliantApp:null===(d=e.headers)||void 0===d?void 0:d[c.t.isClpCompliantApp]}}const{siteUrl:u,driveId:g,itemId:p,path:m,containerPackageName:C,fileVersion:k}=function(e){const[t,r]=e.split("?"),o=new URLSearchParams(r),n=o.get("driveId"),i=o.get("itemId"),s=o.get("path"),a=o.get("containerPackageName"),c=o.get("fileVersion");if(null===n)throw new Error("ODSP URL did not contain a drive id");if(null===i)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:t,driveId:decodeURIComponent(n),itemId:decodeURIComponent(i),path:decodeURIComponent(s),containerPackageName:a?decodeURIComponent(a):void 0,fileVersion:c?decodeURIComponent(c):void 0}}(e.url),w=await async function(e,t){const r=l.Ss.from("".concat(e,"_").concat(t));return encodeURIComponent(await h(r,"SHA-256","base64"))}(g,p);(0,n.vA)(!w.includes("/"),168);const P="https://placeholder/placeholder/".concat(w,"/").concat((T=m).startsWith("/")?T.slice(1):T);var T;const E=!(null===(r=e.headers)||void 0===r||!r[i.U.summarizingClient]);return{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:v(u,g,p,k),attachmentPOSTStorageUrl:y(u,g,p,k),attachmentGETStorageUrl:b(u,g,p,k),deltaStorageUrl:S(u,g,p,k)},id:w,tokens:{},url:P,hashedDocumentId:w,siteUrl:u,driveId:g,itemId:p,dataStorePath:m,fileName:"",summarizer:E,codeHint:{containerPackageName:C},fileVersion:k,isClpCompliantApp:null===(o=e.headers)||void 0===o?void 0:o[c.t.isClpCompliantApp]}}async getAbsoluteUrl(e,t,r){var n;const i=(0,p.Yn)(e);let s,a=t;var c;return""===t&&void 0!==i.dataStorePath&&(a=i.dataStorePath),a.startsWith("/")&&(a=a.slice(1)),r&&"name"in r?s=r.name:s="object"===typeof(c=null===r||void 0===r?void 0:r.package)&&"string"===typeof(null===c||void 0===c?void 0:c.name)&&"object"===typeof(null===c||void 0===c?void 0:c.fluid)?null===r||void 0===r?void 0:r.package.name:null===r||void 0===r?void 0:r.package,s=null!==s&&void 0!==s?s:null===(n=i.codeHint)||void 0===n?void 0:n.containerPackageName,(0,d.m)((0,o.A)((0,o.A)({},i),{},{containerPackageName:s,dataStorePath:a}))}}},11502:(e,t,r)=>{"use strict";var o;r.d(t,{e:()=>o}),function(e){e[e.Shared=0]="Shared",e[e.Plain=1]="Plain"}(o||(o={}))},11582:(e,t,r)=>{"use strict";r.d(t,{$T:()=>n});var o=r(37513);function n(e){if("object"===typeof e){const t=e;if(function(e){return e.errorType===o.a.genericError}(t))return o.a.genericError;if(function(e){return e.errorType===o.a.fileNotFoundOrAccessDeniedError}(t))return o.a.fileNotFoundOrAccessDeniedError;if(function(e){return e.errorType===o.a.authorizationError}(t))return o.a.authorizationError;if(function(e){return e.errorType===o.a.throttlingError}(t))return o.a.throttlingError}}},12283:(e,t,r)=>{"use strict";r.d(t,{d$:()=>n,vV:()=>s,wC:()=>i});var o=function(){var e=[];return{fireEvent:function(t){e.forEach(function(e){return e(t)})},addListener:function(t){t&&e.push(t)}}}();function n(){return o}function i(e,t,r){o.fireEvent({level:e,category:t,message:r})}function s(e,t,r){i(0,e,function(){var e=r instanceof Error?r.message:"";return"".concat(t,": ").concat(e)})}},13290:(e,t,r)=>{"use strict";r.d(t,{G:()=>n,S:()=>i});var o=r(44828);function n(e){var t=null;try{var r=(0,o.z)();t=r?r.sessionStorage.getItem(e):null}catch(n){}return t}function i(e,t){var r;try{null===(r=(0,o.z)())||void 0===r||r.sessionStorage.setItem(e,t)}catch(n){}}},13296:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>l,k3:()=>s,qP:()=>c,wP:()=>d});var o=r(91947);const n="ms-ContextualMenu",i="ms-Callout";function s(e,t){e.defaultPrevented||"Escape"==e.key&&async function(e,t){const r=e.target;if(!r)return!1;if(r===a)return!t;if(a&&a.contains(r))return!1;if(function(e){for(;e;){var t;const r=null===(t=e)||void 0===t?void 0:t.className;if(r&&(r.indexOf(n)>-1||r.indexOf(i)>-1))return!0;e=e.parentElement}return!1}(r))return!1;return!0}(e,t).then(t=>{t&&((0,o.wL)(e.key),e.preventDefault())})}let a;function c(e){e&&(a=e)}function d(e){if(e.target&&a){const t=e.target;if(a.contains(t))return!0}return!1}function l(e){if(e.target&&a){return e.target===a}return!0}},13760:(e,t,r)=>{"use strict";t.b=void 0;var o=r(87987);Object.defineProperty(t,"b",{enumerable:!0,get:function(){return o.EventEmitter}})},14202:(e,t)=>{"use strict";var r=Symbol.for("react.element"),o=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function v(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var S=b.prototype=new y;S.constructor=b,f(S,v.prototype),S.isPureReactComponent=!0;var C=Array.isArray,k=Object.prototype.hasOwnProperty,w={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,o){var n,i={},s=null,a=null;if(null!=t)for(n in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)k.call(t,n)&&!P.hasOwnProperty(n)&&(i[n]=t[n]);var c=arguments.length-2;if(1===c)i.children=o;else if(1<c){for(var d=Array(c),l=0;l<c;l++)d[l]=arguments[l+2];i.children=d}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===i[n]&&(i[n]=c[n]);return{$$typeof:r,type:e,key:s,ref:a,props:i,_owner:w.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var I=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,n,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case o:c=!0}}if(c)return s=s(c=e),e=""===i?"."+N(c,0):i,C(s)?(n="",null!=e&&(n=e.replace(I,"$&/")+"/"),A(s,t,n,"",function(e){return e})):null!=s&&(E(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",C(e))for(var d=0;d<e.length;d++){var l=i+N(a=e[d],d);c+=A(a,t,n,l,s)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=g&&e[g]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),d=0;!(a=e.next()).done;)c+=A(a=a.value,t,n,l=i+N(a,d++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function F(e,t,r){if(null==e)return e;var o=[],n=0;return A(e,o,"","",function(e){return t.call(r,e,n++)}),o}function D(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var B={current:null},L={transition:null},O={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:L,ReactCurrentOwner:w};t.Children={map:F,forEach:function(e,t,r){F(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return F(e,function(){t++}),t},toArray:function(e){return F(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=n,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,o){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=f({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=w.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(d in t)k.call(t,d)&&!P.hasOwnProperty(d)&&(n[d]=void 0===t[d]&&void 0!==c?c[d]:t[d])}var d=arguments.length-2;if(1===d)n.children=o;else if(1<d){c=Array(d);for(var l=0;l<d;l++)c[l]=arguments[l+2];n.children=c}return{$$typeof:r,type:e.type,key:i,ref:s,props:n,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:d,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return B.current.useCallback(e,t)},t.useContext=function(e){return B.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return B.current.useDeferredValue(e)},t.useEffect=function(e,t){return B.current.useEffect(e,t)},t.useId=function(){return B.current.useId()},t.useImperativeHandle=function(e,t,r){return B.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return B.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return B.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return B.current.useMemo(e,t)},t.useReducer=function(e,t,r){return B.current.useReducer(e,t,r)},t.useRef=function(e){return B.current.useRef(e)},t.useState=function(e){return B.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return B.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return B.current.useTransition()},t.version="18.3.0"},14365:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});const o=async e=>new Promise(t=>setTimeout(()=>t(),e))},14818:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});const o="IFluidDependencySynthesizer"},14826:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});const o={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const i=new Uint8Array(16);function s(){if(!n&&(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const a=[];for(let l=0;l<256;++l)a.push((l+256).toString(16).slice(1));function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}const d=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();const n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return c(n)}},14836:(e,t,r)=>{"use strict";r.d(t,{r:()=>s});var o=r(83125),n=r(5667),i=r(95720);function s(e,t){const r=t&&new o.p(i.Ak,t);return{claims:e.claims,forceRefresh:e.refresh,siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.itemId,request:e.request||null,tenantId:e.tenantId||(0,n.n)(e.siteUrl,r)}}},15217:(e,t,r)=>{"use strict";function o(e,t){e||n(t)}function n(e){const t=new Error("number"===typeof e?"0x".concat(e.toString(16).padStart(3,"0")):e);throw i(t),t}function i(e){for(const t of s)t(e)}r.d(t,{aT:()=>a,fJ:()=>n,vA:()=>o});const s=new Set;function a(e){d(()=>{if(c){const t=e();if(!0!==t){const e=new Error("Debug assert failed: ".concat(t.toString()));throw i(e),e}}})}let c=!1;function d(e){}},15894:(e,t,r)=>{"use strict";r.d(t,{SA:()=>u,oh:()=>a,jP:()=>d,zF:()=>i,Fz:()=>l});const o="IFluidHandle",n=Symbol.for("FluidHandle-3978c7cf-4675-49ba-a20c-bf35efbf43da"),i=e=>"__fluid_handle__"===(null===e||void 0===e?void 0:e.type),s=e=>"payloadPending"in e&&!0===e.payloadPending;function a(e){return s(e)?{type:"__fluid_handle__",url:e.absolutePath,payloadPending:!0}:{type:"__fluid_handle__",url:e.absolutePath}}const c=!0;function d(e){if("object"!==typeof e||null===e)return!1;if(n in e)return!0;if(c&&o in e){const t=e[o];return"object"===typeof t&&null!==t&&o in t}return!1}function l(e){if(!(n in e)||!(n in e[n])){if(c&&o in e)return e[o];throw new TypeError("Invalid IFluidHandle")}return e[n]}class u{get IFluidHandle(){return this}get[n](){return this}}},16026:(e,t,r)=>{"use strict";function o(e,t,r){return void 0===e?e:t.stringify(e,r)}function n(e,t,r){return t.encode(e,r)}function i(e,t){return t.decode(e)}function s(e,t,r){return t.encode(e,r),e}r.d(t,{Dv:()=>n,KC:()=>o,Zb:()=>i,pM:()=>s})},16135:(e,t,r)=>{"use strict";function o(e){const t=n(null===e||void 0===e?void 0:e.audience);return t||(null!==e&&void 0!==e&&e.ring?e.ring:"Prod")}function n(e){switch(e){case"Development":case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";case"USNat":return"USNat";case"USSec":return"USSec";case"Gallatin":return"Gallatin";case"Bleu":return"Bleu";case"Delos":return"Delos";default:return}}function i(e){switch(e){case"Development":return{audience:"Development"};case"Staging":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Gcc":return{audience:"GCC"};case"GccHigh":return{audience:"GCC-High"};case"DoD":return{audience:"DoD"};case"USNat":return{audience:"USNat"};case"USSec":return{audience:"USSec"};default:return{audience:"Production"}}}function s(e,t){var r;return e?o(e):null!==(r=n(t))&&void 0!==r?r:"Prod"}r.d(t,{H9:()=>s,H_:()=>n,Rs:()=>o,mo:()=>i})},16218:(e,t,r)=>{"use strict";r.d(t,{Fq:()=>a,KM:()=>o,PB:()=>s,Ve:()=>c,_D:()=>n,aM:()=>i});const o={BlockingBackground:"--ms-themeColorBlockingBackground",BlockingIcon:"--ms-themeColorBlockingIcon",BodyBackground:"--ms-themeColorBodyBackground",BodyBackgroundChecked:"--ms-themeColorBodyBackgroundChecked",BodyBackgroundHovered:"--ms-themeColorBodyBackgroundHovered",BodyDivider:"--ms-themeColorBodyDivider",BodyFrameBackground:"--ms-themeColorBodyFrameBackground",BodyFrameDivider:"--ms-themeColorBodyFrameDivider",BodyText:"--ms-themeColorBodyText",BodyTextChecked:"--ms-themeColorBodyTextChecked",BodyStandoutBackground:"--ms-themeColorBodyStandoutBackground",BodySubtext:"--ms-themeColorBodySubtext",DefaultStateBackground:"--ms-themeColorDefaultStateBackground",DisabledBodySubtext:"--ms-themeColorDisabledBodySubtext",DisabledBodyText:"--ms-themeColorDisabledBodyText",DisabledBorder:"--ms-themeColorDisabledBorder",ErrorBackground:"--ms-themeColorErrorBackground",ErrorBoxBackground:"--ms-themeColorErrorBoxBackground",ErrorIcon:"--ms-themeColorErrorIcon",ErrorBorder:"--ms-themeColorErrorBorder",ErrorBlock:"--ms-themeColorErrorBlock",DarkErrorBlock:"--ms-themeColorDarkErrorBlock",GrayErrorBackground:"--ms-themeColorGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorDarkGrayErrorBackground",ErrorText:"--ms-themeColorErrorText",InfoText:"--ms-themeColorInfoText",RedErrorText:"--ms-themeColorRedErrorText",GrayIcon:"--ms-themeColorGrayIcon",FocusBorder:"--ms-themeColorFocusBorder",InfoBackground:"--ms-themeColorInfoBackground",InfoIcon:"--ms-themeColorInfoIcon",MessageLink:"--ms-themeColorMessageLink",MessageLinkHovered:"--ms-themeColorMessageLinkHovered",MessageText:"--ms-themeColorMessageText",SevereWarningBackground:"--ms-themeColorSevereWarningBackground",SevereWarningIcon:"--ms-themeColorSevereWarningIcon",SuccessBackground:"--ms-themeColorSuccessBackground",SuccessIcon:"--ms-themeColorSuccessIcon",VariantBorder:"--ms-themeColorVariantBorder",VariantBorderHovered:"--ms-themeColorVariantBorderHovered",WarningBackground:"--ms-themeColorWarningBackground",WarningHighlight:"--ms-themeColorWarningHighlight",WarningIcon:"--ms-themeColorWarningIcon",ActionLink:"--ms-themeColorActionLink",ActionLinkHovered:"--ms-themeColorActionLinkHovered",Link:"--ms-themeColorLink",LinkHovered:"--ms-themeColorLinkHovered",AccentButtonBackground:"--ms-themeColorAccentButtonBackground",AccentButtonText:"--ms-themeColorAccentButtonText",ButtonBackground:"--ms-themeColorButtonBackground",ButtonBackgroundChecked:"--ms-themeColorButtonBackgroundChecked",ButtonBackgroundHovered:"--ms-themeColorButtonBackgroundHovered",ButtonBackgroundCheckedHovered:"--ms-themeColorButtonBackgroundCheckedHovered",ButtonBackgroundPressed:"--ms-themeColorButtonBackgroundPressed",ButtonBackgroundDisabled:"--ms-themeColorButtonBackgroundDisabled",ButtonBorder:"--ms-themeColorButtonBorder",ButtonText:"--ms-themeColorButtonText",ButtonTextHovered:"--ms-themeColorButtonTextHovered",ButtonTextChecked:"--ms-themeColorButtonTextChecked",ButtonTextCheckedHovered:"--ms-themeColorButtonTextCheckedHovered",ButtonTextPressed:"--ms-themeColorButtonTextPressed",ButtonTextDisabled:"--ms-themeColorButtonTextDisabled",ButtonBorderDisabled:"--ms-themeColorButtonBorderDisabled",PrimaryButtonBackground:"--ms-themeColorPrimaryButtonBackground",PrimaryButtonBackgroundHovered:"--ms-themeColorPrimaryButtonBackgroundHovered",PrimaryButtonBackgroundPressed:"--ms-themeColorPrimaryButtonBackgroundPressed",PrimaryButtonBackgroundDisabled:"--ms-themeColorPrimaryButtonBackgroundDisabled",PrimaryButtonBorder:"--ms-themeColorPrimaryButtonBorder",PrimaryButtonText:"--ms-themeColorPrimaryButtonText",PrimaryButtonTextHovered:"--ms-themeColorPrimaryButtonTextHovered",PrimaryButtonTextPressed:"--ms-themeColorPrimaryButtonTextPressed",PrimaryButtonTextDisabled:"--ms-themeColorPrimaryButtonTextDisabled",InputBorder:"--ms-themeColorInputBorder",InputBorderHovered:"--ms-themeColorInputBorderHovered",InputBackground:"--ms-themeColorInputBackground",InputBackgroundChecked:"--ms-themeColorInputBackgroundChecked",InputBackgroundCheckedHovered:"--ms-themeColorInputBackgroundCheckedHovered",InputPlaceholderBackgroundChecked:"--ms-themeColorInputPlaceholderBackgroundChecked",InputForegroundChecked:"--ms-themeColorInputForegroundChecked",InputIcon:"--ms-themeColorInputIcon",InputIconHovered:"--ms-themeColorInputIconHovered",InputIconDisabled:"--ms-themeColorInputIconDisabled",InputFocusBorderAlt:"--ms-themeColorInputFocusBorderAlt",SmallInputBorder:"--ms-themeColorSmallInputBorder",InputText:"--ms-themeColorInputText",InputTextHovered:"--ms-themeColorInputTextHovered",InputTextPressed:"--ms-themeColorInputTextPressed",InputPlaceholderText:"--ms-themeColorInputPlaceholderText",DisabledBackground:"--ms-themeColorDisabledBackground",DisabledText:"--ms-themeColorDisabledText",DisabledSubtext:"--ms-themeColorDisabledSubtext",ListBackground:"--ms-themeColorListBackground",ListText:"--ms-themeColorListText",ListTextColor:"--ms-themeColorListTextColor",ListItemBackgroundHovered:"--ms-themeColorListItemBackgroundHovered",ListItemBackgroundChecked:"--ms-themeColorListItemBackgroundChecked",ListItemBackgroundCheckedHovered:"--ms-themeColorListItemBackgroundCheckedHovered",ListHeaderBackgroundHovered:"--ms-themeColorListHeaderBackgroundHovered",ListHeaderBackgroundPressed:"--ms-themeColorListHeaderBackgroundPressed",MenuBackground:"--ms-themeColorMenuBackground",MenuBorder:"--ms-themeColorMenuBorder",MenuDivider:"--ms-themeColorMenuDivider",MenuIcon:"--ms-themeColorMenuIcon",MenuHeader:"--ms-themeColorMenuHeader",MenuItemBackgroundChecked:"--ms-themeColorMenuItemBackgroundChecked",MenuItemBackgroundHovered:"--ms-themeColorMenuItemBackgroundHovered",MenuItemBackgroundPressed:"--ms-themeColorMenuItemBackgroundPressed",MenuItemText:"--ms-themeColorMenuItemText",MenuItemTextHovered:"--ms-themeColorMenuItemTextHovered",MenuItemTextPressed:"--ms-themeColorMenuItemTextPressed",MenuItemTextChecked:"--ms-themeColorMenuItemTextChecked",MenuItemTextSecondary:"--ms-themeColorMenuItemTextSecondary",CardShadow:"--ms-themeCardShadow",CardShadowHovered:"--ms-themeCardShadowHovered",CardStandoutBackground:"--ms-themeColorCardStandoutBackground",GrabberBorderChecked:"--ms-grabberBorderChecked",GrabberBackgroundChecked:"--ms-grabberBackgroundChecked",GrabberColor:"--ms-grabberColor",GrabberColorChecked:"--ms-grabberColorChecked",CheckboxBackgroundUnchecked:"--ms-checkboxBackgroundUnchecked",CheckboxBackgroundChecked:"--ms-checkboxBackgroundChecked",CheckboxColorUnchecked:"--ms-checkboxColorUnchecked",CheckboxColorUncheckedHovered:"--ms-checkboxColorUncheckedHovered",CheckboxColorCheckedHovered:"--ms-checkboxColorCheckedHovered",CheckboxColorChecked:"--ms-checkboxColorChecked",CheckboxUnpopulated:"--ms-checkboxUnpopulated",TeamsV2DefaultForeground2:"--ms-themeColorPaletteTeamsV2DefaultForeground2",TeamsV2DefaultForeground:"--ms-themeColorPaletteTeamsV2DefaultForeground",TeamsV2DefaultForegroundHover:"--ms-themeColorPaletteTeamsV2DefaultForegroundHover",TeamsV2DefaultForegroundPressed:"--ms-themeColorPaletteTeamsV2DefaultForegroundPressed",TeamsV2DefaultBackground:"--ms-themeColorPaletteTeamsV2DefaultBackground",TeamsV2DefaultBackgroundHover:"--ms-themeColorPaletteTeamsV2DefaultBackgroundHover",TeamsV2DefaultBackgroundPressed:"--ms-themeColorPaletteTeamsV2DefaultBackgroundPressed",TeamsV2DefaultBorder:"--ms-themeColorPaletteTeamsV2DefaultBorder",TeamsV2DefaultBorderHover:"--ms-themeColorPaletteTeamsV2DefaultBorderHover",TeamsV2DefaultBorderPressed:"--ms-themeColorPaletteTeamsV2DefaultBorderPressed",TeamsV2BrandForeground4:"--ms-themeColorPaletteTeamsV2BrandForeground4",TeamsV2BrandBackground:"--ms-themeColorPaletteTeamsV2BrandBackground",TeamsV2BrandBackgroundHover:"--ms-themeColorPaletteTeamsV2BrandBackgroundHover",TeamsV2BrandBackgroundPressed:"--ms-themeColorPaletteTeamsV2BrandBackgroundPressed",VotingButtonHoverShadow:"--ms-themeColorPaletteVotingButtonHoverShadow"},n={ThemeName:"--ms-themeColorThemeName",TextSizeAdjust:"--ms-themeTextSizeAdjust",Selection:"--ms-themeColorSelection",SelectionBackground:"--ms-themeColorSelectionBackground",SelectionBorder:"--ms-themeColorSelectionBorder",DragDropTearOffPageBorder:"--ms-themeColorPaletteDragDropTearOffPageBorder",DragDropTearOffPageBackground:"--ms-themeColorPaletteDragDropTearOffPageBackground",BlockComponentPlaceholderBackground:"--ms-themeColorPaletteBlockComponentPlaceholderBackground",AtMentionBackgroundMe:"--ms-themeColorPaletteAtMentionBackGroundMe",AtMentionTextMe:"--ms-themeColorPaletteAtMentionTextMe",AtMentionBackgroundOther:"--ms-themeColorPaletteAtMentionBackgroundOther",AtMentionTextOther:"--ms-themeColorPaletteAtMentionTextOther",AtMentionBackgroundHighlight:"--ms-themeColorPaletteAtMentionBackgroundHighlight",AtMentionHighlightBorder:"--ms-themeColorPaletteAtMentionHighlightBorder",AtMentionUnresolvedBackground:"--ms-themeColorPaletteAtMentionUnresolvedBackground",AtMentionUnresolvedBackgroundHovered:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudHovered",AtMentionUnresolvedBackgroundPressed:"--ms-themeColorPaletteAtMentionsUnresolvedBackgroundPressed",AtMentionUnresolvedBackgroundSelected:"--ms-themeColorPaletteAtMentionUnresolvedBackgroudSelected",AtMentionUnresolvedIcon:"--ms-themeColorPaletteAtMentionUnresolvedIcon",AtMentionUnresolvedIconHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconHovered",AtMentionUnresolvedIconPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconPressed",AtMentionUnresolvedIconSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconSelected",AtMentionUnresolvedIconInner:"--ms-themeColorPaletteAtMentionUnresolvedIconInner",AtMentionUnresolvedIconInnerHovered:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerHovered",AtMentionUnresolvedIconInnerPressed:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerPressed",AtMentionUnresolvedIconInnerSelected:"--ms-themeColorPaletteAtMentionUnresolvedIconInnerSelected",AtMentionUnresolvedOutline:"--ms-themeColorPaletteAtMentionUnresolvedOutline",AtMentionUnresolvedOutlineHovered:"--ms-themeColorPaletteAtMentionUnresolvedOutlineHovered",AtMentionUnresolvedOutlinePressed:"--ms-themeColorPaletteAtMentionUnresolvedOutlinePressed",AtMentionUnresolvedOutlineSelected:"--ms-themeColorPaletteAtMentionUnresolvedOutlineSelected",IconButton:"--ms-themeColorIconButton",IconButtonHovered:"--ms-themeColorIconButtonHovered",IconButtonPressed:"--ms-themeColorIconButtonPressed",IconButtonChecked:"--ms-themeColorIconButtonChecked",IconButtonBackground:"--ms-themeColorIconButtonBackground",IconButtonBackgroundHovered:"--ms-themeColorIconButtonBackgroundHovered",IconButtonBackgroundPressed:"--ms-themeColorIconButtonBackgroundPressed",IconButtonBackgroundChecked:"--ms-themeColorIconButtonBackgroundChecked",OverflowText:"--ms-themeColorOverflowText",OverflowTextHovered:"--ms-themeColorOverflowTextHovered",OverflowTextPressed:"--ms-themeColorOverflowTextPressed",OverflowTextChecked:"--ms-themeColorOverflowTextChecked",OverflowBackground:"--ms-themeColorOverflowBackground",OverflowBackgroundHovered:"--ms-themeColorOverflowBackgroundHovered",OverflowBackgroundPressed:"--ms-themeColorOverflowBackgroundPressed",OverflowBackgroundChecked:"--ms-themeColorOverflowBackgroundChecked",MenuBorder:"--ms-themeColorMenuBorder",TooltipText:"--ms-themeColorTooltipText",TooltipBackground:"--ms-themeColorTooltipBackground",CalendarCellText:"--ms-themeColorCalendarCellText",CalendarCellTextHovered:"--ms-themeColorCalendarCellTextHovered",CalendarCellTextChecked:"--ms-themeColorCalendarCellTextChecked",CalendarCellTextToday:"--ms-themeColorCalendarCellTextToday",CalendarHeaderText:"--ms-themeColorCalendarHeaderText",CalendarBackground:"--ms-themeColorCalendarBackground",CalendarCellBackground:"--ms-themeColorCalendarCellBackground",CalendarCellBackgroundHovered:"--ms-themeColorCalendarCellBackgroundHovered",CalendarCellBackgroundChecked:"--ms-themeColorCalendarCellBackgroundSelected",CalendarCellBackgroundToday:"--ms-themeColorCalendarCellBackgroundToday",DatePickerTextToday:"--ms-themeColorDatePickerTextToday",DatePickerTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",DatePickerTextYesterday:"--ms-themeColorDatePickerTextYesterday",DatePickerTextOther:"--ms-themeColorDatePickerTextOther",DatePickerBackgroundToday:"--ms-themeColorDatePickerBackgroundToday",DatePickerBackgroundTomorrow:"--ms-themeColorDatePickerBackgroundTomorrow",DatePickerBackgroundYesterday:"--ms-themeColorDatePickerBackgroundYesterday",DatePickerBackground:"--ms-themeColorDatePickerBackground",DatePickerGrayedText:"--ms-themeColorDatePickerGrayedText",DatePickerGrayedBackground:"--ms-themeColorDatePickerGrayedBackground",TaskDueDateTextToday:"--ms-themeColorDatePickerTextToday",TaskDueDateTextTomorrow:"--ms-themeColorDatePickerTextTomorrow",TaskDueDateTextYesterday:"--ms-themeColorDatePickerTextYesterday",TaskDueDateTextOther:"--ms-themeColorDatePickerTextOther",PersonaBorder:"--ms-themeColorPersonaBorder",PersonaText:"--ms-themeColorPersonaText",BodyBackgroundWithAlpha:"--ms-themeColorBodyBackgroundWithAlpha",ErrorCalloutText:"--ms-themeColorErrorCalloutText",ErrorCalloutBackground:"--ms-themeColorErrorCalloutBackground",ErrorSnackbarText:"--ms-themeColorErrorSnackbarText",ErrorSnackbarBackground:"--ms-themeColorErrorSnackbarBackground",WarningSnackbarText:"--ms-themeColorWarningSnackbarText",WarningSnackbarBackground:"--ms-themeColorWarningSnackbarBackground",TextSelectionBackgroundHovered:"--ms-themeColorPaletteTextSelectionBackgroundHovered",TextSelectionBackgroundPressed:"--ms-themeColorPaletteTextSelectionBackgroundPressed",TextSelectionEndCap:"--ms-themeColorPaletteTextSelectionEndCap",TextSelectionHorizontalCap:"--ms-themeColorPaletteTextSelectionHorizontalCap",FloatieText:"--ms-themeColorPaletteFloatieText",FloatieTextHovered:"--ms-themeColorPaletteFloatieTextHovered",FloatieTextPressed:"--ms-themeColorPaletteFloatieTextPressed",FloatieBackground:"--ms-themeColorPaletteFloatieBackground",FloatieBackgroundHovered:"--ms-themeColorPaletteFloatieBackgroundHovered",FloatieBackgroundPressed:"--ms-themeColorPaletteFloatieBackgroundPressed",FloatieBorder:"--ms-themeColorPaletteFloatieBorder",FloatieBorderHovered:"--ms-themeColorPaletteFloatieBorderHovered",FloatieBorderPressed:"--ms-themeColorPaletteFloatieBorderPressed",FontColorRed:"--ms-themeColorPaletteFontColorRed",FontColorOrange:"--ms-themeColorPaletteFontColorOrange",FontColorYellow:"--ms-themeColorPaletteFontColorYellow",FontColorGreen:"--ms-themeColorPaletteFontColorGreen",FontColorBlueGreen:"--ms-themeColorPaletteFontColorBlueGreen",FontColorBlue:"--ms-themeColorPaletteFontColorBlue",FontColorPurple:"--ms-themeColorPaletteFontColorPurple",BackgroundColorRed:"--ms-themeColorPaletteBackgroundColorRed",BackgroundColorOrange:"--ms-themeColorPaletteBackgroundColorOrange",BackgroundColorYellow:"--ms-themeColorPaletteBackgroundColorYellow",BackgroundColorGreen:"--ms-themeColorPaletteBackgroundColorGreen",BackgroundColorBlueGreen:"--ms-themeColorPaletteBackgroundColorBlueGreen",BackgroundColorBlue:"--ms-themeColorPaletteBackgroundColorBlue",BackgroundColorPurple:"--ms-themeColorPaletteBackgroundColorPurple",BackgroundAcrylicColorized:"--colorBackgroundAcrylicColorized",BackgroundAcrylicColorizedFallback:"--colorBackgroundAcrylicColorizedFallback",ComponentGlowBorder1:"--ms-themeColorPaletteComponentGlowBorder1",ComponentGlowBorder2:"--ms-themeColorPaletteComponentGlowBorder2",ComponentGlowBorder3:"--ms-themeColorPaletteComponentGlowBorder3",ComponentGlowBorder4:"--ms-themeColorPaletteComponentGlowBorder4",ComponentGlowBorder5:"--ms-themeColorPaletteComponentGlowBorder5",InCanvasPresenceText:"--ms-themeColorInCanvasPresenceText",CanvasBackground:"--ms-themeColorCanvasBackground"},i={Default:"default",Dark:"dark",HighContrast:"high-contrast"},s={MarginTopBody:"--ms-themeMarginTopBody",MarginTopHeading1:"--ms-themeMarginTopHeading1",MarginTopHeading2:"--ms-themeMarginTopHeading2",MarginTopHeading3:"--ms-themeMarginTopHeading3",MarginTopHeading4:"--ms-themeMarginTopHeading4",MarginTopHeading5:"--ms-themeMarginTopHeading5",MarginTopHeading6:"--ms-themeMarginTopHeading6",MarginBottomHeading1:"--ms-themeMarginBottomHeading1",MarginBottomHeading2:"--ms-themeMarginBottomHeading2",MarginBottomHeading3:"--ms-themeMarginBottomHeading3",MarginBottomHeading4:"--ms-themeMarginBottomHeading4",MarginBottomHeading5:"--ms-themeMarginBottomHeading5",MarginBottomHeading6:"--ms-themeMarginBottomHeading6",LineHeightBody:"--ms-themeLineHeightBody",LineHeightHeading1:"--ms-themeLineHeightHeading1",LineHeightHeading2:"--ms-themeLineHeightHeading2",LineHeightHeading3:"--ms-themeLineHeightHeading3",LineHeightHeading4:"--ms-themeLineHeightHeading4",LineHeightHeading5:"--ms-themeLineHeightHeading5",LineHeightHeading6:"--ms-themeLineHeightHeading6",OutlineBody:"--ms-themeOutlineBody",OutlineHeading1:"--ms-themeOutlineHeading1",OutlineHeading2:"--ms-themeOutlineHeading2",OutlineHeading3:"--ms-themeOutlineHeading3",OutlineHeading4:"--ms-themeOutlineHeading4",OutlineHeading5:"--ms-themeOutlineHeading5",OutlineHeading6:"--ms-themeOutlineHeading6",TextDecorationComplement:"--ms-themeTextDecorationComplement"},a={FontFamilyBody:"--ms-themeFontFamilyBody",FontFamilyHeading1:"--ms-themeFontFamilyHeading1",FontFamilyHeading2:"--ms-themeFontFamilyHeading2",FontFamilyHeading3:"--ms-themeFontFamilyHeading3",FontFamilyMenu:"--ms-themeFontFamilyMenu",FontFamilyButton:"--ms-themeFontFamilyButton",FontSizeBody:"--ms-themeFontSizeBody",FontSizeHeading1:"--ms-themeFontSizeHeading1",FontSizeHeading2:"--ms-themeFontSizeHeading2",FontSizeHeading3:"--ms-themeFontSizeHeading3",FontSizeHeading4:"--ms-themeFontSizeHeading4",FontSizeHeading5:"--ms-themeFontSizeHeading5",FontSizeHeading6:"--ms-themeFontSizeHeading6",FontSizeMenu:"--ms-themeFontSizeMenu",FontSizeButton:"--ms-themeFontSizeButton",FontWeightBody:"--ms-themeFontWeightBody",FontWeightHeading1:"--ms-themeFontWeightHeading1",FontWeightHeading2:"--ms-themeFontWeightHeading2",FontWeightHeading3:"--ms-themeFontWeightHeading3",FontWeightMenu:"--ms-themeFontWeightMenu",FontWeightButton:"--ms-themeFontWeightButton"},c={PinkRed10:"--ms-themeColorPaletteSharedPinkRed10",Red20:"--ms-themeColorPaletteSharedRed20",Red10:"--ms-themeColorPaletteSharedRed10",RedOrange10:"--ms-themeColorPaletteSharedRedOrange10",Orange30:"--ms-themeColorPaletteSharedOrange30",Orange20:"--ms-themeColorPaletteSharedOrange20",Orange10:"--ms-themeColorPaletteSharedOrange10",Yellow20:"--ms-themeColorPaletteSharedYellow20",Yellow10:"--ms-themeColorPaletteSharedYellow10",OrangeYellow20:"--ms-themeColorPaletteSharedOrangeYellow20",OrangeYellow10:"--ms-themeColorPaletteSharedOrangeYellow10",YellowGreen10:"--ms-themeColorPaletteSharedYellowGreen10",Green20:"--ms-themeColorPaletteSharedGreen20",Green10:"--ms-themeColorPaletteSharedGreen10",GreenCyan10:"--ms-themeColorPaletteSharedGreenCyan10",Cyan30:"--ms-themeColorPaletteSharedCyan30",Cyan20:"--ms-themeColorPaletteSharedCyan20",Cyan10:"--ms-themeColorPaletteSharedCyan10",CyanBlue20:"--ms-themeColorPaletteSharedCyanBlue20",CyanBlue10:"--ms-themeColorPaletteSharedCyanBlue10",Blue10:"--ms-themeColorPaletteSharedBlue10",BlueMagenta30:"--ms-themeColorPaletteSharedBlueMagenta30",BlueMagenta20:"--ms-themeColorPaletteSharedBlueMagenta20",BlueMagenta10:"--ms-themeColorPaletteSharedBlueMagenta10",Magenta20:"--ms-themeColorPaletteSharedMagenta20",Magenta10:"--ms-themeColorPaletteSharedMagenta10",MagentaPink20:"--ms-themeColorPaletteSharedMagentaPink20",MagentaPink10:"--ms-themeColorPaletteSharedMagentaPink10",Gray430:"--ms-themeColorPaletteSharedGray430",Gray180:"--ms-themeColorPaletteSharedGray180",Gray130:"--ms-themeColorPaletteSharedGray130",Gray100:"--ms-themeColorPaletteSharedGray100",Gray80:"--ms-themeColorPaletteSharedGray80",Gray70:"--ms-themeColorPaletteSharedGray70",Gray50:"--ms-themeColorPaletteSharedGray50",Gray40:"--ms-themeColorPaletteSharedGray40",Gray30:"--ms-themeColorPaletteSharedGray30",Gray20:"--ms-themeColorPaletteSharedGray20",Gray10:"--ms-themeColorPaletteSharedGray10",Gray4:"--ms-themeColorPaletteSharedGray4",Gray6:"--ms-themeColorPaletteSharedGray6",Gray5:"--ms-themeColorPaletteSharedGray5",Gray1:"--ms-themeColorPaletteSharedGray1",Away:"--ms-themeColorPalettePresenceAway",DoNotDisturb:"--ms-themeColorPalettePresenceDoNotDisturb",Online:"--ms-themeColorPalettePresenceOnline",Invisible:"--ms-themeColorPalettePresenceInvisible",OutOfOffice:"--ms-themeColorPalettePresenceOutOfOffice",Warning:"--ms-themeColorPaletteMessagingWarning",WarningIcon:"--ms-themeColorPaletteMessagingWarningIcon",SevereWarning:"--ms-themeColorPaletteMessagingSevereWarning",SevereWarningIcon:"--ms-themeColorPaletteMessagingServereWarningIcon",ErrorBlock:"--ms-themeColorPaletteMessagingErrorBlock",ErrorBlockIcon:"--ms-themeColorPaletteMessagingErrorBlockIcon",ErrorBackground:"--ms-themeColorPaletteMessagingErrorBackground",ErrorBoxBackground:"--ms-themeColorPaletteMessagingErrorBoxBackground",ErrorText:"--ms-themeColorPaletteMessagingErrorText",InfoText:"--ms-themeColorPaletteMessagingInfoText",DarkErrorBlock:"--ms-themeColorPaletteMessagingDarkErrorBlock",GrayErrorBackground:"--ms-themeColorPaletteMessagingGrayErrorBackground",DarkGrayErrorBackground:"--ms-themeColorPaletteMessagingDarkGrayErrorBackground",GrayErrorText:"--ms-themeColorPaletteMessagingGrayErrorText",RedErrorText:"--ms-themeColorPaletteMessagingRedErrorText",GrayIcon:"--ms-themeColorPaletteMessagingGrayIcon",ButtonText:"--ms-themeColorPaletteMessagingButtonText",Success:"--ms-themeColorPaletteMessagingSuccess",SuccessIcon:"--ms-themeColorPaletteMessagingSuccessIcon",themeDarker:"--ms-themeColorPaletteThemeDarker",themeDark:"--ms-themeColorPaletteThemeDark",themeDarkAlt:"--ms-themeColorPaletteThemeDarkAlt",themePrimary:"--ms-themeColorPaletteThemePrimary",themeSecondary:"--ms-themeColorPaletteThemeSecondary",themeTertiary:"--ms-themeColorPaletteThemeTertiary",themeLight:"--ms-themeColorPaletteThemeLight",themeLighter:"--ms-themeColorPaletteThemeLighter",themeLighterAlt:"--ms-themeColorPaletteThemeLighterAlt",black:"--ms-themeColorPaletteBlack",neutralDark:"--ms-themeColorPaletteNeutralDark",neutralPrimary:"--ms-themeColorPaletteNeutralPrimary",neutralPrimaryAlt:"--ms-themeColorPaletteNeutralPrimaryAlt",neutralSecondary:"--ms-themeColorPaletteNeutralSecondary",neutralSecondaryAlt:"--ms-themeColorPaletteNeutralSecondaryAlt",neutralTertiary:"--ms-themeColorPaletteNeutralTertiary",neutralTertiaryAlt:"--ms-themeColorPaletteNeutralTertiaryAlt",neutralQuaternary:"--ms-themeColorPaletteNeutralQuaternary",neutralQuaternaryAlt:"--ms-themeColorPaletteNeutralQuaternaryAlt",neutralQuaternaryAlt2:"--ms-themeColorPaletteNeutralQuaternaryAlt2",neutralLight:"--ms-themeColorPaletteNeutralLight",neutralLightAlt:"--ms-themeColorPaletteNeutralLightAlt",neutralLighter:"--ms-themeColorPaletteNeutralLighter",neutralLighterAlt:"--ms-themeColorPaletteNeutralLighterAlt",white:"--ms-themeColorPaletteWhite",yellowDark:"--ms-themeColorPaletteAccentYellowDark",yellow:"--ms-themeColorPaletteAccentYellow",yellowLight:"--ms-themeColorPaletteAccentYellowLight",orange:"--ms-themeColorPaletteAccentOrange",orangeLight:"--ms-themeColorPaletteAccentOrangeLight",orangeLighter:"--ms-themeColorPaletteAccentOrangeLighter",redDark:"--ms-themeColorPaletteAccentRedDark",red:"--ms-themeColorPaletteAccentRed",magentaDark:"--ms-themeColorPaletteAccentMagentaDark",magenta:"--ms-themeColorPaletteAccentMagenta",magentaLight:"--ms-themeColorPaletteAccentMagentaLight",purpleDark:"--ms-themeColorPaletteAccentPurpleDark",purple:"--ms-themeColorPaletteAccentPurple",purpleLight:"--ms-themeColorPaletteAccentPurpleLight",blueDark:"--ms-themeColorPaletteAccentBlueDark",blueMid:"--ms-themeColorPaletteAccentBlueMid",blue:"--ms-themeColorPaletteAccentBlue",blueAlt:"--ms-themeColorPaletteAccentBlueAlt",blueLight:"--ms-themeColorPaletteAccentBlueLight",tealDark:"--ms-themeColorPaletteAccentTealDark",teal:"--ms-themeColorPaletteAccentTeal",tealLight:"--ms-themeColorPaletteAccentTealLight",greenDark:"--ms-themeColorPaletteAccentGreenDark",green:"--ms-themeColorPaletteAccentGreen",greenLight:"--ms-themeColorPaletteAccentGreenLight",SuggestionAcceptedBackground:"--ms-themeColorPaletteProofingSuggestionAcceptedBackground",SpellingSuggestionHoverHighlight:"--ms-themeColorPaletteProofingSpellingSuggestionHoverHighlight",SpellingHoverTextColor:"--ms-themeColorPaletteProofingSpellingHoverTextColor",GrammarSuggestionHoverHighlight:"--ms-themeColorPaletteProofingGrammarSuggestionHoverHighlight",GrammarHoverTextColor:"--ms-themeColorPaletteProofingGrammarHoverTextColor",HeadingDetectedHoverHighlight:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverHighlight",HeadingDetectedHoverTextColor:"--ms-themeColorPaletteAnnotationsHeadingDetectedHoverTextColor",TaskRecognitionUnderline:"--ms-themeColorPaletteAnnotationsTaskRecognitionUnderline",TaskRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverHighlight",TaskRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsTaskRecognitionHoverTextColor",EntityRecognitionUnderline:"--ms-themeColorPaletteAnnotationsEntityRecognitionUnderline",EntityRecognitionHoverHighlight:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverHighlight",EntityRecognitionHoverTextColor:"--ms-themeColorPaletteAnnotationsEntityRecognitionHoverTextColor",Scrollbar:"--ms-themeColorScrollbar",ScrollbarPressed:"--ms-themeColorScrollbarPressed",HeadingText:"--ms-themeColorHeadingText"}},16281:e=>{"use strict";e.exports=JSON.parse('{"ControlClickToFollowLink":"Ctrl+Click to follow link","ClickToFollowLink":"Click to follow link","GettingThisReady":"Getting this ready...","NewLoopComponentFileName":"Loop component","CalloutTitle":"This is a Loop component","CalloutDescription":"You can edit this directly without sending a reply, and everyone will see changes in real time.","GotIt":"Got it","CustomPermissionsPanelPeopleOutsideWithLinkText_Default":"People outside this message with the link have access","CustomPermissionsPanelSpecificPermissionText_Default":"People in this message have access","CustomPermissionsPanelPeopleOutsideText_Default":"People outside this message have access","CustomPermissionsPanelSomePeopleText_Default":"Some people in this message have access","CustomPermissionsPanelPeopleOutsideWithLinkText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelSpecificPermissionText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelPeopleOutsideText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document.","CustomPermissionsPanelSomePeopleText_OneNote":"People in your organization with the link can edit. Please be cautious if you\'re working on a confidential or highly confidential document."}')},16460:(e,t,r)=>{"use strict";r.d(t,{$R:()=>a,$h:()=>f,D4:()=>i,DP:()=>u,DS:()=>S,ED:()=>p,Lb:()=>s,Md:()=>C,QF:()=>d,U4:()=>h,Vg:()=>T,WU:()=>m,Yz:()=>g,fQ:()=>P,gC:()=>w,gp:()=>l,hj:()=>v,tM:()=>b,us:()=>k});var o=r(6971);class n extends EventTarget{constructor(){super()}}let i=function(e){return e.BackgroundChanged="BackgroundChanged",e.ContentPlayableStateUpdate="ContentPlayableStateUpdate",e.FluidComponentDataSaved="FluidComponentDataSaved",e.FocusEvent="FocusEvent",e.IsContentHeightLimitedChanged="IsContentHeightLimitedChanged",e.LinkPermissionChanged="LinkPermissionChanged",e.LinkProblemStateChanged="LinkProblemStateChanged",e.LinkUrlChanged="LinkUrlChanged",e.ReadOnlyChanged="ReadOnlyChanged",e.RequestDataToSave="RequestDataToSave",e.ShowLoopGlowBorder="ShowLoopGlowBorder",e.ThemeChanged="ThemeChanged",e}({}),s=function(e){return e[e.Unknown=0]="Unknown",e[e.Play=1]="Play",e[e.Pause=2]="Pause",e}({}),a=function(e){return e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error",e}({});const c=new n;async function d(e){const t=await(0,o.E)();if(!t.version)return!1;switch(e){case i.LinkUrlChanged:case i.ThemeChanged:return t.version>=2;case i.LinkPermissionChanged:return t.version>=2&&t.version<=5;case i.LinkProblemStateChanged:return t.version>=5;case i.BackgroundChanged:return t.version>=6;case i.IsContentHeightLimitedChanged:return t.version>=15;case i.RequestDataToSave:case i.FluidComponentDataSaved:return t.version>=16;case i.ShowLoopGlowBorder:return t.version>=20;default:return!1}}function l(e){c.addEventListener(i.BackgroundChanged,e)}function u(e){c.addEventListener(i.ContentPlayableStateUpdate,e)}function h(e){c.addEventListener(i.FluidComponentDataSaved,e)}function g(e){c.removeEventListener(i.FluidComponentDataSaved,e)}function p(e){c.addEventListener(i.IsContentHeightLimitedChanged,e)}function f(e){c.addEventListener(i.LinkPermissionChanged,e)}function m(e){c.addEventListener(i.LinkProblemStateChanged,e)}function v(e){c.addEventListener(i.LinkUrlChanged,e)}function y(e,t){c.dispatchEvent(new CustomEvent(e,{detail:t}))}function b(e){c.addEventListener(i.RequestDataToSave,e)}function S(e){c.removeEventListener(i.RequestDataToSave,e)}function C(e){c.addEventListener(i.ShowLoopGlowBorder,e)}function k(e){c.addEventListener(i.FocusEvent,e)}function w(e){c.addEventListener(i.ReadOnlyChanged,e)}function P(e){c.addEventListener(i.ThemeChanged,e)}function T(){Object.defineProperty(window,"onNativeEvent",{value:y})}},17483:(e,t,r)=>{"use strict";r.d(t,{V:()=>o});const o={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"}},17637:(e,t,r)=>{"use strict";r.d(t,{CL:()=>v,G0:()=>h,Ln:()=>p,fG:()=>f,uz:()=>g});var o=r(27051),n=r(78945),i=r(50178);const s=new n.d(()=>c(u())),a={getRawConfig:()=>{}},c=e=>void 0!==e&&null!==e?new h(void 0,{getRawConfig:t=>{try{var r,o;return null===(r=l(null!==(o=e.getItem(t))&&void 0!==o?o:void 0))||void 0===r?void 0:r.raw}catch(n){return}}}):a;function d(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function l(e){let t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch(i){}if(void 0===r)return t;const n=typeof r;if(d(n))return(0,o.A)((0,o.A)({},t),{},{raw:e,[n]:r});if(Array.isArray(r)){const n=typeof r[0];if(!d(n))return t;for(const e of r)if(typeof e!==n)return t;return(0,o.A)((0,o.A)({},t),{},{raw:e,["".concat(n,"[]")]:r})}return t}const u=()=>{try{var e;return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(t){return}};class h{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=[...o];for(;i.length>0;){const e=i.shift();void 0!==e&&m(e)&&!t.has(e)&&(t.add(e),e instanceof h?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}getStringArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const r of this.orderedBaseProviders){const n=l(null===r||void 0===r?void 0:r.getRawConfig(e));var t;if(void 0!==n)return this.configCache.set(e,n),null===(t=this.logger)||void 0===t||t.send((0,o.A)({category:"generic",eventName:"ConfigRead"},(0,i.Df)({configName:e,configValue:JSON.stringify(n)}))),n}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function g(e){const t=e;return m(null===t||void 0===t?void 0:t.config)&&void 0!==(null===t||void 0===t?void 0:t.logger)}function p(e){return g(e)?e:f(e,s.value)}function f(e){if(g(e))throw new Error("Logger is already a monitoring context");const t=e;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return t.config=new h(e,...o),t.logger=e,t}function m(e){return"function"===typeof(null===e||void 0===e?void 0:e.getRawConfig)}function v(e){return p((0,i.pW)(e))}},18206:(e,t,r)=>{"use strict";r.d(t,{XM:()=>l,fV:()=>h,sG:()=>g,z$:()=>u});var o=r(27051),n=r(93537),i=r(37805),s=r(40635),a=r(74405),c=r(47860),d=r(7621);const l={respectRetryAfterHeader:!0,maxRetries:3,filter:(0,n.sC)([503]),backoffFn:(0,i.Ed)(100)};async function u(e,t,r,o,n,i,s){let a=arguments.length>10?arguments[10]:void 0;return h(e,t,null!==a&&void 0!==a?a:"Production",r,o,n,i,s,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0)}async function h(e,t,r,n,i,d,l,u){let h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,g=arguments.length>9?arguments[9]:void 0,p=arguments.length>10?arguments[10]:void 0;const f={getToken:t=>{if(t)return e(t);throw Error("Options must be specified")},url:t.startsWith("http")?t:"".concat((0,c.o)(r),"/v1.0/").concat(t),tenantId:d,requestInit:l,retryPolicy:u,timeoutMs:h,additionalRequestHeaders:p},m=i&&n?(0,s.g)((0,o.A)((0,o.A)({},f),{},{logger:i,nameForLogging:n,doNotLogOnSuccess:g,getAdditionalProps:async(e,t)=>(0,a.u)(e)})):(0,s.y)(f);return(await m).result}function g(e,t){const r=(0,d.wJ)(e,t);return async function(){const e=await r.get(...arguments);return"number"===typeof e&&200!==e&&404!==e&&r.delete(...arguments),e}}},18731:(e,t,r)=>{"use strict";r.d(t,{kN:()=>i});var o=r(94794),n=r(53783);function i(e){if("object"===typeof e){const t=e;if(function(e){var t;return e.errorType===n.ZY.ContainerUpgradeRequired&&(null===(t=e.error)||void 0===t?void 0:t.name)===n.ZY.ContainerUpgradeRequired}(t))return n.ZY.ContainerUpgradeRequired;if(function(e){return e.errorType===o.D.genericError}(t))return o.D.genericError;if(function(e){return e.errorType===o.D.throttlingError}(t))return o.D.throttlingError;const r=function(e){return Object.values(n.qb).find(t=>t===e.name||t===e.errorType)}(t);if(r)return r}}},19466:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var o=r(3542),n=r(63722),i=r(28205);function s(e){var t=n.nr.getInstance(),r=(0,i.bz)((0,o.Iy)(),e);if(!t.classNameFromKey(r)){var s=t.getClassName();t.insertRule("@font-face{".concat(r,"}"),!0),t.cacheClassName(s,r,[],["font-face",r])}}},19688:(e,t,r)=>{"use strict";var o;r.d(t,{d:()=>o}),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(o||(o={}))},19813:(e,t,r)=>{"use strict";r.d(t,{JL:()=>o,Yr:()=>a,ZJ:()=>s,pU:()=>n,tG:()=>i});var o="@ms/whiteboard-container",n="Whiteboard",i="WhiteboardLoopComponent",s=200,a=600},19984:(e,t,r)=>{"use strict";r.d(t,{MD:()=>s,Yj:()=>i,or:()=>a,wx:()=>c});var o=r(15217),n=r(95663);function i(e){if(null!==e&&"object"===typeof e&&!0===e.errorFromRequestFluidObject){const t=e;return{mimeType:"text/plain",status:t.code,value:t.message,get stack(){return t.stack},headers:t.underlyingResponseHeaders}}const t=(0,n.oD)();return{mimeType:"text/plain",status:500,value:"".concat(e),get stack(){var r;return null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:t.stack}}}function s(e,t){const r=e.value,o=(0,n.oD)();return{errorFromRequestFluidObject:!0,message:r,name:"Error",code:e.status,get stack(){var t;return null!==(t=e.stack)&&void 0!==t?t:o.stack},underlyingResponseHeaders:e.headers}}const a=e=>c(404,"not found",e);function c(e,t,r,i){var s;(0,o.vA)(200!==e,411);const a=null===(s=r.url)||void 0===s?void 0:s.split("?")[0],c=(0,n.oD)();return{mimeType:"text/plain",status:e,value:void 0===a?t:"".concat(t,": ").concat(a),get stack(){return c.stack},headers:i}}},20258:(e,t,r)=>{"use strict";r.d(t,{I:()=>n,d:()=>o});class o{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}class n{get[Symbol.toStringTag](){return"[object LazyPromise]"}constructor(e){this.execute=e}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},20310:(e,t,r)=>{"use strict";r.d(t,{l:()=>o});const o=()=>globalThis.performance.now()},20611:(e,t,r)=>{"use strict";r.d(t,{Pb:()=>o,V$:()=>s,W3:()=>i,o1:()=>n});const o=432e6,n="snapshot",i="snapshotWithLoadingGroupId";function s(e){return"".concat(e.file.docId,"_").concat(e.type,"_").concat(e.key)}},21673:(e,t,r)=>{"use strict";r.d(t,{v:()=>n});var o=r(85038);class n{constructor(e){this.maxRequests=e,this.tasks=[],this.release=()=>{const e=this.tasks.shift();if(void 0!==e)return e();this.maxRequests++},(0,o.vA)(e>0,174)}get waitQueueLength(){return this.tasks.length}async acquire(){if(!(this.maxRequests>0))return new Promise(e=>{this.tasks.push(e)});this.maxRequests--}async schedule(e){return await this.acquire(),e().finally(this.release)}}},21856:(e,t,r)=>{"use strict";r.d(t,{m:()=>O,B:()=>x});var o=r(36294),n=r(27051),i=r(93023),s=r(15217),a=r(77565),c=r(96516),d=r(86748);const l=0,u=1;class h{constructor(e,t){this.compareKeys=e,this.aug=t}makeNode(e,t,r,o){return{key:e,data:t,color:r,size:o}}isRed(e){return!!e&&e.color===l}nodeSize(e){return e?e.size:0}size(){return this.nodeSize(this.root)}isEmpty(){return!this.root}get(e){if(void 0!==e)return this.nodeGet(this.root,e)}nodeGet(e,t){let r=e;for(;r;){const e=this.compareKeys(t,r.key);if(e<0)r=r.left;else{if(!(e>0))return r;r=r.right}}}contains(e){return this.get(e)}gather(e,t){const r=[];return void 0!==e&&this.nodeGather(this.root,r,e,t),r}nodeGather(e,t,r,o){e&&(o.continueSubtree(e.left,r)&&this.nodeGather(e.left,t,r,o),o.matchNode(e,r)&&t.push(e),o.continueSubtree(e.right,r)&&this.nodeGather(e.right,t,r,o))}walkExactMatchesForward(e,t,r,o){this.nodeWalkExactMatchesForward(this.root,e,t,r,o)}nodeWalkExactMatchesForward(e,t,r,o,n){if(!e)return;const i=t(e);o(i)&&this.nodeWalkExactMatchesForward(e.left,t,r,o,n),0===i&&r(e),n(i)&&this.nodeWalkExactMatchesForward(e.right,t,r,o,n)}walkExactMatchesBackward(e,t,r,o){this.nodeWalkExactMatchesBackward(this.root,e,t,r,o)}nodeWalkExactMatchesBackward(e,t,r,o,n){if(!e)return;const i=t(e);n(i)&&this.nodeWalkExactMatchesBackward(e.right,t,r,o,n),0===i&&r(e),o(i)&&this.nodeWalkExactMatchesBackward(e.left,t,r,o,n)}put(e,t,r){void 0!==e&&(void 0===t?this.remove(e):(this.root=this.nodePut(this.root,e,t,r),this.root.color=u))}nodePut(e,t,r,o){let n=e;if(n){const e=this.compareKeys(t,n.key);if(e<0)n.left=this.nodePut(n.left,t,r,o);else if(e>0)n.right=this.nodePut(n.right,t,r,o);else if(o){var i;const e=o(t,n.key,r,n.data);e.key&&(n.key=e.key),n.data=null!==(i=e.data)&&void 0!==i?i:r}else n.data=r;return this.isRed(n.right)&&!this.isRed(n.left)&&(n=this.rotateLeft(n)),this.isRed(n.left)&&this.isRed(n.left.left)&&(n=this.rotateRight(n)),this.isRed(n.left)&&this.isRed(n.right)&&this.flipColors(n),n.size=this.nodeSize(n.left)+this.nodeSize(n.right)+1,this.aug&&this.updateLocal(n),n}return this.makeNode(t,r,l,1)}updateLocal(e){this.aug&&(this.isRed(e.left)&&this.aug.update(e.left),this.isRed(e.right)&&this.aug.update(e.right),this.aug.update(e))}nodeRemoveMin(e){let t=e;if(t.left)return this.isRed(t.left)||this.isRed(t.left.left)||(t=this.moveRedLeft(t)),t.left=this.nodeRemoveMin(t.left),this.balance(t)}remove(e){if(void 0!==e){if(!this.contains(e))return;this.removeExisting(e)}}removeExisting(e){this.isRed(this.root.left)||this.isRed(this.root.right)||(this.root.color=l),this.root=this.nodeRemove(this.root,e)}nodeRemove(e,t){let r=e;if(this.compareKeys(t,r.key)<0)this.isRed(r.left)||this.isRed(r.left.left)||(r=this.moveRedLeft(r)),r.left=this.nodeRemove(r.left,t);else{if(this.isRed(r.left)&&(r=this.rotateRight(r)),0===this.compareKeys(t,r.key)&&!r.right)return;if(this.isRed(r.right)||this.isRed(r.right.left)||(r=this.moveRedRight(r)),0===this.compareKeys(t,r.key)){const e=this.nodeMin(r.right);r.key=e.key,r.data=e.data,r.right=this.nodeRemoveMin(r.right)}else r.right=this.nodeRemove(r.right,t)}return this.balance(r)}floor(e){if(!this.isEmpty())return this.nodeFloor(this.root,e)}nodeFloor(e,t){if(e){const r=this.compareKeys(t,e.key);if(0===r)return e;if(r<0)return this.nodeFloor(e.left,t);{const r=this.nodeFloor(e.right,t);return null!==r&&void 0!==r?r:e}}}ceil(e){if(!this.isEmpty())return this.nodeCeil(this.root,e)}nodeCeil(e,t){if(e){const r=this.compareKeys(t,e.key);if(0===r)return e;if(r>0)return this.nodeCeil(e.right,t);{const r=this.nodeCeil(e.left,t);return null!==r&&void 0!==r?r:e}}}min(){if(this.root)return this.nodeMin(this.root)}nodeMin(e){return e.left?this.nodeMin(e.left):e}max(){if(this.root)return this.nodeMax(this.root)}nodeMax(e){return e.right?this.nodeMax(e.right):e}rotateRight(e){const t=e.left;return e.left=t.right,t.right=e,t.color=t.right.color,t.right.color=l,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}rotateLeft(e){const t=e.right;return e.right=t.left,t.left=e,t.color=t.left.color,t.left.color=l,t.size=e.size,e.size=this.nodeSize(e.left)+this.nodeSize(e.right)+1,this.aug&&(this.updateLocal(e),this.updateLocal(t)),t}oppositeColor(e){return e===u?l:u}flipColors(e){e.color=this.oppositeColor(e.color),e.left.color=this.oppositeColor(e.left.color),e.right.color=this.oppositeColor(e.right.color)}moveRedLeft(e){let t=e;return this.flipColors(t),this.isRed(t.right.left)&&(t.right=this.rotateRight(t.right),t=this.rotateLeft(t),this.flipColors(t)),t}moveRedRight(e){let t=e;return this.flipColors(t),this.isRed(t.left.left)&&(t=this.rotateRight(t),this.flipColors(t)),t}balance(e){let t=e;return this.isRed(t.right)&&(t=this.rotateLeft(t)),this.isRed(t.left)&&this.isRed(t.left.left)&&(t=this.rotateRight(t)),this.isRed(t.left)&&this.isRed(t.right)&&this.flipColors(t),t.size=this.nodeSize(t.left)+this.nodeSize(t.right)+1,this.aug&&this.aug.update(t),t}mapRange(e,t,r,o){this.nodeMap(this.root,e,t,r,o)}map(e,t){this.nodeMap(this.root,e,t)}keys(){const e=[],t={showStructure:!0,infix:t=>(e.push(t.key),!0)};return this.walk(t),e}walk(e){this.nodeWalk(this.root,e)}walkBackward(e){this.nodeWalkBackward(this.root,e)}nodeWalk(e,t){let r=!0;return e&&(t.pre&&(t.showStructure||e.color===u)&&(r=t.pre(e)),e.left&&(r=this.nodeWalk(e.left,t)),r&&t.infix&&(t.showStructure||e.color===u)&&(r=t.infix(e)),r&&(r=this.nodeWalk(e.right,t)),r&&t.post&&(t.showStructure||e.color===u)&&(r=t.post(e))),r}nodeWalkBackward(e,t){let r=!0;return e&&(t.pre&&(t.showStructure||e.color===u)&&(r=t.pre(e)),e.right&&(r=this.nodeWalkBackward(e.right,t)),r&&t.infix&&(t.showStructure||e.color===u)&&(r=t.infix(e)),r&&(r=this.nodeWalkBackward(e.left,t)),r&&t.post&&(t.showStructure||e.color===u)&&(r=t.post(e))),r}nodeMap(e,t,r,o,n){let i=o,s=n;if(!e)return!0;void 0===i&&(i=this.nodeMin(e).key),void 0===s&&(s=this.nodeMax(e).key);const a=this.compareKeys(i,e.key),c=this.compareKeys(s,e.key);let d=!0;return a<0&&(d=this.nodeMap(e.left,t,r,i,s)),d&&a<=0&&c>=0&&(d=t(e,r)),d&&c>0&&(d=this.nodeMap(e.right,t,r,i,s)),d}}var g,p,f=r(52389),m=r(16026),v=r(11502),y=r(39773),b=r(53316),S=r(55651);const C=b.posix,k="header",w=(e,t)=>P(e)?P(t)?e.seq===t.seq?e.clientSeq-t.clientSeq:e.seq-t.seq:-1:P(t)?1:e.seq===t.seq?e.clientSeq-t.clientSeq:e.seq-t.seq;function P(e){return e.seq>=0}class T{constructor(){this.indexToKey=new h(w),this.keyToIndex=new Map}set(e,t){this.indexToKey.put(t,e),this.keyToIndex.set(e,t)}has(e){return"string"===typeof e?this.keyToIndex.has(e):void 0!==this.indexToKey.get(e)}delete(e){if(this.has(e))if("string"===typeof e){const t=this.keyToIndex.get(e);this.keyToIndex.delete(e),this.indexToKey.remove(t)}else{var t;const r=null===(t=this.indexToKey.get(e))||void 0===t?void 0:t.data;this.indexToKey.remove(e),this.keyToIndex.delete(r)}}keys(e){const t=[];return this.indexToKey.mapRange(r=>(e&&!e(r.data)||t.push(r.data),!0),t),t}get size(){return this.keyToIndex.size}}class E extends o.T6{get absolutePath(){return this.root.absolutePath}constructor(e,t,r){super(e,t,r,"fluid_directory_"),this[g]="SharedDirectory",this.root=new B({seq:0,clientSeq:0},new Set,this,this.runtime,this.serializer,C.sep,this.logger),this.messageHandlers=new Map,this.setMessageHandlers(),this.root.on("containedValueChanged",(e,t)=>{this.emit("containedValueChanged",e,t,this)}),this.root.on("subDirectoryCreated",(e,t)=>{this.emit("subDirectoryCreated",e,t,this)}),this.root.on("subDirectoryDeleted",(e,t)=>{this.emit("subDirectoryDeleted",e,t,this)})}get(e){return this.root.get(e)}set(e,t){return this.root.set(e,t),this}dispose(e){this.root.dispose(e)}get disposed(){return this.root.disposed}delete(e){return this.root.delete(e)}clear(){this.root.clear()}has(e){return this.root.has(e)}get size(){return this.root.size}forEach(e){this.root.forEach(e)}[(g=Symbol.toStringTag,Symbol.iterator)](){return this.root[Symbol.iterator]()}entries(){return this.root.entries()}countSubDirectory(){return this.root.countSubDirectory()}keys(){return this.root.keys()}values(){return this.root.values()}createSubDirectory(e){return this.root.createSubDirectory(e)}getSubDirectory(e){return this.root.getSubDirectory(e)}hasSubDirectory(e){return this.root.hasSubDirectory(e)}deleteSubDirectory(e){return this.root.deleteSubDirectory(e)}subdirectories(){return this.root.subdirectories()}getWorkingDirectory(e){const t=this.makeAbsolute(e);if(t===C.sep)return this.root;let r=this.root;const o=t.slice(1).split(C.sep);for(const n of o)if(r=r.getSubDirectory(n),!r)return;return r}summarizeCore(e,t){return this.serializeDirectory(this.root,e)}submitDirectoryMessage(e,t){this.submitLocalMessage(e,t)}onDisconnect(){}reSubmitCore(e,t){const r=e,o=this.messageHandlers.get(r.type);(0,s.vA)(void 0!==o,13),o.submit(r,t)}async loadCore(e){const t=await(0,d.P)(e,k),r=t;if(Array.isArray(r.blobs)){this.populate(r.content);const t=await Promise.all(r.blobs.map(async t=>(0,d.P)(e,t)));for(const e of t)this.populate(e)}else this.populate(t)}populate(e){const t=[];for(t.push([this.root,e]);t.length>0;){const[e,r]=t.pop();if(r.subdirectories){const o=new Map;for(const[i,s]of Object.entries(r.subdirectories)){let r,a=e.getSubDirectory(i);if(!a){const t=s.ci;if(void 0!==t&&t.csn>0){o.has(t.csn)||o.set(t.csn,0);let e=o.get(t.csn);r={seq:t.csn,clientSeq:e},o.set(t.csn,++e)}else r={seq:0,clientSeq:++e.localCreationSeq};a=new B(r,void 0===t?new Set:new Set(t.ccIds),this,this.runtime,this.serializer,C.join(e.absolutePath,i),this.logger),e.populateSubDirectory(i,a),e.ackedCreationSeqTracker.set(i,(0,n.A)({},r))}t.push([a,s])}}if(r.storage)for(const[t,o]of Object.entries(r.storage)){const r=(0,m.Zb)(o,this.serializer);(0,S.R)(r,this.serializer,this.handle),e.populateStorage(t,r.value)}}}processCore(e,t,r){if(e.type===c.Go.Operation){const o=e.contents,n=this.messageHandlers.get(o.type);(0,s.vA)(void 0!==n,14),n.process(e,o,t,r)}}rollback(e,t){const r=e,o=this.getWorkingDirectory(r.path);o&&o.rollback(r,t)}makeAbsolute(e){return C.resolve(C.sep,e)}isSubDirectoryDeletePending(e){const t=this.makeAbsolute(e);if(t===C.sep)return!1;let r=this.root;const o=t.split(C.sep).slice(1);for(const n of o){if(r.isSubDirectoryDeletePending(n))return!0;if(r=r.getSubDirectory(n),void 0===r)return!0}return!1}setMessageHandlers(){this.messageHandlers.set("clear",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processClearMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitClearMessage(e,t)}}),this.messageHandlers.set("delete",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processDeleteMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("set",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);if(n&&!this.isSubDirectoryDeletePending(t.path)){(0,S.R)(t.value,this.serializer,this.handle);const i=r?void 0:{value:t.value.value};n.processSetMessage(e,t,i,r,o)}},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitKeyMessage(e,t)}}),this.messageHandlers.set("createSubDirectory",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processCreateSubDirectoryMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}}),this.messageHandlers.set("deleteSubDirectory",{process:(e,t,r,o)=>{const n=this.getWorkingDirectory(t.path);n&&!this.isSubDirectoryDeletePending(t.path)&&n.processDeleteSubDirectoryMessage(e,t,r,o)},submit:(e,t)=>{const r=this.getWorkingDirectory(e.path);r&&r.resubmitSubDirectoryMessage(e,t)}})}applyStashedOp(e){const t=e,r=this.getWorkingDirectory(t.path);switch(t.type){case"clear":null===r||void 0===r||r.clear();break;case"createSubDirectory":null===r||void 0===r||r.createSubDirectory(t.subdirName);break;case"delete":null===r||void 0===r||r.delete(t.key);break;case"deleteSubDirectory":null===r||void 0===r||r.deleteSubDirectory(t.subdirName);break;case"set":(0,S.R)(t.value,this.serializer,this.handle),null===r||void 0===r||r.set(t.key,t.value.value);break;default:(0,a.$)(t)}}serializeDirectory(e,t,r){const o=new f.qt;let n=0;const i=[],s=[],a={};for(s.push([e,a]);s.length>0;){const[e,r]=s.pop();r.ci=e.getSerializableCreateInfo();for(const[s,a]of e.getSerializedStorage(t)){r.storage||(r.storage={});const t={type:a.type,value:a.value&&JSON.parse(a.value)};if(a.value&&a.value.length>=8192){const r={};let a=r;if(e.absolutePath!==C.sep)for(const t of e.absolutePath.slice(1).split(C.sep)){const e={};a.subdirectories={[t]:e},a=e}a.storage={[s]:t};const c="blob".concat(n);n++,i.push(c),o.addBlob(c,JSON.stringify(r))}else r.storage[s]=t}for(const[t,o]of e.subdirectories()){r.subdirectories||(r.subdirectories={});const e={};r.subdirectories[t]=e,s.push([o,e])}}const c={blobs:i,content:a};return o.addBlob(k,JSON.stringify(c)),o.getSummaryTree()}}function I(e){return void 0!==e&&"number"===typeof e.pendingMessageId&&"edit"===e.type}function N(e){return void 0!==e&&"clear"===e.type&&"number"===typeof e.pendingMessageId&&"object"===typeof e.previousStorage}function A(e){return void 0!==e&&("createSubDir"===e.type||"deleteSubDir"===e.type)}function F(e){(0,s.vA)(null!==e,1711)}let D=!1;class B extends i.X{constructor(e,t,r,o,n,i,s){super(),this.seqData=e,this.clientIds=t,this.directory=r,this.runtime=o,this.serializer=n,this.absolutePath=i,this.logger=s,this._deleted=!1,this[p]="SubDirectory",this._storage=new Map,this._subdirectories=new Map,this.pendingKeys=new Map,this.pendingDeleteSubDirectoriesTracker=new Map,this.pendingCreateSubDirectoriesTracker=new Map,this.pendingMessageId=-1,this.pendingClearMessageIds=[],this.localCreationSeq=0,this.localCreationSeqTracker=new T,this.ackedCreationSeqTracker=new T}dispose(e){this._deleted=!0,this.emit("disposed",this)}undispose(){this._deleted=!1,this.emit("undisposed",this)}get disposed(){return this._deleted}throwIfDisposed(){if(this._deleted)throw new y.eb("Cannot access Disposed subDirectory")}has(e){return this.throwIfDisposed(),this._storage.has(e)}get(e){var t;return this.throwIfDisposed(),null===(t=this._storage.get(e))||void 0===t?void 0:t.value}set(e,t){if(this.throwIfDisposed(),void 0===e||null===e)throw new Error("Undefined and null keys are not supported");const r={value:t};(0,m.pM)(r,this.serializer,this.directory.handle);const o=this.setCore(e,r,!0);if(!this.directory.isAttached())return this;const n={key:e,path:this.absolutePath,type:"set",value:{type:v.e[v.e.Plain],value:r.value}};return this.submitKeyMessage(n,o),this}countSubDirectory(){return this._subdirectories.size}createSubDirectory(e){var t;if(this.throwIfDisposed(),void 0===e||null===e)throw new Error("SubDirectory name may not be undefined or null");if(e.includes(C.sep))throw new Error("SubDirectory name may not contain ".concat(C.sep));const r=this.createSubDirectoryCore(e,!0,this.getLocalSeq(),null!==(t=this.runtime.clientId)&&void 0!==t?t:"detached"),o=this._subdirectories.get(e);if((0,s.vA)(void 0!==o,1450),!this.directory.isAttached())return o;if(r){const t={path:this.absolutePath,subdirName:e,type:"createSubDirectory"};this.submitCreateSubDirectoryMessage(t)}return o}getLocalSeq(){return this.directory.isAttached()?{seq:-1,clientSeq:++this.localCreationSeq}:{seq:0,clientSeq:++this.localCreationSeq}}getSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.get(e)}hasSubDirectory(e){return this.throwIfDisposed(),this._subdirectories.has(e)}deleteSubDirectory(e){this.throwIfDisposed();const t=this.deleteSubDirectoryCore(e,!0);if(!this.directory.isAttached())return void 0!==t;if(void 0!==t){const r={path:this.absolutePath,subdirName:e,type:"deleteSubDirectory"};this.submitDeleteSubDirectoryMessage(r,t)}return void 0!==t}subdirectories(){this.throwIfDisposed();const e=[...this.ackedCreationSeqTracker.keys(),...this.localCreationSeqTracker.keys(e=>!this.ackedCreationSeqTracker.has(e))];if(e.length!==this._subdirectories.size)return D||(this.logger.sendTelemetryEvent({eventName:"inconsistentSubdirectoryOrdering",localKeyCount:this.localCreationSeqTracker.size,ackedKeyCount:this.ackedCreationSeqTracker.size,subdirNamesLength:e.length,subdirectoriesSize:this._subdirectories.size}),D=!0),this._subdirectories.entries();return{index:0,dirs:this._subdirectories,next(){if(this.index<e.length){const t=e[this.index++],r=this.dirs.get(t);return(0,s.vA)(void 0!==r,2220),{value:[t,r],done:!1}}return{value:void 0,done:!0}},[Symbol.iterator](){return this}}}getWorkingDirectory(e){return this.throwIfDisposed(),this.directory.getWorkingDirectory(this.makeAbsolute(e))}isSubDirectoryDeletePending(e){return!!this.pendingDeleteSubDirectoriesTracker.has(e)}delete(e){this.throwIfDisposed();const t=this.deleteCore(e,!0);if(!this.directory.isAttached())return void 0!==t;const r={key:e,path:this.absolutePath,type:"delete"};return this.submitKeyMessage(r,t),void 0!==t}clear(){if(this.throwIfDisposed(),!this.directory.isAttached())return void this.clearCore(!0);const e=new Map(this._storage);this.clearCore(!0);const t={path:this.absolutePath,type:"clear"};this.submitClearMessage(t,e)}forEach(e){this.throwIfDisposed(),this._storage.forEach((t,r,o)=>{e(t.value,r,o)})}get size(){return this.throwIfDisposed(),this._storage.size}entries(){this.throwIfDisposed();const e=this._storage.entries();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:[t.value[0],t.value[1].value],done:!1}},[Symbol.iterator](){return this}}}keys(){return this.throwIfDisposed(),this._storage.keys()}values(){this.throwIfDisposed();const e=this._storage.values();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:t.value.value,done:!1}},[Symbol.iterator](){return this}}}[(p=Symbol.toStringTag,Symbol.iterator)](){return this.throwIfDisposed(),this.entries()}processClearMessage(e,t,r,o){if(this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)){if(r){(0,s.vA)(N(o),15);const e=this.pendingClearMessageIds.shift();return void(0,s.vA)(e===o.pendingMessageId,810)}this.clearExceptPendingKeys(!1)}}processDeleteMessage(e,t,r,o){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessStorageOperation(t,r,o)&&this.deleteCore(t.key,r)}processSetMessage(e,t,r,o,n){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessStorageOperation(t,o,n)&&this.setCore(t.key,r,o)}processCreateSubDirectoryMessage(e,t,r,o){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessSubDirectoryOperation(e,t,r,o)&&(F(e.clientId),this.createSubDirectoryCore(t.subdirName,r,{seq:e.sequenceNumber,clientSeq:e.clientSequenceNumber},e.clientId))}processDeleteSubDirectoryMessage(e,t,r,o){this.throwIfDisposed(),this.isMessageForCurrentInstanceOfSubDirectory(e)&&this.needProcessSubDirectoryOperation(e,t,r,o)&&this.deleteSubDirectoryCore(t.subdirName,r)}submitClearMessage(e,t){this.throwIfDisposed();const r=++this.pendingMessageId;this.pendingClearMessageIds.push(r);const o={type:"clear",pendingMessageId:r,previousStorage:t};this.directory.submitDirectoryMessage(e,o)}resubmitClearMessage(e,t){(0,s.vA)(N(t),811);this.pendingClearMessageIds.shift()===t.pendingMessageId&&this.submitClearMessage(e,t.previousStorage)}getKeyMessageId(e){const t=++this.pendingMessageId,r=this.pendingKeys.get(e.key);return void 0===r?this.pendingKeys.set(e.key,[t]):r.push(t),t}submitKeyMessage(e,t){this.throwIfDisposed();const r={type:"edit",pendingMessageId:this.getKeyMessageId(e),previousValue:t};this.directory.submitDirectoryMessage(e,r)}resubmitKeyMessage(e,t){(0,s.vA)(I(t),813);const r=this.pendingKeys.get(e.key);if(void 0!==r){const o=r.indexOf(t.pendingMessageId);if(-1===o)return;r.splice(o,1),0===r.length&&this.pendingKeys.delete(e.key),this.submitKeyMessage(e,t.previousValue)}}incrementPendingSubDirCount(e,t){var r;const o=null!==(r=e.get(t))&&void 0!==r?r:0;e.set(t,o+1)}decrementPendingSubDirCount(e,t){var r;const o=null!==(r=e.get(t))&&void 0!==r?r:0;e.set(t,o-1),o<=1&&e.delete(t)}updatePendingSubDirMessageCount(e){"deleteSubDirectory"===e.type?this.incrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,e.subdirName):"createSubDirectory"===e.type&&this.incrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,e.subdirName)}submitCreateSubDirectoryMessage(e){this.throwIfDisposed(),this.updatePendingSubDirMessageCount(e);this.directory.submitDirectoryMessage(e,{type:"createSubDir"})}submitDeleteSubDirectoryMessage(e,t){this.throwIfDisposed(),this.updatePendingSubDirMessageCount(e);const r={type:"deleteSubDir",subDirectory:t};this.directory.submitDirectoryMessage(e,r)}resubmitSubDirectoryMessage(e,t){(0,s.vA)(A(t),815),("createSubDir"!==t.type||this.pendingCreateSubDirectoriesTracker.has(e.subdirName))&&("deleteSubDir"!==t.type||this.pendingDeleteSubDirectoriesTracker.has(e.subdirName))&&("createSubDir"===t.type?(this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,e.subdirName),this.submitCreateSubDirectoryMessage(e)):(this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,e.subdirName),this.submitDeleteSubDirectoryMessage(e,t.subDirectory)))}*getSerializedStorage(e){this.throwIfDisposed();for(const[t,r]of this._storage){const o=[t,(0,S.Q)(r.value,e,this.directory.handle)];yield o}}getSerializableCreateInfo(){this.throwIfDisposed();return{csn:this.seqData.seq,ccIds:[...this.clientIds]}}populateStorage(e,t){this.throwIfDisposed(),this._storage.set(e,{value:t})}populateSubDirectory(e,t){this.throwIfDisposed(),this.registerEventsOnSubDirectory(t,e),this._subdirectories.set(e,t)}getLocalValue(e){return this.throwIfDisposed(),this._storage.get(e)}rollbackPendingMessageId(e,t,r){const o=e.get(t),n=null===o||void 0===o?void 0:o.pop();if(!o||n!==r)throw new Error("Rollback op does not match last pending");0===o.length&&e.delete(t)}rollback(e,t){if(!(I(r=t)||N(r)||A(r)))throw new Error("Invalid localOpMetadata");var r;if("clear"===e.type&&"clear"===t.type){for(const[r,o]of t.previousStorage.entries())this.setCore(r,o,!0);const e=this.pendingClearMessageIds.pop();if(void 0===e||e!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else if("delete"!==e.type&&"set"!==e.type||"edit"!==t.type)if("createSubDirectory"===e.type&&"createSubDir"===t.type){const t=e.subdirName;(0,s.vA)(void 0!==t,2223),(0,s.vA)("string"===typeof t,2224),this.deleteSubDirectoryCore(t,!0),this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,t)}else{if("deleteSubDirectory"!==e.type||"deleteSubDir"!==t.type)throw new Error("Unsupported op for rollback");{const r=e.subdirName;(0,s.vA)(void 0!==r,2225),(0,s.vA)("string"===typeof r,2226),void 0!==t.subDirectory&&(this.undeleteSubDirectoryTree(t.subDirectory),this._subdirectories.set(r,t.subDirectory),P(t.subDirectory.seqData)?this.ackedCreationSeqTracker.set(r,(0,n.A)({},t.subDirectory.seqData)):this.localCreationSeqTracker.set(r,(0,n.A)({},t.subDirectory.seqData)),this.emit("subDirectoryCreated",r,!0,this)),this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,r)}}else{const r=e.key;(0,s.vA)(void 0!==r,2221),(0,s.vA)("string"===typeof r,2222),void 0===t.previousValue?this.deleteCore(r,!0):this.setCore(r,t.previousValue,!0),this.rollbackPendingMessageId(this.pendingKeys,r,t.pendingMessageId)}}makeAbsolute(e){return C.resolve(this.absolutePath,e)}needProcessStorageOperation(e,t,r){const o=this.pendingClearMessageIds[0];if(void 0!==o){if(t){(0,s.vA)(void 0!==r&&I(r)&&r.pendingMessageId<o,16);const t=o,n=this.pendingKeys.get(e.key);if(void 0!==n){let r=0,o=n[r];for(;void 0!==o&&o<t;)r+=1,o=n[r];const i=n.splice(r);0===i.length?this.pendingKeys.delete(e.key):this.pendingKeys.set(e.key,i)}}return!1}const n=this.pendingKeys.get(e.key);return void 0!==n?(t&&((0,s.vA)(void 0!==r&&I(r),17),n[0]!==r.pendingMessageId&&this.logger.sendTelemetryEvent({eventName:"unexpectedPendingMessage",expectedPendingMessage:n[0],actualPendingMessage:r.pendingMessageId,expectedPendingMessagesLength:n.length}),n.shift(),0===n.length&&this.pendingKeys.delete(e.key)),!1):!t}isMessageForCurrentInstanceOfSubDirectory(e){return null!==e.clientId&&this.clientIds.has(e.clientId)||this.clientIds.has("detached")||-1!==this.seqData.seq&&this.seqData.seq<=e.referenceSequenceNumber}needProcessSubDirectoryOperation(e,t,r,o){F(e.clientId);const n=this.pendingDeleteSubDirectoriesTracker.get(t.subdirName),i=this.pendingCreateSubDirectoriesTracker.get(t.subdirName);if(void 0!==n&&n>0||void 0!==i&&i>0){if(r&&((0,s.vA)(A(o),18),"deleteSubDir"===o.type?((0,s.vA)(void 0!==n&&n>0,1730),this.decrementPendingSubDirCount(this.pendingDeleteSubDirectoriesTracker,t.subdirName)):"createSubDir"===o.type&&((0,s.vA)(void 0!==i&&i>0,1731),this.decrementPendingSubDirCount(this.pendingCreateSubDirectoriesTracker,t.subdirName))),"deleteSubDirectory"===t.type){const e=t=>{if(!t)return;t.clearExceptPendingKeys(r),t.seqData.seq=-1,t.seqData.clientSeq=-1,t.clientIds.clear();const o=t.subdirectories();for(const[r,n]of o)t.pendingCreateSubDirectoriesTracker.has(r)?e(n):t.deleteSubDirectoryCore(r,!1)},o=this._subdirectories.get(t.subdirName);this.ackedCreationSeqTracker.delete(t.subdirName),e(o)}if("createSubDirectory"===t.type){const o=this._subdirectories.get(t.subdirName);-1!==this.seqData.seq&&this.seqData.seq<=e.sequenceNumber&&(-1===(null===o||void 0===o?void 0:o.seqData.seq)&&(o.seqData.seq=e.sequenceNumber,o.seqData.clientSeq=e.clientSequenceNumber,this.ackedCreationSeqTracker.has(t.subdirName)||this.pendingDeleteSubDirectoriesTracker.has(t.subdirName)||(this.ackedCreationSeqTracker.set(t.subdirName,{seq:e.sequenceNumber,clientSeq:e.clientSequenceNumber}),r&&this.localCreationSeqTracker.delete(t.subdirName))),void 0!==o&&!o.clientIds.has(e.clientId)&&o.seqData.seq<=e.sequenceNumber&&o.clientIds.add(e.clientId))}return!1}return!r}clearExceptPendingKeys(e){const t=new Map;for(const[r]of this.pendingKeys){const e=this._storage.get(r);void 0!==e&&t.set(r,e)}this.clearCore(e);for(const[r,o]of t.entries())this.setCore(r,o,!0)}clearCore(e){this._storage.clear(),this.directory.emit("clear",e,this.directory)}deleteCore(e,t){const r=this._storage.get(e),o=null===r||void 0===r?void 0:r.value;if(this._storage.delete(e)){const r={key:e,path:this.absolutePath,previousValue:o};this.directory.emit("valueChanged",r,t,this.directory);const n={key:e,previousValue:o};this.emit("containedValueChanged",n,t,this)}return r}setCore(e,t,r){const o=this._storage.get(e),n=null===o||void 0===o?void 0:o.value;this._storage.set(e,t);const i={key:e,path:this.absolutePath,previousValue:n};this.directory.emit("valueChanged",i,r,this.directory);const s={key:e,previousValue:n};return this.emit("containedValueChanged",s,r,this),o}createSubDirectoryCore(e,t,r,o){const i=this._subdirectories.get(e);if(void 0===i){const i=C.join(this.absolutePath,e),s=new B((0,n.A)({},r),new Set([o]),this.directory,this.runtime,this.serializer,i,this.logger);return P(r)?this.ackedCreationSeqTracker.set(e,(0,n.A)({},r)):this.localCreationSeqTracker.set(e,(0,n.A)({},r)),this.registerEventsOnSubDirectory(s,e),this._subdirectories.set(e,s),this.emit("subDirectoryCreated",e,t,this),!0}return i.clientIds.add(o),!1}registerEventsOnSubDirectory(e,t){e.on("subDirectoryCreated",(e,r)=>{this.emit("subDirectoryCreated",C.join(t,e),r,this)}),e.on("subDirectoryDeleted",(e,r)=>{this.emit("subDirectoryDeleted",C.join(t,e),r,this)})}deleteSubDirectoryCore(e,t){const r=this._subdirectories.get(e);return void 0!==r&&(this._subdirectories.delete(e),this.ackedCreationSeqTracker.has(e)&&this.ackedCreationSeqTracker.delete(e),this.localCreationSeqTracker.has(e)&&this.localCreationSeqTracker.delete(e),this.disposeSubDirectoryTree(r),this.emit("subDirectoryDeleted",e,t,this)),r}disposeSubDirectoryTree(e){if(!e)return;const t=e.subdirectories();for(const[r,o]of t)this.disposeSubDirectoryTree(o);"function"===typeof e.dispose&&e.dispose()}undeleteSubDirectoryTree(e){e.undispose();for(const[t,r]of e.subdirectories())this.undeleteSubDirectoryTree(r)}}var L=r(90876);class O{get type(){return O.Type}get attributes(){return O.Attributes}async load(e,t,r,o){const n=new E(t,e,o);return await n.load(r),n}create(e,t){const r=new E(t,e,O.Attributes);return r.initializeLocal(),r}}O.Type="https://graph.microsoft.com/types/directory",O.Attributes={type:O.Type,snapshotFormatVersion:"0.1",packageVersion:L.z};const x=(0,o.Bm)(O)},22751:(e,t,r)=>{"use strict";r.d(t,{a:()=>k});var o={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"},n=r(46851),i={elevation4:n.f.depth4,elevation8:n.f.depth8,elevation16:n.f.depth16,elevation64:n.f.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},s=r(19466),a=r(53815),c="'Segoe UI', '".concat(a.Dn.WestEuropean,"'"),d={ar:a.bi.Arabic,bg:a.bi.Cyrillic,cs:a.bi.EastEuropean,el:a.bi.Greek,et:a.bi.EastEuropean,he:a.bi.Hebrew,hi:a.bi.Hindi,hr:a.bi.EastEuropean,hu:a.bi.EastEuropean,ja:a.bi.Japanese,kk:a.bi.EastEuropean,ko:a.bi.Korean,lt:a.bi.EastEuropean,lv:a.bi.EastEuropean,pl:a.bi.EastEuropean,ru:a.bi.Cyrillic,sk:a.bi.EastEuropean,"sr-latn":a.bi.EastEuropean,th:a.bi.Thai,tr:a.bi.EastEuropean,uk:a.bi.Cyrillic,vi:a.bi.Vietnamese,"zh-hans":a.bi.ChineseSimplified,"zh-hant":a.bi.ChineseTraditional,hy:a.bi.Armenian,ka:a.bi.Georgian};function l(e,t,r){return{fontFamily:r,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var u=r(48717),h=r(44828);var g,p=r(13290),f="language";var m=function(e){var t=function(e){for(var t in d)if(d.hasOwnProperty(t)&&e&&0===t.indexOf(e))return d[t];return c}(e),r="".concat(t,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif");return{tiny:l(a.s.mini,a.BO.regular,r),xSmall:l(a.s.xSmall,a.BO.regular,r),small:l(a.s.small,a.BO.regular,r),smallPlus:l(a.s.smallPlus,a.BO.regular,r),medium:l(a.s.medium,a.BO.regular,r),mediumPlus:l(a.s.mediumPlus,a.BO.regular,r),large:l(a.s.large,a.BO.regular,r),xLarge:l(a.s.xLarge,a.BO.semibold,r),xLargePlus:l(a.s.xLargePlus,a.BO.semibold,r),xxLarge:l(a.s.xxLarge,a.BO.semibold,r),xxLargePlus:l(a.s.xxLargePlus,a.BO.semibold,r),superLarge:l(a.s.superLarge,a.BO.semibold,r),mega:l(a.s.mega,a.BO.semibold,r)}}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===g){var t=(0,u.Y)(),r="localStorage"===e?function(e){var t=null;try{var r=(0,h.z)();t=r?r.localStorage.getItem(e):null}catch(o){}return t}(f):"sessionStorage"===e?p.G(f):void 0;r&&(g=r),void 0===g&&t&&(g=t.documentElement.getAttribute("lang")),void 0===g&&(g="en")}return g}());function v(e,t,r,o){e="'".concat(e,"'");var n=void 0!==o?"local('".concat(o,"'),"):"";(0,s.n)({fontFamily:e,src:n+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:r,fontStyle:"normal",fontDisplay:"swap"})}function y(e,t,r,o,n){void 0===o&&(o="segoeui");var i="".concat(e,"/").concat(r,"/").concat(o);v(t,i+"-light",a.BO.light,n&&n+" Light"),v(t,i+"-semilight",a.BO.semilight,n&&n+" SemiLight"),v(t,i+"-regular",a.BO.regular,n),v(t,i+"-semibold",a.BO.semibold,n&&n+" SemiBold"),v(t,i+"-bold",a.BO.bold,n&&n+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");y(t,a.Dn.Thai,"leelawadeeui-thai","leelawadeeui"),y(t,a.Dn.Arabic,"segoeui-arabic"),y(t,a.Dn.Cyrillic,"segoeui-cyrillic"),y(t,a.Dn.EastEuropean,"segoeui-easteuropean"),y(t,a.Dn.Greek,"segoeui-greek"),y(t,a.Dn.Hebrew,"segoeui-hebrew"),y(t,a.Dn.Vietnamese,"segoeui-vietnamese"),y(t,a.Dn.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),y(t,a.bi.Selawik,"selawik","selawik"),y(t,a.Dn.Armenian,"segoeui-armenian"),y(t,a.Dn.Georgian,"segoeui-georgian"),v("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),a.BO.light),v("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),a.BO.semibold)}}(function(){var e,t,r=null===(e=(0,h.z)())||void 0===e?void 0:e.FabricConfig;return null!==(t=null===r||void 0===r?void 0:r.fontBaseUrl)&&void 0!==t?t:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"}());var b=r(4563),S={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},C=r(40695);function k(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var r=!!e.isInverted,n={palette:o,effects:i,fonts:m,spacing:S,isInverted:r,disableGlobalClassNames:!1,semanticColors:(0,C.b)(o,i,void 0,r,t),rtl:void 0};return(0,b.z)(n,e)}},23989:(e,t,r)=>{"use strict";r.d(t,{_:()=>l});var o=r(27051),n=r(47373),i=r(83125),s=r(33788),a=r(75335),c=r(25045);const d="EndToEnd";class l{static startScenario(e,t,r,o){if(r){const n=l.startScenario(e,t);return(async()=>{try{const e=await r(n);return n.setSuccess(null===o||void 0===o?void 0:o()),e}catch(e){throw n.setFailure(e,null===o||void 0===o?void 0:o()),e}})()}let n;return new l(t+d,e,()=>{n=(0,a.yb)();try{var t,r;const o=null===(t=e.PersistedProperties)||void 0===t||null===(r=t.getPersistedProperties)||void 0===r?void 0:r.call(t).hostScenarioStartTime;if(o&&"number"===typeof o){const e=performance.now()-(Date.now()-o);e>=0&&performance.measure("PreScenarioOverhead",{start:e})}}catch(o){}},()=>{n&&((0,a.WN)(n),n=void 0)},()=>({documentHidden:n?(0,a.xl)(n,!0)>-1:""}))}static startActivity(e,t,r,o){if(r){const n=l.startActivity(e,t);return(async()=>{try{const e=await r();return n.setSuccess(null===o||void 0===o?void 0:o()),e}catch(e){throw n.setFailure(e,null===o||void 0===o?void 0:o()),e}})()}return new l(c.K[t]||t,e)}getLogger(){return this.logger}scenarioEndsAfterRender(){return"LoadEndToEnd"===this.activityType||"PasteEndToEnd"===this.activityType}setSuccess(e){var t;this.activityTracker&&(this.activityTracker.setResult(!0,(0,o.A)((0,o.A)({},e),null===(t=this.getExtraPropsToLog)||void 0===t?void 0:t.call(this))),this.dispose())}setFailure(e,t){var r;this.activityTracker&&(this.activityTracker.setResult(!1,(0,o.A)((0,o.A)((0,o.A)({},t),null===(r=this.getExtraPropsToLog)||void 0===r?void 0:r.call(this)),{},{errorType:e?e.errorType:void 0}),e),this.dispose())}cancel(){this.dispose()}dispose(){var e,t;null===(e=this.additionalCleanup)||void 0===e||e.call(this),this.logger&&(0,n.Ot)(this.logger,{eventName:this.activityType,subCategory:"HostActivityTrackerDisposed"}),null===(t=this.activityTracker)||void 0===t||t.dispose(),this.activityTracker=void 0,this.logger=void 0}constructor(e,t,r,o,a){this.activityType=e,this.additionalCleanup=o,this.getExtraPropsToLog=a,null===r||void 0===r||r(),this.logger=new i.p("HostTracker",t),this.activityTracker=s.m.start(e,this.logger,{addUserTiming:!0,isAPerformanceMetric:[c.G.RenderComponent,c.K.RenderComponent].includes(e)||e.endsWith(d)}),(0,n.Ot)(this.logger,{eventName:e,subCategory:"HostActivityTrackerCreated"})}}},24217:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,F:()=>o});const o=3,n="PolicyLabelsUpdate"},24907:(e,t,r)=>{"use strict";function o(e,t){if(""===e)return void 0===t?"":t.absolutePath;{let r=e.startsWith("/")?e.slice(1):e;return r=r.endsWith("/")?r.slice(0,-1):r,void 0===t?"/".concat(r):"".concat("/"===t.absolutePath?"":t.absolutePath,"/").concat(r)}}r.d(t,{a:()=>o})},24921:(e,t,r)=>{"use strict";function o(e){return new Promise((t,r)=>{try{setTimeout(t,e)}catch(o){r(o)}})}r.d(t,{y:()=>o})},25045:(e,t,r)=>{"use strict";r.d(t,{G:()=>o,K:()=>n});const o={GetDriveInfo:"GetDriveInfo",AttachContainer:"AttachContainer",GetFileLink:"GetFileLink",CreateShareLink:"CreateShareLink",RenderComponent:"RenderComponent",PostRender:"PostRender"},n={RenderComponent:"RenderComponentByHost"}},25418:(e,t,r)=>{"use strict";r.d(t,{s:()=>E});var o=r(27051),n=r(33669),i=r(93220),s=r(57471),a=r(85038),c=r(70354),d=r(54813),l=r(93586),u=r(83533),h=r(27250),g=r(58358),p=r(46402),f=r(70530),m=r(27612),v=r(62951);const y=new Map,b=(0,p.p)(async(e,t,r)=>{const o="".concat(t.siteUrl,"_").concat(t.driveId,"_").concat(t.itemId),n=y.get(o);if(void 0!==n)return n;const i=async function(){let n;try{let o=0;n=await(0,c.M)(async()=>(0,v.M)(async()=>async function(e,t,r){let o,n=!1;for(let s=1;s<=5;s++)try{const o=await k(e,t,r),i=new URL(t.siteUrl).origin,a=new URL(o.sharepointIds.siteUrl).origin;return i!==a&&(n=!0,r.sendTelemetryEvent({eventName:"LocationRedirectionErrorForGetOdspFileLink",retryCount:s}),w(t,a)),await S(e,t,r,o)}catch(i){if(o=i,(0,u.X)(i)&&n&&(i.errorType===l.E.fileNotFoundOrAccessDeniedError||i.errorType===l.E.authorizationError))continue;throw i}throw o}(e,t,r),"getFileLinkCore",r),"getShareLink",r,{onRetry(e,t){if(o++,5===o){if(void 0!==t&&"object"===typeof t)throw t.canRetry=!1,t;throw t}}})}catch(i){throw y.delete(o),i}return(0,a.vA)(void 0!==n,658),n}();return y.set(o,i),i});async function S(e,t,r,n){return h.Bt.timedExecAsync(r,{eventName:"odspFileLink",requestName:"getSharingInformation"},async i=>{let s,a=0;const c=await(0,f.gO)(async i=>{var c;a++;const u=(0,f.bJ)(r,t,e),h="".concat(t.siteUrl,"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid").concat(encodeURIComponent("'".concat(n.sharepointIds.listItemUniqueId,"'"))),p="POST",v=await u((0,o.A)((0,o.A)({},i),{},{request:{url:h,method:p}}),"GetFileLinkCore"),y=(0,g.b)(v),b={method:p,headers:(0,o.A)({"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose"},y)},S=await(0,f.ZR)(h,b);s=S.propsToLog;const C=await S.content.json(),k=null===C||void 0===C||null===(c=C.d)||void 0===c?void 0:c.directUrl;if("string"!==typeof k)throw new d.OI("Malformed GetSharingInformation response",l.E.incorrectServerResponse,{driverVersion:m.z});return k});return i.end((0,o.A)((0,o.A)({},s),{},{attempts:a})),c})}const C=e=>"string"===typeof e.webUrl&&"string"===typeof e.webDavUrl&&"object"===typeof e.sharepointIds;async function k(e,t,r){return h.Bt.timedExecAsync(r,{eventName:"odspFileLink",requestName:"getFileItemLite"},async n=>{let i,s=0;const c=await(0,f.gO)(async n=>{s++;const{siteUrl:c,driveId:u,itemId:h}=t,p=(0,f.bJ)(r,t,e),v="".concat(c,"/_api/v2.0/drives/").concat(u,"/items/").concat(h,"?select=webUrl,webDavUrl,sharepointIds"),y=await p((0,o.A)((0,o.A)({},n),{},{request:{url:v,method:"GET"}}),"GetFileItemLite");(0,a.vA)(null!==y,700);const b={method:"GET",headers:(0,g.b)(y)},S=await(0,f.ZR)(v,b);i=S.propsToLog;const k=await S.content.json();if(!C(k))throw new d.OI("Malformed getFileItemLite response",l.E.incorrectServerResponse,{driverVersion:m.z});return k});return n.end((0,o.A)((0,o.A)({},i),{},{attempts:s})),c})}function w(e,t){const r="".concat(t).concat(new URL(e.siteUrl).pathname);e.siteUrl=r,e.endpoints.attachmentGETStorageUrl&&(e.endpoints.attachmentGETStorageUrl="".concat(t).concat(new URL(e.endpoints.attachmentGETStorageUrl).pathname)),e.endpoints.attachmentPOSTStorageUrl&&(e.endpoints.attachmentPOSTStorageUrl="".concat(t).concat(new URL(e.endpoints.attachmentPOSTStorageUrl).pathname)),e.endpoints.deltaStorageUrl&&(e.endpoints.deltaStorageUrl="".concat(t).concat(new URL(e.endpoints.deltaStorageUrl).pathname)),e.endpoints.snapshotStorageUrl&&(e.endpoints.snapshotStorageUrl="".concat(t).concat(new URL(e.endpoints.snapshotStorageUrl).pathname))}var P=r(11137),T=r(50349);class E{constructor(e,t,r,i,s){this.appName=r,this.getContext=i,this.containerPackageInfo=s,this.sharingLinkCache=new n.o,this.logger=(0,f.bP)(t),e&&(this.shareLinkFetcherProps=(0,o.A)((0,o.A)({},e),{},{tokenFetcher:e.tokenFetcher}))}appendDataStorePath(e,t){const r=(0,T.Mh)(e);if(!r)return;const o=new URL(r.dataStorePath,"".concat(e.protocol,"//").concat(e.hostname));if(t.startsWith("/?")||t.startsWith("?")){const e=new URLSearchParams(t);for(const[t,r]of e.entries())o.searchParams.append(t,r);r.dataStorePath="".concat(o.pathname).concat(o.search)}else r.dataStorePath="".concat(o.pathname).concat(o.pathname.endsWith("/")||t.startsWith("/")?"":"/").concat(t,"/").concat(o.search);return(0,T.Cu)(e,r),e.href}getKey(e){return"".concat(e.siteUrl,",").concat(e.driveId,",").concat(e.itemId)}async resolve(e){var t,r,o,n;const a={headers:e.headers,url:e.url},c=null===(t=a.headers)||void 0===t?void 0:t[i.O.isSharingLinkToRedeem];try{const t=new URL(e.url),r=(0,T.Mh)(t);r&&(a.url=(0,s.m)(r))}catch(u){}const d=await(new P.Y).resolve(a);var l;(d.context=await(null===(r=this.getContext)||void 0===r?void 0:r.call(this,d,null!==(o=d.dataStorePath)&&void 0!==o?o:"")),d.appName=this.appName,d.codeHint=null!==(n=d.codeHint)&&void 0!==n&&n.containerPackageName?d.codeHint:{containerPackageName:(0,f.nb)(this.containerPackageInfo)},c)&&(d.shareLinkInfo=Object.assign(null!==(l=d.shareLinkInfo)&&void 0!==l?l:{},{sharingLinkToRedeem:this.removeNavParam(e.url)}));return d.itemId&&this.getShareLinkPromise(d).catch(()=>{}),d}removeNavParam(e){const t=new URL(e),r=new URLSearchParams(t.search);return r.delete(T.jC),t.search=r.toString(),t.href}async getShareLinkPromise(e){if(void 0===this.shareLinkFetcherProps)throw new Error("Failed to get share link because share link fetcher props are missing");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");const t=this.getKey(e),r=this.sharingLinkCache.get(t);if(r)return r;const o=b(this.shareLinkFetcherProps.tokenFetcher,e,this.logger).catch(e=>{throw this.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),this.sharingLinkCache.remove(t),e});return this.sharingLinkCache.add(t,async()=>o),o}async getAbsoluteUrl(e,t,r){const o=(0,f.Yn)(e),n=await this.getShareLinkPromise(o);return this.appendLocatorParams(n,e,t,r)}async appendLocatorParams(e,t,r,o){var n,i,s,a,c;const d=(0,f.Yn)(t),l=r||(null!==(n=d.dataStorePath)&&void 0!==n?n:"");d.context=await(null===(i=this.getContext)||void 0===i?void 0:i.call(this,d,l));const u=null!==(s=null!==(a=(0,f.nb)(o))&&void 0!==a?a:null===(c=d.codeHint)||void 0===c?void 0:c.containerPackageName)&&void 0!==s?s:(0,f.nb)(this.containerPackageInfo);return d.appName=this.appName,(0,f.z6)(e,d,l,u)}static createDocumentUrl(e,t){const r=new URL(e);return(0,T.Cu)(r,t),r.href}}},25532:(e,t,r)=>{"use strict";r.d(t,{J:()=>u});var o=r(78796),n=r(47373),i=r(93537),s=r(29018),a=r(48116),c=r(43172),d=r(46624),l=r(26308);async function u(e,t){const r=new URL(e);if([o.i,a.t].includes(r.origin.toLowerCase()))return d.DR;const n=r.hostname.toLowerCase(),i=(0,l.v6)(n);return null!==i&&void 0!==i&&i.guid?i.guid:await async function(e,t,r){const o=await h.get(e,t,r);void 0===o&&h.delete(e,t,r);return o}(e,n,t)}const h=(0,r(7621).wJ)(async(e,t,r)=>{let o,a;try{const r="".concat((0,s.$)(e),"/_api/v2.0/drives");let n;try{n=await(0,i.J5)(r,{method:"GET",headers:{Authorization:"Bearer"},credentials:"omit"})}catch(d){o="Server did not respond"}n&&(a=(0,c.J)(n.result.headers),a?(0,l.b6)(t,{guid:a}):o="ODSP did not return tenant id in headers. Response status code: ".concat(n.result.status))}catch(u){o="Unexpected error"}return o&&r&&(0,n.Ot)(r,{eventName:"AadTenantNotFound",message:o}),a},(e,t)=>t)},25573:(e,t,r)=>{"use strict";function o(){return(new Date).getTime()}r.d(t,{W:()=>o})},25969:(e,t,r)=>{"use strict";r.d(t,{K:()=>n});var o=r(29018);function n(e){return["".concat((0,o.$)(e),"/files.readwrite.all")]}},26140:(e,t,r)=>{"use strict";function o(){return performance.now()}function n(){return performance.getEntriesByType("resource")}r.d(t,{F:()=>o,T:()=>n})},26308:(e,t,r)=>{"use strict";r.d(t,{b6:()=>d,v6:()=>c});var o=r(63990),n=r(52841);let i;const s="FluidSiteToAadTenantMapping";function a(){if(!i){let t;const r=(0,n.Ar)(),o=null===r||void 0===r?void 0:r.getItem(s);if(o)try{t=JSON.parse(o)}catch(e){null===r||void 0===r||r.removeItem(s)}i=new Map(t)}return i}function c(e){return a().get(e)}function d(e,t){const r=a(),o=r.get(e);r.set(e,{hostname:(null===o||void 0===o?void 0:o.hostname)||t.hostname,guid:(null===o||void 0===o?void 0:o.guid)||t.guid}),u()}let l=!1;function u(){l||(l=!0,(0,o.l)(()=>{try{var e;if(i)null===(e=(0,n.Ar)())||void 0===e||e.setItem(s,JSON.stringify(Array.from(i.entries())))}finally{l=!1}},{ensureExecution:!0}))}},26631:(e,t,r)=>{"use strict";r.d(t,{JR:()=>s,Km:()=>n,Ss:()=>c,Xg:()=>i});var o=r(34445);function n(e,t){switch(t){case"base64":return o.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>c.from(e,t).buffer,s=(e,t)=>c.from(e).toString(t);function a(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class c extends Uint8Array{toString(e){return n(this,e)}static from(e,t,r){if("string"===typeof e)return c.fromString(e,t);if(null!==e&&"object"===typeof e&&a(e.buffer))return c.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(a(e))return c.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const o=null!==t&&void 0!==t?t:0,n=null!==r&&void 0!==r?r:e.byteLength-o;if(o<0||o>e.byteLength||n<0||n+o>e.byteLength)throw new RangeError("Invalid range specified.");return new c(e,o,n)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=o.toByteArray(t);return new c(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new c(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}},27015:(e,t,r)=>{"use strict";function o(e){return e.origin.endsWith("onedrive.com")||e.origin.endsWith("storage.live.com")||e.origin.endsWith("storage.live-int.com")||e.origin.endsWith("onedrive-tst.com")}function n(e){let t="_api/";return o(e)&&(t=""),"".concat(e.origin,"/").concat(t,"v2.1")}function i(e){const t=new URL(e).hostname.toLowerCase();return t.endsWith(".sharepoint-df.com")?"SPDF":"microsoft.sharepoint.com"===t||"microsoft-my.sharepoint.com"===t?"MSIT":void 0}r.d(t,{ir:()=>i,je:()=>o,lA:()=>n})},27051:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var o=r(59526);function n(e,t,r){return(t=(0,o.A)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){n(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}},27250:(e,t,r)=>{"use strict";r.d(t,{Bt:()=>f,Df:()=>y,ZK:()=>u,fV:()=>m,mc:()=>l,pW:()=>g});var o=r(53986),n=r(27051),i=r(87615),s=r(97813),a=r(63520),c=r(39521);const d=["category","eventName"];var l;function u(e){if(void 0===e||null===e)return;const t=Number(e);return Number.isNaN(t)?e:t}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(l||(l={}));class h{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,r){const{message:o,errorType:n,stack:i}=(0,c.AV)(t,!0);if(e.stack=i,e.error=o,e.errorType=n,(0,c.dy)(t)){const r=t.getTelemetryProperties();for(const t of Object.keys(r))void 0===e[t]&&(e[t]=r[t])}void 0===e.stack&&r&&(e.stack=(0,c.aX)())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.$.default;this.sendTelemetryEventCore((0,n.A)((0,n.A)({},e),{},{category:null!==(r=e.category)&&void 0!==r?r:"generic"}),t,"error"===e.category?s.$.error:o)}sendTelemetryEventCore(e,t,r){const n=function(e){let{category:t,eventName:r}=e,n=(0,o.A)(e,d);const i={category:t,eventName:r};for(const o of Object.keys(n))i[o]=m(n[o]);return i}(e);var i;void 0!==t&&h.prepareErrorObject(n,t,!1),"number"===typeof n.duration&&(n.duration=(i=n.duration,Math.floor(i))),this.send(n,r)}sendErrorEvent(e,t){this.sendTelemetryEventCore((0,n.A)((0,n.A)({error:e.eventName},e),{},{category:"error"}),t,s.$.error)}sendPerformanceEvent(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.$.default;const i=(0,n.A)((0,n.A)({},e),{},{category:null!==(r=e.category)&&void 0!==r?r:"performance"});this.sendTelemetryEventCore(i,t,"error"===i.category?s.$.error:o)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,r=(0,n.A)({},e);return void 0!==this.namespace&&(r.eventName="".concat(this.namespace).concat(h.eventNamespaceSeparator).concat(r.eventName)),this.extendProperties(r,t)}extendProperties(e,t){const r=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,o]of Object.entries(t)){if(void 0!==r[e])continue;const t="function"===typeof o?o():o;void 0!==t&&(r[e]=t)}}return e}}h.eventNamespaceSeparator=":";function g(e){return p.create(null===e||void 0===e?void 0:e.logger,null===e||void 0===e?void 0:e.namespace,null===e||void 0===e?void 0:e.properties)}class p extends h{static create(e,t,r){if(e instanceof p){const o={};for(const t of[e.properties,r])void 0!==t&&(void 0!==t.all&&(o.all=(0,n.A)((0,n.A)({},o.all),t.all)),void 0!==t.error&&(o.error=(0,n.A)((0,n.A)({},o.error),t.error)));const i=void 0===e.namespace?t:void 0===t?e.namespace:"".concat(e.namespace).concat(h.eventNamespaceSeparator).concat(t),s=new p(e.baseLogger,i,o);return!(0,a.uz)(s)&&(0,a.uz)(e)&&(0,a.fG)(s,e.config),s}return new p(null!==e&&void 0!==e?e:{send(){}},t,r)}constructor(e,t,r){super(t,r),this.baseLogger=e,(0,a.uz)(e)&&(0,a.fG)(this,new a.G0(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){var r;return(null!==t&&void 0!==t?t:s.$.default)<(null!==(r=this.baseLogger.minLogLevel)&&void 0!==r?r:s.$.default)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}class f{static start(e,t,r){return new f(e,t,r,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}static timedExec(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=f.start(e,t,o,f.shouldReport(t,n));try{const e=r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}static async timedExecAsync(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=f.start(e,t,o,f.shouldReport(t,n));try{const e=await r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}get duration(){return(0,i.l)()-this.startTime}constructor(e,t){var r,o;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.logger=e,this.markers=s,this.emitLogs=a,this.startTime=(0,i.l)(),this.event=(0,n.A)({},t),this.markers.start&&this.reportEvent("start"),"object"===typeof window&&void 0!==(null===(r=window)||void 0===r||null===(r=r.performance)||void 0===r?void 0:r.mark)&&null!==(null===(o=window)||void 0===o||null===(o=o.performance)||void 0===o?void 0:o.mark)&&(this.startMark="".concat(t.eventName,"-start"),window.performance.mark(this.startMark))}reportProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e="".concat(this.event.eventName,"-end");window.performance.mark(e),window.performance.measure("".concat(this.event.eventName),this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",(0,n.A)({category:this.markers.cancel},e),t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;if(!this.emitLogs)return;const o=(0,n.A)((0,n.A)({},this.event),t);o.eventName="".concat(o.eventName,"_").concat(e),"start"!==e&&(o.duration=this.duration),this.logger.sendPerformanceEvent(o,r)}static shouldReport(e,t){var r;const o=".".concat(e.category,".").concat(e.eventName),n=null!==(r=f.eventHits.get(o))&&void 0!==r?r:0;return f.eventHits.set(o,n>=t?1:n+1),n%t===0}}function m(e){return(0,c.qp)(e)?{value:v(e.value),tag:e.tag}:v(e)}function v(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error("convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ".concat(typeof e,")")),"INVALID PROPERTY (typed as ".concat(typeof e,")")}}f.eventHits=new Map;const y=e=>((e,t)=>Object.entries(t).filter(e=>void 0!==e[1]).reduce((t,r)=>{const[o,n]=r;return t[o]="function"===typeof n?()=>({tag:e,value:n()}):{tag:e,value:n},t},{}))(l.CodeArtifact,e)},27284:e=>{"use strict";var t,r="object"===typeof Reflect?Reflect:null,o=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise(function(r,o){function n(r){e.removeListener(t,i),o(r)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}f(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&f(e,"error",t,r)}(e,n,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function d(e,t,r,o){var n,i,s,d;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"===typeof s?s=i[t]=o?[r,s]:[s,r]:o?s.unshift(r):s.push(r),(n=c(e))>0&&s.length>n&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,d=l,console&&console.warn&&console.warn(d)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=l.bind(o);return n.listener=r,o.wrapFn=n,n}function h(e,t,r){var o=e._events;if(void 0===o)return[];var n=o[t];return void 0===n?[]:"function"===typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):p(n,n.length)}function g(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),o=0;o<t;++o)r[o]=e[o];return r}function f(e,t,r,o){if("function"===typeof e.on)o.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function n(i){o.once&&e.removeEventListener(t,n),r(i)})}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)o(c,this,t);else{var d=c.length,l=p(c,d);for(r=0;r<d;++r)o(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return d(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return d(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,o,n,i,s;if(a(t),void 0===(o=this._events))return this;if(void 0===(r=o[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(n=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,n=i;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(o[e]=r[0]),void 0!==o.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,o;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,i=Object.keys(r);for(o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},i.prototype.listenerCount=g,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},27377:(e,t,r)=>{"use strict";r.d(t,{O:()=>g,_:()=>h});r(65043);const o=r.p+"static/media/DarkBackground.f9c4b682680f49530d388ba0f2830809.svg";const n=r.p+"static/media/LightBackground.d93751152f3824d76f84f995fec9752f.svg";const i=r.p+"static/media/LightShimmerLoading.838ac9544853d68b3b1b62a5009ecef8.svg";const s=r.p+"static/media/DarkShimmerLoading.5bd608fb2a16127c459c6027848848ce.svg";const a=r.p+"static/media/DarkBackground_Old.df15325639cb5218602d4da3c7467955.svg";const c=r.p+"static/media/LightBackground_Old.f5416049e2f7d9abee2b5d9386b6fe77.svg";const d=r.p+"static/media/LightShimmerLoading_Old.ea2f880c2eab4e2bba069ba794390732.svg";const l=r.p+"static/media/DarkShimmerLoading_Old.e340d47723d2a30dc95ec74facf4f8b6.svg";var u=r(58443);function h(){const e=document.getElementById(u.bY),t=document.getElementById(u.xu);e&&(e.hidden=!0),null===t||void 0===t||t.removeAttribute("hidden")}function g(e,t){return t?e?{background:o,shimmer:s}:{background:n,shimmer:i}:e?{background:a,shimmer:l}:{background:c,shimmer:d}}},27586:(e,t,r)=>{"use strict";r.d(t,{S:()=>o});const o={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"}},27612:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});const o="2.23.0"},27750:(e,t,r)=>{"use strict";var o;r.d(t,{Z:()=>o}),function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(o||(o={}))},27901:(e,t,r)=>{"use strict";function o(){return"".concat(n()+n(),"-").concat(n(),"-").concat(n(),"-").concat(n(),"-").concat(n()).concat(n()).concat(n())}function n(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}r.d(t,{_:()=>o})},28205:(e,t,r)=>{"use strict";r.d(t,{Ae:()=>A,bz:()=>I,kG:()=>F,GJ:()=>N});var o,n=r(56851),i=r(63722),s={};function a(e,t){var r=e[t];"-"!==r.charAt(0)&&(e[t]=s[r]=s[r]||r.replace(/([A-Z])/g,"-$1").toLowerCase())}var c={"user-select":1};function d(e,t){var r=function(){var e;if(!o){var t="undefined"!==typeof document?document:void 0,r="undefined"!==typeof navigator?navigator:void 0,n=null===(e=null===r||void 0===r?void 0:r.userAgent)||void 0===e?void 0:e.toLowerCase();o=t?{isWebkit:!(!t||!("WebkitAppearance"in t.documentElement.style)),isMoz:!!(n&&n.indexOf("firefox")>-1),isOpera:!!(n&&n.indexOf("opera")>-1),isMs:!(!r||!/rv:11.0/i.test(r.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return o}(),n=e[t];if(c[n]){var i=e[t+1];c[n]&&(r.isWebkit&&e.push("-webkit-"+n,i),r.isMoz&&e.push("-moz-"+n,i),r.isMs&&e.push("-ms-"+n,i),r.isOpera&&e.push("-o-"+n,i))}}var l,u=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function h(e,t){var r=e[t],o=e[t+1];if("number"===typeof o){var n=u.indexOf(r)>-1,i=r.indexOf("--")>-1,s=n||i?"":"px";e[t+1]="".concat(o).concat(s)}}var g="left",p="right",f="@noflip",m=((l={})[g]=p,l[p]=g,l),v={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function y(e,t,r){if(e.rtl){var o=t[r];if(!o)return;var n=t[r+1];if("string"===typeof n&&n.indexOf(f)>=0)t[r+1]=n.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(o.indexOf(g)>=0)t[r]=o.replace(g,p);else if(o.indexOf(p)>=0)t[r]=o.replace(p,g);else if(String(n).indexOf(g)>=0)t[r+1]=n.replace(g,p);else if(String(n).indexOf(p)>=0)t[r+1]=n.replace(p,g);else if(m[o])t[r]=m[o];else if(v[n])t[r+1]=v[n];else switch(o){case"margin":case"padding":t[r+1]=function(e){if("string"===typeof e){var t=e.split(" ");if(4===t.length)return"".concat(t[0]," ").concat(t[3]," ").concat(t[2]," ").concat(t[1])}return e}(n);break;case"box-shadow":t[r+1]=function(e,t){var r=e.split(" "),o=parseInt(r[t],10);return r[0]=r[0].replace(String(o),String(-1*o)),r.join(" ")}(n,0)}}}var b="displayName";var S=/\:global\((.+?)\)/g;function C(e){return e.indexOf(":global(")>=0||0===e.indexOf(":")}function k(e,t){return e.indexOf(":global(")>=0?e.replace(S,"$1"):0===e.indexOf(":host(")?e:0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function w(e,t,r,o,n){void 0===t&&(t={__order:[]}),0===r.indexOf("@")?P([o],t,r=r+"{"+e,n):r.indexOf(",")>-1?function(e){if(!S.test(e))return e;for(var t=[],r=/\:global\((.+?)\)/g,o=null;o=r.exec(e);)o[1].indexOf(",")>-1&&t.push([o.index,o.index+o[0].length,o[1].split(",").map(function(e){return":global(".concat(e.trim(),")")}).join(", ")]);return t.reverse().reduce(function(e,t){var r=t[0],o=t[1],n=t[2];return e.slice(0,r)+n+e.slice(o)},e)}(r).split(",").map(function(e){return e.trim()}).forEach(function(r){return P([o],t,k(r,e),n)}):P([o],t,k(r,e),n)}function P(e,t,r,o){void 0===t&&(t={__order:[]}),void 0===r&&(r="&");var n=t[r];n||(n={},t[r]=n,t.__order.push(r));for(var i=0,s=e;i<s.length;i++){var a=s[i];if("string"===typeof a){var c=o.argsFromClassName(a);c&&P(c,t,r,o)}else if(Array.isArray(a))P(a,t,r,o);else for(var d in a)if(a.hasOwnProperty(d)){var l=a[d];if("selectors"===d){var u=a.selectors;for(var h in u)u.hasOwnProperty(h)&&w(r,t,h,u[h],o)}else"object"===typeof l||C(d)?null!==l&&void 0!==l&&w(r,t,d,l,o):void 0!==l&&("margin"===d||"padding"===d?T(n,d,l):n[d]=l)}}return t}function T(e,t,r){var o="string"===typeof r?function(e){for(var t=[],r=0,o=0,n=0;n<e.length;n++)switch(e[n]){case"(":o++;break;case")":o&&o--;break;case"\t":case" ":o||(n>r&&t.push(e.substring(r,n)),r=n+1)}return r<e.length&&t.push(e.substring(r)),t}(r):[r];0===o.length&&o.push(r),"!important"===o[o.length-1]&&(o=o.slice(0,-1).map(function(e){return e+" !important"})),e[t+"Top"]=o[0],e[t+"Right"]=o[1]||o[0],e[t+"Bottom"]=o[2]||o[0],e[t+"Left"]=o[3]||o[1]||o[0]}function E(e,t){return t<=0?"":1===t?e:e+E(e,t-1)}function I(e,t){if(!t)return"";var r=[];for(var o in t)t.hasOwnProperty(o)&&o!==b&&void 0!==t[o]&&r.push(o,t[o]);for(var n=0;n<r.length;n+=2)a(r,n),h(r,n),y(e,r,n),d(r,n);for(n=1;n<r.length;n+=4)r.splice(n,1,":",r[n],";");return r.join("")}function N(e){for(var t,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var n=null!==(t=e.stylesheet)&&void 0!==t?t:i.nr.getInstance(e.shadowConfig),s=P(r,void 0,void 0,n),a=function(e,t){for(var r=[e.rtl?"rtl":"ltr"],o=!1,n=0,i=t.__order;n<i.length;n++){var s=i[n];r.push(s);var a=t[s];for(var c in a)a.hasOwnProperty(c)&&void 0!==a[c]&&(o=!0,r.push(c,a[c]))}return o?r.join(""):void 0}(e,s);if(a){var c={className:n.classNameFromKey(a),key:a,args:r};if(!c.className){c.className=n.getClassName(function(e){var t=e&&e["&"];return t?t.displayName:void 0}(s));for(var d=[],l=0,u=s.__order;l<u.length;l++){var h=u[l];d.push(h,I(e,s[h]))}c.rulesToInsert=d}return c}}function A(e,t,r,o){void 0===t&&(t=1);var n=null!==o&&void 0!==o?o:i.nr.getInstance(r),s=e.className,a=e.key,c=e.args,d=e.rulesToInsert;if(d){for(var l=0;l<d.length;l+=2){var u=d[l+1];if(u){var h=d[l];h=h.replace(/&/g,E(".".concat(e.className),t));var g="".concat(h,"{").concat(u,"}").concat(0===h.indexOf("@")?"}":"");n.insertRule(g)}}n.cacheClassName(s,a,c,d)}}function F(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=N.apply(void 0,(0,n.__spreadArray)([e],t,!1));return o?(A(o,e.specificityMultiplier,e.shadowConfig,e.stylesheet),o.className):""}},29018:(e,t,r)=>{"use strict";function o(e){return new URL(e).origin}r.d(t,{$:()=>o})},29900:(e,t,r)=>{"use strict";r.d(t,{E:()=>c,q:()=>a});var o=r(56851),n=r(82770),i=r(12283),s=r(50406),a=function(){return(a="object"===typeof self&&"object"===typeof self.performance&&"function"===typeof self.performance.now?function(){return self.performance.now()}:function(){return Date.now()})()},c=function(e){var t,r=a(),d=(0,s.EY)(e.telemetryEvent);return(0,o.__assign)((0,o.__assign)({cv:e.parentCv.getNext()},d),{createChildActivity:function(t){return c({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,r){this.result={code:e,type:t,tag:r}},endNow:function(){var o,s,c=this;if(!t){void 0===this.success&&void 0===this.result&&(0,i.wC)(1,0,function(){return"Activity does not have success or result set"});var d=a(),l=Math.floor(1e3*(d-r));t=!0;var u={duration:l,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},h=null!==(s=null===(o=this.eventContract)||void 0===o?void 0:o.dataFields)&&void 0!==s?s:[];return h.push.apply(h,n.Il.getFields(u)),this.eventContract={name:n.Il.contractName,dataFields:h},e.sendTelemetryEvent(this)}(0,i.wC)(0,0,function(){return"'".concat(c.eventName,"' already ended")})}})}},29951:(e,t,r)=>{"use strict";function o(e){return e}function n(e){return e}r.d(t,{P:()=>n,k:()=>o})},29967:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});var o=r(25418),n=r(83125),i=r(25969),s=r(14836);function a(e,t,r,a){const c=t&&new n.p("OdspUrlResolver",t),d="UnauthenticatedGuest"===e.identityType?void 0:{tokenFetcher:r=>e.getToken((0,i.K)(r.siteUrl),(0,s.r)(r,t)),identityType:e.identityType||"Enterprise"};return new o.s(d,c,null===r||void 0===r?void 0:r.appName,a)}},31482:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});var o=r(45799),n=r(65922);const i=(0,o.a)(n.oZ)},31831:(e,t,r)=>{"use strict";r.d(t,{c:()=>a,y:()=>s});var o=r(99282),n=r(16218),i=r(31482);const s=new Map([[o.Jf.colorNeutralForeground1,[n.Ve.neutralPrimary,n.KM.ActionLink,n.KM.BodyText,n.KM.ButtonText,n.KM.ButtonTextChecked,n.KM.ButtonTextCheckedHovered,n.KM.ButtonTextHovered,n.KM.ButtonTextPressed,n.KM.InputText,n.KM.ListText,n.KM.ListTextColor,n.KM.MenuIcon,n.KM.MenuItemText,n.KM.MessageText]],[o.Jf.colorNeutralForeground1Hover,[n.Ve.neutralPrimary,n.KM.ActionLinkHovered,n.KM.InputTextHovered]],[o.Jf.colorNeutralForeground1Pressed,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground1Selected,[n.Ve.neutralPrimary,n.KM.BodyTextChecked]],[o.Jf.colorNeutralForeground2,[n.Ve.neutralSecondary,n.KM.BodySubtext]],[o.Jf.colorNeutralForeground2Hover,[n.Ve.neutralPrimary,n.KM.MenuItemTextHovered]],[o.Jf.colorNeutralForeground2Pressed,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2Selected,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2BrandHover,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground2BrandPressed,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground2BrandSelected,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground3,[n.Ve.neutralTertiary,n.KM.InputIcon,n.KM.InputIconHovered,n.KM.MenuHeader]],[o.Jf.colorNeutralForeground3Hover,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground3Pressed,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground3Selected,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground3BrandHover,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground3BrandPressed,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground3BrandSelected,[n.Ve.themePrimary]],[o.Jf.colorNeutralForeground4,[n.Ve.neutralQuaternary,n.KM.InputPlaceholderText]],[o.Jf.colorNeutralForegroundDisabled,[n.Ve.neutralTertiaryAlt,n.KM.ButtonTextDisabled,n.KM.DisabledBodySubtext,n.KM.DisabledBodyText,n.KM.DisabledText,n.KM.InputIconDisabled,n.KM.PrimaryButtonTextDisabled]],[o.Jf.colorBrandForegroundLink,[n.Ve.themeDarkAlt,n.KM.Link,n.KM.MessageLink]],[o.Jf.colorBrandForegroundLinkHover,[n.Ve.themeDark,n.KM.LinkHovered,n.KM.MessageLinkHovered]],[o.Jf.colorBrandForegroundLinkPressed,[n.Ve.themeDarker]],[o.Jf.colorBrandForegroundLinkSelected,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground2Link,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralForeground2LinkHover,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2LinkPressed,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForeground2LinkSelected,[n.Ve.neutralPrimary]],[o.Jf.colorCompoundBrandForeground1,[n.Ve.themePrimary]],[o.Jf.colorCompoundBrandForeground1Hover,[n.Ve.themeDarkAlt]],[o.Jf.colorCompoundBrandForeground1Pressed,[n.Ve.themeDark]],[o.Jf.colorBrandForeground1,[n.Ve.themePrimary]],[o.Jf.colorBrandForeground2,[n.Ve.themeDarkAlt]],[o.Jf.colorNeutralForeground1Static,[n.Ve.neutralPrimary]],[o.Jf.colorNeutralForegroundInverted,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedHover,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedPressed,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedSelected,[n.Ve.white]],[o.Jf.colorNeutralForegroundOnBrand,[n.Ve.white,n.KM.AccentButtonText,n.KM.InputForegroundChecked,n.KM.PrimaryButtonText,n.KM.PrimaryButtonTextHovered,n.KM.PrimaryButtonTextPressed]],[o.Jf.colorNeutralForegroundInvertedLink,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedLinkHover,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedLinkPressed,[n.Ve.white]],[o.Jf.colorNeutralForegroundInvertedLinkSelected,[n.Ve.white]],[o.Jf.colorNeutralForegroundInverted2,[n.Ve.white]],[o.Jf.colorBrandForegroundInverted,[n.Ve.themeSecondary]],[o.Jf.colorBrandForegroundInvertedHover,[n.Ve.themeTertiary]],[o.Jf.colorBrandForegroundInvertedPressed,[n.Ve.themeSecondary]],[o.Jf.colorBrandForegroundOnLight,[n.Ve.themePrimary]],[o.Jf.colorBrandForegroundOnLightHover,[n.Ve.themeDarkAlt]],[o.Jf.colorBrandForegroundOnLightPressed,[n.Ve.themeDark]],[o.Jf.colorBrandForegroundOnLightSelected,[n.Ve.themeDark]],[o.Jf.colorNeutralBackground1,[n.Ve.white,n.KM.BodyBackground,n.KM.BodyFrameBackground,n.KM.ButtonBackground,n.KM.CardStandoutBackground,n.KM.InputBackground,n.KM.ListBackground,n.KM.MenuBackground,n.KM.MenuItemBackgroundChecked]],[o.Jf.colorNeutralBackground1Hover,[n.Ve.neutralLighter,n.KM.BodyBackgroundHovered,n.KM.ButtonBackgroundCheckedHovered,n.KM.ButtonBackgroundHovered,n.KM.ListHeaderBackgroundHovered,n.KM.ListItemBackgroundHovered,n.KM.MenuItemBackgroundHovered,n.KM.MenuItemBackgroundPressed]],[o.Jf.colorNeutralBackground1Pressed,[n.Ve.neutralQuaternaryAlt,n.KM.ButtonBackgroundPressed,n.KM.ListHeaderBackgroundPressed]],[o.Jf.colorNeutralBackground1Selected,[n.Ve.neutralLight,n.KM.BodyBackgroundChecked,n.KM.ButtonBackgroundChecked,n.KM.ListItemBackgroundChecked,n.KM.ListItemBackgroundCheckedHovered]],[o.Jf.colorNeutralBackground2,[n.Ve.neutralLighterAlt,n.KM.BodyStandoutBackground,n.KM.DefaultStateBackground]],[o.Jf.colorNeutralBackground2Hover,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground2Pressed,[n.Ve.neutralQuaternaryAlt]],[o.Jf.colorNeutralBackground2Selected,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackground3,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground3Hover,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackground3Pressed,[n.Ve.neutralQuaternary]],[o.Jf.colorNeutralBackground3Selected,[n.Ve.neutralQuaternaryAlt]],[o.Jf.colorNeutralBackground4,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground4Hover,[n.Ve.neutralLighterAlt]],[o.Jf.colorNeutralBackground4Pressed,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground4Selected,[n.Ve.white]],[o.Jf.colorNeutralBackground5,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackground5Hover,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground5Pressed,[n.Ve.neutralLighter]],[o.Jf.colorNeutralBackground5Selected,[n.Ve.neutralLighterAlt]],[o.Jf.colorNeutralBackground6,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackgroundInverted,[n.Ve.neutralSecondary]],[o.Jf.colorSubtleBackgroundHover,[n.Ve.neutralLighter]],[o.Jf.colorSubtleBackgroundPressed,[n.Ve.neutralQuaternaryAlt]],[o.Jf.colorSubtleBackgroundSelected,[n.Ve.neutralLight]],[o.Jf.colorNeutralBackgroundDisabled,[n.Ve.neutralLighter,n.KM.ButtonBackgroundDisabled,n.KM.DisabledBackground,n.KM.PrimaryButtonBackgroundDisabled]],[o.Jf.colorNeutralStencil1,[n.Ve.neutralLight]],[o.Jf.colorNeutralStencil2,[n.Ve.neutralLighterAlt]],[o.Jf.colorBrandBackground,[n.Ve.themePrimary,n.KM.AccentButtonBackground,n.KM.PrimaryButtonBackground]],[o.Jf.colorBrandBackgroundHover,[n.Ve.themeDarkAlt,n.KM.PrimaryButtonBackgroundHovered]],[o.Jf.colorBrandBackgroundPressed,[n.Ve.themeDarker,n.KM.PrimaryButtonBackgroundPressed]],[o.Jf.colorBrandBackgroundSelected,[n.Ve.themeDark]],[o.Jf.colorCompoundBrandBackground,[n.Ve.themePrimary,n.KM.InputBackgroundChecked]],[o.Jf.colorCompoundBrandBackgroundHover,[n.Ve.themeDarkAlt,n.KM.InputBackgroundCheckedHovered]],[o.Jf.colorCompoundBrandBackgroundPressed,[n.Ve.themeDark]],[o.Jf.colorBrandBackgroundStatic,[n.Ve.themePrimary]],[o.Jf.colorBrandBackground2,[n.Ve.themeLighterAlt]],[o.Jf.colorBrandBackgroundInverted,[n.Ve.white]],[o.Jf.colorBrandBackgroundInvertedHover,[n.Ve.themeLighterAlt]],[o.Jf.colorBrandBackgroundInvertedPressed,[n.Ve.themeLight]],[o.Jf.colorBrandBackgroundInvertedSelected,[n.Ve.themeLighter,n.KM.InputPlaceholderBackgroundChecked]],[o.Jf.colorNeutralStrokeAccessible,[n.Ve.neutralSecondary,n.KM.InputBorder]],[o.Jf.colorNeutralStrokeAccessibleHover,[n.Ve.neutralSecondary,n.KM.InputBorderHovered]],[o.Jf.colorNeutralStrokeAccessiblePressed,[n.Ve.neutralSecondary]],[o.Jf.colorNeutralStrokeAccessibleSelected,[n.Ve.themePrimary]],[o.Jf.colorNeutralStroke1,[n.Ve.neutralQuaternary,n.KM.ButtonBorder]],[o.Jf.colorNeutralStroke1Hover,[n.Ve.neutralTertiaryAlt]],[o.Jf.colorNeutralStroke1Pressed,[n.Ve.neutralTertiaryAlt]],[o.Jf.colorNeutralStroke1Selected,[n.Ve.neutralTertiaryAlt]],[o.Jf.colorNeutralStroke2,[n.Ve.neutralQuaternaryAlt,n.KM.BodyDivider,n.KM.BodyFrameDivider,n.KM.MenuDivider]],[o.Jf.colorNeutralStroke3,[n.Ve.neutralLighter]],[o.Jf.colorNeutralStrokeOnBrand,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2Hover,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2Pressed,[n.Ve.white]],[o.Jf.colorNeutralStrokeOnBrand2Selected,[n.Ve.white]],[o.Jf.colorBrandStroke1,[n.Ve.themePrimary]],[o.Jf.colorBrandStroke2,[n.Ve.themeLight]],[o.Jf.colorCompoundBrandStroke,[n.Ve.themePrimary,n.KM.InputFocusBorderAlt]],[o.Jf.colorCompoundBrandStrokeHover,[n.Ve.themeDarkAlt]],[o.Jf.colorCompoundBrandStrokePressed,[n.Ve.themeDark]],[o.Jf.colorNeutralStrokeDisabled,[n.Ve.neutralQuaternaryAlt,n.KM.ButtonBorderDisabled,n.KM.DisabledBorder]],[o.Jf.colorStrokeFocus2,[n.KM.FocusBorder]],[n.Ve.black,[o.Jf.colorStrokeFocus2,o.Jf.colorNeutralForeground1Selected]],[n.Ve.neutralDark,[o.Jf.colorNeutralForeground1Hover]],[n.Ve.neutralPrimary,[o.Jf.colorNeutralForeground1,o.Jf.colorNeutralStrokeAccessibleHover]],[n.Ve.neutralSecondary,[o.Jf.colorNeutralForeground2,o.Jf.colorNeutralForeground3,o.Jf.colorNeutralForeground4,o.Jf.colorNeutralStrokeAccessible]],[n.Ve.neutralSecondaryAlt,[o.Jf.colorNeutralStroke1]],[n.Ve.neutralTertiary,[o.Jf.colorNeutralForegroundDisabled]],[n.Ve.neutralLight,[o.Jf.colorNeutralBackground1Selected,o.Jf.colorNeutralBackground1Pressed,o.Jf.colorNeutralStroke2]],[n.Ve.neutralLighter,[o.Jf.colorNeutralStrokeDisabled,o.Jf.colorNeutralBackgroundDisabled,o.Jf.colorNeutralBackground1Hover]],[n.Ve.neutralLightAlt,[o.Jf.colorNeutralBackground2]],[n.Ve.neutralLight,[o.Jf.colorSubtleBackgroundPressed]],[n.Ve.neutralSecondary,[o.Jf.colorNeutralForeground2Selected]],[n.Ve.white,[o.Jf.colorStrokeFocus1,o.Jf.colorNeutralForegroundOnBrand,o.Jf.colorNeutralBackground1]],[n.Ve.themeDarker,[o.Jf.colorBrandForegroundLinkHover]],[n.Ve.themeDark,[o.Jf.colorCompoundBrandBackgroundHover,o.Jf.colorBrandBackgroundPressed]],[n.Ve.themeDarkAlt,[o.Jf.colorBrandBackgroundHover]],[n.Ve.themePrimary,[o.Jf.colorBrandBackground,o.Jf.colorCompoundBrandBackground,o.Jf.colorCompoundBrandStroke,o.Jf.colorBrandForegroundLink]],[n.Ve.themeLighter,[o.Jf.colorBrandBackgroundInvertedSelected]],[n.KM.AccentButtonBackground,[o.Jf.colorBrandBackground]],[n.KM.AccentButtonText,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.ActionLink,[o.Jf.colorNeutralForeground1]],[n.KM.ActionLinkHovered,[o.Jf.colorNeutralForeground1Hover]],[n.KM.BodyBackground,[o.Jf.colorNeutralBackground1]],[n.KM.BodyBackgroundChecked,[o.Jf.colorNeutralBackground1Selected]],[n.KM.BodyBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.BodyDivider,[o.Jf.colorNeutralStroke2]],[n.KM.BodyFrameBackground,[o.Jf.colorNeutralBackground1]],[n.KM.BodyFrameDivider,[o.Jf.colorNeutralStroke2]],[n.KM.BodyStandoutBackground,[o.Jf.colorNeutralBackground2]],[n.KM.BodySubtext,[o.Jf.colorNeutralForeground3]],[n.KM.BodyText,[o.Jf.colorNeutralForeground1]],[n.KM.BodyTextChecked,[o.Jf.colorNeutralForeground1Selected]],[n.KM.ButtonBackground,[o.Jf.colorNeutralBackground1]],[n.KM.ButtonBackgroundChecked,[o.Jf.colorNeutralBackground1Selected]],[n.KM.ButtonBackgroundCheckedHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ButtonBackgroundDisabled,[o.Jf.colorNeutralBackgroundDisabled]],[n.KM.ButtonBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ButtonBackgroundPressed,[o.Jf.colorNeutralBackground1Pressed]],[n.KM.ButtonBorder,[o.Jf.colorNeutralStroke1]],[n.KM.ButtonBorderDisabled,[o.Jf.colorNeutralStrokeDisabled]],[n.KM.ButtonText,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextChecked,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextCheckedHovered,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextDisabled,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.ButtonTextHovered,[o.Jf.colorNeutralForeground1]],[n.KM.ButtonTextPressed,[o.Jf.colorNeutralForeground1]],[n.KM.CardStandoutBackground,[o.Jf.colorNeutralBackground1]],[n.KM.DefaultStateBackground,[o.Jf.colorNeutralBackground2]],[n.KM.DisabledBackground,[o.Jf.colorNeutralBackgroundDisabled]],[n.KM.DisabledBodySubtext,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.DisabledBodySubtext,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.DisabledBorder,[o.Jf.colorNeutralStrokeDisabled]],[n.KM.DisabledSubtext,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.DisabledText,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.FocusBorder,[o.Jf.colorStrokeFocus2]],[n.KM.InputBackground,[o.Jf.colorNeutralBackground1]],[n.KM.InputBackgroundChecked,[o.Jf.colorCompoundBrandBackground]],[n.KM.InputBackgroundCheckedHovered,[o.Jf.colorCompoundBrandBackgroundHover]],[n.KM.InputBorder,[o.Jf.colorNeutralStrokeAccessible]],[n.KM.InputBorderHovered,[o.Jf.colorNeutralStrokeAccessibleHover]],[n.KM.InputFocusBorderAlt,[o.Jf.colorCompoundBrandStroke]],[n.KM.InputForegroundChecked,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.InputIcon,[o.Jf.colorNeutralForeground3]],[n.KM.InputIconDisabled,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.InputIconHovered,[o.Jf.colorNeutralForeground3]],[n.KM.InputPlaceholderBackgroundChecked,[o.Jf.colorBrandBackgroundInvertedSelected]],[n.KM.InputPlaceholderText,[o.Jf.colorNeutralForeground4]],[n.KM.InputText,[o.Jf.colorNeutralForeground1]],[n.KM.InputTextHovered,[o.Jf.colorNeutralForeground1Hover]],[n.KM.Link,[o.Jf.colorBrandForegroundLink]],[n.KM.LinkHovered,[o.Jf.colorBrandForegroundLinkHover]],[n.KM.ListBackground,[o.Jf.colorNeutralBackground1]],[n.KM.ListHeaderBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ListHeaderBackgroundPressed,[o.Jf.colorNeutralBackground1Pressed]],[n.KM.ListItemBackgroundChecked,[o.Jf.colorNeutralBackground1Selected]],[n.KM.ListItemBackgroundCheckedHovered,[o.Jf.colorNeutralBackground1Selected]],[n.KM.ListItemBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.ListText,[o.Jf.colorNeutralForeground1]],[n.KM.ListTextColor,[o.Jf.colorNeutralForeground1]],[n.KM.MenuBackground,[o.Jf.colorNeutralBackground1]],[n.KM.MenuDivider,[o.Jf.colorNeutralStroke2]],[n.KM.MenuHeader,[o.Jf.colorNeutralForeground3]],[n.KM.MenuIcon,[o.Jf.colorNeutralForeground1]],[n.KM.MenuItemBackgroundChecked,[o.Jf.colorNeutralBackground1]],[n.KM.MenuItemBackgroundHovered,[o.Jf.colorNeutralBackground1Hover]],[n.KM.MenuItemBackgroundPressed,[o.Jf.colorNeutralBackground1Hover]],[n.KM.MenuItemText,[o.Jf.colorNeutralForeground1]],[n.KM.MenuItemTextHovered,[o.Jf.colorNeutralForeground2Hover]],[n.KM.MessageLink,[o.Jf.colorBrandForegroundLink]],[n.KM.MessageLinkHovered,[o.Jf.colorBrandForegroundLinkHover]],[n.KM.MessageText,[o.Jf.colorNeutralForeground1]],[n.KM.PrimaryButtonBackground,[o.Jf.colorBrandBackground]],[n.KM.PrimaryButtonBackgroundDisabled,[o.Jf.colorNeutralBackgroundDisabled]],[n.KM.PrimaryButtonBackgroundHovered,[o.Jf.colorBrandBackgroundHover]],[n.KM.PrimaryButtonBackgroundPressed,[o.Jf.colorBrandBackgroundPressed]],[n.KM.PrimaryButtonBorder,[o.Jf.colorTransparentStroke]],[n.KM.PrimaryButtonText,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.PrimaryButtonTextDisabled,[o.Jf.colorNeutralForegroundDisabled]],[n.KM.PrimaryButtonTextHovered,[o.Jf.colorNeutralForegroundOnBrand]],[n.KM.PrimaryButtonTextPressed,[o.Jf.colorNeutralForegroundOnBrand]]]),a=Object.keys(i.o).map(e=>({name:"--"+e,value:i.o[e]}))},31942:(e,t,r)=>{"use strict";var o;r.d(t,{S:()=>o}),function(e){e.fixedByHost="fixedByHost",e.grow="grow",e.growHeight="growHeight"}(o||(o={}))},32896:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});const o=function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"low",i=3;return function s(){return n(e,t,r,o).catch(()=>(i-=1,0===i?n(e,t,r,o):s()))}()};async function n(e,t,r,o){return new Promise((n,i)=>{var s,a;const c=e.document,d=c.createElement("script");d.setAttribute("fetchpriority",o);const l=null!==(s=null===r||void 0===r||null===(a=r.trustedTypesPolicy)||void 0===a?void 0:a.createScriptURL(t,{allowedScriptOrigins:r.allowedOrigins}))&&void 0!==s?s:t;d.src=l,d.async=!1,d.charset="utf-8",d.crossOrigin="anonymous",d.onload=n,d.onerror=()=>i(new Error("Failed to download the script at url: ".concat(t,", isUserDefinitelyOffline: ").concat(!e.navigator.onLine))),c.head.appendChild(d)})}},33669:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});class o{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout(()=>{this.cleanup(e),this.cancel(e)},this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class n{constructor(){let{expiry:e={policy:"indefinite"},removeOnError:t=()=>!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cache=new Map,this.removeOnError=t,this.gc=new o(e,e=>this.remove(e))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let r=this.get(e);if(void 0===r){r=(async()=>t())(),this.cache.set(e,r),r.catch(t=>{this.removeOnError(t)&&this.remove(e)}),this.gc.schedule(e)}return r}add(e,t){const r=this.has(e);return this.addOrGet(e,t).catch(()=>{}),!r}async addValueOrGet(e,t){return this.addOrGet(e,async()=>t)}addValue(e,t){return this.add(e,async()=>t)}}},33788:(e,t,r)=>{"use strict";r.d(t,{m:()=>c});var o=r(27051),n=r(78702),i=r(51238),s=r(47373);const a=new Set;class c{constructor(e,t,r){var o;this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=null===r||void 0===r?void 0:r.additionalPropsToLog,this.addUserTiming=null===r||void 0===r?void 0:r.addUserTiming,this.isAPerformanceMetric=(null===r||void 0===r?void 0:r.isAPerformanceMetric)||!1,this.logSubactivityStartTimes=null===(o=null===r||void 0===r?void 0:r.logSubactivityStartTimes)||void 0===o||o,this.subActivities={},this.identifier=(0,i.A)(),this.activityStartName="".concat(this.activityName,"-start-").concat(this.identifier),this.activityEndName="".concat(this.activityName,"-end-").concat(this.identifier),this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}static start(e,t,r){const o=new c(e,t,r);return a.add(o),o}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){const r=this.subActivities[e];if(!r)return;if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}const n={["durationMs_".concat(e)]:Math.round(performance.now()-r.startTime)};this.logSubactivityStartTimes&&(n["startTime_".concat(e)]=r.startTimeSinceEpoch),this.additionalPropsToLog=(0,o.A)((0,o.A)((0,o.A)({},n),this.additionalPropsToLog),t)}setResult(e,t,r,o){this.logActivityResult(e,t,r,null===o||void 0===o?void 0:o.skipLogging,void 0,null===o||void 0===o?void 0:o.sampleEvent)}cancel(e,t,r){this.logActivityResult(e,t,r,!1,!0)}addAdditionalProps(e){this.additionalPropsToLog=(0,o.A)((0,o.A)({},this.additionalPropsToLog),e)}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const r in this.subActivities)e(this.getSubActivityName(r,"start")),e(this.getSubActivityName(r,"end")),t(r)}}logActivityResult(e,t,r,i,c,d){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const l=performance.now(),u=Math.round(l-this.startTime);if(this.isAPerformanceMetric){(window._pageTimings||(window._pageTimings={}))[this.activityName]=null!==t&&void 0!==t&&t.durationMs?Number(t.durationMs):u}if(this.logger&&!i){const i=(0,o.A)((0,o.A)({eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:u,succeeded:e,sampleEvent:d,resultType:c?n.Tp.Cancelled:e?n.Tp.Success:n.Tp.Failure},this.additionalPropsToLog),t);(0,s.IA)(this.logger,i,r)}this.logger=void 0,a.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}generateMeasureName(e){return this.cachedMeasureName="".concat(this.activityName).concat(!1===e?"-FAILED":"","-").concat(this.identifier),this.cachedMeasureName}getSubActivityName(e,t){return"".concat(e,"-").concat(t,"-").concat(this.identifier)}}},33829:(e,t,r)=>{"use strict";r.d(t,{As:()=>c,CD:()=>l,R2:()=>u,TN:()=>h,VN:()=>p,Vb:()=>d,bv:()=>g,dR:()=>s,sc:()=>a});var o=r(16460),n=r(91947),i=r(90662);function s(e){(0,o.gp)(t=>{const r=t.detail.isDarkBackground;e.forEach(e=>{e(r)})})}function a(e){(0,o.fQ)(t=>{const r=t.detail.newTheme,o=(0,i.g4)(r);e.forEach(e=>{e(o)})})}function c(e){(0,o.hj)(t=>{e(t.detail.documentUrl,t.detail.linkScope)})}async function d(e){(0,o.WU)(t=>{e(t.detail.linkProblemState)});const t=(await(0,n.KE)()).linkProblemState;t&&e(t)}function l(e){(0,o.$h)(t=>{t.detail.isPermissionError&&e(o.$R.Error)})}function u(e){(0,o.ED)(t=>{const r=t.detail.isContentHeightLimited;e(r)})}function h(e){(0,o.Md)(t=>{const r=t.detail.showLoopGlowBorder;e(r)})}function g(e){(0,o.us)(t=>{const r=t.detail.isHeader;e(r)})}function p(e){(0,o.gC)(t=>{e(t.detail.isReadOnly)})}},34023:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});const o={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},34170:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LoopRegistrationId:()=>$h,NpmCodeLoaderFactory:()=>np,PowerBIPortableComponent:()=>Xh,loopExport:()=>eg});var o=r(53986),n=r(27051),i=r(57833),s=r(9580),a=r(75368),c=r(38954),d=r(27284);const l=["type","asyncId","instanceId"];var u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:"undefined"!==typeof self?self:{},h=function(e){return e&&e.Math===Math&&e},g=h("object"==typeof globalThis&&globalThis)||h("object"==typeof window&&window)||h("object"==typeof self&&self)||h("object"==typeof u&&u)||h("object"==typeof u&&u)||function(){return this}()||Function("return this")(),p={},f=function(e){try{return!!e()}catch(t){return!0}},m=!f(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),v=!f(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),y=v,b=Function.prototype.call,S=y?b.bind(b):function(){return b.apply(b,arguments)},C={},k={}.propertyIsEnumerable,w=Object.getOwnPropertyDescriptor,P=w&&!k.call({1:2},1);C.f=P?function(e){var t=w(this,e);return!!t&&t.enumerable}:k;var T,E,I=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},N=v,A=Function.prototype,F=A.call,D=N&&A.bind.bind(F,F),B=N?D:function(e){return function(){return F.apply(e,arguments)}},L=B,O=L({}.toString),x=L("".slice),M=function(e){return x(O(e),8,-1)},R=f,_=M,H=Object,U=B("".split),j=R(function(){return!H("z").propertyIsEnumerable(0)})?function(e){return"String"===_(e)?U(e,""):H(e)}:H,q=function(e){return null===e||void 0===e},V=q,z=TypeError,G=function(e){if(V(e))throw new z("Can't call method on "+e);return e},W=j,J=G,K=function(e){return W(J(e))},Q="object"==typeof document&&document.all,$="undefined"==typeof Q&&void 0!==Q?function(e){return"function"==typeof e||e===Q}:function(e){return"function"==typeof e},Z=$,Y=function(e){return"object"==typeof e?null!==e:Z(e)},X=g,ee=$,te=function(e,t){return arguments.length<2?(r=X[e],ee(r)?r:void 0):X[e]&&X[e][t];var r},re=B({}.isPrototypeOf),oe="undefined"!=typeof navigator&&String(navigator.userAgent)||"",ne=g,ie=oe,se=ne.process,ae=ne.Deno,ce=se&&se.versions||ae&&ae.version,de=ce&&ce.v8;de&&(E=(T=de.split("."))[0]>0&&T[0]<4?1:+(T[0]+T[1])),!E&&ie&&(!(T=ie.match(/Edge\/(\d+)/))||T[1]>=74)&&(T=ie.match(/Chrome\/(\d+)/))&&(E=+T[1]);var le=E,ue=le,he=f,ge=g.String,pe=!!Object.getOwnPropertySymbols&&!he(function(){var e=Symbol("symbol detection");return!ge(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ue&&ue<41}),fe=pe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,me=te,ve=$,ye=re,be=Object,Se=fe?function(e){return"symbol"==typeof e}:function(e){var t=me("Symbol");return ve(t)&&ye(t.prototype,be(e))},Ce=String,ke=function(e){try{return Ce(e)}catch(t){return"Object"}},we=$,Pe=ke,Te=TypeError,Ee=function(e){if(we(e))return e;throw new Te(Pe(e)+" is not a function")},Ie=Ee,Ne=q,Ae=function(e,t){var r=e[t];return Ne(r)?void 0:Ie(r)},Fe=S,De=$,Be=Y,Le=TypeError,Oe={exports:{}},xe=g,Me=Object.defineProperty,Re=function(e,t){try{Me(xe,e,{value:t,configurable:!0,writable:!0})}catch(r){xe[e]=t}return t},_e=g,He=Re,Ue="__core-js_shared__",je=Oe.exports=_e[Ue]||He(Ue,{});(je.versions||(je.versions=[])).push({version:"3.36.1",mode:"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.1/LICENSE",source:"https://github.com/zloirock/core-js"});var qe=Oe.exports,Ve=qe,ze=function(e,t){return Ve[e]||(Ve[e]=t||{})},Ge=G,We=Object,Je=function(e){return We(Ge(e))},Ke=Je,Qe=B({}.hasOwnProperty),$e=Object.hasOwn||function(e,t){return Qe(Ke(e),t)},Ze=B,Ye=0,Xe=Math.random(),et=Ze(1..toString),tt=function(e){return"Symbol("+(void 0===e?"":e)+")_"+et(++Ye+Xe,36)},rt=ze,ot=$e,nt=tt,it=pe,st=fe,at=g.Symbol,ct=rt("wks"),dt=st?at.for||at:at&&at.withoutSetter||nt,lt=function(e){return ot(ct,e)||(ct[e]=it&&ot(at,e)?at[e]:dt("Symbol."+e)),ct[e]},ut=S,ht=Y,gt=Se,pt=Ae,ft=function(e,t){var r,o;if("string"===t&&De(r=e.toString)&&!Be(o=Fe(r,e)))return o;if(De(r=e.valueOf)&&!Be(o=Fe(r,e)))return o;if("string"!==t&&De(r=e.toString)&&!Be(o=Fe(r,e)))return o;throw new Le("Can't convert object to primitive value")},mt=TypeError,vt=lt("toPrimitive"),yt=function(e,t){if(!ht(e)||gt(e))return e;var r,o=pt(e,vt);if(o){if(void 0===t&&(t="default"),r=ut(o,e,t),!ht(r)||gt(r))return r;throw new mt("Can't convert object to primitive value")}return void 0===t&&(t="number"),ft(e,t)},bt=Se,St=function(e){var t=yt(e,"string");return bt(t)?t:t+""},Ct=Y,kt=g.document,wt=Ct(kt)&&Ct(kt.createElement),Pt=function(e){return wt?kt.createElement(e):{}},Tt=Pt,Et=!m&&!f(function(){return 7!==Object.defineProperty(Tt("div"),"a",{get:function(){return 7}}).a}),It=m,Nt=S,At=C,Ft=I,Dt=K,Bt=St,Lt=$e,Ot=Et,xt=Object.getOwnPropertyDescriptor;p.f=It?xt:function(e,t){if(e=Dt(e),t=Bt(t),Ot)try{return xt(e,t)}catch(r){}if(Lt(e,t))return Ft(!Nt(At.f,e,t),e[t])};var Mt={},Rt=m&&f(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),_t=Y,Ht=String,Ut=TypeError,jt=function(e){if(_t(e))return e;throw new Ut(Ht(e)+" is not an object")},qt=m,Vt=Et,zt=Rt,Gt=jt,Wt=St,Jt=TypeError,Kt=Object.defineProperty,Qt=Object.getOwnPropertyDescriptor,$t="enumerable",Zt="configurable",Yt="writable";Mt.f=qt?zt?function(e,t,r){if(Gt(e),t=Wt(t),Gt(r),"function"===typeof e&&"prototype"===t&&"value"in r&&Yt in r&&!r[Yt]){var o=Qt(e,t);o&&o[Yt]&&(e[t]=r.value,r={configurable:Zt in r?r[Zt]:o[Zt],enumerable:$t in r?r[$t]:o[$t],writable:!1})}return Kt(e,t,r)}:Kt:function(e,t,r){if(Gt(e),t=Wt(t),Gt(r),Vt)try{return Kt(e,t,r)}catch(o){}if("get"in r||"set"in r)throw new Jt("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Xt=Mt,er=I,tr=m?function(e,t,r){return Xt.f(e,t,er(1,r))}:function(e,t,r){return e[t]=r,e},rr={exports:{}},or=m,nr=$e,ir=Function.prototype,sr=or&&Object.getOwnPropertyDescriptor,ar=nr(ir,"name"),cr={EXISTS:ar,PROPER:ar&&"something"===function(){}.name,CONFIGURABLE:ar&&(!or||or&&sr(ir,"name").configurable)},dr=$,lr=qe,ur=B(Function.toString);dr(lr.inspectSource)||(lr.inspectSource=function(e){return ur(e)});var hr,gr,pr,fr=lr.inspectSource,mr=$,vr=g.WeakMap,yr=mr(vr)&&/native code/.test(String(vr)),br=tt,Sr=ze("keys"),Cr=function(e){return Sr[e]||(Sr[e]=br(e))},kr={},wr=yr,Pr=g,Tr=Y,Er=tr,Ir=$e,Nr=qe,Ar=Cr,Fr=kr,Dr="Object already initialized",Br=Pr.TypeError,Lr=Pr.WeakMap;if(wr||Nr.state){var Or=Nr.state||(Nr.state=new Lr);Or.get=Or.get,Or.has=Or.has,Or.set=Or.set,hr=function(e,t){if(Or.has(e))throw new Br(Dr);return t.facade=e,Or.set(e,t),t},gr=function(e){return Or.get(e)||{}},pr=function(e){return Or.has(e)}}else{var xr=Ar("state");Fr[xr]=!0,hr=function(e,t){if(Ir(e,xr))throw new Br(Dr);return t.facade=e,Er(e,xr,t),t},gr=function(e){return Ir(e,xr)?e[xr]:{}},pr=function(e){return Ir(e,xr)}}var Mr={set:hr,get:gr,has:pr,enforce:function(e){return pr(e)?gr(e):hr(e,{})},getterFor:function(e){return function(t){var r;if(!Tr(t)||(r=gr(t)).type!==e)throw new Br("Incompatible receiver, "+e+" required");return r}}},Rr=B,_r=f,Hr=$,Ur=$e,jr=m,qr=cr.CONFIGURABLE,Vr=fr,zr=Mr.enforce,Gr=Mr.get,Wr=String,Jr=Object.defineProperty,Kr=Rr("".slice),Qr=Rr("".replace),$r=Rr([].join),Zr=jr&&!_r(function(){return 8!==Jr(function(){},"length",{value:8}).length}),Yr=String(String).split("String"),Xr=rr.exports=function(e,t,r){"Symbol("===Kr(Wr(t),0,7)&&(t="["+Qr(Wr(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Ur(e,"name")||qr&&e.name!==t)&&(jr?Jr(e,"name",{value:t,configurable:!0}):e.name=t),Zr&&r&&Ur(r,"arity")&&e.length!==r.arity&&Jr(e,"length",{value:r.arity});try{r&&Ur(r,"constructor")&&r.constructor?jr&&Jr(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(n){}var o=zr(e);return Ur(o,"source")||(o.source=$r(Yr,"string"==typeof t?t:"")),e};Function.prototype.toString=Xr(function(){return Hr(this)&&Gr(this).source||Vr(this)},"toString");var eo=rr.exports,to=$,ro=Mt,oo=eo,no=Re,io=function(e,t,r,o){o||(o={});var n=o.enumerable,i=void 0!==o.name?o.name:t;if(to(r)&&oo(r,i,o),o.global)n?e[t]=r:no(t,r);else{try{o.unsafe?e[t]&&(n=!0):delete e[t]}catch(s){}n?e[t]=r:ro.f(e,t,{value:r,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e},so={},ao=Math.ceil,co=Math.floor,lo=Math.trunc||function(e){var t=+e;return(t>0?co:ao)(t)},uo=function(e){var t=+e;return t!==t||0===t?0:lo(t)},ho=uo,go=Math.max,po=Math.min,fo=uo,mo=Math.min,vo=function(e){var t=fo(e);return t>0?mo(t,9007199254740991):0},yo=function(e){return vo(e.length)},bo=K,So=function(e,t){var r=ho(e);return r<0?go(r+t,0):po(r,t)},Co=yo,ko=function(e){return function(t,r,o){var n=bo(t),i=Co(n);if(0===i)return!e&&-1;var s,a=So(o,i);if(e&&r!==r){for(;i>a;)if((s=n[a++])!==s)return!0}else for(;i>a;a++)if((e||a in n)&&n[a]===r)return e||a||0;return!e&&-1}},wo={includes:ko(!0),indexOf:ko(!1)},Po=$e,To=K,Eo=wo.indexOf,Io=kr,No=B([].push),Ao=function(e,t){var r,o=To(e),n=0,i=[];for(r in o)!Po(Io,r)&&Po(o,r)&&No(i,r);for(;t.length>n;)Po(o,r=t[n++])&&(~Eo(i,r)||No(i,r));return i},Fo=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Do=Ao,Bo=Fo.concat("length","prototype");so.f=Object.getOwnPropertyNames||function(e){return Do(e,Bo)};var Lo={};Lo.f=Object.getOwnPropertySymbols;var Oo=te,xo=so,Mo=Lo,Ro=jt,_o=B([].concat),Ho=Oo("Reflect","ownKeys")||function(e){var t=xo.f(Ro(e)),r=Mo.f;return r?_o(t,r(e)):t},Uo=$e,jo=Ho,qo=p,Vo=Mt,zo=function(e,t,r){for(var o=jo(t),n=Vo.f,i=qo.f,s=0;s<o.length;s++){var a=o[s];Uo(e,a)||r&&Uo(r,a)||n(e,a,i(t,a))}},Go=f,Wo=$,Jo=/#|\.prototype\./,Ko=function(e,t){var r=$o[Qo(e)];return r===Yo||r!==Zo&&(Wo(t)?Go(t):!!t)},Qo=Ko.normalize=function(e){return String(e).replace(Jo,".").toLowerCase()},$o=Ko.data={},Zo=Ko.NATIVE="N",Yo=Ko.POLYFILL="P",Xo=Ko,en=g,tn=p.f,rn=tr,on=io,nn=Re,sn=zo,an=Xo,cn=function(e,t){var r,o,n,i,s,a=e.target,c=e.global,d=e.stat;if(r=c?en:d?en[a]||nn(a,{}):en[a]&&en[a].prototype)for(o in t){if(i=t[o],n=e.dontCallGetSet?(s=tn(r,o))&&s.value:r[o],!an(c?o:a+(d?".":"#")+o,e.forced)&&void 0!==n){if(typeof i==typeof n)continue;sn(i,n)}(e.sham||n&&n.sham)&&rn(i,"sham",!0),on(r,o,i,e)}},dn=v,ln=Function.prototype,un=ln.apply,hn=ln.call,gn="object"==typeof Reflect&&Reflect.apply||(dn?hn.bind(un):function(){return hn.apply(un,arguments)}),pn=B,fn=Ee,mn=Y,vn=function(e){return mn(e)||null===e},yn=String,bn=TypeError,Sn=function(e,t,r){try{return pn(fn(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(o){}},Cn=Y,kn=G,wn=function(e){if(vn(e))return e;throw new bn("Can't set "+yn(e)+" as a prototype")},Pn=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Sn(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(o){}return function(r,o){return kn(r),wn(o),Cn(r)?(t?e(r,o):r.__proto__=o,r):r}}():void 0),Tn=Mt.f,En=$,In=Y,Nn=Pn,An={};An[lt("toStringTag")]="z";var Fn="[object z]"===String(An),Dn=$,Bn=M,Ln=lt("toStringTag"),On=Object,xn="Arguments"===Bn(function(){return arguments}()),Mn=Fn?Bn:function(e){var t,r,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=On(e),Ln))?r:xn?Bn(t):"Object"===(o=Bn(t))&&Dn(t.callee)?"Arguments":o},Rn=Mn,_n=String,Hn=function(e){if("Symbol"===Rn(e))throw new TypeError("Cannot convert a Symbol value to a string");return _n(e)},Un=Hn,jn=Y,qn=tr,Vn=Error,zn=B("".replace),Gn=String(new Vn("zxcasd").stack),Wn=/\n\s*at [^:]*:[^\n]*/,Jn=Wn.test(Gn),Kn=I,Qn=!f(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Kn(1,7)),7!==e.stack)}),$n=tr,Zn=function(e,t){if(Jn&&"string"==typeof e&&!Vn.prepareStackTrace)for(;t--;)e=zn(e,Wn,"");return e},Yn=Qn,Xn=Error.captureStackTrace,ei=te,ti=$e,ri=tr,oi=re,ni=Pn,ii=zo,si=function(e,t,r){r in e||Tn(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})},ai=function(e,t,r){var o,n;return Nn&&En(o=t.constructor)&&o!==r&&In(n=o.prototype)&&n!==r.prototype&&Nn(e,n),e},ci=function(e,t){return void 0===e?arguments.length<2?"":t:Un(e)},di=function(e,t){jn(t)&&"cause"in t&&qn(e,"cause",t.cause)},li=function(e,t,r,o){Yn&&(Xn?Xn(e,t):$n(e,"stack",Zn(r,o)))},ui=m,hi=cn,gi=gn,pi=function(e,t,r,o){var n="stackTraceLimit",i=o?2:1,s=e.split("."),a=s[s.length-1],c=ei.apply(null,s);if(c){var d=c.prototype;if(ti(d,"cause")&&delete d.cause,!r)return c;var l=ei("Error"),u=t(function(e,t){var r=ci(o?t:e,void 0),n=o?new c(e):new c;return void 0!==r&&ri(n,"message",r),li(n,u,n.stack,2),this&&oi(d,this)&&ai(n,this,u),arguments.length>i&&di(n,arguments[i]),n});u.prototype=d,"Error"!==a?ni?ni(u,l):ii(u,l,{name:!0}):ui&&n in c&&(si(u,c,n),si(u,c,"prepareStackTrace")),ii(u,c);try{d.name!==a&&ri(d,"name",a),d.constructor=u}catch(h){}return u}},fi="WebAssembly",mi=g[fi],vi=7!==new Error("e",{cause:7}).cause,yi=function(e,t){var r={};r[e]=pi(e,t,vi),hi({global:!0,constructor:!0,arity:1,forced:vi},r)},bi=function(e,t){if(mi&&mi[e]){var r={};r[e]=pi(fi+"."+e,t,vi),hi({target:fi,stat:!0,constructor:!0,arity:1,forced:vi},r)}};yi("Error",function(e){return function(t){return gi(e,this,arguments)}}),yi("EvalError",function(e){return function(t){return gi(e,this,arguments)}}),yi("RangeError",function(e){return function(t){return gi(e,this,arguments)}}),yi("ReferenceError",function(e){return function(t){return gi(e,this,arguments)}}),yi("SyntaxError",function(e){return function(t){return gi(e,this,arguments)}}),yi("TypeError",function(e){return function(t){return gi(e,this,arguments)}}),yi("URIError",function(e){return function(t){return gi(e,this,arguments)}}),bi("CompileError",function(e){return function(t){return gi(e,this,arguments)}}),bi("LinkError",function(e){return function(t){return gi(e,this,arguments)}}),bi("RuntimeError",function(e){return function(t){return gi(e,this,arguments)}});var Si={},Ci=Ao,ki=Fo,wi=Object.keys||function(e){return Ci(e,ki)},Pi=m,Ti=Rt,Ei=Mt,Ii=jt,Ni=K,Ai=wi;Si.f=Pi&&!Ti?Object.defineProperties:function(e,t){Ii(e);for(var r,o=Ni(t),n=Ai(t),i=n.length,s=0;i>s;)Ei.f(e,r=n[s++],o[r]);return e};var Fi,Di=te("document","documentElement"),Bi=jt,Li=Si,Oi=Fo,xi=kr,Mi=Di,Ri=Pt,_i="prototype",Hi="script",Ui=Cr("IE_PROTO"),ji=function(){},qi=function(e){return"<"+Hi+">"+e+"</"+Hi+">"},Vi=function(e){e.write(qi("")),e.close();var t=e.parentWindow.Object;return e=null,t},zi=function(){try{Fi=new ActiveXObject("htmlfile")}catch(t){}zi="undefined"!=typeof document?document.domain&&Fi?Vi(Fi):function(){var e,t=Ri("iframe"),r="java"+Hi+":";return t.style.display="none",Mi.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(qi("document.F=Object")),e.close(),e.F}():Vi(Fi);for(var e=Oi.length;e--;)delete zi[_i][Oi[e]];return zi()};xi[Ui]=!0;var Gi=Object.create||function(e,t){var r;return null!==e?(ji[_i]=Bi(e),r=new ji,ji[_i]=null,r[Ui]=e):r=zi(),void 0===t?r:Li.f(r,t)},Wi=lt,Ji=Gi,Ki=Mt.f,Qi=Wi("unscopables"),$i=Array.prototype;void 0===$i[Qi]&&Ki($i,Qi,{configurable:!0,value:Ji(null)});var Zi,Yi,Xi,es=function(e){$i[Qi][e]=!0},ts={},rs=!f(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),os=$e,ns=$,is=Je,ss=rs,as=Cr("IE_PROTO"),cs=Object,ds=cs.prototype,ls=ss?cs.getPrototypeOf:function(e){var t=is(e);if(os(t,as))return t[as];var r=t.constructor;return ns(r)&&t instanceof r?r.prototype:t instanceof cs?ds:null},us=f,hs=$,gs=Y,ps=ls,fs=io,ms=lt("iterator"),vs=!1;[].keys&&("next"in(Xi=[].keys())?(Yi=ps(ps(Xi)))!==Object.prototype&&(Zi=Yi):vs=!0);var ys=!gs(Zi)||us(function(){var e={};return Zi[ms].call(e)!==e});ys&&(Zi={}),hs(Zi[ms])||fs(Zi,ms,function(){return this});var bs={IteratorPrototype:Zi,BUGGY_SAFARI_ITERATORS:vs},Ss=Mt.f,Cs=$e,ks=lt("toStringTag"),ws=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Cs(e,ks)&&Ss(e,ks,{configurable:!0,value:t})},Ps=bs.IteratorPrototype,Ts=Gi,Es=I,Is=ws,Ns=ts,As=function(){return this},Fs=cn,Ds=S,Bs=$,Ls=function(e,t,r,o){var n=t+" Iterator";return e.prototype=Ts(Ps,{next:Es(+!o,r)}),Is(e,n,!1),Ns[n]=As,e},Os=ls,xs=Pn,Ms=ws,Rs=tr,_s=io,Hs=ts,Us=cr.PROPER,js=cr.CONFIGURABLE,qs=bs.IteratorPrototype,Vs=bs.BUGGY_SAFARI_ITERATORS,zs=lt("iterator"),Gs="keys",Ws="values",Js="entries",Ks=function(){return this},Qs=K,$s=es,Zs=ts,Ys=Mr,Xs=Mt.f,ea=function(e,t,r,o,n,i,s){Ls(r,t,o);var a,c,d,l=function(e){if(e===n&&f)return f;if(!Vs&&e&&e in g)return g[e];switch(e){case Gs:case Ws:case Js:return function(){return new r(this,e)}}return function(){return new r(this)}},u=t+" Iterator",h=!1,g=e.prototype,p=g[zs]||g["@@iterator"]||n&&g[n],f=!Vs&&p||l(n),m="Array"===t&&g.entries||p;if(m&&(a=Os(m.call(new e)))!==Object.prototype&&a.next&&(Os(a)!==qs&&(xs?xs(a,qs):Bs(a[zs])||_s(a,zs,Ks)),Ms(a,u,!0)),Us&&n===Ws&&p&&p.name!==Ws&&(js?Rs(g,"name",Ws):(h=!0,f=function(){return Ds(p,this)})),n)if(c={values:l(Ws),keys:i?f:l(Gs),entries:l(Js)},s)for(d in c)(Vs||h||!(d in g))&&_s(g,d,c[d]);else Fs({target:t,proto:!0,forced:Vs||h},c);return g[zs]!==f&&_s(g,zs,f,{name:n}),Hs[t]=f,c},ta=function(e,t){return{value:e,done:t}},ra=m,oa="Array Iterator",na=Ys.set,ia=Ys.getterFor(oa),sa=ea(Array,"Array",function(e,t){na(this,{type:oa,target:Qs(e),index:0,kind:t})},function(){var e=ia(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=void 0,ta(void 0,!0);switch(e.kind){case"keys":return ta(r,!1);case"values":return ta(t[r],!1)}return ta([r,t[r]],!1)},"values"),aa=Zs.Arguments=Zs.Array;if($s("keys"),$s("values"),$s("entries"),ra&&"values"!==aa.name)try{Xs(aa,"name",{value:"values"})}catch(ip){}var ca="process"===M(g.process),da=eo,la=Mt,ua=function(e,t,r){return r.get&&da(r.get,t,{getter:!0}),r.set&&da(r.set,t,{setter:!0}),la.f(e,t,r)},ha=te,ga=ua,pa=m,fa=lt("species"),ma=re,va=TypeError,ya=function(e,t){if(ma(t,e))return e;throw new va("Incorrect invocation")},ba=B,Sa=f,Ca=$,ka=Mn,wa=fr,Pa=function(){},Ta=te("Reflect","construct"),Ea=/^\s*(?:class|function)\b/,Ia=ba(Ea.exec),Na=!Ea.test(Pa),Aa=function(e){if(!Ca(e))return!1;try{return Ta(Pa,[],e),!0}catch(ip){return!1}},Fa=function(e){if(!Ca(e))return!1;switch(ka(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Na||!!Ia(Ea,wa(e))}catch(ip){return!0}};Fa.sham=!0;var Da,Ba,La,Oa,xa=!Ta||Sa(function(){var e;return Aa(Aa.call)||!Aa(Object)||!Aa(function(){e=!0})||e})?Fa:Aa,Ma=xa,Ra=ke,_a=TypeError,Ha=jt,Ua=function(e){if(Ma(e))return e;throw new _a(Ra(e)+" is not a constructor")},ja=q,qa=lt("species"),Va=M,za=B,Ga=function(e){if("Function"===Va(e))return za(e)},Wa=Ee,Ja=v,Ka=Ga(Ga.bind),Qa=function(e,t){return Wa(e),void 0===t?e:Ja?Ka(e,t):function(){return e.apply(t,arguments)}},$a=B([].slice),Za=TypeError,Ya=/(?:ipad|iphone|ipod).*applewebkit/i.test(oe),Xa=g,ec=gn,tc=Qa,rc=$,oc=$e,nc=f,ic=Di,sc=$a,ac=Pt,cc=function(e,t){if(e<t)throw new Za("Not enough arguments");return e},dc=Ya,lc=ca,uc=Xa.setImmediate,hc=Xa.clearImmediate,gc=Xa.process,pc=Xa.Dispatch,fc=Xa.Function,mc=Xa.MessageChannel,vc=Xa.String,yc=0,bc={},Sc="onreadystatechange";nc(function(){Da=Xa.location});var Cc=function(e){if(oc(bc,e)){var t=bc[e];delete bc[e],t()}},kc=function(e){return function(){Cc(e)}},wc=function(e){Cc(e.data)},Pc=function(e){Xa.postMessage(vc(e),Da.protocol+"//"+Da.host)};uc&&hc||(uc=function(e){cc(arguments.length,1);var t=rc(e)?e:fc(e),r=sc(arguments,1);return bc[++yc]=function(){ec(t,void 0,r)},Ba(yc),yc},hc=function(e){delete bc[e]},lc?Ba=function(e){gc.nextTick(kc(e))}:pc&&pc.now?Ba=function(e){pc.now(kc(e))}:mc&&!dc?(Oa=(La=new mc).port2,La.port1.onmessage=wc,Ba=tc(Oa.postMessage,Oa)):Xa.addEventListener&&rc(Xa.postMessage)&&!Xa.importScripts&&Da&&"file:"!==Da.protocol&&!nc(Pc)?(Ba=Pc,Xa.addEventListener("message",wc,!1)):Ba=Sc in ac("script")?function(e){ic.appendChild(ac("script"))[Sc]=function(){ic.removeChild(this),Cc(e)}}:function(e){setTimeout(kc(e),0)});var Tc={set:uc,clear:hc},Ec=g,Ic=m,Nc=Object.getOwnPropertyDescriptor,Ac=function(){this.head=null,this.tail=null};Ac.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Fc,Dc,Bc,Lc,Oc,xc=Ac,Mc=/ipad|iphone|ipod/i.test(oe)&&"undefined"!=typeof Pebble,Rc=/web0s(?!.*chrome)/i.test(oe),_c=g,Hc=function(e){if(!Ic)return Ec[e];var t=Nc(Ec,e);return t&&t.value},Uc=Qa,jc=Tc.set,qc=xc,Vc=Ya,zc=Mc,Gc=Rc,Wc=ca,Jc=_c.MutationObserver||_c.WebKitMutationObserver,Kc=_c.document,Qc=_c.process,$c=_c.Promise,Zc=Hc("queueMicrotask");if(!Zc){var Yc=new qc,Xc=function(){var e,t;for(Wc&&(e=Qc.domain)&&e.exit();t=Yc.get();)try{t()}catch(ip){throw Yc.head&&Fc(),ip}e&&e.enter()};Vc||Wc||Gc||!Jc||!Kc?!zc&&$c&&$c.resolve?((Lc=$c.resolve(void 0)).constructor=$c,Oc=Uc(Lc.then,Lc),Fc=function(){Oc(Xc)}):Wc?Fc=function(){Qc.nextTick(Xc)}:(jc=Uc(jc,_c),Fc=function(){jc(Xc)}):(Dc=!0,Bc=Kc.createTextNode(""),new Jc(Xc).observe(Bc,{characterData:!0}),Fc=function(){Bc.data=Dc=!Dc}),Zc=function(e){Yc.head||Fc(),Yc.add(e)}}var ed=Zc,td=function(e){try{return{error:!1,value:e()}}catch(ip){return{error:!0,value:ip}}},rd=g.Promise,od="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,nd=!od&&!ca&&"object"==typeof window&&"object"==typeof document,id=g,sd=rd,ad=$,cd=Xo,dd=fr,ld=lt,ud=nd,hd=od,gd=le;sd&&sd.prototype;var pd=ld("species"),fd=!1,md=ad(id.PromiseRejectionEvent),vd=cd("Promise",function(){var e=dd(sd),t=e!==String(sd);if(!t&&66===gd)return!0;if(!gd||gd<51||!/native code/.test(e)){var r=new sd(function(e){e(1)}),o=function(e){e(function(){},function(){})};if((r.constructor={})[pd]=o,!(fd=r.then(function(){})instanceof o))return!0}return!t&&(ud||hd)&&!md}),yd={CONSTRUCTOR:vd,REJECTION_EVENT:md,SUBCLASSING:fd},bd={},Sd=Ee,Cd=TypeError,kd=function(e){var t,r;this.promise=new e(function(e,o){if(void 0!==t||void 0!==r)throw new Cd("Bad Promise constructor");t=e,r=o}),this.resolve=Sd(t),this.reject=Sd(r)};bd.f=function(e){return new kd(e)};var wd,Pd,Td,Ed=cn,Id=ca,Nd=g,Ad=S,Fd=io,Dd=Pn,Bd=ws,Ld=function(e){var t=ha(e);pa&&t&&!t[fa]&&ga(t,fa,{configurable:!0,get:function(){return this}})},Od=Ee,xd=$,Md=Y,Rd=ya,_d=function(e,t){var r,o=Ha(e).constructor;return void 0===o||ja(r=Ha(o)[qa])?t:Ua(r)},Hd=Tc.set,Ud=ed,jd=function(e,t){try{1===arguments.length?console.error(e):console.error(e,t)}catch(ip){}},qd=td,Vd=xc,zd=Mr,Gd=rd,Wd=bd,Jd="Promise",Kd=yd.CONSTRUCTOR,Qd=yd.REJECTION_EVENT,$d=yd.SUBCLASSING,Zd=zd.getterFor(Jd),Yd=zd.set,Xd=Gd&&Gd.prototype,el=Gd,tl=Xd,rl=Nd.TypeError,ol=Nd.document,nl=Nd.process,il=Wd.f,sl=il,al=!!(ol&&ol.createEvent&&Nd.dispatchEvent),cl="unhandledrejection",dl=function(e){var t;return!(!Md(e)||!xd(t=e.then))&&t},ll=function(e,t){var r,o,n,i=t.value,s=1===t.state,a=s?e.ok:e.fail,c=e.resolve,d=e.reject,l=e.domain;try{a?(s||(2===t.rejection&&fl(t),t.rejection=1),!0===a?r=i:(l&&l.enter(),r=a(i),l&&(l.exit(),n=!0)),r===e.promise?d(new rl("Promise-chain cycle")):(o=dl(r))?Ad(o,r,c,d):c(r)):d(i)}catch(ip){l&&!n&&l.exit(),d(ip)}},ul=function(e,t){e.notified||(e.notified=!0,Ud(function(){for(var r,o=e.reactions;r=o.get();)ll(r,e);e.notified=!1,t&&!e.rejection&&gl(e)}))},hl=function(e,t,r){var o,n;al?((o=ol.createEvent("Event")).promise=t,o.reason=r,o.initEvent(e,!1,!0),Nd.dispatchEvent(o)):o={promise:t,reason:r},!Qd&&(n=Nd["on"+e])?n(o):e===cl&&jd("Unhandled promise rejection",r)},gl=function(e){Ad(Hd,Nd,function(){var t,r=e.facade,o=e.value;if(pl(e)&&(t=qd(function(){Id?nl.emit("unhandledRejection",o,r):hl(cl,r,o)}),e.rejection=Id||pl(e)?2:1,t.error))throw t.value})},pl=function(e){return 1!==e.rejection&&!e.parent},fl=function(e){Ad(Hd,Nd,function(){var t=e.facade;Id?nl.emit("rejectionHandled",t):hl("rejectionhandled",t,e.value)})},ml=function(e,t,r){return function(o){e(t,o,r)}},vl=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,ul(e,!0))},yl=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new rl("Promise can't be resolved itself");var o=dl(t);o?Ud(function(){var r={done:!1};try{Ad(o,t,ml(yl,r,e),ml(vl,r,e))}catch(ip){vl(r,ip,e)}}):(e.value=t,e.state=1,ul(e,!1))}catch(ip){vl({done:!1},ip,e)}}};if(Kd&&(tl=(el=function(e){Rd(this,tl),Od(e),Ad(wd,this);var t=Zd(this);try{e(ml(yl,t),ml(vl,t))}catch(ip){vl(t,ip)}}).prototype,(wd=function(e){Yd(this,{type:Jd,done:!1,notified:!1,parent:!1,reactions:new Vd,rejection:!1,state:0,value:void 0})}).prototype=Fd(tl,"then",function(e,t){var r=Zd(this),o=il(_d(this,el));return r.parent=!0,o.ok=!xd(e)||e,o.fail=xd(t)&&t,o.domain=Id?nl.domain:void 0,0===r.state?r.reactions.add(o):Ud(function(){ll(o,r)}),o.promise}),Pd=function(){var e=new wd,t=Zd(e);this.promise=e,this.resolve=ml(yl,t),this.reject=ml(vl,t)},Wd.f=il=function(e){return e===el||undefined===e?new Pd(e):sl(e)},xd(Gd)&&Xd!==Object.prototype)){Td=Xd.then,$d||Fd(Xd,"then",function(e,t){var r=this;return new el(function(e,t){Ad(Td,r,e,t)}).then(e,t)},{unsafe:!0});try{delete Xd.constructor}catch(ip){}Dd&&Dd(Xd,tl)}Ed({global:!0,constructor:!0,wrap:!0,forced:Kd},{Promise:el}),Bd(el,Jd,!1),Ld(Jd);var bl=ts,Sl=lt("iterator"),Cl=Array.prototype,kl=Mn,wl=Ae,Pl=q,Tl=ts,El=lt("iterator"),Il=function(e){if(!Pl(e))return wl(e,El)||wl(e,"@@iterator")||Tl[kl(e)]},Nl=S,Al=Ee,Fl=jt,Dl=ke,Bl=Il,Ll=TypeError,Ol=S,xl=jt,Ml=Ae,Rl=Qa,_l=S,Hl=jt,Ul=ke,jl=function(e){return void 0!==e&&(bl.Array===e||Cl[Sl]===e)},ql=yo,Vl=re,zl=function(e,t){var r=arguments.length<2?Bl(e):t;if(Al(r))return Fl(Nl(r,e));throw new Ll(Dl(e)+" is not iterable")},Gl=Il,Wl=function(e,t,r){var o,n;xl(e);try{if(!(o=Ml(e,"return"))){if("throw"===t)throw r;return r}o=Ol(o,e)}catch(ip){n=!0,o=ip}if("throw"===t)throw r;if(n)throw o;return xl(o),r},Jl=TypeError,Kl=function(e,t){this.stopped=e,this.result=t},Ql=Kl.prototype,$l=function(e,t,r){var o,n,i,s,a,c,d,l=r&&r.that,u=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),g=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),f=Rl(t,l),m=function(e){return o&&Wl(o,"normal",e),new Kl(!0,e)},v=function(e){return u?(Hl(e),p?f(e[0],e[1],m):f(e[0],e[1])):p?f(e,m):f(e)};if(h)o=e.iterator;else if(g)o=e;else{if(!(n=Gl(e)))throw new Jl(Ul(e)+" is not iterable");if(jl(n)){for(i=0,s=ql(e);s>i;i++)if((a=v(e[i]))&&Vl(Ql,a))return a;return new Kl(!1)}o=zl(e,n)}for(c=h?e.next:o.next;!(d=_l(c,o)).done;){try{a=v(d.value)}catch(ip){Wl(o,"throw",ip)}if("object"==typeof a&&a&&Vl(Ql,a))return a}return new Kl(!1)},Zl=lt("iterator"),Yl=!1;try{var Xl=0,eu={next:function(){return{done:!!Xl++}},return:function(){Yl=!0}};eu[Zl]=function(){return this},Array.from(eu,function(){throw 2})}catch(ip){}var tu=rd,ru=function(e,t){try{if(!t&&!Yl)return!1}catch(ip){return!1}var r=!1;try{var o={};o[Zl]=function(){return{next:function(){return{done:r=!0}}}},e(o)}catch(ip){}return r},ou=yd.CONSTRUCTOR||!ru(function(e){tu.all(e).then(void 0,function(){})}),nu=S,iu=Ee,su=bd,au=td,cu=$l;cn({target:"Promise",stat:!0,forced:ou},{all:function(e){var t=this,r=su.f(t),o=r.resolve,n=r.reject,i=au(function(){var r=iu(t.resolve),i=[],s=0,a=1;cu(e,function(e){var c=s++,d=!1;a++,nu(r,t,e).then(function(e){d||(d=!0,i[c]=e,--a||o(i))},n)}),--a||o(i)});return i.error&&n(i.value),r.promise}});var du=cn,lu=yd.CONSTRUCTOR,uu=rd,hu=te,gu=$,pu=io,fu=uu&&uu.prototype;if(du({target:"Promise",proto:!0,forced:lu,real:!0},{catch:function(e){return this.then(void 0,e)}}),gu(uu)){var mu=hu("Promise").prototype.catch;fu.catch!==mu&&pu(fu,"catch",mu,{unsafe:!0})}var vu=S,yu=Ee,bu=bd,Su=td,Cu=$l;cn({target:"Promise",stat:!0,forced:ou},{race:function(e){var t=this,r=bu.f(t),o=r.reject,n=Su(function(){var n=yu(t.resolve);Cu(e,function(e){vu(n,t,e).then(r.resolve,o)})});return n.error&&o(n.value),r.promise}});var ku=bd;cn({target:"Promise",stat:!0,forced:yd.CONSTRUCTOR},{reject:function(e){var t=ku.f(this);return(0,t.reject)(e),t.promise}});var wu=jt,Pu=Y,Tu=bd,Eu=cn,Iu=yd.CONSTRUCTOR,Nu=function(e,t){if(wu(e),Pu(t)&&t.constructor===e)return t;var r=Tu.f(e);return(0,r.resolve)(t),r.promise};te("Promise"),Eu({target:"Promise",stat:!0,forced:Iu},{resolve:function(e){return Nu(this,e)}});var Au=jt,Fu=function(){var e=Au(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Du=S,Bu=$e,Lu=re,Ou=Fu,xu=RegExp.prototype,Mu=cr.PROPER,Ru=io,_u=jt,Hu=Hn,Uu=f,ju=function(e){var t=e.flags;return void 0!==t||"flags"in xu||Bu(e,"flags")||!Lu(xu,e)?t:Du(Ou,e)},qu="toString",Vu=RegExp.prototype,zu=Vu[qu],Gu=Uu(function(){return"/a/b"!==zu.call({source:"a",flags:"b"})}),Wu=Mu&&zu.name!==qu;(Gu||Wu)&&Ru(Vu,qu,function(){var e=_u(this);return"/"+Hu(e.source)+"/"+Hu(ju(e))},{unsafe:!0});var Ju=m,Ku=Mt,Qu=I,$u=cn,Zu=g,Yu=ya,Xu=jt,eh=$,th=ls,rh=ua,oh=function(e,t,r){Ju?Ku.f(e,t,Qu(0,r)):e[t]=r},nh=f,ih=$e,sh=bs.IteratorPrototype,ah=m,ch="constructor",dh="Iterator",lh=lt("toStringTag"),uh=TypeError,hh=Zu[dh],gh=!eh(hh)||hh.prototype!==sh||!nh(function(){hh({})}),ph=function(){if(Yu(this,sh),th(this)===sh)throw new uh("Abstract class Iterator not directly constructable")},fh=function(e,t){ah?rh(sh,e,{configurable:!0,get:function(){return t},set:function(t){if(Xu(this),this===sh)throw new uh("You can't redefine this property");ih(this,e)?this[e]=t:oh(this,e,t)}}):sh[e]=t};ih(sh,lh)||fh(lh,dh),!gh&&ih(sh,ch)&&sh[ch]!==Object||fh(ch,ph),ph.prototype=sh,$u({global:!0,constructor:!0,forced:gh},{Iterator:ph});var mh=$l,vh=Ee,yh=jt,bh=function(e){return{iterator:e,next:e.next,done:!1}};cn({target:"Iterator",proto:!0,real:!0},{find:function(e){yh(this),vh(e);var t=bh(this),r=0;return mh(t,function(t,o){if(e(t,r++))return o(t)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});var Sh=Pt("span").classList,Ch=Sh&&Sh.constructor&&Sh.constructor.prototype,kh=Ch===Object.prototype?void 0:Ch,wh=g,Ph={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Th=kh,Eh=sa,Ih=tr,Nh=ws,Ah=lt("iterator"),Fh=Eh.values,Dh=function(e,t){if(e){if(e[Ah]!==Fh)try{Ih(e,Ah,Fh)}catch(ip){e[Ah]=Fh}if(Nh(e,t,!0),Ph[t])for(var r in Eh)if(e[r]!==Eh[r])try{Ih(e,r,Eh[r])}catch(ip){e[r]=Eh[r]}}};for(var Bh in Ph)Dh(wh[Bh]&&wh[Bh].prototype,Bh);Dh(Th,"DOMTokenList");const Lh=(e,t)=>Object.assign(void 0!==t?function(){return(0,n.A)({type:e},t(...arguments))}:t=>void 0!==t?(0,n.A)({type:e},t):{type:e},{type:e}),Oh="[Loop]",xh="".concat(Oh," [Start]"),Mh="".concat(Oh," [Resolve]"),Rh="".concat(Oh," [Reject]"),_h=e=>({start:Object.assign(t=>Lh("".concat(xh," ").concat(e),e=>(0,n.A)((0,n.A)({},t),{},{asyncId:window.crypto.randomUUID(),instanceId:e})),{type:"".concat(xh," ").concat(e)}),resolve:Object.assign(t=>Lh("".concat(Mh," ").concat(e),(e,r)=>(0,n.A)((0,n.A)({},t),{},{asyncId:r,instanceId:e})),{type:"".concat(Mh," ").concat(e)}),reject:Object.assign(t=>Lh("".concat(Rh," ").concat(e),(e,r)=>(0,n.A)((0,n.A)({},t),{},{asyncId:r,instanceId:e})),{type:"".concat(Rh," ").concat(e)})});function Hh(e){return void 0!==e.asyncId}class Uh{constructor(e){this.target=e,this.listeners=new Set,this.typeListeners=new Map,this.asyncListeners=new Map,this.asyncResponders=new Map,this.messageDelegator=e=>this.onMessage(e),this.listener=e=>this.messageDelegator(e),this.queue=[],window.addEventListener("message",this.listener)}pause(e){this.messageDelegator=t=>{e&&e(t)?this.onMessage(t):this.queue.push(t)}}flush(){const e=this.queue;this.queue=[];for(const t of e)this.onMessage(t)}resume(){this.messageDelegator=e=>this.onMessage(e),this.flush()}dispose(){window.removeEventListener("message",this.listener),this.listeners.clear(),this.typeListeners.clear(),this.asyncListeners.clear(),this.asyncResponders.clear(),this.queue=[]}listen(e){this.listeners.add(e)}listenFor(e,t){let{type:r}=e;const o=this.typeListeners.get(r);o?o.add(t):this.typeListeners.set(r,new Set([t]))}listenForAsync(e,t){const r=e.start.type,o=this.asyncListeners.get(r);o?o.add(t):this.asyncListeners.set(r,new Set([t]))}send(e){"function"===typeof e?this.sendMessage(e(this.target.instanceId)):this.sendMessage((0,n.A)((0,n.A)({},e),{},{instanceId:this.target.instanceId}))}async sendAsync(e){return new Promise((t,r)=>{const o=e(this.target.instanceId),{asyncId:n}=o;this.asyncResponders.set(n,[t,r]),this.sendMessage(o)})}onMessage(e){if(this.target.origin!==e.origin)return;const t=e.data;if(function(e){const t=e;return null!=t&&"object"===typeof t&&void 0!==t.type&&void 0!==t.instanceId}(t)){if(Hh(t)){const e=this.asyncResponders.get(t.asyncId);if(e){this.asyncResponders.delete(t.asyncId);const[r,n]=e,{type:i,asyncId:s,instanceId:a}=t,c=(0,o.A)(t,l);i.startsWith(Mh)?r(c):t.type.startsWith(Rh)&&n(c)}}for(const r of Array.from(this.listeners))r(t);const e=this.typeListeners.get(t.type);if(e)for(const r of Array.from(e))r(t);if(Hh(t)&&t.type.startsWith(xh)){const e=this.asyncListeners.get(t.type);if(e)for(const r of Array.from(e))Promise.resolve(r(t)).then(e=>this.sendMessage(e(t.instanceId,t.asyncId)))}}}sendMessage(e){var t;null===(t=this.target.window())||void 0===t||t.postMessage(e,this.target.origin)}}class jh extends Uh{constructor(e,t,r){super({origin:e,window:t,instanceId:r})}}const qh=_h("Open"),Vh=_h("Initialize"),zh=_h("GetToken"),Gh=_h("Render"),Wh=_h("SetIframeSize"),Jh=_h("LoopActivity"),Kh=[0,0,1];class Qh{constructor(e,t){this.container=e,this.config=t,this.renderPromiseResolver={resolve:()=>{},reject:()=>{}},this.renderPromise=new Promise((e,t)=>this.renderPromiseResolver={resolve:e,reject:t})}dispose(){var e,t;null===(e=this.broker)||void 0===e||e.dispose(),this.broker=void 0,null===(t=this.iframe)||void 0===t||t.remove(),this.iframe=void 0,this.instanceId=void 0}async open(e){return await this.bootstrap(e),this.broker?this.broker.sendAsync(qh.start(e)):{kind:"Unknown",resolved:"Unknown"}}setupLoopActivityListeners(e){var t;null===(t=this.broker)||void 0===t||t.listenForAsync(Jh,t=>{let{options:r}=t;return this.instanceId&&(null===r||void 0===r?void 0:r.iframeInstanceId)===this.instanceId&&e(r),Jh.resolve({isError:!1})})}async bootstrap(e){var t;if(this.broker)return Kh;const r=new URL(e.url);r.pathname="loop",r.search="";const o=this.config.featureSwitches;if(o)for(const d in o)r.searchParams.set(d,o[d]?"1":"0");this.instanceId=window.crypto.randomUUID();const n=function(e,t,r){const o="string"===typeof e?new URL(e):e;return o.searchParams.set("__instanceId",t),o.searchParams.set("__hostOrigin",r),o}(r,this.instanceId,location.origin),i=this.iframe=this.container.ownerDocument.createElement("iframe");i.src=n.toString(),i.style.width="100%",i.style.height="400px",i.style.border="none",i.title="Power BI",i.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms");const s=null===(t=new URLSearchParams(i.src))||void 0===t?void 0:t.get("__hostOrigin"),a=new Promise((e,t)=>{i.onload=e,i.onerror=t});this.broker=new jh(r.origin,()=>null===i||void 0===i?void 0:i.contentWindow,this.instanceId);const c=new Promise((t,r)=>{var o;null===(o=this.broker)||void 0===o||o.listenForAsync(Vh,o=>{let{version:n}=o;return(e=>e[0]===Kh[0])(n)?t(n):r(n),Vh.resolve({version:Kh,context:this.config.hostContext,launchPbiStartTime:e.launchPbiStartTime,hostName:null!==s&&void 0!==s?s:"unknown"})})});return this.setupListeners(),this.container.appendChild(i),this.renderPromiseResolver.resolve(),await a,c}setupListeners(){var e,t,r;null===(e=this.broker)||void 0===e||e.listenForAsync(zh,e=>{let{scopes:t,options:r}=e;return this.config.providers.token.getToken(t,r).then(zh.resolve,zh.reject)}),null===(t=this.broker)||void 0===t||t.listenForAsync(Gh,e=>{let{isError:t}=e;return t?this.renderPromiseResolver.reject():this.renderPromiseResolver.resolve(),Gh.resolve({isError:t})}),null===(r=this.broker)||void 0===r||r.listenForAsync(Wh,e=>{let{options:t}=e;var r;this.instanceId&&(null===t||void 0===t?void 0:t.iframeInstanceId)===this.instanceId&&(null===(r=this.iframe)||void 0===r||r.style.setProperty("height","".concat(null===t||void 0===t?void 0:t.height,"px")));return Wh.resolve({isError:!1})})}}const $h="@trident/powerbi-loop",Zh="Power BI";class Yh extends d.EventEmitter{constructor(e,t){if(super(),this.props=e,this.providers=t,this.isFocused=!1,this.hostKeyboardShortcuts=[],this.isUserActivityLogged=!1,this.visualReadyTracker=(0,i.p)("visualReady",this),this.fullUiReadyTracker=(0,i.p)("fullUIReady",this),this.launchPbiStartTime=performance.timeOrigin,!t)throw Error("Missing providers")}get ComponentFocusable(){return this}giveFocus(){return this.setFocus()}isComponentFocused(){return this.hasFocus()}setHostComponentFocusable(e){this.hostComponentFocusable=e}get FocusableV2(){return this}setFocus(){var e;if(!this.iframeInstanceId)return!1;const t=null==(e=document.querySelector('iframe[src*="__instanceId='.concat(this.iframeInstanceId,'"]')))?void 0:e.contentWindow;return t&&(t.focus(),this.isFocused=!0),this.isFocused}hasFocus(){return this.isFocused}get KeyboardShortcutEmitter(){return this}setShortcuts(e){this.hostKeyboardShortcuts=e}get UserActivityProvider(){return this}get RenderStageEmitter(){return this}get HTMLView(){return this}async render(e){var t,r,o;this.visualReadyTracker.start(),this.fullUiReadyTracker.start();const[n,i,s]=await Promise.all([null==(t=this.providers)?void 0:t.InternationalizationContext,null==(r=this.providers)?void 0:r.TelemetryConfig,null==(o=this.providers)?void 0:o.TokenProvider]);if(!s)throw Error("No telemetryConfig or token provider");var a;return this.loopClient=new Qh(e,{featureSwitches:{},hostContext:{hostSessionId:(null==i?void 0:i.hostSessionId)||"",hostLocaleContext:(null==n?void 0:n.uiLocale)||"",hostCorrelationId:(null==i?void 0:i.hostCorrelationId)||""},providers:{token:{getToken:async function(e){const t=e[0];if(1!==e.length||"https://analysis.windows-int.net/powerbi/api/.default"!==t&&"https://analysis.windows.net/powerbi/api/.default"!==t)throw Error("Incorrect token scopes requested");{const t=await(null==s?void 0:s.getToken(e,{request:null}));if(t){return{token:null==t?void 0:t.token}}throw Error("No token")}}}}}),this.props.url&&(this.loopClient.open({url:null==(a=this.props.url)?void 0:a.toString(),launchPbiStartTime:this.launchPbiStartTime}),this.loopClient.setupLoopActivityListeners(e=>this.loopActivityHandler(e))),this.loopClient.renderPromise}async dispose(){this.element&&delete this.element}loopActivityHandler(e){if(this.iframeInstanceId=e.iframeInstanceId,"visualReady"===e.type)this.visualReadyTracker.end();else if("fullUIReady"===e.type)this.fullUiReadyTracker.end();else if("keyPress"===e.type){if("ctrlF6"===e.message){var t;const e=new KeyboardEvent("keydown",{key:"F6",code:"F6",ctrlKey:!0,bubbles:!0,cancelable:!0}),r=null==(t=this.hostKeyboardShortcuts)?void 0:t.find(t=>(0,s.X)(e,t));null==r||r.handler(e)}else if("escape"===e.message){var r;this.FocusableV2.emit("moveFocusToHost"),this.hostComponentFocusable&&null!=(r=this.element)&&r.contains(document.activeElement)&&this.hostComponentFocusable.ComponentFocusable.giveFocus()}}else"userActivity"!==e.type||this.isUserActivityLogged||(this.emit("userActivity"),this.isUserActivityLogged=!0)}}class Xh{constructor(e,t){var r;this.powerBILoopInitialConfig=e,this.providers=t,this.name=Zh,this.iconUrl=(r="data:image/svg+xml,%3csvg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3cg clip-path='url(%23clip0_2135_196676)'%3e%3cmask id='mask0_2135_196676' style='mask-type:alpha' maskUnits='userSpaceOnUse' x='2' y='0' width='16' height='20'%3e%3cpath d='M10.8333 0.833333C10.8333 0.61232 10.9211 0.400358 11.0774 0.244078C11.2337 0.0877974 11.4457 0 11.6667 0L16.6667 0C16.8877 0 17.0996 0.0877974 17.2559 0.244078C17.4122 0.400358 17.5 0.61232 17.5 0.833333V19.1667C17.5 19.3877 17.4122 19.5996 17.2559 19.7559C17.0996 19.9122 16.8877 20 16.6667 20H3.33333C3.11232 20 2.90036 19.9122 2.74408 19.7559C2.5878 19.5996 2.5 19.3877 2.5 19.1667V10.8333C2.5 10.6123 2.5878 10.4004 2.74408 10.2441C2.90036 10.0878 3.11232 10 3.33333 10H6.66667V5.83333C6.66667 5.61232 6.75446 5.40036 6.91074 5.24408C7.06702 5.0878 7.27899 5 7.5 5H10.8333V0.833333Z' fill='white'/%3e%3c/mask%3e%3cg mask='url(%23mask0_2135_196676)'%3e%3cpath d='M17.5 0V20H10.8333V0H17.5Z' fill='url(%23paint0_linear_2135_196676)'/%3e%3cg filter='url(%23filter0_f_2135_196676)'%3e%3cpath d='M13.3334 5.91671V20.0834H6.66669V5.08337H12.5C12.721 5.08337 12.933 5.17117 13.0893 5.32745C13.2456 5.48373 13.3334 5.69569 13.3334 5.91671Z' fill='black' fill-opacity='0.2'/%3e%3c/g%3e%3cg filter='url(%23filter1_f_2135_196676)'%3e%3cpath d='M13.3334 6.24996V20.4166H6.66669V5.41663H12.5C12.721 5.41663 12.933 5.50442 13.0893 5.6607C13.2456 5.81698 13.3334 6.02895 13.3334 6.24996Z' fill='black' fill-opacity='0.18'/%3e%3c/g%3e%3cpath d='M13.3334 5.83333V20H6.66669V5H12.5C12.721 5 12.933 5.0878 13.0893 5.24408C13.2456 5.40036 13.3334 5.61232 13.3334 5.83333Z' fill='url(%23paint1_linear_2135_196676)'/%3e%3cpath d='M2.5 10V20H9.16667V10.8333C9.16667 10.6123 9.07887 10.4004 8.92259 10.2441C8.76631 10.0878 8.55435 10 8.33333 10H2.5Z' fill='url(%23paint2_linear_2135_196676)'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cfilter id='filter0_f_2135_196676' x='6.26669' y='4.68337' width='7.46669' height='15.8' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e%3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e%3cfeBlend mode='normal' in='SourceGraphic' in2='BackgroundImageFix' result='shape'/%3e%3cfeGaussianBlur stdDeviation='0.2' result='effect1_foregroundBlur_2135_196676'/%3e%3c/filter%3e%3cfilter id='filter1_f_2135_196676' x='2.66669' y='1.41663' width='14.6667' height='23' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3e%3cfeFlood flood-opacity='0' result='BackgroundImageFix'/%3e%3cfeBlend mode='normal' in='SourceGraphic' in2='BackgroundImageFix' result='shape'/%3e%3cfeGaussianBlur stdDeviation='2' result='effect1_foregroundBlur_2135_196676'/%3e%3c/filter%3e%3clinearGradient id='paint0_linear_2135_196676' x1='9.72206' y1='-1.22525e-07' x2='18.5135' y2='18.6348' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23E6AD10'/%3e%3cstop offset='1' stop-color='%23C87E0E'/%3e%3c/linearGradient%3e%3clinearGradient id='paint1_linear_2135_196676' x1='6.66606' y1='5' x2='14.0596' y2='19.3387' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23F6D751'/%3e%3cstop offset='1' stop-color='%23E6AD10'/%3e%3c/linearGradient%3e%3clinearGradient id='paint2_linear_2135_196676' x1='2.49937' y1='10' x2='6.585' y2='19.6829' gradientUnits='userSpaceOnUse'%3e%3cstop stop-color='%23F9E589'/%3e%3cstop offset='1' stop-color='%23F6D751'/%3e%3c/linearGradient%3e%3cclipPath id='clip0_2135_196676'%3e%3crect width='20' height='20' fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",{type:"image",source:r}).source,this.experienceType="Isolated",e.creationData.dataType===a.kW&&(this.initialURL=e.creationData.data.url),this.loopTitle=Zh}get HTMLViewable(){return this}get ContentURL(){return this}async getView(){return new Yh({url:this.initialURL},this.providers)}async getContentURL(){if(!this.initialURL)throw Error("Unable to retrieve URL");return this.initialURL}get ComponentTelemetryMetadata(){return this}get entityName(){return"PowerBILoopComponent"}getLoopComponentUrl(){if(!this.initialURL)throw Error("Unable to retrieve URL");return Promise.resolve(this.initialURL)}get LoopComponentUrl(){return this}get ComponentTitle(){return this}on(e,t){return this}off(e,t){return this}get title(){return this.loopTitle}getTitle(){return Promise.resolve(this.loopTitle)}get ComponentProperties(){return this}get ComponentSerializable(){return this}async serialize(){throw Error("serialize is not implemented")}async rehydrate(e){throw Error("rehydrate is not implemented")}async getHtmlAsync(){var e;const t=document.createElement("a");return t.href=(null==(e=this.initialURL)?void 0:e.href)||"",t.textContent=this.loopTitle,t.rel="noreferrer noopener",t.outerHTML}async getTextAsync(){var e;return(null==(e=this.initialURL)?void 0:e.href)||""}}const eg=new c.p(Xh,{InternationalizationContext:"InternationalizationContext",TelemetryConfig:"TelemetryConfig",TokenProvider:"TokenProvider"});var tg=Object.freeze({__proto__:null,PowerBIPortableComponent:Xh,loopExport:eg}),rg=wo.includes,og=es;cn({target:"Array",proto:!0,forced:f(function(){return!Array(1).includes()})},{includes:function(e){return rg(this,e,arguments.length>1?arguments[1]:void 0)}}),og("includes");var ng=f,ig=g.RegExp,sg=ng(function(){var e=ig("a","y");return e.lastIndex=2,null!==e.exec("abcd")}),ag=sg||ng(function(){return!ig("a","y").sticky}),cg={BROKEN_CARET:sg||ng(function(){var e=ig("^r","gy");return e.lastIndex=2,null!==e.exec("str")}),MISSED_STICKY:ag,UNSUPPORTED_Y:sg},dg=f,lg=g.RegExp,ug=dg(function(){var e=lg(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)}),hg=f,gg=g.RegExp,pg=hg(function(){var e=gg("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}),fg=S,mg=B,vg=Hn,yg=Fu,bg=cg,Sg=Gi,Cg=Mr.get,kg=ug,wg=pg,Pg=ze("native-string-replace",String.prototype.replace),Tg=RegExp.prototype.exec,Eg=Tg,Ig=mg("".charAt),Ng=mg("".indexOf),Ag=mg("".replace),Fg=mg("".slice),Dg=function(){var e=/a/,t=/b*/g;return fg(Tg,e,"a"),fg(Tg,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Bg=bg.BROKEN_CARET,Lg=void 0!==/()??/.exec("")[1];(Dg||Lg||Bg||kg||wg)&&(Eg=function(e){var t,r,o,n,i,s,a,c=this,d=Cg(c),l=vg(e),u=d.raw;if(u)return u.lastIndex=c.lastIndex,t=fg(Eg,u,l),c.lastIndex=u.lastIndex,t;var h=d.groups,g=Bg&&c.sticky,p=fg(yg,c),f=c.source,m=0,v=l;if(g&&(p=Ag(p,"y",""),-1===Ng(p,"g")&&(p+="g"),v=Fg(l,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==Ig(l,c.lastIndex-1))&&(f="(?: "+f+")",v=" "+v,m++),r=new RegExp("^(?:"+f+")",p)),Lg&&(r=new RegExp("^"+f+"$(?!\\s)",p)),Dg&&(o=c.lastIndex),n=fg(Tg,g?r:c,v),g?n?(n.input=Fg(n.input,m),n[0]=Fg(n[0],m),n.index=c.lastIndex,c.lastIndex+=n[0].length):c.lastIndex=0:Dg&&n&&(c.lastIndex=c.global?n.index+n[0].length:o),Lg&&n&&n.length>1&&fg(Pg,n[0],r,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)}),n&&h)for(n.groups=s=Sg(null),i=0;i<h.length;i++)s[(a=h[i])[0]]=n[a[1]];return n});cn({target:"RegExp",proto:!0,forced:/./.exec!==Eg},{exec:Eg});var Og=cn,xg=S,Mg=$,Rg=jt,_g=Hn,Hg=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),Ug=/./.test;Og({target:"RegExp",proto:!0,forced:!Hg},{test:function(e){var t=Rg(this),r=_g(e),o=t.exec;if(!Mg(o))return xg(Ug,t,r);var n=xg(o,t,r);return null!==n&&(Rg(n),!0)}});var jg=Y,qg=M,Vg=lt("match"),zg=function(e){var t;return jg(e)&&(void 0!==(t=e[Vg])?!!t:"RegExp"===qg(e))},Gg=TypeError,Wg=lt("match"),Jg=cn,Kg=function(e){if(zg(e))throw new Gg("The method doesn't accept regular expressions");return e},Qg=G,$g=Hn,Zg=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[Wg]=!1,"/./"[e](t)}catch(o){}}return!1},Yg=B("".indexOf);Jg({target:"String",proto:!0,forced:!Zg("includes")},{includes:function(e){return!!~Yg($g(Qg(this)),$g(Kg(e)),arguments.length>1?arguments[1]:void 0)}});let Xg,ep,tp;const rp=function(){if("undefined"===typeof window)return!1;if(void 0===tp){const e=navigator.userAgentData;if(null!=e&&e.mobile)return!0;tp=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||(void 0===Xg&&(Xg=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),Xg)||function(){if(void 0===ep){const e=navigator.userAgentData;ep=null!=e&&e.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return ep}()}return tp};class op{canLoad(e){return e.packageName===$h&&!rp()}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details");return Promise.resolve().then(function(){return tg}).then(t=>({module:t,details:e}))}}const np={instantiateLoopCodeLoader:e=>Promise.resolve(new op)}},34445:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),r=t[0],o=t[1];return 3*(r+o)/4-o},t.toByteArray=function(e){var t,r,i=a(e),s=i[0],c=i[1],d=new n(function(e,t,r){return 3*(t+r)/4-r}(0,s,c)),l=0,u=c>0?s-4:s;for(r=0;r<u;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],d[l++]=t>>16&255,d[l++]=t>>8&255,d[l++]=255&t;2===c&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,d[l++]=255&t);1===c&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,d[l++]=t>>8&255,d[l++]=255&t);return d},t.fromByteArray=function(e){for(var t,o=e.length,n=o%3,i=[],s=16383,a=0,c=o-n;a<c;a+=s)i.push(d(e,a,a+s>c?c:a+s));1===n?(t=e[o-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[o-2]<<8)+e[o-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],n="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=i[s],o[i.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function d(e,t,r){for(var o,n=[],i=t;i<r;i+=3)o=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),n.push(c(o));return n.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},34805:(e,t,r)=>{"use strict";r.d(t,{B2:()=>o.J,IG:()=>i.J,Zj:()=>l});var o=r(35159),n=r(96689),i=r(38314),s=r(52059),a=r(66267),c=r(81918),d=r(34170);function l(e){let t;switch(e){case o.J:t=(0,c.Cw)().then(e=>e.getCodeLoaderFactory());break;case i.J:t=r.e(30769).then(r.bind(r,30769)).then(e=>e.CdnCodeLoaderFactory);break;case n.JL:t=(0,c.vJ)().then(e=>e.getNpmCodeLoader());break;case d.LoopRegistrationId:t=Promise.resolve().then(r.bind(r,34170)).then(e=>e.NpmCodeLoaderFactory);break;case s.JL:t=r.e(72520).then(r.bind(r,72520)).then(e=>e.NpmCodeLoaderFactory);break;case a.J:t=Promise.all([r.e(2977),r.e(55198)]).then(r.bind(r,55198)).then(e=>e.NpmCodeLoaderFactory);break;default:throw new Error("Unknown registration ID: ".concat(e))}const l={getLoopCodeLoaderFactory:async()=>t,LoopCodeLoaderFactoryProvider:null};return l.LoopCodeLoaderFactoryProvider=l,l}},35159:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});const o="@1js/card-loop"},35237:(e,t,r)=>{e.exports=function(e){function t(e){let r,n,i,s=null;function a(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];if(!a.enabled)return;const i=a,s=Number(new Date),c=s-(r||s);i.diff=c,i.prev=r,i.curr=s,r=s,o[0]=t.coerce(o[0]),"string"!==typeof o[0]&&o.unshift("%O");let d=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(e,r)=>{if("%%"===e)return"%";d++;const n=t.formatters[r];if("function"===typeof n){const t=o[d];e=n.call(i,t),o.splice(d,1),d--}return e}),t.formatArgs.call(i,o);(i.log||t.log).apply(i,o)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=o,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"===typeof t.init&&t.init(a),a}function o(e,r){const o=t(this.namespace+("undefined"===typeof r?":":r)+e);return o.log=this.log,o}function n(e,t){let r=0,o=0,n=-1,i=0;for(;r<e.length;)if(o<t.length&&(t[o]===e[r]||"*"===t[o]))"*"===t[o]?(n=o,i=r,o++):(r++,o++);else{if(-1===n)return!1;o=n+1,i++,r=i}for(;o<t.length&&"*"===t[o];)o++;return o===t.length}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"===typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const o of r)"-"===o[0]?t.skips.push(o.slice(1)):t.names.push(o)},t.enabled=function(e){for(const r of t.skips)if(n(e,r))return!1;for(const r of t.names)if(n(e,r))return!0;return!1},t.humanize=r(97340),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},36294:(e,t,r)=>{"use strict";r.d(t,{T6:()=>R,Bm:()=>_});var o=r(27051),n=r(19688),i=r(15217),s=r(60295),a=r(29951),c=r(93023);class d extends c.X{constructor(e){super(),this.errorHandler=e}emit(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}catch(n){return this.errorHandler(e,n),!0}}}var l=r(50178),u=r(17637),h=r(20310);function g(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}class p{get disposed(){return this._disposed}constructor(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Map;this.eventBase=e,this.logger=t,this.sampleThreshold=r,this.includeAggregateMetrics=o,this.perBucketProperties=n,this._disposed=!1,this.measurementsMap=new Map}measure(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=(0,h.l)(),o=e(),n=(0,h.l)()-r;let i=this.measurementsMap.get(t);void 0===i&&(i={measurements:{count:0,duration:-1},dataSums:{},dataMaxes:{}},this.measurementsMap.set(t,i));const s=i.measurements;var a,c,d;(s.count++,s.duration=n,this.includeAggregateMetrics)&&(s.totalDuration=(null!==(a=s.totalDuration)&&void 0!==a?a:0)+n,s.minDuration=Math.min(null!==(c=s.minDuration)&&void 0!==c?c:n,n),s.maxDuration=Math.max(null!==(d=s.maxDuration)&&void 0!==d?d:0,n));if(this.isCustomData(o)&&(i=this.accumulateCustomData(o.customData,i)),s.count>=this.sampleThreshold){var l;if(this.includeAggregateMetrics)s.averageDuration=(null!==(l=s.totalDuration)&&void 0!==l?l:0)/s.count;this.flushBucket(t)}return o}isCustomData(e){return"object"===typeof e&&null!==e&&"customData"in e&&"object"===typeof e.customData}accumulateCustomData(e,t){for(const[n,s]of Object.entries(e)){var r,o;(0,i.vA)("string"===typeof n,2527),(0,i.vA)("number"===typeof s,2528),t.dataSums[n]=(null!==(r=t.dataSums[n])&&void 0!==r?r:0)+s,t.dataMaxes[n]=Math.max(null!==(o=t.dataMaxes[n])&&void 0!==o?o:Number.NEGATIVE_INFINITY,s)}return t}processCustomData(e,t){const r={};if(void 0===e.dataSums||void 0===e.dataMaxes)return r;const o=e.dataSums,n=e.dataMaxes;for(const[s,a]of Object.entries(o)){var i;r["avg_".concat(s)]=g(a/t,6),r["max_".concat(s)]=null!==(i=n[s])&&void 0!==i?i:0}return r}flushBucket(e){const t=this.measurementsMap.get(e);if(void 0===t)return;const r=t.measurements,n=this.processCustomData(t,r.count);if(0!==r.count){const t=this.perBucketProperties.get(e),i=(0,o.A)((0,o.A)((0,o.A)((0,o.A)({},this.eventBase),t),r),n);this.logger.sendPerformanceEvent(i),this.measurementsMap.delete(e)}}dispose(e){for(const[t]of this.measurementsMap.entries())this.flushBucket(t);this._disposed=!0}}var f=r(39773),m=r(95663);const v={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let y;const b=new Uint8Array(16);function S(){if(!y&&(y="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(b)}const C=[];for(let H=0;H<256;++H)C.push((H+256).toString(16).slice(1));function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+"-"+C[e[t+4]]+C[e[t+5]]+"-"+C[e[t+6]]+C[e[t+7]]+"-"+C[e[t+8]]+C[e[t+9]]+"-"+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]}const w=function(e,t,r){if(v.randomUUID&&!t&&!e)return v.randomUUID();const o=(e=e||{}).random||(e.rng||S)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return k(o)};function P(e){return Array.isArray(e)?[...e]:(0,o.A)({},e)}var T=r(15894),E=r(24907),I=r(19984),N=r(4041);class A extends T.SA{constructor(e,t,r){super(),this.absolutePath=e,this.routeContext=t,this.payloadPending=r,this.isAttached=!0,(0,i.vA)(e.startsWith("/"),413)}async get(){if(void 0===this.objectP){const e={url:this.absolutePath,headers:{[N.$6.viaHandle]:!0,[N.$6.payloadPending]:this.payloadPending}};this.objectP=this.routeContext.resolveHandle(e).then(t=>{if("fluid/object"===t.mimeType){return t.value}throw(0,I.MD)(t,e)})}return this.objectP}attachGraph(){}bind(e){(0,i.fJ)("RemoteFluidObjectHandle not supported as a bind source")}}var F=r(98483);function D(e){return(0,T.jP)(e)&&"function"===typeof e.bind}class B extends F.a{get isAttached(){return this.value.isAttached()}constructor(e,t,r){super(e,t,r.IFluidHandleContext),this.value=e,this.runtime=r}attachGraph(){this.value.bindToContext(),super.attachGraph()}bind(e){!0!==this.runtime.inStagingMode&&super.bind(e)}}class L{constructor(e){for(this.context=e,this.root=this.context;void 0!==this.root.routeContext;)this.root=this.root.routeContext}get IFluidSerializer(){return this}encode(e,t){return(0,i.vA)(D(t),2956),e&&"object"===typeof e?this.recursivelyReplace(e,this.encodeValue.bind(this),t):e}decode(e){return e&&"object"===typeof e?this.recursivelyReplace(e,this.decodeValue.bind(this)):e}stringify(e,t){return(0,i.vA)(D(t),2957),JSON.stringify(e,(e,r)=>this.encodeValue(r,t))}parse(e){return JSON.parse(e,(e,t)=>this.decodeValue(t))}encodeValue(e,t){return(0,T.jP)(e)?((0,i.vA)(void 0!==t,2707),this.bindAndEncodeHandle((0,T.Fz)(e),t)):e}decodeValue(e){if((0,T.zF)(e)){const t=e.url.startsWith("/")?e.url:(0,E.a)(e.url,this.context);return new A(t,this.root,!0===e.payloadPending)}return e}recursivelyReplace(e,t,r){const o=t(e,r);if((0,T.jP)(e)||(0,T.jP)(o))return o;let n;for(const i of Object.keys(e)){const o=e[i];if(o&&"object"===typeof o){const s=this.recursivelyReplace(o,t,r);s!==o&&(null!==n&&void 0!==n||(n=P(e)),n[i]=s)}}return null!==n&&void 0!==n?n:e}bindAndEncodeHandle(e,t){return t.bind(e),(0,T.oh)(e)}}class O extends L{constructor(){super(...arguments),this.visitedHandlePaths=new Set}getVisitedHandlePaths(){return[...this.visitedHandlePaths]}bindAndEncodeHandle(e){return this.visitedHandlePaths.add(e.absolutePath),{type:"__fluid_handle__",url:"UNUSED (see GCHandleVisitor)"}}}var x=r(16026);class M extends d{get IFluidLoadable(){return this}get connected(){return this._connected}constructor(e,t,r){var n;super((e,t)=>this.eventListenerErrorHandler(e,t)),this.id=e,this.runtime=t,this.attributes=r,this._connected=!1,this._isBoundToContext=!1,(0,i.vA)(!e.includes("/"),772),this.handle=new B(this,e,t),this.logger=(0,l.pW)({logger:t.logger,properties:{all:(0,o.A)({sharedObjectId:w()},(0,l.Df)({ddsType:this.attributes.type}))}}),this.mc=(0,u.Ln)(this.logger);const{opProcessingHelper:s,callbacksHelper:a}=this.setUpSampledTelemetryHelpers();this.opProcessingHelper=s,this.callbacksHelper=a;const c=null===(n=this.processMessagesCore)||void 0===n?void 0:n.bind(this);this.processMessagesHelper=void 0===c?e=>function(e,t){const{envelope:r,local:n,messagesContent:i}=e;for(const{contents:s,localOpMetadata:a,clientSequenceNumber:c}of i)t((0,o.A)((0,o.A)({},r),{},{contents:s,clientSequenceNumber:c}),n,a)}(e,this.process.bind(this)):e=>{!function(e,t,r,n){const{envelope:i,local:s,messagesContent:a}=e,c=(e,t)=>{for(const{contents:n,clientSequenceNumber:a}of t){const t=(0,o.A)((0,o.A)({},i),{},{contents:n,clientSequenceNumber:a});r(e,t,s)}};c("pre-op",a),t.measure(()=>{n(e);return{customData:{sequenceDifference:i.sequenceNumber-i.referenceSequenceNumber}}},s?"local":"remote"),c("op",a)}(e,this.opProcessingHelper,this.emitInternal.bind(this),c)}}get deltaManager(){return(0,a.k)(this.runtime.deltaManager)}setUpSampledTelemetryHelpers(){var e,t;(0,i.vA)(void 0!==this.mc&&void 0!==this.logger,841);const r=new p({eventName:"ddsOpProcessing",category:"performance"},this.logger,null!==(e=this.mc.config.getNumber("Fluid.SharedObject.OpProcessingTelemetrySampling"))&&void 0!==e?e:1e3,!0,new Map([["local",{localOp:!0}],["remote",{localOp:!1}]])),o=new p({eventName:"ddsEventCallbacks",category:"performance"},this.logger,null!==(t=this.mc.config.getNumber("Fluid.SharedObject.DdsCallbacksTelemetrySampling"))&&void 0!==t?t:1e3,!0);return this.runtime.once("dispose",()=>{this.callbacksHelper.dispose(),this.opProcessingHelper.dispose()}),{opProcessingHelper:r,callbacksHelper:o}}closeWithError(e){void 0===this.closeError&&(this.closeError=e)}verifyNotClosed(){if(void 0!==this.closeError)throw this.closeError}eventListenerErrorHandler(e,t){const r=f.I9.wrapIfUnrecognized(t,"SharedObjectEventListenerException");throw r.addTelemetryProperties({emittedEventName:String(e)}),this.closeWithError(r),r}setBoundAndHandleAttach(){this.setBoundAndHandleAttach=()=>this.setConnectionState(this.runtime.connected),this._isBoundToContext=!0;const e=()=>{this.didAttach(),this.setConnectionState(this.runtime.connected)};this.isAttached()?e():this.runtime.once("attaching",e)}async load(e){this.services=e,this._isBoundToContext=!0,await this.loadCore(e.objectStorage),this.attachDeltaHandler(),this.setBoundAndHandleAttach()}initializeLocal(){this.initializeLocalCore()}bindToContext(){this.bindToContext=()=>{},this._isBoundToContext||(this.runtime.bindChannel(this),this.setBoundAndHandleAttach())}connect(e){void 0===this.services&&(this.services=e,this.attachDeltaHandler()),this.setBoundAndHandleAttach()}isAttached(){return this._isBoundToContext&&this.runtime.attachState!==n.d.Detached}initializeLocalCore(){}didAttach(){}submitLocalMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(this.verifyNotClosed(),this.isAttached()){const r=!0===this.runtime.submitMessagesWithoutEncodingHandles?(0,x.pM)(e,this.serializer,this.handle):(0,x.Dv)(e,this.serializer,this.handle);this.services.deltaConnection.submit(r,t)}}dirty(){this.isAttached()&&this.services.deltaConnection.dirty()}onConnect(){}reSubmitCore(e,t){this.submitLocalMessage(e,t)}reSubmitSquashed(e,t){var r,o;null===(r=null!==(o=(0,u.Ln)(this.logger).config.getBoolean("Fluid.SharedObject.AllowStagingModeWithoutSquashing"))&&void 0!==o?o:this.runtime.options.allowStagingModeWithoutSquashing)||void 0===r||r?this.reSubmitCore(e,t):this.throwUnsupported("reSubmitSquashed")}async newAckBasedPromise(e){let t;return new Promise((r,o)=>{t=()=>o(new Error("FluidDataStoreRuntime disposed while this ack-based Promise was pending")),this.runtime.disposed?t():(this.runtime.on("dispose",t),e(r,o))}).finally(()=>{this.runtime.off("dispose",t)})}attachDeltaHandler(){(0,i.vA)(void 0!==this.services,122),this.services.deltaConnection.attach({processMessages:e=>{this.processMessages(e)},setConnectionState:e=>{this.setConnectionState(e)},reSubmit:(e,t,r)=>{this.reSubmit(e,t,r)},applyStashedOp:e=>{this.applyStashedOp((0,x.Zb)(e,this.serializer))},rollback:(e,t)=>{this.rollback(e,t)}})}setConnectionState(e){this.isAttached()&&this._connected!==e&&(this._connected=e,e?this.onConnect():this.onDisconnect())}process(e,t,r){this.verifyNotClosed(),this.emitInternal("pre-op",e,t,this),this.opProcessingHelper.measure(()=>{this.processCore(e,t,r);return{customData:{sequenceDifference:e.sequenceNumber-e.referenceSequenceNumber}}},t?"local":"remote"),this.emitInternal("op",e,t,this)}processMessages(e){this.verifyNotClosed();const t=[];for(const{contents:o,localOpMetadata:n,clientSequenceNumber:i}of e.messagesContent){const e={contents:(0,x.Zb)(o,this.serializer),localOpMetadata:n,clientSequenceNumber:i};t.push(e)}const r=(0,o.A)((0,o.A)({},e),{},{messagesContent:t});this.processMessagesHelper(r)}reSubmit(e,t,r){null!==r&&void 0!==r&&r?this.reSubmitSquashed(e,t):this.reSubmitCore(e,t)}rollback(e,t){this.throwUnsupported("rollback")}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return this.callbacksHelper.measure(()=>super.emit(e,...r))}emitInternal(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return super.emit(e,...r)}throwUnsupported(e){throw new m.iq("Unsupported DDS feature",(0,o.A)({featureName:e},(0,l.Df)({ddsType:this.attributes.type})))}}class R extends M{get serializer(){return(0,i.vA)(!this._isGCing,117),this._serializer}constructor(e,t,r,o){super(e,t,r),this.telemetryContextPrefix=o,this._isGCing=!1,this._serializer=new L(this.runtime.channelsRoutingContext)}getAttachSummary(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>2?arguments[2]:void 0;const r=this.summarizeCore(this.serializer,t,void 0,e);return this.incrementTelemetryMetric(s.RN,r.stats.blobNodeCount,t),this.incrementTelemetryMetric(s.NM,r.stats.totalBlobSize,t),r}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const o=this.summarizeCore(this.serializer,t,r,e);return this.incrementTelemetryMetric(s.RN,o.stats.blobNodeCount,t),this.incrementTelemetryMetric(s.NM,o.stats.totalBlobSize,t),o}getGCData(){let e;(0,i.vA)(!this._isGCing,120),this._isGCing=!0;try{const t=new O(this.runtime.channelsRoutingContext);this.processGCDataCore(t),e={gcNodes:{"/":t.getVisitedHandlePaths()}},(0,i.vA)(this._isGCing,121)}finally{this._isGCing=!1}return e}processGCDataCore(e){this.summarizeCore(e)}incrementTelemetryMetric(e,t,r){if(void 0!==r){var o;(0,i.vA)("get"in r&&"function"===typeof r.get,2430);const n=null!==(o=r.get(this.telemetryContextPrefix,e))&&void 0!==o?o:0;r.set(this.telemetryContextPrefix,e,n+t)}}}function _(e){const t={getFactory:()=>new e,create:(t,r)=>t.createChannel(r,e.Type),is:t=>void 0!==t.attributes&&t.attributes.type===e.Type};return t}},37450:(e,t,r)=>{"use strict";var o;r.d(t,{o:()=>o}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"},e.QosPillarName={Interruptions:"Interruptions",Open:"Open",Save:"Save",RealTimeCoauth:"RealTimeCoauth",NotebookNavigation:"NotebookNavigation",Fidelity:"Fidelity",AsyncCollab:"AsyncCollab",Present:"Present",ContentConsumption:"ContentConsumption",ContentCreation:"ContentCreation"}}(o||(o={}))},37513:(e,t,r)=>{"use strict";r.d(t,{a:()=>d});var o=r(27051),n=r(53986),i=r(488);const{dataCorruptionError:s,dataProcessingError:a}=i.k,c=(0,n.A)(i.k,["dataCorruptionError","dataProcessingError"]),d=(0,o.A)((0,o.A)({},c),{},{genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"})},37805:(e,t,r)=>{"use strict";r.d(t,{Ed:()=>s,FT:()=>i,mI:()=>n,pb:()=>c,sb:()=>a});var o=r(78632);function n(e){return t=>t*e}function i(e){return()=>e}function s(e){return t=>Math.pow(2,t)*e}function a(){return()=>!1}function c(e,t,r){return d(e,[],new AbortController,t,r)}function d(e,t,r,n,i){let s;const a=[e(t.length).then(e=>(s=e,!1))];return i&&i.timeoutMs>0&&a.push((0,o.c)(i.timeoutMs,r.signal).then(()=>!0)),Promise.race(a).then(a=>(a&&(s=i.onTimeout()),null===n||void 0===n||!n.filter(s)||t.length>=n.maxRetries?(r.abort(),{result:s,tries:t}):(0,o.c)(n.backoffFn(t.length,s),r.signal).then(()=>(t.push(s),d(e,t,r,n,i)))))}},38314:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});const o="@ms/forms-loop"},38954:(e,t,r)=>{"use strict";r.d(t,{x:()=>xe,p:()=>Oe});var o=r(27051),n=r(21856),i=r(54733);var s=r(39773);class a{get IFluidDataStoreRegistry(){return this}constructor(e){this.map=new Map;for(const t of e){if(this.map.has(t[0]))throw new s.eb("Duplicate entry names exist");this.map.set(t[0],t[1])}}async get(e){if(this.map.has(e))return this.map.get(e)}getSync(e){const t=this.map.get(e);if(!(e=>"object"===typeof e&&null!==e)(r=t)||!("then"in r)||"function"!==typeof r.then)return t;var r}}var c=r(15217),d=r(53986),l=r(93023),u=r(19688);class h{constructor(){this.completed=!1,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}var g=r(78945),p=r(77565),f=r(27750),m=r(26631),v=r(97423);const y={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let b;const S=new Uint8Array(16);function C(){if(!b&&(b="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!b))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return b(S)}const k=[];for(let He=0;He<256;++He)k.push((He+256).toString(16).slice(1));function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return k[e[t+0]]+k[e[t+1]]+k[e[t+2]]+k[e[t+3]]+"-"+k[e[t+4]]+k[e[t+5]]+"-"+k[e[t+6]]+k[e[t+7]]+"-"+k[e[t+8]]+k[e[t+9]]+"-"+k[e[t+10]]+k[e[t+11]]+k[e[t+12]]+k[e[t+13]]+k[e[t+14]]+k[e[t+15]]}const P=function(e,t,r){if(y.randomUUID&&!t&&!e)return y.randomUUID();const o=(e=e||{}).random||(e.rng||C)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return w(o)};function T(e,t,r){const o=[];for(const n of t){const t="".concat(e).concat(n.path);if(n.type===v.$.Blob){const e=n.value,i=(0,m.Xg)(e.contents,e.encoding),s=P();r.set(s,i);const a={mode:v.S[n.mode],path:t,sha:s,size:0,type:"blob",url:""};o.push(a)}else if(n.type===v.$.Tree){(0,c.vA)(n.type===v.$.Tree,257);const e=n.value,i={mode:v.S[n.mode],path:t,sha:"",size:-1,type:"tree",url:""};o.push(i);const s=T("".concat(t,"/"),e.entries,r);o.push(...s)}}return o}function E(e,t){return{sha:"",tree:T("",e,t),url:""}}function I(e,t){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o={},n={id:e.sha,blobs:{},trees:{}};o[""]=n;for(const i of e.tree){const e=r?i.path.replace(/^\.app\//,""):i.path,n=e.lastIndexOf("/"),s=e.slice(0,Math.max(0,n)),a=e.slice(n+1),c=o[s];if("tree"===i.type){const t={id:i.sha,blobs:{},commits:{},trees:{}};c.trees[decodeURIComponent(a)]=t,o[e]=t}else{if("blob"!==i.type)throw new Error("Unknown entry type!!");c.blobs[decodeURIComponent(a)]=i.sha,t.set(i.sha,"/".concat(e))}}return n}(E(e,t))}var N,A,F=r(60295);!function(e){e[e.Immediate=0]="Immediate",e[e.TurnBased=1]="TurnBased"}(N||(N={})),function(e){e[e.Async=2]="Async"}(A||(A={}));const D="NotVisible",B="LocallyVisible",L="GloballyVisible";var O=r(7428),x=r(24907),M=r(29951);class R{static getPathParts(e){const t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce((e,t)=>(void 0!==t&&t.length>0&&e.push(decodeURIComponent(t)),e),[])}static create(e){return e instanceof R?e:new R(e)}constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.substring(t):"",void 0!==e.headers&&(this.headers=e.headers)}get url(){return this.request.url}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=R.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:"/".concat(this.query),headers:this.headers};const r="/".concat(this.pathParts.slice(e).join("/"));return{url:""===this.query?r:"".concat(r,"/").concat(this.query),headers:this.headers}}}var _=r(19984),H=r(4041),U=r(15894),j=r(52389);var q=r(17637),V=r(95663);var z=r(50178);const G={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let W;const J=new Uint8Array(16);function K(){if(!W&&(W="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!W))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return W(J)}const Q=[];for(let He=0;He<256;++He)Q.push((He+256).toString(16).slice(1));function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Q[e[t+0]]+Q[e[t+1]]+Q[e[t+2]]+Q[e[t+3]]+"-"+Q[e[t+4]]+Q[e[t+5]]+"-"+Q[e[t+6]]+Q[e[t+7]]+"-"+Q[e[t+8]]+Q[e[t+9]]+"-"+Q[e[t+10]]+Q[e[t+11]]+Q[e[t+12]]+Q[e[t+13]]+Q[e[t+14]]+Q[e[t+15]]}const Z=function(e,t,r){if(G.randomUUID&&!t&&!e)return G.randomUUID();const o=(e=e||{}).random||(e.rng||K)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return $(o)};var Y=r(86748);const X=Symbol();function ee(e){return Array.isArray(e)&&X in e&&e[X]===X}function te(e,t,r){if(ee(t))for(const{contents:o,metadata:n}of t)r(o,n);else r(e,t)}class re{get handler(){return(0,c.vA)(!!this._handler,375),this._handler}get connected(){return this._connected}constructor(e,t,r,o){this._connected=e,this.submitFn=t,this.dirty=r,this.isAttachedAndVisible=o}attach(e){(0,c.vA)(void 0===this._handler,376),this._handler=e}setConnectionState(e){this._connected=e,this.handler.setConnectionState(e)}processMessages(e){try{const t=function(e){const t=[];for(const r of e)if(ee(r.localOpMetadata))for(const{contents:e,metadata:o}of r.localOpMetadata)t.push({contents:e,localOpMetadata:o,clientSequenceNumber:r.clientSequenceNumber});else t.push(r);return t}(e.messagesContent);this.handler.processMessages((0,o.A)((0,o.A)({},e),{},{messagesContent:t}))}catch(t){throw s.I9.wrapIfUnrecognized(t,"channelDeltaConnectionFailedToProcessMessages",e.envelope)}}reSubmit(e,t,r){te(e,t,(e,t)=>this.handler.reSubmit(e,t,r))}rollback(e,t){if(void 0===this.handler.rollback)throw new Error("Handler doesn't support rollback");te(e,t,this.handler.rollback.bind(this.handler))}applyStashedOp(e){try{return this.stashedOpMd=this.isAttachedAndVisible()?function(){const e=[];return Object.defineProperty(e,X,{value:X,writable:!1,enumerable:!0}),e}():void 0,this.handler.applyStashedOp(e),this.stashedOpMd}finally{this.stashedOpMd=void 0}}submit(e,t){void 0===this.stashedOpMd?this.submitFn(e,t):this.stashedOpMd.push({contents:e,metadata:t})}}function oe(e){let t=e;return t.startsWith("/")&&(t=t.substr(1)),t.endsWith("/")&&(t=t.substr(0,t.length-1)),t.length>0?t.split("/"):[]}class ne{static flattenTree(e,t,r){for(const[o,n]of Object.entries(t.trees))ne.flattenTree("".concat(e).concat(o,"/"),n,r);for(const[o,n]of Object.entries(t.blobs))r["".concat(e).concat(o)]=n}constructor(e,t,r,o){this.tree=e,this.storage=t,this.logger=r,this.extraBlobs=o,this.flattenedTree={},void 0!==e&&ne.flattenTree("",e,this.flattenedTree)}async contains(e){return void 0!==this.flattenedTree[e]}async readBlob(e){const t=await this.getIdForPath(e);(0,c.vA)(void 0!==t,2519);const r=void 0===this.extraBlobs?void 0:this.extraBlobs.get(t);if(void 0!==r)return r;const o=this.storage.readBlob(t);return o.catch(e=>this.logger.sendErrorEvent({eventName:"ChannelStorageBlobError"},e)),o}async list(e){var t,r;let o=this.tree;const n=oe(e);for(;void 0!==o&&n.length>0;){const e=n.shift();o=o.trees[e]}if(void 0===o||n.length>0)throw new Error("path does not exist");return Object.keys(null!==(t=null===(r=o)||void 0===r?void 0:r.blobs)&&void 0!==t?t:{})}async getIdForPath(e){return this.flattenedTree[e]}}const ie=".attributes";function se(e,t,r,o,n,i,s,a){return{deltaConnection:new re(e,(e,r)=>t(e,r),r,o),objectStorage:new ne(s,n,i,a)}}function ae(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;const n=e.getAttachSummary(t,r,o);return(0,j.su)(n,ie,JSON.stringify(e.attributes)),n}async function ce(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;const i=await e.summarize(t,r,o,n);return(0,j.su)(i,ie,JSON.stringify(e.attributes)),i}async function de(e,t,r,o,n){let i;await t.objectStorage.contains(ie)&&(i=await(0,Y.P)(t.objectStorage,ie));const a=i?i.type:n;if(void 0===a)throw new s.EW("channelTypeNotAvailable",(0,z.Df)({channelId:r,dataStoreId:e.id,dataStorePackagePath:e.packagePath.join("/"),channelFactoryType:a}));const c=o.get(a);if(void 0===c)throw new s.EW("channelFactoryNotRegisteredForGivenType",(0,z.Df)({channelId:r,dataStoreId:e.id,dataStorePackagePath:e.packagePath.join("/"),channelFactoryType:a}));return i=null!==i&&void 0!==i?i:c.attributes,{factory:c,attributes:i}}async function le(e,t,r,n,i,s){return void 0!==t.snapshotFormatVersion&&t.snapshotFormatVersion!==r.attributes.snapshotFormatVersion&&i.sendTelemetryEvent((0,o.A)({eventName:"ChannelAttributesVersionMismatch"},(0,z.Df)({channelType:t.type,channelSnapshotVersion:"".concat(t.snapshotFormatVersion,"@").concat(t.packageVersion),channelCodeVersion:"".concat(r.attributes.snapshotFormatVersion,"@").concat(r.attributes.packageVersion)}))),r.load(e,s,n,t)}const ue={supportedFeatures:new Set,generation:0,pkgVersion:"unknown"};const he="2.43.0",ge={pkgVersion:he,generation:1},pe=(0,o.A)((0,o.A)({},ge),{},{supportedFeatures:new Set}),fe={minSupportedGeneration:0,requiredFeatures:[]};function me(e,t){const r=function(e,t){const r=null!==t&&void 0!==t?t:ue;let o=!0;const n=[];r.generation<e.minSupportedGeneration&&(o=!1);for(const i of e.requiredFeatures)r.supportedFeatures.has(i)||n.push(i);return o&&0===n.length?{isCompatible:!0}:{isCompatible:!1,isGenerationCompatible:o,unsupportedFeatures:n.length>0?n:void 0}}(fe,e);if(!r.isCompatible){const o=new s.eb("DataStore is not compatible with Runtime",{errorDetails:JSON.stringify({dataStoreVersion:ge.pkgVersion,runtimeVersion:null===e||void 0===e?void 0:e.pkgVersion,dataStoreGeneration:ge.generation,runtimeGeneration:null===e||void 0===e?void 0:e.generation,minSupportedGeneration:fe.minSupportedGeneration,isGenerationCompatible:r.isGenerationCompatible,unsupportedFeatures:r.unsupportedFeatures})});throw t(),o}}var ve=r(98483);class ye{constructor(e,t,r,o,n){this.id=e,this.runtime=t,this.services=r,this.channelP=o,this._channel=n,this.globallyVisible=!1,this.pendingMessagesState={messageCollections:[],pendingCount:0},(0,c.vA)(!this.id.includes("/"),783)}get isGloballyVisible(){return this.globallyVisible}async getChannel(){return void 0===this._channel?this.channelP.then(e=>this._channel=e):this.channelP}get isLoaded(){return void 0!==this._channel}setConnectionState(e,t){this.globallyVisible&&this.isLoaded&&this.services.value.deltaConnection.setConnectionState(e)}processMessages(e){if((0,c.vA)(this.globallyVisible,723),this.isLoaded)this.services.value.deltaConnection.processMessages(e);else{(0,c.vA)(!e.local,393);const t=(0,o.A)((0,o.A)({},e),{},{messagesContent:[...e.messagesContent]});this.pendingMessagesState.messageCollections.push(t)}}reSubmit(e,t,r){(0,c.vA)(this.isLoaded,394),(0,c.vA)(this.globallyVisible,724),this.services.value.deltaConnection.reSubmit(e,t,r)}rollback(e,t){(0,c.vA)(this.isLoaded,750),(0,c.vA)(this.globallyVisible,751),this.services.value.deltaConnection.rollback(e,t)}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;return ce(await this.getChannel(),e,t,r)}getAttachSummary(e){return(0,c.vA)(void 0!==this._channel,397),ae(this._channel,!0,!1,e)}getAttachGCData(e){return(0,c.vA)(void 0!==this._channel,2301),this._channel.getGCData(!0)}makeVisible(){if(this.globallyVisible)throw new Error("Channel is already globally visible");this.isLoaded&&((0,c.vA)(!!this._channel,402),this._channel.connect(this.services.value)),this.globallyVisible=!0}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.getChannel()).getGCData(e)}updateUsedRoutes(e){}}class be extends ye{constructor(e,t,r,o,n,i,a,c,d,l){super(e,r,new g.d(()=>{const e=new Map(l),t=Ce(this.snapshotTree);return this.isSnapshotInOldFormatAndCollectBlobs(t,e)&&this.sanitizeSnapshot(t),se(o.connected,a,this.dirtyFn,()=>this.isGloballyVisible,n,i,t,e)}),new g.I(async()=>{try{const{attributes:e,factory:n}=await de(o,this.services.value,this.id,t),s=await le(r,e,n,this.services.value,i,this.id);for(const t of this.pendingMessagesState.messageCollections)this.services.value.deltaConnection.processMessages(t);return s}catch(e){throw s.I9.wrapIfUnrecognized(e,"rehydratedLocalChannelContextFailedToLoadChannel",void 0)}})),this.snapshotTree=d,this.dirtyFn=()=>{c(e)}}applyStashedOp(e){return this.services.value.deltaConnection.applyStashedOp(e)}isSnapshotInOldFormatAndCollectBlobs(e,t){let r=!1;const o=e.blobsContents;if(void 0!==o)for(const[n,i]of Object.entries(o))t.set(n,i),void 0!==e.blobs[n]&&(r=!0);for(const n of Object.values(e.trees))r=r||this.isSnapshotInOldFormatAndCollectBlobs(n,t);return r}sanitizeSnapshot(e){const t=new Map(Object.entries(e.blobs));for(const[r,o]of t.entries()){void 0===t.get(o)&&delete e.blobs[r]}for(const r of Object.values(e.trees))this.sanitizeSnapshot(r)}}class Se extends ye{constructor(e,t,r,o,n,i,s){super(e.id,t,new g.d(()=>se(r.connected,i,this.dirtyFn,()=>this.isGloballyVisible,o,n)),Promise.resolve(e),e),this.channel=e,this.channel=e,this.dirtyFn=()=>{s(e.id)}}applyStashedOp(){throw new Error("no stashed ops on local channel")}}function Ce(e){const t=(0,o.A)((0,o.A)({},e),{},{blobs:(0,o.A)({},e.blobs),trees:{}});for(const[r,o]of Object.entries(e.trees))t.trees[r]=Ce(o);return t}class ke{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.threshold=e,this.logger=t,this.thresholdMultiple=r}send(e,t){t<this.threshold||this.logger.sendPerformanceEvent({eventName:e,value:t})}sendIfMultiple(e,t){t===this.thresholdMultiple&&(this.logger.sendPerformanceEvent({eventName:e,value:t}),this.thresholdMultiple=2*this.thresholdMultiple)}}class we{constructor(e,t,r,o,n,i,s,a,d,l,h){this.id=i,this.isLoaded=!1,this.pendingMessagesState={messageCollections:[],pendingCount:0},(0,c.vA)(!this.id.includes("/"),784),this.subLogger=(0,z.pW)({logger:e.logger,namespace:"RemoteChannelContext"}),this.services=se(t.connected,o,()=>n(this.id),()=>e.attachState!==u.d.Detached,r,this.subLogger,s,d),this.channelP=new g.I(async()=>{const{attributes:r,factory:o}=await de(t,this.services,this.id,a,h),n=await le(e,r,o,this.services,this.subLogger,this.id);(0,c.vA)(void 0!==this.pendingMessagesState,2668);for(const e of this.pendingMessagesState.messageCollections)this.services.deltaConnection.processMessages(e);return this.thresholdOpsCounter.send("ProcessPendingOps",this.pendingMessagesState.pendingCount),this.channel=n,this.pendingMessagesState=void 0,this.isLoaded=!0,this.services.deltaConnection.setConnectionState(t.connected),this.channel}),this.summarizerNode=l(async(e,t,r,o)=>this.summarizeInternal(e,t,r,o),async e=>this.getGCDataInternal(e)),this.thresholdOpsCounter=new ke(we.pendingOpsCountThreshold,this.subLogger)}getChannel(){return this.channelP}setConnectionState(e,t){this.isLoaded&&this.services.deltaConnection.setConnectionState(e)}applyStashedOp(e){return(0,c.vA)(this.isLoaded,404),this.services.deltaConnection.applyStashedOp(e)}processMessages(e){const{envelope:t,messagesContent:r,local:n}=e;this.summarizerNode.invalidate(t.sequenceNumber),this.isLoaded?this.services.deltaConnection.processMessages(e):((0,c.vA)(!n,405),(0,c.vA)(void 0!==this.pendingMessagesState,2669),this.pendingMessagesState.messageCollections.push((0,o.A)((0,o.A)({},e),{},{messagesContent:[...r]})),this.pendingMessagesState.pendingCount+=r.length,this.thresholdOpsCounter.sendIfMultiple("StorePendingOps",this.pendingMessagesState.pendingCount))}reSubmit(e,t,r){(0,c.vA)(this.isLoaded,406),this.services.deltaConnection.reSubmit(e,t,r)}rollback(e,t){(0,c.vA)(this.isLoaded,752),this.services.deltaConnection.rollback(e,t)}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;return this.summarizerNode.summarize(e,t,r)}async summarizeInternal(e,t,r,n){const i=await this.getChannel(),s=await ce(i,e,t,r,n);return(0,o.A)((0,o.A)({},s),{},{id:this.id})}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.summarizerNode.getGCData(e)}async getGCDataInternal(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.getChannel()).getGCData(e)}updateUsedRoutes(e){this.summarizerNode.updateUsedRoutes([""])}}we.pendingOpsCountThreshold=1e3;const Pe=["contents"];function Te(e,t){var r;const{ILayerCompatDetails:o}=e;return null!==(r=null===o||void 0===o?void 0:o.supportedFeatures.has(t))&&void 0!==r&&r}var Ee;!function(e){e.Attach="attach",e.ChannelOp="op"}(Ee||(Ee={}));const Ie={readonlyInStagingMode:!0};class Ne extends l.X{get connected(){return this.dataStoreContext.connected}get clientId(){return this.dataStoreContext.clientId}get clientDetails(){return this.dataStoreContext.clientDetails}get isAttached(){return this.attachState!==u.d.Detached}get attachState(){return this._attachState}get absolutePath(){return(0,x.a)(this.id,this.routeContext)}get routeContext(){return this.dataStoreContext.IFluidHandleContext}get idCompressor(){return this.dataStoreContext.idCompressor}get IFluidHandleContext(){return this}get rootRoutingContext(){return this}get channelsRoutingContext(){return this}get objectsRoutingContext(){return this}get disposed(){return this._disposed}get logger(){return this.mc.logger}constructor(e,t,r,n,i){var s;super(),this.dataStoreContext=e,this.sharedObjectRegistry=t,this.isReadOnly=()=>this._readonly,this._disposed=!1,this.contexts=new Map,this.pendingAttach=new Set,this.deferredAttached=new h,this.localChannelContextQueue=new Map,this.notBoundedChannelContextSet=new Set,this.pendingHandlesToMakeVisible=new Set,this.ILayerCompatDetails=pe,this.pendingOpCount=function(){let e=0;return{get value(){return e},set value(t){(0,c.vA)(t>=0,3005),e=t}}}(),(0,c.vA)(!e.id.includes("/"),782),this.policies=(0,o.A)((0,o.A)({},Ie),i);const{ILayerCompatDetails:a}=e;me(a,this.dispose.bind(this)),Te(e,"notifiesReadOnlyState")?this._readonly=e.isReadOnly():(this._readonly=!0===this.dataStoreContext.deltaManager.readOnlyInfo.readonly,this.dataStoreContext.deltaManager.on("readonly",e=>this.notifyReadOnlyState(e))),this.submitMessagesWithoutEncodingHandles=Te(e,"encodeHandlesInContainerRuntime"),(0,c.aT)(()=>void 0!==this.submitMessagesWithoutEncodingHandles),this.mc=(0,q.CL)({logger:e.baseLogger,namespace:"FluidDataStoreRuntime",properties:{all:{dataStoreId:Z(),dataStoreVersion:he}}}),this.id=e.id,this.options=e.options,this.deltaManagerInternal=e.deltaManager,this.quorum=e.getQuorum(),this.audience=e.getAudience();const d=e.baseSnapshot;if(void 0!==(null===d||void 0===d?void 0:d.trees))for(const[o,c]of Object.entries(d.trees)){if("_search"===o)continue;let t;e.isLocalDataStore?(t=this.createRehydratedLocalChannelContext(o,c),e.attachState===u.d.Detached?this.localChannelContextQueue.set(o,t):t.makeVisible()):t=new we(this,e,e.storage,(e,t)=>this.submitChannelOp(o,e,t),e=>this.setChannelDirty(e),o,c,this.sharedObjectRegistry,void 0,this.dataStoreContext.getCreateChildSummarizerNodeFn(o,{type:F.nL.FromSummary})),this.contexts.set(o,t)}this.entryPoint=new ve.a(new g.I(async()=>n(this)),"",this.objectsRoutingContext),this.attachListener(),this._attachState=e.attachState,this.visibilityState=r?e.attachState===u.d.Detached?B:L:D,r&&this.deferredAttached.resolve(),this.localChangesTelemetryCount=null!==(s=this.mc.config.getNumber("Fluid.Telemetry.LocalChangesTelemetryCount"))&&void 0!==s?s:10,this.inStagingMode,this.isDirty}get inStagingMode(){var e;return null===(e=this.dataStoreContext.containerRuntime)||void 0===e?void 0:e.inStagingMode}get isDirty(){return this.pendingOpCount.value>0}get deltaManager(){return(0,M.P)(this.deltaManagerInternal)}dispose(){this._disposed||(this._disposed=!0,this.emit("dispose"),this.removeAllListeners())}async resolveHandle(e){return this.request(e)}async request(e){try{var t;const o=R.create(e);if(0===o.pathParts.length&&!0===(null===(t=e.headers)||void 0===t?void 0:t.viaHandle))return{mimeType:"fluid/object",status:200,value:await this.entryPoint.get()};const n=o.pathParts[0];if("_channels"===n||"_custom"===n)return await this.request(o.createSubRequest(1));if(void 0!==n){const t=this.contexts.get(n);if(void 0!==t&&o.isLeaf(1))try{return{mimeType:"fluid/object",status:200,value:await t.getChannel()}}catch(r){return this.mc.logger.sendErrorEvent({eventName:"GetChannelFailedInRequest"},r),(0,_.wx)(500,"Failed to get Channel: ".concat(r),e)}}return(0,_.or)(e)}catch(r){return(0,_.Yj)(r)}}async getChannel(e){this.verifyNotClosed();const t=this.contexts.get(e);if(void 0===t)throw new V.iq("Channel does not exist");return t.getChannel()}validateChannelId(e){if(e.includes("/"))throw new s.eb("Id cannot contain slashes: ".concat(e));if(e.startsWith("_"))throw new s.eb("Id cannot start with underscore: ".concat(e))}addChannel(e){const t=e.id;this.validateChannelId(t),this.verifyNotClosed(),(0,c.vA)(!this.contexts.has(t),2149);const r=e.attributes.type;if(void 0===this.sharedObjectRegistry.get(e.attributes.type))throw new Error("Channel Factory ".concat(r," not registered"));this.createChannelContext(e),this.identifyLocalChangeInSummarizer("DDSCreatedInSummarizer",t,r)}createChannel(e,t){let r;if(void 0===e){if(!0===this.mc.config.getBoolean("Fluid.Runtime.DisableShortIds"))r=Z();else if(this.visibilityState===L){var o,n,i;const e=null!==(o=null===(n=(i=this.dataStoreContext.containerRuntime).generateDocumentUniqueId)||void 0===n?void 0:n.call(i))&&void 0!==o?o:Z();r="number"===typeof e?(0,H.Z_)(2*e+1,"_"):e}else r=(0,H.Z_)(2*this.contexts.size,"_");(0,c.vA)(!r.includes("/"),2300)}else r=e,this.validateChannelId(r);this.verifyNotClosed(),(0,c.vA)(!this.contexts.has(r),377),(0,c.vA)(void 0!==t,521);const s=this.sharedObjectRegistry.get(t);if(void 0===s)throw new Error("Channel Factory ".concat(t," not registered"));const a=s.create(this,r);return this.createChannelContext(a),this.identifyLocalChangeInSummarizer("DDSCreatedInSummarizer",r,t),a}createChannelContext(e){this.notBoundedChannelContextSet.add(e.id);const t=new Se(e,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(t,r)=>this.submitChannelOp(e.id,t,r),e=>this.setChannelDirty(e));this.contexts.set(e.id,t)}createRehydratedLocalChannelContext(e,t,r){return new be(e,this.sharedObjectRegistry,this,this.dataStoreContext,this.dataStoreContext.storage,this.logger,(t,r)=>this.submitChannelOp(e,t,r),e=>this.setChannelDirty(e),t,r)}bindChannel(e){(0,c.vA)(this.notBoundedChannelContextSet.has(e.id),379),this.notBoundedChannelContextSet.delete(e.id),this.isAttached?this.makeChannelLocallyVisible(e):this.pendingHandlesToMakeVisible.has((0,U.Fz)(e.handle))||(this.bind(e.handle),this.localChannelContextQueue.has(e.id)||this.localChannelContextQueue.set(e.id,this.contexts.get(e.id)))}makeVisibleAndAttachGraph(){if(this.visibilityState===D){this.visibilityState=B;for(const e of this.pendingHandlesToMakeVisible)e.attachGraph();this.pendingHandlesToMakeVisible.clear(),this.dataStoreContext.makeLocallyVisible()}}attachGraph(){this.makeVisibleAndAttachGraph()}bind(e){this.visibilityState===D?this.pendingHandlesToMakeVisible.add((0,U.Fz)(e)):(0,U.Fz)(e).attachGraph()}setConnectionState(e,t){this.verifyNotClosed();for(const[,r]of this.contexts)r.setConnectionState(e,t);!function(e,t,r,o,n){try{r?t.emit("connected",o):t.emit("disconnected",n)}catch(i){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},i)}}(this.logger,this,e,t)}notifyReadOnlyState(e){this.verifyNotClosed(),e!==this._readonly&&(this._readonly=e,this.emit("readonly",e))}getQuorum(){return this.quorum}getAudience(){return this.audience}async uploadBlob(e,t){return this.verifyNotClosed(),this.dataStoreContext.uploadBlob(e,t)}createRemoteChannelContext(e,t){const r=new Map,o=I(e.snapshot.entries,r);return new we(this,this.dataStoreContext,this.dataStoreContext.storage,(t,r)=>this.submitChannelOp(e.id,t,r),e=>this.setChannelDirty(e),e.id,o,this.sharedObjectRegistry,r,this.dataStoreContext.getCreateChildSummarizerNodeFn(e.id,t),e.type)}processChannelMessages(e){let t;this.verifyNotClosed();let r=[];const{messagesContent:n,local:i,envelope:s}=e,a=()=>{if(void 0===t)return;const e=this.contexts.get(t);(0,c.vA)(!!e,2667),e.processMessages({envelope:s,messagesContent:r,local:i}),r=[]};for(const c of n){const{contents:e}=c,n=(0,d.A)(c,Pe),i=e;t!==i.address&&a(),r.push((0,o.A)({contents:i.contents},n)),t=i.address}a()}processAttachMessages(e){const{envelope:t,messagesContent:r,local:o}=e;for(const{contents:n}of r){const e=n,r=e.id;if((0,j.eK)(e.snapshot,(e,o)=>{const n="/".concat(this.id,"/").concat(r).concat("/"===e?"":e);this.dataStoreContext.addedGCOutboundRoute(n,o,t.timestamp)}),o)(0,c.vA)(this.pendingAttach.delete(r),380);else{(0,c.vA)(!this.contexts.has(r),381);const o={type:F.nL.FromAttach,sequenceNumber:t.sequenceNumber,snapshot:e.snapshot},n=this.createRemoteChannelContext(e,o);this.contexts.set(r,n)}}}processMessages(e){this.verifyNotClosed();const{envelope:t,local:r,messagesContent:n}=e;r&&(this.pendingOpCount.value-=n.length);try{switch(t.type){case Ee.ChannelOp:this.processChannelMessages(e);break;case Ee.Attach:this.processAttachMessages(e)}}catch(i){throw s.I9.wrapIfUnrecognized(i,"fluidDataStoreRuntimeFailedToProcessMessage",t)}for(const{contents:s,clientSequenceNumber:a}of n)this.emit("op",(0,o.A)((0,o.A)({},t),{},{contents:s,clientSequenceNumber:a}))}processSignal(e,t){this.emit("signal",e,t)}isChannelAttached(e){return!this.notBoundedChannelContextSet.has(e)&&!this.localChannelContextQueue.has(e)&&!this.pendingAttach.has(e)}getOutboundRoutes(){const e=[];for(const[t]of this.contexts)e.push("".concat(this.absolutePath,"/").concat(t));return e}updateGCNodes(e){e.addRouteToAllNodes(this.absolutePath),e.addNode("/",this.getOutboundRoutes())}async summarize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;const o=new j.qt;return await this.visitContextsDuringSummary(async(n,i)=>{const s=await i.summarize(e,t,r);o.addWithStats(n,s)}),o.getSummaryTree()}async getGCData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new j.EI;return await this.visitContextsDuringSummary(async(r,o)=>{const n=await o.getGCData(e);t.prefixAndAddNodes(r,n.gcNodes)}),this.updateGCNodes(t),t.getGCData()}updateUsedRoutes(e){const t=function(e){const t=e.filter(e=>""!==e&&"/"!==e),r=new Map;for(const o of t){(0,c.vA)(o.startsWith("/"),1504);const e=o.split("/")[1];(0,c.vA)(void 0!==e,2475);const t=o.slice(e.length+1),n=r.get(e);void 0!==n?n.push(t):r.set(e,[t])}return r}(e);for(const[o]of t)(0,c.vA)(this.contexts.has(o),382);for(const[o,n]of this.contexts){var r;n.updateUsedRoutes(null!==(r=t.get(o))&&void 0!==r?r:[])}}getAttachSummary(e){const t=new j.qt;return this.visitLocalBoundContextsDuringAttach((r,o)=>{let n;if(o.isLoaded){const t=o.getAttachSummary(e);(0,c.vA)(t.summary.type===f.Z.Tree,384),n={stats:t.stats,summary:t.summary}}else(0,c.vA)(!!this.dataStoreContext.baseSnapshot,385),n=(0,j.jw)(this.dataStoreContext.baseSnapshot.trees[r]);t.addWithStats(r,n)}),t.getSummaryTree()}getAttachGCData(e){const t=new j.EI;return this.visitLocalBoundContextsDuringAttach((r,o)=>{if(o.isLoaded){const n=o.getAttachGCData(e);t.prefixAndAddNodes(r,n.gcNodes)}}),this.updateGCNodes(t),t.getGCData()}async visitContextsDuringSummary(e){for(const[t,r]of this.contexts){const o=this.isChannelAttached(t);(0,c.vA)(o,383),await e(t,r)}}visitLocalBoundContextsDuringAttach(e){this.attachGraph();const t=new Set;let r=-1;for(;r!==t.size;){r=t.size;for(const[r,o]of this.contexts){if(!(o instanceof ye))throw new V.iq("Should only be called with local channel handles");t.has(r)||this.notBoundedChannelContextSet.has(r)||(e(r,o),t.add(r))}}}submitMessage(e,t,r){this.submit(e,t,r)}submitSignal(e,t,r){this.verifyNotClosed(),this.dataStoreContext.submitSignal(e,t,r)}async waitAttached(){return this.deferredAttached.promise}makeChannelLocallyVisible(e){if(this.verifyNotClosed(),e.handle.isAttached)return;(0,U.Fz)(e.handle).attachGraph(),(0,c.vA)(this.isAttached,386),(0,c.vA)(this.visibilityState===L,720);const t=ae(e,!0,!1),r=e.getGCData(!0);(0,j.su)(t,O.xX,JSON.stringify(r));const o=(0,j.ym)(t.summary),n={id:e.id,snapshot:o,type:e.attributes.type};this.pendingAttach.add(e.id),this.submit(Ee.Attach,n);this.contexts.get(e.id).makeVisible()}submitChannelOp(e,t,r){const o={address:e,contents:t};this.submit(Ee.ChannelOp,o,r)}submit(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.verifyNotClosed(),this.dataStoreContext.submitMessage(e,t,r),++this.pendingOpCount.value}reSubmit(e,t,r,o){switch(this.verifyNotClosed(),--this.pendingOpCount.value,e){case Ee.ChannelOp:{const e=t,n=this.contexts.get(e.address);(0,c.vA)(!!n,387),n.reSubmit(e.contents,r,o);break}case Ee.Attach:this.submit(e,t,r);break;default:(0,p.$)(e)}}rollback(e,t,r){switch(this.verifyNotClosed(),--this.pendingOpCount.value,e){case Ee.ChannelOp:{const e=t,o=this.contexts.get(e.address);(0,c.vA)(!!o,749),o.rollback(e.contents,r);break}default:throw new V.iq("Can't rollback ".concat(e," message"))}}async applyStashedOp(e){++this.pendingOpCount.value;const t=null===e||void 0===e?void 0:e.type;switch(t){case Ee.Attach:{const t=e.content,r=new Map,o=I(t.snapshot.entries,r),n=this.createRehydratedLocalChannelContext(t.id,o,r);return await n.getChannel(),this.contexts.set(t.id,n),void(this.attachState===u.d.Detached?this.localChannelContextQueue.set(t.id,n):(n.makeVisible(),this.pendingAttach.add(t.id)))}case Ee.ChannelOp:{const t=e.content,r=this.contexts.get(t.address);return(0,c.vA)(!!r,388),await r.getChannel(),r.applyStashedOp(t.contents)}default:(0,p.$)(t)}}setChannelDirty(e){this.verifyNotClosed(),this.dataStoreContext.setChannelDirty(e)}attachListener(){var e,t,r,o;this.setMaxListeners(Number.MAX_SAFE_INTEGER),null===(e=(t=this.dataStoreContext).once)||void 0===e||e.call(t,"attaching",()=>{this.setAttachState(u.d.Attaching)}),null===(r=(o=this.dataStoreContext).once)||void 0===r||r.call(o,"attached",()=>{this.setAttachState(u.d.Attached)})}verifyNotClosed(){if(this._disposed)throw new V.iq("Runtime is closed")}identifyLocalChangeInSummarizer(e,t,r){"summarizer"!==this.clientDetails.type||this.localChangesTelemetryCount<=0||(this.mc.logger.sendTelemetryEvent((0,o.A)((0,o.A)({eventName:e},(0,z.Df)({channelType:r,channelId:t,fluidDataStoreId:this.id,fluidDataStorePackagePath:this.dataStoreContext.packagePath.join("/")})),{},{stack:(0,V.aX)(30)})),this.localChangesTelemetryCount--)}setAttachState(e){switch(e){case u.d.Attaching:this.attachGraph(),this._attachState=u.d.Attaching,(0,c.vA)(this.visibilityState===B,721),this.visibilityState=L;for(const[,e]of this.localChannelContextQueue)e.makeVisible();this.localChannelContextQueue.clear(),this.deferredAttached.resolve(),this.emit("attaching");break;case u.d.Attached:(0,c.vA)(this.visibilityState===L,722),this._attachState=u.d.Attached,this.emit("attached");break;default:(0,p.$)(e,"unreached")}}}const Ae=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ne;return class extends t{async request(t){const r=await super.request(t);return 404===r.status?e(t,this):r}}};async function Fe(e){var t,r;let{ctor:o,context:n,sharedObjectRegistry:i,optionalProviders:s,runtimeClassArg:a,existing:d,initialState:l,policies:u}=e,h=a;h=Ae(async(e,t)=>{const r=await t.entryPoint.get();return(0,c.vA)(void 0!==r.request,1941),r.request(e)},h);const g=new h(n,i,d,async e=>((0,c.vA)(void 0!==p,1130),await p.finishInitialization(!0),p),u),p=new o({runtime:g,context:n,providers:null!==(t=null===(r=n.scope.IFluidDependencySynthesizer)||void 0===r?void 0:r.synthesize(s,{}))&&void 0!==t?t:{},initProps:l});return d||await p.finishInitialization(d),{instance:p,runtime:g}}class De{constructor(e,t,r,o,n,i){var s,c,d;const l="string"===typeof e?{type:e,ctor:t,sharedObjects:r,optionalProviders:o,registryEntries:n,runtimeClass:i}:e;if(""===l.type)throw new Error("undefined type member");this.type=l.type,this.createProps={ctor:l.ctor,optionalProviders:null!==(s=l.optionalProviders)&&void 0!==s?s:{},sharedObjectRegistry:new Map(null===(c=l.sharedObjects)||void 0===c?void 0:c.map(e=>[e.type,e])),runtimeClassArg:null!==(d=l.runtimeClass)&&void 0!==d?d:Ne,policies:l.policies},void 0!==l.registryEntries&&(this.registry=new a(l.registryEntries))}get IFluidDataStoreFactory(){return this}get IFluidDataStoreRegistry(){return this.registry}get registryEntry(){return[this.type,Promise.resolve(this)]}async instantiateDataStore(e,t){const{runtime:r}=await Fe((0,o.A)((0,o.A)({},this.createProps),{},{context:e,existing:t}));return r}async createChildInstance(e,t,r){return this.createNonRootInstanceCore(e.containerRuntime,[...e.packagePath,this.type],t,r)}async createPeerInstance(e,t,r){return this.createNonRootInstanceCore(e.containerRuntime,e.packagePath,t,r)}async createInstance(e,t,r){return this.createNonRootInstanceCore(e,[this.type],t,r)}async createInstanceWithDataStore(e,t,r,n){const i=e.createDetachedDataStore(null!==r&&void 0!==r?r:[this.type],n),{instance:s,runtime:a}=await Fe((0,o.A)((0,o.A)({},this.createProps),{},{context:i,existing:!1,initialState:t}));return[s,await i.attachRuntime(this,a)]}async createRootInstance(e,t,r){const n=t.createDetachedDataStore([this.type]),{instance:i,runtime:s}=await Fe((0,o.A)((0,o.A)({},this.createProps),{},{context:n,existing:!1,initialState:r})),a=await n.attachRuntime(this,s);if("Success"!==await a.trySetAlias(e)){const r=await t.getAliasedDataStoreEntryPoint(e);return(0,c.vA)(void 0!==r,2273),await r.get()}return i}async createNonRootInstanceCore(e,t,r,o){const n=e.createDetachedDataStore(t,o);return this.createInstanceCore(n,r)}async createInstanceCore(e,t){const{instance:r,runtime:n}=await Fe((0,o.A)((0,o.A)({},this.createProps),{},{context:e,existing:!1,initialState:t}));return await e.attachRuntime(this,n),r}}class Be extends De{constructor(e,t,r,s,a,c){var d;const l="string"===typeof e?{type:e,ctor:t,sharedObjects:r,optionalProviders:s,registryEntries:a,runtimeClass:c}:(0,o.A)({},e),u=l.sharedObjects=[...null!==(d=l.sharedObjects)&&void 0!==d?d:[]];u.some(e=>e.type===n.m.Type)||u.push(n.B.getFactory()),u.some(e=>e.type===i.n.Type)||u.push(i.S.getFactory()),super(l)}}var Le=r(96076);class Oe{constructor(e,t){this.ctor=e,this.optionalProviders=t,this.type="LoopObject"}async instantiateLoopComponent(e,t){const r=this.optionalProviders&&(null===t||void 0===t?void 0:t.synthesize(this.optionalProviders,void 0))||void 0;return new this.ctor(e,r)}}class xe extends Be{constructor(e,t,r,n,i,s){const a="string"===typeof e?{type:e,ctor:t,sharedObjects:r,optionalProviders:n,registryEntries:i,runtimeClass:s}:e;super((0,o.A)((0,o.A)({},a),{},{registryEntries:Me(a.registryEntries),runtimeClass:Re(_e(a.runtimeClass))})),this.registryEntries=a.registryEntries}getSubComponentRegistryInfo(e){var t;return null===(t=this.registryEntries)||void 0===t?void 0:t.get(e)}get SubComponentRegistryDataProvider(){return this}get FluidDataObjectFactoryProvider(){return this}async createDataObject(e,t,r){const[o,n]=await this.createInstanceWithDataStore(e,t,r);return{entryPoint:o,dataStore:n}}}function Me(e){if(!e)return;const t=new Map;return e.forEach((e,r)=>{"FluidObject"===e.factory.type&&t.set(r,e.factory.factory)}),t}function Re(){return Ae(async(e,t)=>(await Le.C.getDataObject(t)).request(e),arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne)}function _e(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ne;return class extends t{addBlob(e,t,r){const o=t.shift();if(void 0===o)throw new V.iq("Path can't be empty");let n={type:f.Z.Blob,content:r};e.stats.blobNodeCount++,e.stats.totalBlobSize+=r.length;for(const i of t.reverse())n={type:f.Z.Tree,tree:{[i]:n}},e.stats.treeNodeCount++;e.summary.tree[o]=n}async summarize(){const t=await super.summarize(...arguments);try{const r=await e(this);void 0!==r&&this.addBlob(t,r.path,r.content)}catch(r){throw s.I9.wrapIfUnrecognized(r,"mixinSummaryHandler")}return t}}}(async e=>{const t=(await Le.C.getDataObject(e)).SearchContent;if(void 0===t)return;const r=await t.getSearchContent();if(void 0===r)return;return{path:["_search","01"],content:r.endsWith("\n")?r:r+"\n"}},arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne)}},39430:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var o=r(31831);function n(e){const t=[];for(const r of e){let e,n;Array.isArray(r)?(e=r[0],n=r[1]):(e=r.name,n=r.value),t.push({name:e,value:n});const i=o.y.get(e);if(i)for(const r of i)if(void 0===t.find(e=>e.name===r)){const e={name:r,value:n};t.push(e)}}return t}},39521:(e,t,r)=>{"use strict";r.d(t,{iq:()=>P,i5:()=>T,AV:()=>p,aX:()=>y,OQ:()=>w,vt:()=>C,dy:()=>f,qp:()=>k,cQ:()=>m,kc:()=>S,J4:()=>b});var o=r(27051);const n={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i;const s=new Uint8Array(16);function a(){if(!i&&(i="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(s)}const c=[];for(let I=0;I<256;++I)c.push((I+256).toString(16).slice(1));function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]}const l=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const o=(e=e||{}).random||(e.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return d(o)};var u=r(83533),h=r(27250);const g=e=>null!==e&&!Array.isArray(e)&&"object"===typeof e;function p(e,t){const r={message:"string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:String(e)};if(g(e)){const{errorType:o,stack:n,name:i}=e;if("string"===typeof o&&(r.errorType=o),"string"===typeof n){const e="string"===typeof i?i:void 0;r.stack=((e,r)=>{if(!t)return e;const o=e.split("\n");return o.shift(),void 0!==r&&o.unshift(r),o.join("\n")})(n,e)}}return r}const f=e=>"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;if((0,u.X)(e))return e.addTelemetryProperties(null!==(r=t.props)&&void 0!==r?r:{}),e;const{message:n,stack:i}=p(e,!1),s=new E({message:n,stack:i});if("object"===typeof e&&null!==e){const t=e;let r;"canRetry"in e&&(null!==r&&void 0!==r||(r={}),r.canRetry=t.canRetry),"retryAfterSeconds"in e&&(null!==r&&void 0!==r||(r={}),r.retryAfterSeconds=t.retryAfterSeconds),void 0!==r&&Object.assign(s,r)}"object"!==typeof e&&s.addTelemetryProperties({typeofError:typeof e});const a=P.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return s.addTelemetryProperties((0,o.A)((0,o.A)({},a),t.props)),s}let v;function y(e){return function(e){const t=Error,r=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const o=new Error("<<generated stack>>");if(void 0===v&&(v=void 0!==o.stack),v)return t.stackTraceLimit=r,o;try{throw o}catch(n){return t.stackTraceLimit=r,n}}(e).stack}function b(e,t){const{message:r,stack:o}=p(e,!1),n=t(r);return void 0!==o&&S(n,o),C(e)&&n.addTelemetryProperties({untrustedOrigin:1}),(0,u.f)(e)&&(n.overwriteErrorInstanceId(e.errorInstanceId),n.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),f(e)&&n.addTelemetryProperties(e.getTelemetryProperties()),n}function S(e,t){try{Object.assign(e,{stack:t})}catch(r){e.addTelemetryProperties({stack2:t})}}function C(e){if(P.typeCheck(e)){if(e.errorType===T){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}function k(e){return"string"===typeof(null===e||void 0===e?void 0:e.tag)}const w=()=>{const e=new WeakSet;return(t,r)=>{if("object"===typeof r&&null!==r){if(e.has(r))return"<removed/circular>";e.add(r)}return r}};class P extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=r,this._errorInstanceId=l(),r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[r,o]of Object.entries(t))void 0===e[r]&&(e[r]=o)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const r=this[t];e[t]=(0,h.fV)(r)}return(0,o.A)((0,o.A)({},e),{},{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}}const T="genericError";class E extends P{constructor(e){super(e.message),this.errorType=T,void 0!==e.stack&&S(this,e.stack)}}},39773:(e,t,r)=>{"use strict";r.d(t,{EW:()=>a,I9:()=>c,eb:()=>s});var o=r(27051),n=r(488),i=r(95663);i.iq;class s extends i.iq{constructor(e,t){super(e,(0,o.A)((0,o.A)({},t),{},{usageError:!0})),this.errorType=n.k.usageError}}class a extends i.iq{constructor(e,t){super(e,(0,o.A)((0,o.A)({},t),{},{dataProcessingError:1})),this.errorType=n.k.dataCorruptionError,this.canRetry=!1}}class c extends i.iq{constructor(e,t){super(e,t),this.errorType=n.k.dataProcessingError,this.canRetry=!1}static create(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4?arguments[4]:void 0;const i=Error,s=i.stackTraceLimit;try{void 0!==n&&(i.stackTraceLimit=n);const s=c.wrapIfUnrecognized(e,t,r);return s.addTelemetryProperties(o),s}finally{void 0!==n&&(i.stackTraceLimit=s)}}static wrapIfUnrecognized(e,t,r){const n=(0,o.A)({dataProcessingError:1,dataProcessingCodepath:t},void 0===r?void 0:d(r)),s=(0,i.cQ)(e,{props:n});if((0,i.vt)(s)||s.errorType===i.i5){const e=(0,i.J4)(s,e=>new c(e));return e.addTelemetryProperties(s.getTelemetryProperties()),e}return s}}const d=e=>({messageClientId:null===e.clientId?"null":e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp})},39888:(e,t,r)=>{"use strict";var o;r.d(t,{j:()=>o}),function(e){e.themePropertiesChanged="themePropertiesChanged",e.textStylesChanged="textStylesChanged"}(o||(o={}))},40118:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var o=r(91947);class n{constructor(){this.tokenMap=new Map,this.pendingRequests=new Map,this.tokenExpirationDuration=18e4,this.isCacheEnabled=!1}generateTokenKey(e,t){return"".concat(e,"|").concat(t)}static getCurrentTime(){return(new Date).getTime()}async getToken(e,t,r){if(!this.isCacheEnabled){return{token:await(0,o.gf)(e,t)}}const i=this.generateTokenKey(e,t);if(r)this.tokenMap.delete(i);else{const e=this.tokenMap.get(i);if(e){if(!(n.getCurrentTime()>=e.expiration)){return{token:e.token,fromCache:!0}}this.tokenMap.delete(i)}}const s=this.pendingRequests.get(i);if(s){return{token:await s}}const a=(0,o.gf)(e,t);this.pendingRequests.set(i,a);try{const e=await a;return this.tokenMap.set(i,{token:e,expiration:n.getCurrentTime()+this.tokenExpirationDuration}),{token:e}}finally{this.pendingRequests.delete(i)}}static GetInstance(){return null==this.instance&&(this.instance=new n),this.instance}}n.instance=void 0},40635:(e,t,r)=>{"use strict";r.d(t,{y:()=>h,g:()=>g});var o=r(27051),n=r(73370),i=r(93537),s=r(75812),a=r(75964);var c=r(43172),d=r(47373);function l(){return"undefined"!==typeof performance?performance.now():Date.now()}function u(e){var t;return{tenantId:e.tenantId,request:{url:e.url,method:null!==(t=e.requestInit)&&void 0!==t&&t.method?e.requestInit.method:"GET"}}}function h(e){return f(e,u(e))}function g(e){return f(e,u(e))}const p=3;async function f(e,t){var r,d;let u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const h=null!==(r=null===(d=e.retryPolicy)||void 0===d?void 0:d.maxAuthRetries)&&void 0!==r?r:p,g=l(),{token:v,authorizationHeader:y}=await e.getToken(t),b=l(),{url:S,requestInit:C,retryPolicy:k,timeoutMs:w,tokenPolicy:P,additionalRequestHeaders:T}=e,{url:E,request:I}=(0,n.p)(S,C,v,y||"".concat(n.Y," ").concat(v),P||{});T&&I&&T.forEach((e,t)=>{!function(e,t,r){if(void 0===e.headers){const o=new Headers;o.set(t,r),e.headers=o}else if(e.headers instanceof Headers)e.headers.has(t)||e.headers.set(t,r);else if(Array.isArray(e.headers)){for(let r=0;r<e.headers.length;r+=1)if(e.headers[r][0]===t)return;e.headers=[...e.headers,[t,r]]}else e.hasOwnProperty("headers")&&(e.headers=(0,o.A)({[t]:r},e.headers))}(I,t,e)});const N=e=>401===e.status&&function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;return t.split(",").map(e=>{const t=e.split("=");if(t.length>=2)if(o||"error"!==t[0].trim().toLowerCase()){if(!r&&"claims"===t[0].trim().toLowerCase()){const t=(0,a.X)(e.substring(e.indexOf("=")+1).trim());t&&(r=atob(t))}}else o="insufficient_claims"===(0,a.X)(t[1].trim().toLowerCase())}),o?r:void 0}(e.headers)||void 0,A=e=>401===e.status&&void 0!==function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;for(const n of t.split(",")){const e=n.split("=");e.length>=2&&(o||"error"!==e[0].trim().toLowerCase()?void 0===r&&"error_description"===e[0].trim().toLowerCase()&&(r=(0,a.X)(e[1].trim())):o="invalid_token"===(0,a.X)(e[1].trim().toLowerCase()))}return o?{errorDescription:r}:void 0}(e.headers)||void 0,F=e=>{if(401===e.status){const r=(0,c.J)(e.headers);if(r&&r!==t.tenantId)return r}};let D,B;if(k&&(D=(0,o.A)((0,o.A)({},k),{},{filter:e=>!N(e)&&!A(e)&&!F(e)&&k.filter(e)})),"logger"in e&&"nameForLogging"in e){const t=async(t,r)=>{var n;const i=await(null===(n=e.getAdditionalProps)||void 0===n?void 0:n.call(e,t,r)),s=Math.round(b-g);return(0,o.A)({tokenFetchDurationMs:s},i)};B=await(0,s.R)(E,I,e.nameForLogging,e.logger,e.doNotLogOnSuccess,D,w,t)}else B=await(0,i.J5)(E,I,D,w);if(u<=h){const r=u===h,n=N(B.result);if(n)return m(e,"InsufficientClaims",u,r),f(e,(0,o.A)((0,o.A)({},t),{},{claims:n,forceRefresh:!0}),u+1);if(A(B.result))return m(e,"InvalidToken",u,r),f(e,(0,o.A)((0,o.A)({},t),{},{forceRefresh:!0}),u+1);const i=F(B.result);if(i)return m(e,"SpecificTenant",u,r),f(e,(0,o.A)((0,o.A)({},t),{},{tenantId:i}),u+1)}return B}function m(e,t,r,o){"logger"in e&&"nameForLogging"in e&&(0,d.Ot)(e.logger,{eventName:"Retry".concat(e.nameForLogging,"OnAuthError"),subCategory:t,attempt:r,isFinalAttempt:o})}},40684:(e,t,r)=>{"use strict";r.d(t,{QK:()=>c,qH:()=>h,tR:()=>a,zr:()=>f});var o=r(899),n=r(31942),i=r(56142),s=r(69235);let a=function(e){return e[e.GetToken=1e3]="GetToken",e[e.SizeChanged=1001]="SizeChanged",e[e.GetFeature=1002]="GetFeature",e[e.SendTelemetry=1003]="SendTelemetry",e[e.ReportActivityResult=1004]="ReportActivityResult",e[e.GetUserIdentity=1006]="GetUserIdentity",e[e.GetNativeInfo=1007]="GetNativeInfo",e[e.ShowPermissionCallout=1008]="ShowPermissionCallout",e[e.CaretPositionChanged=1009]="CaretPositionChanged",e[e.OnAtMention=1010]="OnAtMention",e[e.OnInvokeFromInjectedScript=1011]="OnInvokeFromInjectedScript",e[e.FluidComponentCreated=1012]="FluidComponentCreated",e[e.IsChangeGateEnabled=1013]="IsChangeGateEnabled",e[e.FluidHostIsReady=1015]="FluidHostIsReady",e[e.PassKeyToHost=1016]="PassKeyToHost",e[e.GetDataForCreate=1017]="GetDataForCreate",e[e.SetCanProvideDataToSave=1018]="SetCanProvideDataToSave",e[e.ProvideDataToSave=1019]="ProvideDataToSave",e[e.FluidComponentEdited=1020]="FluidComponentEdited",e[e.TeachingCalloutDismissed=1021]="TeachingCalloutDismissed",e[e.TeachingCalloutShown=1022]="TeachingCalloutShown",e[e.FluidComponentCreateFailed=1023]="FluidComponentCreateFailed",e[e.InvokeMessageExtensionCommand=1024]="InvokeMessageExtensionCommand",e[e.LoopComponentCreated=1025]="LoopComponentCreated",e[e.Dehydrate=1026]="Dehydrate",e[e.SaveEmbeddedData=1027]="SaveEmbeddedData",e[e.UpdateLoopInfo=1028]="UpdateLoopInfo",e[e.CursUpDownFromE2o=1029]="CursUpDownFromE2o",e[e.ClearYCaretCoordinate=1030]="ClearYCaretCoordinate",e[e.GetOcps=1031]="GetOcps",e[e.ScrollHost=1032]="ScrollHost",e}({}),c=function(e){return e[e.Hydrate=0]="Hydrate",e}({});class d extends Error{constructor(e,t){super(t),this.errorCode=void 0,this.errorCode=e}}let l=function(e){return e[e.fixed=0]="fixed",e[e.growHeight=1]="growHeight",e[e.grow=2]="grow",e}({});function u(e){return a[e]}function h(e){switch(e){case n.S.grow:return l.grow;case n.S.growHeight:return l.growHeight;case n.S.fixedByHost:return l.fixed;default:throw new s.uV("Unknown LayoutMode")}}let g=0;const p=!1;function f(e,t){return new Promise((r,n)=>{try{const c=function(e){if(p){++g;const t=a[e];return(0,i.Rm)("[".concat(g,"] Native method called: ").concat(t)),{invocation:g,methodName:t,timeStart:performance.now()}}return}(e);o.qn&&o.qn.Execute||n(new d(void 0,"Native requests are not supported.")),o.qn.Execute(e,t,(t,o)=>{if(function(e){if(e){const t=performance.now()-e.timeStart;(0,i.Rm)("[".concat(e.invocation,"] Native method return: ").concat(e.methodName," (Duration: ").concat(t,")"))}}(c),!t)throw new s.uV("The callback did not provide any data.");const a=t.toArray();if(!Array.isArray(a))throw new s.uV("The callback data is not an array.");0===a.length&&a.push("number"===typeof o?o:0);const[l,...h]=a;if("number"!==typeof l)throw new s.uV("The first item returned should be an error code number.");if(0===l)r(h);else{const[t]=h,r="string"===typeof t?"\n".concat(t):"";n(new d(l,"".concat(u(e)," native method failed. Error code: ").concat(l).concat(r)))}})}catch(c){n(new d(void 0,"Unexpected response from native request: ".concat(u(e),".\n").concat(c instanceof Error?c.message:c)))}})}},40695:(e,t,r)=>{"use strict";r.d(t,{B:()=>i,b:()=>n});var o=r(56851);function n(e,t,r,n,s){return void 0===s&&(s=!1),function(e,t){var r="";!0===t&&(r=" /* @deprecated */");return e.listTextColor=e.listText+r,e.menuItemBackgroundChecked+=r,e.warningHighlight+=r,e.warningText=e.messageText+r,e.successText+=r,e}(i(e,t,(0,o.__assign)({primaryButtonBorder:"transparent",errorText:n?"#F1707B":"#a4262c",messageText:n?"#F3F2F1":"#323130",messageLink:n?"#6CB8F6":"#005A9E",messageLinkHovered:n?"#82C7FF":"#004578",infoIcon:n?"#C8C6C4":"#605e5c",errorIcon:n?"#F1707B":"#A80000",blockingIcon:n?"#442726":"#FDE7E9",warningIcon:n?"#C8C6C4":"#797775",severeWarningIcon:n?"#FCE100":"#D83B01",successIcon:n?"#92C353":"#107C10",infoBackground:n?"#323130":"#f3f2f1",errorBackground:n?"#442726":"#FDE7E9",blockingBackground:n?"#442726":"#FDE7E9",warningBackground:n?"#433519":"#FFF4CE",severeWarningBackground:n?"#4F2A0F":"#FED9CC",successBackground:n?"#393D1B":"#DFF6DD",warningHighlight:n?"#fff100":"#ffb900",successText:n?"#92c353":"#107C10"},r),n),s)}function i(e,t,r,n,i){void 0===i&&(i=!1);var s={},a=e||{},c=a.white,d=a.black,l=a.themePrimary,u=a.themeDark,h=a.themeDarker,g=a.themeDarkAlt,p=a.themeLighter,f=a.neutralLight,m=a.neutralLighter,v=a.neutralDark,y=a.neutralQuaternary,b=a.neutralQuaternaryAlt,S=a.neutralPrimary,C=a.neutralSecondary,k=a.neutralSecondaryAlt,w=a.neutralTertiary,P=a.neutralTertiaryAlt,T=a.neutralLighterAlt,E=a.accent;return c&&(s.bodyBackground=c,s.bodyFrameBackground=c,s.accentButtonText=c,s.buttonBackground=c,s.primaryButtonText=c,s.primaryButtonTextHovered=c,s.primaryButtonTextPressed=c,s.inputBackground=c,s.inputForegroundChecked=c,s.listBackground=c,s.menuBackground=c,s.cardStandoutBackground=c),d&&(s.bodyTextChecked=d,s.buttonTextCheckedHovered=d),l&&(s.link=l,s.primaryButtonBackground=l,s.inputBackgroundChecked=l,s.inputIcon=l,s.inputFocusBorderAlt=l,s.menuIcon=l,s.menuHeader=l,s.accentButtonBackground=l),u&&(s.primaryButtonBackgroundPressed=u,s.inputBackgroundCheckedHovered=u,s.inputIconHovered=u),h&&(s.linkHovered=h),g&&(s.primaryButtonBackgroundHovered=g),p&&(s.inputPlaceholderBackgroundChecked=p),f&&(s.bodyBackgroundChecked=f,s.bodyFrameDivider=f,s.bodyDivider=f,s.variantBorder=f,s.buttonBackgroundCheckedHovered=f,s.buttonBackgroundPressed=f,s.listItemBackgroundChecked=f,s.listHeaderBackgroundPressed=f,s.menuItemBackgroundPressed=f,s.menuItemBackgroundChecked=f),m&&(s.bodyBackgroundHovered=m,s.buttonBackgroundHovered=m,s.buttonBackgroundDisabled=m,s.buttonBorderDisabled=m,s.primaryButtonBackgroundDisabled=m,s.disabledBackground=m,s.listItemBackgroundHovered=m,s.listHeaderBackgroundHovered=m,s.menuItemBackgroundHovered=m),y&&(s.primaryButtonTextDisabled=y,s.disabledSubtext=y),b&&(s.listItemBackgroundCheckedHovered=b),w&&(s.disabledBodyText=w,s.variantBorderHovered=(null===r||void 0===r?void 0:r.variantBorderHovered)||w,s.buttonTextDisabled=w,s.inputIconDisabled=w,s.disabledText=w),S&&(s.bodyText=S,s.actionLink=S,s.buttonText=S,s.inputBorderHovered=S,s.inputText=S,s.listText=S,s.menuItemText=S),T&&(s.bodyStandoutBackground=T,s.defaultStateBackground=T),v&&(s.actionLinkHovered=v,s.buttonTextHovered=v,s.buttonTextChecked=v,s.buttonTextPressed=v,s.inputTextHovered=v,s.menuItemTextHovered=v),C&&(s.bodySubtext=C,s.focusBorder=C,s.inputBorder=C,s.smallInputBorder=C,s.inputPlaceholderText=C),k&&(s.buttonBorder=k),P&&(s.disabledBodySubtext=P,s.disabledBorder=P,s.buttonBackgroundChecked=P,s.menuDivider=P),E&&(s.accentButtonBackground=E),(null===t||void 0===t?void 0:t.elevation4)&&(s.cardShadow=t.elevation4),!n&&(null===t||void 0===t?void 0:t.elevation8)?s.cardShadowHovered=t.elevation8:s.variantBorderHovered&&(s.cardShadowHovered="0 0 1px "+s.variantBorderHovered),s=(0,o.__assign)((0,o.__assign)({},s),r)}},41395:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var o=r(27051),n=r(37513);const i=(0,o.A)((0,o.A)({},n.a),{},{invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"})},41818:(e,t,r)=>{"use strict";r.d(t,{Km:()=>n,Ss:()=>a,Xg:()=>i});var o=r(34445);function n(e,t){switch(t){case"base64":return o.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>a.from(e,t).buffer;function s(e){const t=e;return e instanceof ArrayBuffer||"object"===typeof t&&null!==t&&"number"===typeof t.byteLength&&"function"===typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class a extends Uint8Array{toString(e){return n(this,e)}static from(e,t,r){if("string"===typeof e)return a.fromString(e,t);if(null!==e&&"object"===typeof e&&s(e.buffer))return a.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(s(e))return a.fromArrayBuffer(e,t,r);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,r){const o=null!==t&&void 0!==t?t:0,n=null!==r&&void 0!==r?r:e.byteLength-o;if(o<0||o>e.byteLength||n<0||n+o>e.byteLength)throw new RangeError("Invalid range specified.");return new a(e,o,n)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),r=o.toByteArray(t);return new a(r.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new a(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!==0){t+=["","===","==","="][t.length%4]}return t}}},43172:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});var o=r(73370);function n(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(o.Y);if(r<0)return;let n;return t.substring(r+o.Y.length).split(",").map(e=>{if(!n){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(n=JSON.parse(t[1].trim()))}}),n}},43483:(e,t,r)=>{"use strict";r.d(t,{$S:()=>A,$T:()=>P,AV:()=>I,CE:()=>w,D9:()=>b,EM:()=>T,GC:()=>j,JW:()=>N,KK:()=>y,ON:()=>d,Oh:()=>o,Os:()=>B,Q1:()=>i,QH:()=>R,QJ:()=>z,Ql:()=>l,T_:()=>m,Us:()=>x,Vu:()=>U,Vv:()=>f,WB:()=>v,X1:()=>G,Xk:()=>k,Xv:()=>c,Y3:()=>W,YA:()=>C,Z:()=>O,Z1:()=>a,Zp:()=>M,Zz:()=>V,bK:()=>S,c8:()=>n,ik:()=>u,jF:()=>h,je:()=>p,pT:()=>_,qn:()=>H,s$:()=>F,t1:()=>q,ti:()=>s,um:()=>L,wL:()=>E,wv:()=>g,z1:()=>D});const o={2:"#050505",4:"#0a0a0a",6:"#0f0f0f",8:"#141414",10:"#1a1a1a",12:"#1f1f1f",14:"#242424",16:"#292929",18:"#2e2e2e",20:"#333333",22:"#383838",24:"#3d3d3d",26:"#424242",28:"#474747",30:"#4d4d4d",32:"#525252",34:"#575757",36:"#5c5c5c",38:"#616161",40:"#666666",42:"#6b6b6b",44:"#707070",46:"#757575",48:"#7a7a7a",50:"#808080",52:"#858585",54:"#8a8a8a",56:"#8f8f8f",58:"#949494",60:"#999999",62:"#9e9e9e",64:"#a3a3a3",66:"#a8a8a8",68:"#adadad",70:"#b3b3b3",72:"#b8b8b8",74:"#bdbdbd",76:"#c2c2c2",78:"#c7c7c7",80:"#cccccc",82:"#d1d1d1",84:"#d6d6d6",86:"#dbdbdb",88:"#e0e0e0",90:"#e6e6e6",92:"#ebebeb",94:"#f0f0f0",96:"#f5f5f5",98:"#fafafa"},n={5:"rgba(255, 255, 255, 0.05)",10:"rgba(255, 255, 255, 0.1)",20:"rgba(255, 255, 255, 0.2)",30:"rgba(255, 255, 255, 0.3)",40:"rgba(255, 255, 255, 0.4)",50:"rgba(255, 255, 255, 0.5)",60:"rgba(255, 255, 255, 0.6)",70:"rgba(255, 255, 255, 0.7)",80:"rgba(255, 255, 255, 0.8)",90:"rgba(255, 255, 255, 0.9)"},i={5:"rgba(0, 0, 0, 0.05)",10:"rgba(0, 0, 0, 0.1)",20:"rgba(0, 0, 0, 0.2)",30:"rgba(0, 0, 0, 0.3)",40:"rgba(0, 0, 0, 0.4)",50:"rgba(0, 0, 0, 0.5)",60:"rgba(0, 0, 0, 0.6)",70:"rgba(0, 0, 0, 0.7)",80:"rgba(0, 0, 0, 0.8)",90:"rgba(0, 0, 0, 0.9)"},s={5:"rgba(26, 26, 26, 0.05)",10:"rgba(26, 26, 26, 0.1)",20:"rgba(26, 26, 26, 0.2)",30:"rgba(26, 26, 26, 0.3)",40:"rgba(26, 26, 26, 0.4)",50:"rgba(26, 26, 26, 0.5)",60:"rgba(26, 26, 26, 0.6)",70:"rgba(26, 26, 26, 0.7)",80:"rgba(26, 26, 26, 0.8)",90:"rgba(26, 26, 26, 0.9)"},a={5:"rgba(31, 31, 31, 0.05)",10:"rgba(31, 31, 31, 0.1)",20:"rgba(31, 31, 31, 0.2)",30:"rgba(31, 31, 31, 0.3)",40:"rgba(31, 31, 31, 0.4)",50:"rgba(31, 31, 31, 0.5)",60:"rgba(31, 31, 31, 0.6)",70:"rgba(31, 31, 31, 0.7)",80:"rgba(31, 31, 31, 0.8)",90:"rgba(31, 31, 31, 0.9)"},c={5:"rgba(36, 36, 36, 0.05)",10:"rgba(36, 36, 36, 0.1)",20:"rgba(36, 36, 36, 0.2)",30:"rgba(36, 36, 36, 0.3)",40:"rgba(36, 36, 36, 0.4)",50:"rgba(36, 36, 36, 0.5)",60:"rgba(36, 36, 36, 0.6)",70:"rgba(36, 36, 36, 0.7)",80:"rgba(36, 36, 36, 0.8)",90:"rgba(36, 36, 36, 0.9)"},d="#ffffff",l="#000000",u={shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},h={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},g={shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},p={shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},f={shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},m={shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},v={shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},y={shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},b={shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},S={shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},C={shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},k={shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},w={shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},P={shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},T={shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},E={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},I={shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},N={shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},A={shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},F={shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},D={shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},B={shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},L={shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},O={shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},x={shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},M={shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},R={shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},_={shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},H={shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},U={shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},j={shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},q={shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},V={shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},z={shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},G={shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},W={shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},43927:(e,t,r)=>{"use strict";r.d(t,{TQ:()=>o,dt:()=>n});const o=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],n=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"]},44828:(e,t,r)=>{"use strict";r.d(t,{z:()=>i});var o=r(73895),n=void 0;try{n=window}catch(s){}function i(e){if((0,o.S)()&&"undefined"!==typeof n){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:n}}},45799:(e,t,r)=>{"use strict";r.d(t,{a:()=>b});var o=r(27051),n=r(51497),i=r(43927),s=r(6390);const a=i.TQ.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background1")]:n.yd[t].tint60,["colorPalette".concat(r,"Background2")]:n.yd[t].tint40,["colorPalette".concat(r,"Background3")]:n.yd[t].primary,["colorPalette".concat(r,"Foreground1")]:n.yd[t].shade10,["colorPalette".concat(r,"Foreground2")]:n.yd[t].shade30,["colorPalette".concat(r,"Foreground3")]:n.yd[t].primary,["colorPalette".concat(r,"BorderActive")]:n.yd[t].primary,["colorPalette".concat(r,"Border1")]:n.yd[t].tint40,["colorPalette".concat(r,"Border2")]:n.yd[t].primary};return Object.assign(e,o)},{});a.colorPaletteYellowForeground1=n.yd.yellow.shade30,a.colorPaletteRedForegroundInverted=n.yd.red.tint20,a.colorPaletteGreenForegroundInverted=n.yd.green.tint20,a.colorPaletteYellowForegroundInverted=n.yd.yellow.tint40;const c=i.dt.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background2")]:n.cc[t].tint40,["colorPalette".concat(r,"Foreground2")]:n.cc[t].shade30,["colorPalette".concat(r,"BorderActive")]:n.cc[t].primary};return Object.assign(e,o)},{}),d=(0,o.A)((0,o.A)({},a),c),l=Object.entries(s.s).reduce((e,t)=>{let[r,o]=t;const i=r.slice(0,1).toUpperCase()+r.slice(1),s={["colorStatus".concat(i,"Background1")]:n.Ul[o].tint60,["colorStatus".concat(i,"Background2")]:n.Ul[o].tint40,["colorStatus".concat(i,"Background3")]:n.Ul[o].primary,["colorStatus".concat(i,"Foreground1")]:n.Ul[o].shade10,["colorStatus".concat(i,"Foreground2")]:n.Ul[o].shade30,["colorStatus".concat(i,"Foreground3")]:n.Ul[o].primary,["colorStatus".concat(i,"ForegroundInverted")]:n.Ul[o].tint30,["colorStatus".concat(i,"BorderActive")]:n.Ul[o].primary,["colorStatus".concat(i,"Border1")]:n.Ul[o].tint40,["colorStatus".concat(i,"Border2")]:n.Ul[o].primary};return Object.assign(e,s)},{});l.colorStatusDangerBackground3Hover=n.Ul[s.s.danger].shade10,l.colorStatusDangerBackground3Pressed=n.Ul[s.s.danger].shade20,l.colorStatusWarningForeground1=n.Ul[s.s.warning].shade20,l.colorStatusWarningForeground3=n.Ul[s.s.warning].shade20,l.colorStatusWarningBorder2=n.Ul[s.s.warning].shade20;var u=r(43483);var h=r(17483),g=r(95829),p=r(45882),f=r(92708),m=r(27586),v=r(58511),y=r(91809);const b=e=>{const t=(e=>({colorNeutralForeground1:u.Oh[14],colorNeutralForeground1Hover:u.Oh[14],colorNeutralForeground1Pressed:u.Oh[14],colorNeutralForeground1Selected:u.Oh[14],colorNeutralForeground2:u.Oh[26],colorNeutralForeground2Hover:u.Oh[14],colorNeutralForeground2Pressed:u.Oh[14],colorNeutralForeground2Selected:u.Oh[14],colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:u.Oh[38],colorNeutralForeground3Hover:u.Oh[26],colorNeutralForeground3Pressed:u.Oh[26],colorNeutralForeground3Selected:u.Oh[26],colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:u.Oh[44],colorNeutralForegroundDisabled:u.Oh[74],colorNeutralForegroundInvertedDisabled:u.c8[40],colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:u.Oh[26],colorNeutralForeground2LinkHover:u.Oh[14],colorNeutralForeground2LinkPressed:u.Oh[14],colorNeutralForeground2LinkSelected:u.Oh[14],colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:u.Oh[14],colorNeutralForegroundStaticInverted:u.ON,colorNeutralForegroundInverted:u.ON,colorNeutralForegroundInvertedHover:u.ON,colorNeutralForegroundInvertedPressed:u.ON,colorNeutralForegroundInvertedSelected:u.ON,colorNeutralForegroundInverted2:u.ON,colorNeutralForegroundOnBrand:u.ON,colorNeutralForegroundInvertedLink:u.ON,colorNeutralForegroundInvertedLinkHover:u.ON,colorNeutralForegroundInvertedLinkPressed:u.ON,colorNeutralForegroundInvertedLinkSelected:u.ON,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:u.ON,colorNeutralBackground1Hover:u.Oh[96],colorNeutralBackground1Pressed:u.Oh[88],colorNeutralBackground1Selected:u.Oh[92],colorNeutralBackground2:u.Oh[98],colorNeutralBackground2Hover:u.Oh[94],colorNeutralBackground2Pressed:u.Oh[86],colorNeutralBackground2Selected:u.Oh[90],colorNeutralBackground3:u.Oh[96],colorNeutralBackground3Hover:u.Oh[92],colorNeutralBackground3Pressed:u.Oh[84],colorNeutralBackground3Selected:u.Oh[88],colorNeutralBackground4:u.Oh[94],colorNeutralBackground4Hover:u.Oh[98],colorNeutralBackground4Pressed:u.Oh[96],colorNeutralBackground4Selected:u.ON,colorNeutralBackground5:u.Oh[92],colorNeutralBackground5Hover:u.Oh[96],colorNeutralBackground5Pressed:u.Oh[94],colorNeutralBackground5Selected:u.Oh[98],colorNeutralBackground6:u.Oh[90],colorNeutralBackgroundInverted:u.Oh[16],colorNeutralBackgroundStatic:u.Oh[20],colorNeutralBackgroundAlpha:u.c8[50],colorNeutralBackgroundAlpha2:u.c8[80],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:u.Oh[96],colorSubtleBackgroundPressed:u.Oh[88],colorSubtleBackgroundSelected:u.Oh[92],colorSubtleBackgroundLightAlphaHover:u.c8[70],colorSubtleBackgroundLightAlphaPressed:u.c8[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:u.Q1[10],colorSubtleBackgroundInvertedPressed:u.Q1[30],colorSubtleBackgroundInvertedSelected:u.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:u.Oh[94],colorNeutralBackgroundInvertedDisabled:u.c8[10],colorNeutralStencil1:u.Oh[90],colorNeutralStencil2:u.Oh[98],colorNeutralStencil1Alpha:u.Q1[10],colorNeutralStencil2Alpha:u.Q1[5],colorBackgroundOverlay:u.Q1[40],colorScrollbarOverlay:u.Q1[50],colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:u.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:u.Oh[98],colorNeutralCardBackgroundHover:u.ON,colorNeutralCardBackgroundPressed:u.Oh[96],colorNeutralCardBackgroundSelected:u.Oh[92],colorNeutralCardBackgroundDisabled:u.Oh[94],colorNeutralStrokeAccessible:u.Oh[38],colorNeutralStrokeAccessibleHover:u.Oh[34],colorNeutralStrokeAccessiblePressed:u.Oh[30],colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:u.Oh[82],colorNeutralStroke1Hover:u.Oh[78],colorNeutralStroke1Pressed:u.Oh[70],colorNeutralStroke1Selected:u.Oh[74],colorNeutralStroke2:u.Oh[88],colorNeutralStroke3:u.Oh[94],colorNeutralStrokeSubtle:u.Oh[88],colorNeutralStrokeOnBrand:u.ON,colorNeutralStrokeOnBrand2:u.ON,colorNeutralStrokeOnBrand2Hover:u.ON,colorNeutralStrokeOnBrand2Pressed:u.ON,colorNeutralStrokeOnBrand2Selected:u.ON,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:u.Oh[88],colorNeutralStrokeInvertedDisabled:u.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:u.Q1[5],colorNeutralStrokeAlpha2:u.c8[20],colorStrokeFocus1:u.ON,colorStrokeFocus2:u.Ql,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return(0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)({},h.V),g.GR),g.lm),g.aI),g.NM),p.k),y.b),y.F),m.S),v.L),t),d),l),(0,f.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey)),(0,f.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand"))}},45882:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});const o={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"}},46212:(e,t,r)=>{"use strict";r.d(t,{x:()=>c});var o=r(22751),n=r(39430);const i="--ms-themeColorPalette",s="--ms-themeColor";function a(e,t){return e.hasOwnProperty(t)}function c(e){const t=e?(0,n.P)(e):void 0,r={},c={},l=(0,o.a)(),u=(e,t)=>{if(e.startsWith(i)){const o=function(e){const t="--ms-themeColorPaletteShared",r="--ms-themeColorPaletteAccent";if(e.startsWith(t))return d(e,t);if(e.startsWith(r))return d(e,r);if(e.startsWith(i))return d(e,i);return}(e);void 0!==o&&a(l.palette,o)&&!r[o]&&(r[o]=t)}else if(e.startsWith(s)){const r=d(e,s);r&&a(l.semanticColors,r)&&!c[r]&&(c[r]=t)}};if(t)for(const o of t)u(o.name,o.value);return(0,o.a)({palette:r,semanticColors:c})}function d(e,t){const r=e.substring(t.length);return"".concat(r.substring(0,1).toLowerCase()).concat(r.substring(1))}},46402:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});const o=Symbol("`mockify` mock function key");function n(e){const t=function(){return t[o](...arguments)};return t[o]=e,t}n.key=o},46624:(e,t,r)=>{"use strict";r.d(t,{DR:()=>o});const o="9188040d-6c67-4c5b-b112-36a304b66dad";new Set(["72f988bf-86f1-41af-91ab-2d7cd011db47","0000","f34444e5-e35c-4ceb-8a8b-7a0042451ccc","0a54704d-bba9-4e27-878e-fe460a591835","de21c301-a4ae-4292-aa09-6db710a590a6","49b6f6cd-6628-4bd2-8753-4d8c8a68fa04","fabbafd6-0003-4695-ada4-929dea5a0d36","5b73a072-2f1f-46ad-92ca-a9b3993e45aa","d4093791-9818-48dc-8880-35d134b8c79d","0d746a1c-f9a6-47a3-9d3a-4f3f1a79c0f6","13c6a44d-9b52-4b9e-aa34-0513ee7131f2","1f855c63-5a0d-47be-8300-914123519d11","21a4f3dd-ef15-47a5-bc51-1a31b80765be","26ed3691-0678-440d-9bc4-134f94a1beb1","35e07416-9027-4637-ae4d-72159981338a","3cbebbae-5ae7-4090-9654-f2df09940424","40ed3d74-3c8c-4399-866e-d1f7a95bb051","45c54e3f-1b2a-4a84-a2f5-5d5e86845726","4ad43d82-3f33-47ee-b8a0-273939d4570a","55ccf089-0e94-4a28-85df-629d0b273be1","6f6da031-e5cf-4e62-82cd-96636e80639e","73561903-7c11-4927-809d-b9a31fda7d61","78375574-4a4c-41a5-8b31-72e0374aa242","9188040d-6c67-4c5b-b112-36a304b66dad","a0effc3b-4ee4-4a46-9dcc-89fd35b439f6","af33e969-0b64-4c2d-bad6-329f25f2d990","b00367e2-193a-4f48-94de-7245d45c0947","b48595ab-4114-4783-883d-41872f68adfb","b68a597d-37e2-4254-a203-5fd9602367ee","c00cdc1a-23ab-45df-8a48-1f8d96fa2fab","c51071fb-f559-4967-ac4f-63ee879ca4ec","e1a132a4-2f3d-4ef5-9b14-2d4e94833544","e58c8e81-abd8-48a8-929d-eb67611b83bd","e73ba7cf-4e1b-40f5-805e-c3aae41e1b90","fc3fd415-e428-4884-bf6f-62c2e70a6682","8f474e12-1b0c-463d-a004-edbc2e2c72b0","6583636b-d156-492e-86ce-b8fccb790df1","91b036b7-fff3-4c61-8d5e-dba6d56268bd","7a55eed5-98d0-4f09-bf4e-17768961e804"])},46851:(e,t,r)=>{"use strict";var o;r.d(t,{f:()=>o}),function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(o||(o={}))},47373:(e,t,r)=>{"use strict";r.d(t,{LJ:()=>w,IA:()=>f,hO:()=>g,Ot:()=>h,o4:()=>m,A$:()=>u});var o=r(27051),n=r(90589),i={contractName:"Ms.ProductUsage.Action",instanceName:"BaseType",getFields:function(e){var t=this.instanceName,r=[];return r.push((0,n.m9)("zC.".concat(t),this.contractName)),e.ver&&r.push((0,n.m9)("".concat(t,".Ver"),e.ver)),r.push((0,n.m9)("".concat(t,".Name"),e.name)),e.featureName&&r.push((0,n.m9)("".concat(t,".FeatureName"),e.featureName)),e.featureCategory&&r.push((0,n.m9)("".concat(t,".FeatureCategory"),e.featureCategory)),e.inputMethod&&r.push((0,n.m9)("".concat(t,".InputMethod"),e.inputMethod)),r.push((0,n.LK)("".concat(t,".IsExportable"),e.isExportable)),r.push((0,n.LK)("".concat(t,".IsIntentional"),e.isIntentional)),e.subWorkload&&r.push((0,n.m9)("".concat(t,".SubWorkload"),e.subWorkload)),e.target&&r.push((0,n.m9)("".concat(t,".Target"),e.target)),r}},s=r(78702),a=r(83125);const c=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"],d=["local.loop.microsoft.com","res.cdn.office.net","res-sdf.cdn.office.net"];function l(e){for(const t in e)if(-1!==t.search(/message|error|stack/i)||c.includes(t)){const r=e[t];if("string"===typeof r){const o=/\b([A-Z0-9.!#$%&'*+-/=?^_`{|}~]+@[A-Z0-9.-]+\.[A-Z]{2,4})\b|\b((?:https?|ftp):\/\/([^\/\s]+)[^\s]*)\b/gi;e[t]=r.replace(o,(e,t,r,o)=>t?"(scrubbed_email)":r&&!d.includes(o)?"(scrubbed_URL)":e)}}return e}function u(e,t,r,o){if(t)switch(e){case s.hB.Generic:return h(t,r);case s.hB.Error:return g(t,r,o);case s.hB.Activity:return f(t,r,o);case s.hB.UserAction:return m(t,r);default:return}}function h(e,t){const r=l(t);e.send((0,o.A)((0,o.A)({},r),{},{category:s.hB.Generic}))}function g(e,t,r){r&&C(t,r);const n=l(t);e.send((0,o.A)((0,o.A)({},n),{},{category:s.hB.Error})),t.isUserImpacting&&v(e,n)}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0],["Gallatin",0]]);const p={Automation:!0,SyntheticTraffic:!0,Local:!0,Development:!0,Staging:!0,Dogfood:!0,Preview:!0,Microsoft:!0,Production:!1,GCC:!1,"GCC-High":!1,DoD:!1,USNat:!1,USSec:!1,Gallatin:!1,Bleu:!1,Delos:!1};function f(e,t,r){r&&C(t,r),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?s.Tp.Success:s.Tp.Failure);const n=l(t);e.send((0,o.A)((0,o.A)({},n),{},{category:s.hB.Activity})),t.resultType===s.Tp.Failure&&t.isUserImpacting&&v(e,n)}function m(e,t,r){const n=t;if(r){const t=i.getFields(r);e.send((0,o.A)((0,o.A)({},n),{},{dataFields:t,category:s.hB.UserAction}))}else e.send((0,o.A)((0,o.A)({},n),{},{category:s.hB.UserAction}))}function v(e,t){var r,n;let i=e;const c=null===(r=(n=i).getNamespace)||void 0===r?void 0:r.call(n),d="".concat(c,"_").concat(t.eventName);i=new a.p("ContainerSession",e),i.send((0,o.A)((0,o.A)({},t),{},{errorAction:d,category:s.hB.Error}))}const y=e=>"object"===typeof e&&null!==e;function b(e,t){if(!y(t))return;const r=t[e];return"string"===typeof r?r:void 0}function S(e){const t="string"===typeof e?e:void 0,r=b("errorType",e);return{message:null!==t&&void 0!==t?t:b("message",e),errorMessage:null!==t&&void 0!==t?t:b("errorMessage",e),errorName:b("name",e),stack:b("stack",e),errorType:r,errorInstanceId:b("errorInstanceId",e)}}function C(e,t){!function(e,t){var r,o,n;const i=S(e);if(t.message=null!==(r=i.message)&&void 0!==r?r:t.message,t.errorMessage=null!==(o=i.errorMessage)&&void 0!==o?o:t.message,t.errorName=i.errorName,t.stack=null!==(n=i.stack)&&void 0!==n?n:"string"===typeof t.stack?t.stack:void 0,t.errorType=i.errorType||t.errorType,t.errorInstanceId=i.errorInstanceId,c.forEach(r=>{if(y(e)){const o=e[r];"boolean"!==typeof o&&"number"!==typeof o&&"string"!==typeof o&&"undefined"!==typeof o||(t[r]=o),"object"===typeof o&&(t[r]=JSON.stringify(o))}}),"object"===typeof e&&e&&"cause"in e){const r=S(e.cause);t.causeMessage=r.message,t.causeStack=r.stack}}(t,e),e.message||(e.message=e.errorMessage),void 0===e.stack&&(e.stack=k())}function k(e){const t=Error.stackTraceLimit;void 0!==e&&(Error.stackTraceLimit=e);let r=(new Error).stack;if(!r)try{throw new Error}catch(o){r=o.stack}return Error.stackTraceLimit=t,r}function w(e){return p[e]}},47860:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var o=r(77432);const n=e=>(0,o.F)("graph",e)},48116:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});const o="https://home.microsoftpersonalcontent.com"},48219:(e,t,r)=>{"use strict";var o;r.d(t,{U:()=>o}),function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(o||(o={}))},48680:(e,t,r)=>{"use strict";r.d(t,{AU:()=>l});var o=r(75964),n=r(52841),i=r(3503);const s=new Map;function a(e,t){const r=function(e,t){const r=s.get(e);if(void 0!==r)return r;let o,a,d,l;l=void 0!==(o=function(e){const t=i.f.get(e);return c(t)}(e))?o:void 0!==(a=function(e){var t;const r=null===(t=(0,n.Ar)())||void 0===t?void 0:t.getItem(e);return c(r)}(e))?a:void 0!==(d=function(e){var t;const r=null===(t=(0,n.RY)())||void 0===t?void 0:t.getItem(e);return c(r)}(e))?d:t;return s.set(e,l),l}(e,t);return r}function c(e){if(null!==e&&void 0!==e){const t=(0,o.X)(e),r=void 0!==t?t:e;return"on"===r||"off"===r?"on"===r:r}}function d(e,t,r,o){return r?r.getSetting(e,t,o):a(e,t)}const l=(e,t,r)=>d(e,t,r,"FluidExperiences")},48717:(e,t,r)=>{"use strict";r.d(t,{Y:()=>n});var o=r(73895);function n(e){if((0,o.S)()&&"undefined"!==typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},49750:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});class o extends Error{constructor(e,t){super(e),this.name="ErrorWithCode",this.code=t}}class n extends o{constructor(e,t){super(e),this.name="ResponseError",this.code=t.status,this.statusText=t.statusText}}},50178:(e,t,r)=>{"use strict";r.d(t,{mc:()=>u,fV:()=>v,pW:()=>p,ZK:()=>h,Df:()=>b});var o=r(53986),n=r(27051),i=r(20310);const s=20,a=30;var c=r(17637),d=r(95663);const l=["category","eventName"];var u;function h(e){if(void 0===e||null===e)return;const t=Number(e);return Number.isNaN(t)?e:t}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(u||(u={}));class g{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,r){const{message:o,errorType:n,stack:i}=(0,d.AV)(t,!0);if(e.stack=i,e.error=o,e.errorType=n,(0,d.dy)(t)){const r=t.getTelemetryProperties();for(const t of Object.keys(r))void 0===e[t]&&(e[t]=r[t])}void 0===e.stack&&r&&(e.stack=(0,d.aX)())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;this.sendTelemetryEventCore((0,n.A)((0,n.A)({},e),{},{category:null!==(r=e.category)&&void 0!==r?r:"generic"}),t,"error"===e.category?a:o)}sendTelemetryEventCore(e,t,r){const n=function(e){let{category:t,eventName:r}=e,n=(0,o.A)(e,l);const i={category:t,eventName:r};for(const o of Object.keys(n))i[o]=v(n[o]);return i}(e);var i;void 0!==t&&g.prepareErrorObject(n,t,!1),"number"===typeof n.duration&&(n.duration=(i=n.duration,Math.floor(i))),this.send(n,r)}sendErrorEvent(e,t){this.sendTelemetryEventCore((0,n.A)((0,n.A)({error:e.eventName},e),{},{category:"error"}),t,a)}sendPerformanceEvent(e,t){var r;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;const i=(0,n.A)((0,n.A)({},e),{},{category:null!==(r=e.category)&&void 0!==r?r:"performance"});this.sendTelemetryEventCore(i,t,"error"===i.category?a:o)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,r=(0,n.A)({},e);return void 0!==this.namespace&&(r.eventName="".concat(this.namespace).concat(g.eventNamespaceSeparator).concat(r.eventName)),this.extendProperties(r,t)}extendProperties(e,t){const r=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,o]of Object.entries(t)){if(void 0!==r[e])continue;const t="function"===typeof o?o():o;void 0!==t&&(r[e]=t)}}return e}}g.eventNamespaceSeparator=":";function p(e){return f.create(null===e||void 0===e?void 0:e.logger,null===e||void 0===e?void 0:e.namespace,null===e||void 0===e?void 0:e.properties)}class f extends g{static create(e,t,r){if(e instanceof f){const o={};for(const t of[e.properties,r])void 0!==t&&(void 0!==t.all&&(o.all=(0,n.A)((0,n.A)({},o.all),t.all)),void 0!==t.error&&(o.error=(0,n.A)((0,n.A)({},o.error),t.error)));const i=void 0===e.namespace?t:void 0===t?e.namespace:"".concat(e.namespace).concat(g.eventNamespaceSeparator).concat(t),s=new f(e.baseLogger,i,o);return!(0,c.uz)(s)&&(0,c.uz)(e)&&(0,c.fG)(s,e.config),s}return new f(null!==e&&void 0!==e?e:{send(){}},t,r)}constructor(e,t,r){super(t,r),this.baseLogger=e,(0,c.uz)(e)&&(0,c.fG)(this,new c.G0(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){var r;return(null!==t&&void 0!==t?t:s)<(null!==(r=this.baseLogger.minLogLevel)&&void 0!==r?r:s)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}class m{static start(e,t,r){return new m(e,t,r,!(arguments.length>3&&void 0!==arguments[3])||arguments[3])}static timedExec(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=m.start(e,t,o,m.shouldReport(t,n));try{const e=r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}static async timedExecAsync(e,t,r,o){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const i=m.start(e,t,o,m.shouldReport(t,n));try{const e=await r(i);return i.autoEnd(),e}catch(s){throw i.cancel(void 0,s),s}}get duration(){return(0,i.l)()-this.startTime}constructor(e,t){var r,o;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!0,cancel:"generic"},a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.logger=e,this.markers=s,this.emitLogs=a,this.startTime=(0,i.l)(),this.event=(0,n.A)({},t),this.markers.start&&this.reportEvent("start"),"object"===typeof window&&void 0!==(null===(r=window)||void 0===r||null===(r=r.performance)||void 0===r?void 0:r.mark)&&null!==(null===(o=window)||void 0===o||null===(o=o.performance)||void 0===o?void 0:o.mark)&&(this.startMark="".concat(t.eventName,"-start"),window.performance.mark(this.startMark))}reportProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e="".concat(this.event.eventName,"-end");window.performance.mark(e),window.performance.measure("".concat(this.event.eventName),this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",(0,n.A)({category:this.markers.cancel},e),t),this.event=void 0}reportEvent(e,t,r){if(!this.event)return;if(!this.emitLogs)return;const o=(0,n.A)((0,n.A)({},this.event),t);o.eventName="".concat(o.eventName,"_").concat(e),"start"!==e&&(o.duration=this.duration),this.logger.sendPerformanceEvent(o,r)}static shouldReport(e,t){var r;const o=".".concat(e.category,".").concat(e.eventName),n=null!==(r=m.eventHits.get(o))&&void 0!==r?r:0;return m.eventHits.set(o,n>=t?1:n+1),n%t===0}}function v(e){return(0,d.qp)(e)?{value:y(e.value),tag:e.tag}:y(e)}function y(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return console.error("convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ".concat(typeof e,")")),"INVALID PROPERTY (typed as ".concat(typeof e,")")}}m.eventHits=new Map;const b=e=>((e,t)=>Object.entries(t).filter(e=>void 0!==e[1]).reduce((t,r)=>{const[o,n]=r;return t[o]="function"===typeof n?()=>({tag:e,value:n()}):{tag:e,value:n},t},{}))(u.CodeArtifact,e)},50349:(e,t,r)=>{"use strict";r.d(t,{Mh:()=>y,jC:()=>m,Cu:()=>v});var o=r(68194);const n="https://my.microsoftpersonalcontent.com",i="https://1drv.ms",s="1",a="fluid",c="s",d="d",l="f",u="c",h="a",g="p",p="v",f="x";const m="nav";function v(e,t){const r=function(e){const t=new URL(e.siteUrl),r=encodeURIComponent(t.pathname),n=encodeURIComponent(e.driveId),i=encodeURIComponent(e.itemId),m=encodeURIComponent(e.dataStorePath);let v="".concat(c,"=").concat(r,"&").concat(d,"=").concat(n,"&").concat(l,"=").concat(i,"&").concat(u,"=").concat(m,"&").concat(a,"=").concat(s);return e.appName&&(v+="&".concat(h,"=").concat(encodeURIComponent(e.appName))),e.containerPackageName&&(v+="&".concat(g,"=").concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(v+="&".concat(p,"=").concat(encodeURIComponent(e.fileVersion))),e.context&&(v+="&".concat(f,"=").concat(encodeURIComponent(e.context))),(0,o.O0)(v)}(t);e.searchParams.set(m,r)}function y(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.searchParams.get(m);if(!r)return;return function(e,t){var r,n,i,s;let m=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const v=new URLSearchParams((0,o.AH)(e)),y=v.get(a);if(m&&"1"!==y)return;const b=v.get(c),S=v.get(d),C=v.get(l),k=v.get(u),w=null!==(r=v.get(h))&&void 0!==r?r:void 0,P=null!==(n=v.get(g))&&void 0!==n?n:void 0,T=null!==(i=v.get(p))&&void 0!==i?i:void 0,E=null!==(s=v.get(f))&&void 0!==s?s:void 0;if(!b||!S||!C||null===k)return;let I;try{I=new URL(b,t)}catch(N){}return I?{siteUrl:I.href,driveId:S,itemId:C,dataStorePath:k,appName:w,containerPackageName:P,fileVersion:T,context:E}:void 0}(r,e.origin.toLowerCase()===i?n:e.origin,t)}},50406:(e,t,r)=>{"use strict";r.d(t,{GV:()=>b,di:()=>v,EY:()=>y});var o=r(56851),n=r(12283),i={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?i[e]?(t.ariaTenantToken&&(i[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(i[e].dnmToken=t.dnmToken)):i[e]=t:(0,n.wC)(0,0,function(){return"Namespace: ".concat(e)})}function a(e,t){for(var r=e.length;r>0;){var o=e.substr(0,r);if(i[o]){var n=i[o];return t.ariaTenantToken=n.ariaTenantToken,t.dnmToken=n.dnmToken,!0}r=e.lastIndexOf(".",r-1)}return!1}var c=9007199254740991,d=-c,l=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,u=/^[a-zA-Z0-9_\.]{1,95}$/;function h(e){(function(e){if(!e||e.length>98)return!1;return l.test(e)})(e.eventName)||f("eventName",e.eventName,l,98);var t=e.eventContract;t&&(t.name&&!g(t.name)&&f("eventContract",t.name,u),p(t.dataFields)),p(e.dataFields)}function g(e){return u.test(e)}function p(e){e&&e.forEach(function(e){"string"===typeof e.name&&g(e.name)||f("dataField name",e.name,u),2===e.dataType&&function(e){if("number"!==typeof e||!isFinite(e)||Math.floor(e)!==e||e<d||e>c)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)})}function f(e,t,r,o){throw new Error("Invalid ".concat(e," '").concat(t,"' as it does not match regex ").concat(r)+(o?" or exceeds ".concat(o," chars"):""))}var m=r(90589),v=-1;function y(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,o.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var b=function(){function e(t,r,n){var i,s,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},this.instanceId=++e.instanceCounter,t&&(this.telemetrySinks=t.telemetrySinks,(i=this.persistentDataFields).push.apply(i,t.persistentDataFields),this.config=(0,o.__assign)((0,o.__assign)({},t.getConfig()),this.config),(s=this.partAFields).push.apply(s,t.partAFields)),r&&(a=this.persistentDataFields).push.apply(a,r)}return e.prototype.addEventContentType=function(e,t){e.push((0,m.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=y(e),r=t.telemetryProperties;r.nexusTenantToken=v;var o=r.ariaTenantToken;if(!o&&(!a(t.eventName,r)&&!o))return void(0,n.wC)(0,0,function(){return"No tenant token: "+e.eventName});this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var r=y(e);this.sendTelemetryEventInternal(r,t)},e.prototype.sendCustomerContent=function(e){var t=y(e),r=t.telemetryProperties,o=r.customerContentVersion;return(!o||o>2)&&(r.customerContentVersion=2),r.ariaTenantToken=void 0,r.nexusTenantToken=void 0,r.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=y(e),r=t.telemetryProperties;if(!r.dnmToken&&(!a(t.eventName,r)&&!r.dnmToken))return void(0,n.wC)(0,0,function(){return"No dnm token: "+t.eventName});this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,n.wC)(1,0,function(){return"No telemetry sinks are attached."}));this.processTelemetryEvent(e,t)}catch(r){return void(0,n.vV)(0,"SendTelemetryEvent",r)}this.telemetrySinks.forEach(function(r){try{3===t||2===t?r.sendNonStandardEvent&&r.sendNonStandardEvent(e,t):r.sendTelemetryEvent(e)}catch(o){}})}else(0,n.wC)(0,0,function(){return"Customer content"})},e.prototype.processTelemetryEvent=function(e,t){var r,o,n;if(e.dataFields&&(null===(n=e.dataFields)||void 0===n||n.unshift((0,m.m9)("OTelJS.Version","4.23.1146")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(o=i.dataFields).push.apply(o,this.partAFields),e.eventContract=i}this.config.disableValidation||h(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,r=e;t<r.length;t++){var o=r[t],n=o[0],i=o[1];this.sendTelemetryEventInternal(n,i)}},e.prototype.setTenantToken=function(e,t,r){s(e,{ariaTenantToken:t,nexusTenantToken:r})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return y(e)},e.prototype.getConfig=function(){return this.config},e.instanceCounter=0,e}()},51238:(e,t,r)=>{"use strict";var o;r.d(t,{A:()=>u});var n=new Uint8Array(16);function i(){if(!o&&!(o="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(n)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=function(e){return"string"===typeof e&&s.test(e)};for(var c=[],d=0;d<256;++d)c.push((d+256).toString(16).substr(1));const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(r))throw TypeError("Stringified UUID is invalid");return r};const u=function(e,t,r){var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=o[n];return t}return l(o)}},51309:(e,t,r)=>{"use strict";r.d(t,{w:()=>s});var o=r(45799),n=r(39430);const i="--";function s(e){const t=e?(0,n.P)(e):void 0,r=(0,o.a)({10:"#29130b",20:"#4d2415",30:"#792000",40:"#99482b",50:"#a52c00",60:"#c33400",70:"#e06a3f",80:"#d83b01",90:"#dd4f1b",100:"#fe7948",110:"#ff865a",120:"#ff9973",130:"#e8825d",140:"#ffb498",150:"#f4beaa",160:"#f9dcd1"}),s=(e,t)=>{const o=function(e){if(e.startsWith(i)){const t=e.replace(i,"");return"".concat(t.charAt(0).toLowerCase()).concat(t.substring(1))}return e}(e);o&&r.hasOwnProperty(o)&&(r[o]=t)};if(t)for(const o of t)s(o.name,o.value);return r}},51492:(e,t,r)=>{"use strict";r.d(t,{LM:()=>d,MO:()=>m,PA:()=>n.PA,WM:()=>u,Xe:()=>v,dK:()=>S,eH:()=>n.eH,g_:()=>y,lb:()=>f,n_:()=>n.n_,qF:()=>b,tT:()=>g,u:()=>h,x$:()=>n.x$,xB:()=>p,y:()=>c});var o=r(69235),n=r(91947),i=r(6971);let s,a,c,d,l,u,h=function(e){return e.OEP="OEP",e.Word="Word",e}({});async function g(){return s||(s=(0,n.x$)(h.OEP,"FluidHost.IsCardLoopCdnCodeLoaderEnabled")),s}async function p(){return a||(a=(0,n.PA)(h.OEP,"FluidHost.DelayWaitForDriveAndPath")),a}async function f(){return c||(c=(0,n.PA)(h.OEP,"ChangeGate.FluidHost.isAppThemeBrandingEnabled")),c}async function m(){return d||(d=(0,n.PA)(h.OEP,"ChangeGate.FluidHost.isSetReadOnlyEnabled")),d}async function v(){return l||(l=(0,n.PA)(h.Word,"FluidOutlook.InvokeBot")),l}async function y(){return u||(u=(0,n.PA)(h.OEP,"ChangeGate.FluidHost.isDisableV8ThemingEnabled")),u}async function b(){var e;const t=await(0,i.E)();return null!==(e=null===t||void 0===t?void 0:t.useGenericLoader)&&void 0!==e&&e}function S(e,t){if(!t||t.startsWith(".")||t.endsWith(".")||t.startsWith("Microsoft.Office."))throw new o.uV("The feature name is not valid.");return"Microsoft.Office.".concat(e,".").concat(t)}},51497:(e,t,r)=>{"use strict";r.d(t,{Ul:()=>s,cc:()=>i,yd:()=>n});var o=r(43483);const n={red:o.wv,green:o.wL,darkOrange:o.je,yellow:o.D9,berry:o.pT,lightGreen:o.EM,marigold:o.KK},i={darkRed:o.ik,cranberry:o.jF,pumpkin:o.Vv,peach:o.WB,gold:o.bK,brass:o.YA,brown:o.Xk,forest:o.CE,seafoam:o.$T,darkGreen:o.AV,lightTeal:o.JW,teal:o.$S,steel:o.s$,blue:o.z1,royalBlue:o.Os,cornflower:o.um,navy:o.Z,lavender:o.Us,purple:o.Zp,grape:o.QH,lilac:o.qn,pink:o.Vu,magenta:o.GC,plum:o.t1,beige:o.Zz,mink:o.QJ,platinum:o.X1,anchor:o.Y3},s={cranberry:o.jF,green:o.wL,orange:o.T_}},51655:(e,t,r)=>{"use strict";r.d(t,{q:()=>i});var o=r(69235),n=r(26140);class i{constructor(){this.startTime=void 0,this.stopTime=void 0,this.isSuccess=!1,this.error=void 0}measure(e){try{this.start();const t=e();return this.setSuccess(),t}catch(t){throw this.setFailure(t),t}}start(e){if(this.startTime)throw new o.uV("PerfTracker.start() called when already started.");this.startTime=e||i.getTimePoint()}stop(){const e=i.getTimePoint();if(!this.stopTime){if(!this.startTime)throw new o.uV("PerTracker.stop() called when not started.");this.stopTime=e}}static getTimePoint(){return 1e3*(0,n.F)()}getDuration(){if(this.startTime){const e=(this.stopTime||i.getTimePoint())-this.startTime;return Math.floor(e)}return 0}getDurationInSeconds(){return this.getDuration()/1e6}setSuccess(){this.stop(),this.isSuccess=!0}setFailure(e){this.stop(),this.isSuccess=!1,this.error=e}static startNew(e){const t=new i;return t.start(e),t}}},52059:(e,t,r)=>{"use strict";r.d(t,{$A:()=>i,CS:()=>a,JL:()=>o,ZV:()=>n,gE:()=>s});const o="@ms/planner-loop",n="Planner",i=300,s={policyId:"L_Loop_Planner",valueName:"LoopPlanner",registryDataType:"REG_DWORD",regKeyFullPath:"software\\policies\\microsoft\\office\\16.0\\common\\loop"},a="Production"},52389:(e,t,r)=>{"use strict";r.d(t,{EI:()=>w,qt:()=>v,su:()=>m,jw:()=>y,ym:()=>b,eK:()=>S});var o=r(27051),n=r(26631),i=r(2875),s=r(77565),a=r(15217),c=r(27750),d=r(97423);class l{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"utf-8";this.path=e,this.mode=d.S.File,this.type=d.$.Blob,this.value={contents:t,encoding:r}}}class u{constructor(e,t){this.path=e,this.value=t,this.mode=d.S.Directory,this.type=d.$.Tree}}class h{constructor(e,t){this.path=e,this.id=t,this.mode=d.S.File,this.type=d.$.Attachment,this.value={id:t}}}var g=r(7428);function p(){const e={treeNodeCount:0,blobNodeCount:0,handleNodeCount:0,totalBlobSize:0,unreferencedBlobSize:0};for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];for(const n of r)e.treeNodeCount+=n.treeNodeCount,e.blobNodeCount+=n.blobNodeCount,e.handleNodeCount+=n.handleNodeCount,e.totalBlobSize+=n.totalBlobSize,e.unreferencedBlobSize+=n.unreferencedBlobSize;return e}function f(e){return"string"===typeof e?function(e){let t=e.length;for(let r=e.length-1;r>=0;r--){const o=e.charCodeAt(r);o>127&&o<=2047?t++:o>2047&&o<=65535&&(t+=2),o>=56320&&o<=57343&&r--}return t}(e):e.byteLength}function m(e,t,r){const o={type:c.Z.Blob,content:r};e.summary.tree[t]=o,e.stats.blobNodeCount++,e.stats.totalBlobSize+=f(r)}class v{get summary(){const e={type:c.Z.Tree,tree:(0,o.A)({},this.summaryTree)};return void 0!==this.groupId&&(e.groupId=this.groupId),e}get stats(){return(0,o.A)({},this.summaryStats)}constructor(e){this.attachmentCounter=0,this.summaryTree={},this.summaryStats=p(),this.summaryStats.treeNodeCount++,this.groupId=null===e||void 0===e?void 0:e.groupId}addBlob(e,t){m({summary:{type:c.Z.Tree,tree:this.summaryTree},stats:this.summaryStats},e,t)}addHandle(e,t,r){this.summaryTree[e]={type:c.Z.Handle,handleType:t,handle:r},this.summaryStats.handleNodeCount++}addWithStats(e,t){this.summaryTree[e]=t.summary,this.summaryStats=p(this.summaryStats,t.stats)}addAttachment(e){this.summaryTree[this.attachmentCounter++]={id:e,type:c.Z.Attachment}}getSummaryTree(){return{summary:this.summary,stats:this.stats}}}function y(e){const t=new v;for(const[o,s]of Object.entries(e.blobs)){let r;if(void 0!==e.blobsContents){const t=e.blobsContents[s];void 0!==t&&(r=(0,n.JR)(t,"utf-8"))}else void 0!==e.blobs[s]&&(r=(0,i.AH)(e.blobs[s]));void 0!==r&&t.addBlob(o,r)}for(const[o,n]of Object.entries(e.trees)){const e=y(n);t.addWithStats(o,e)}const r=t.getSummaryTree();return r.summary.unreferenced=e.unreferenced,r.summary.groupId=e.groupId,r}function b(e){const t=[];for(const[r,o]of Object.entries(e.tree))switch(o.type){case c.Z.Blob:{let e,i="utf-8";"string"===typeof o.content?e=o.content:(e=(0,n.Km)(o.content,"base64"),i="base64"),t.push(new l(r,e,i));break}case c.Z.Tree:t.push(new u(r,b(o)));break;case c.Z.Attachment:t.push(new h(r,o.id));break;case c.Z.Handle:throw new Error("Should not have Handle type in summary tree");default:(0,s.$)(o,"Unexpected summary tree type")}return{entries:t,unreferenced:e.unreferenced,groupId:e.groupId}}function S(e,t){const r=null===e||void 0===e?void 0:e.entries.find(e=>e.path===g.xX);if(void 0===r)return!1;(0,a.vA)(r.type===d.$.Blob&&"utf-8"===r.value.encoding,2303);const o=JSON.parse(r.value.contents);for(const[n,i]of Object.entries(o.gcNodes))i.forEach(e=>{t(n,e)});return!0}function C(e){return e.replace(/^\/+/g,"")}function k(e){return e.replace(/\/+$/g,"")}class w{constructor(){this.gcNodesSet={}}get gcNodes(){const e={};for(const[t,r]of Object.entries(this.gcNodesSet))e[t]=[...r];return e}addNode(e,t){this.gcNodesSet[e]=new Set(t)}prefixAndAddNodes(e,t){for(const[r,o]of Object.entries(t)){let t=C(r);t="/".concat(e,"/").concat(t),t=k(t),this.gcNodesSet[t]=new Set(o)}}addNodes(e){for(const[t,r]of Object.entries(e))this.gcNodesSet[t]=new Set(r)}addRouteToAllNodes(e){for(const t of Object.values(this.gcNodesSet))t.add(e)}getGCData(){return{gcNodes:this.gcNodes}}}},52563:(e,t,r)=>{"use strict";r.d(t,{Zd:()=>a,q:()=>i,rv:()=>c});const o={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},n={af:o.afZa,am:o.amEt,ar:o.arSa,as:o.asIn,az:o.azLatnAz,bg:o.bgBg,bn:o.enGb,bs:o.bsLatnBa,"bs-cyrl-ba":o.enGb,ca:o.caEs,cs:o.csCz,cy:o.cyGb,da:o.daDk,de:o.deDe,el:o.elGr,"el-cy":o.enGb,en:o.enUs,es:o.esEs,et:o.etEe,eu:o.euEs,fa:o.faIr,fi:o.fiFi,fil:o.filPh,fr:o.frFr,ga:o.gaIe,gd:o.gdGb,gl:o.glEs,gu:o.guIn,he:o.heIl,hi:o.hiIn,hr:o.hrHr,hu:o.huHu,hy:o.hyAm,id:o.idId,is:o.isIs,it:o.itIt,iw:o.heIl,"iw-il":o.heIl,ja:o.jaJp,ka:o.kaGe,kk:o.kkKz,km:o.kmKh,kn:o.knIn,ko:o.koKr,kok:o.kokIn,lb:o.lbLu,lo:o.loLa,lt:o.ltLt,lv:o.lvLv,mi:o.miNz,mk:o.mkMk,ml:o.mlIn,mr:o.mrIn,ms:o.msMy,mt:o.mtMt,nb:o.nbNo,ne:o.neNp,nl:o.nlNl,nn:o.nnNo,or:o.orIn,pa:o.paIn,pl:o.plPl,pt:o.ptBr,quz:o.quzPe,ro:o.roRo,ru:o.ruRu,sk:o.skSk,sl:o.slSi,sq:o.sqAl,sv:o.svSe,ta:o.taIn,te:o.teIn,th:o.thTh,tr:o.trTr,"tr-cy":o.enGb,tt:o.ttRu,ug:o.ugCn,uk:o.ukUa,ur:o.urPk,uz:o.enUs,vi:o.viVn,zh:o.enUs,"zh-hans-tw":o.zhTw},i=o.enUs,s=/^([^-]+)-.+/;function a(e){if(void 0===e||null===e)return!1;const t=e.toLowerCase();return Object.values(o).includes(t)||void 0!==n[t]}function c(e){if(void 0===e||null===e)return i;const t=e.toLowerCase();if(Object.values(o).includes(t))return t;const r=n[t];if(void 0!==r)return r;const a=function(e){const t=s.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1];return}(t);if(void 0!==a){const e=n[a];if(void 0!==e)return e}return i}},52841:(e,t,r)=>{"use strict";let o,n;r.d(t,{Ar:()=>i,RY:()=>s});try{localStorage.getItem("__storage_test__"),o=localStorage}catch(a){o=void 0}try{sessionStorage.getItem("__storage_test__"),n=sessionStorage}catch(c){n=void 0}function i(){return o}function s(){return n}},53316:e=>{"use strict";function t(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function r(e,t){for(var r,o="",n=0,i=-1,s=0,a=0;a<=e.length;++a){if(a<e.length)r=e.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(i===a-1||1===s);else if(i!==a-1&&2===s){if(o.length<2||2!==n||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){var c=o.lastIndexOf("/");if(c!==o.length-1){-1===c?(o="",n=0):n=(o=o.slice(0,c)).length-1-o.lastIndexOf("/"),i=a,s=0;continue}}else if(2===o.length||1===o.length){o="",n=0,i=a,s=0;continue}t&&(o.length>0?o+="/..":o="..",n=2)}else o.length>0?o+="/"+e.slice(i+1,a):o=e.slice(i+1,a),n=a-i-1;i=a,s=0}else 46===r&&-1!==s?++s:s=-1}return o}var o={resolve:function(){for(var e,o="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var s;i>=0?s=arguments[i]:(void 0===e&&(e=process.cwd()),s=e),t(s),0!==s.length&&(o=s+"/"+o,n=47===s.charCodeAt(0))}return o=r(o,!n),n?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(e){if(t(e),0===e.length)return".";var o=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=r(e,!o)).length||o||(e="."),e.length>0&&n&&(e+="/"),o?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,r=0;r<arguments.length;++r){var n=arguments[r];t(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":o.normalize(e)},relative:function(e,r){if(t(e),t(r),e===r)return"";if((e=o.resolve(e))===(r=o.resolve(r)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var i=e.length,s=i-n,a=1;a<r.length&&47===r.charCodeAt(a);++a);for(var c=r.length-a,d=s<c?s:c,l=-1,u=0;u<=d;++u){if(u===d){if(c>d){if(47===r.charCodeAt(a+u))return r.slice(a+u+1);if(0===u)return r.slice(a+u)}else s>d&&(47===e.charCodeAt(n+u)?l=u:0===u&&(l=0));break}var h=e.charCodeAt(n+u);if(h!==r.charCodeAt(a+u))break;47===h&&(l=u)}var g="";for(u=n+l+1;u<=i;++u)u!==i&&47!==e.charCodeAt(u)||(0===g.length?g+="..":g+="/..");return g.length>0?g+r.slice(a+l):(a+=l,47===r.charCodeAt(a)&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var r=e.charCodeAt(0),o=47===r,n=-1,i=!0,s=e.length-1;s>=1;--s)if(47===(r=e.charCodeAt(s))){if(!i){n=s;break}}else i=!1;return-1===n?o?"/":".":o&&1===n?"//":e.slice(0,n)},basename:function(e,r){if(void 0!==r&&"string"!==typeof r)throw new TypeError('"ext" argument must be a string');t(e);var o,n=0,i=-1,s=!0;if(void 0!==r&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var a=r.length-1,c=-1;for(o=e.length-1;o>=0;--o){var d=e.charCodeAt(o);if(47===d){if(!s){n=o+1;break}}else-1===c&&(s=!1,c=o+1),a>=0&&(d===r.charCodeAt(a)?-1===--a&&(i=o):(a=-1,i=c))}return n===i?i=c:-1===i&&(i=e.length),e.slice(n,i)}for(o=e.length-1;o>=0;--o)if(47===e.charCodeAt(o)){if(!s){n=o+1;break}}else-1===i&&(s=!1,i=o+1);return-1===i?"":e.slice(n,i)},extname:function(e){t(e);for(var r=-1,o=0,n=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(47!==c)-1===n&&(i=!1,n=a+1),46===c?-1===r?r=a:1!==s&&(s=1):-1!==r&&(s=-1);else if(!i){o=a+1;break}}return-1===r||-1===n||0===s||1===s&&r===n-1&&r===o+1?"":e.slice(r,n)},format:function(e){if(null===e||"object"!==typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var r=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+o:r+e+o:o}("/",e)},parse:function(e){t(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var o,n=e.charCodeAt(0),i=47===n;i?(r.root="/",o=1):o=0;for(var s=-1,a=0,c=-1,d=!0,l=e.length-1,u=0;l>=o;--l)if(47!==(n=e.charCodeAt(l)))-1===c&&(d=!1,c=l+1),46===n?-1===s?s=l:1!==u&&(u=1):-1!==s&&(u=-1);else if(!d){a=l+1;break}return-1===s||-1===c||0===u||1===u&&s===c-1&&s===a+1?-1!==c&&(r.base=r.name=0===a&&i?e.slice(1,c):e.slice(a,c)):(0===a&&i?(r.name=e.slice(1,s),r.base=e.slice(1,c)):(r.name=e.slice(a,s),r.base=e.slice(a,c)),r.ext=e.slice(s,c)),a>0?r.dir=e.slice(0,a-1):i&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};o.posix=o,e.exports=o},53450:(e,t,r)=>{"use strict";r.d(t,{r:()=>a});var o=r(37450),n=r(90589),i=r(58443),s=r(82645);class a{constructor(e,t){this.activity=void 0,this.activity=s.u.createActivity({eventName:"Office.Extensibility.Fluid.HostWebApp."+e,eventFlags:{dataCategories:o.o.DataCategories.ProductServiceUsage,diagnosticLevel:o.o.DiagnosticLevel.FullEvent}}),this.addStringDataField("HydrateId",t)}async endActivity(e,t,r){this.activity&&(await this.addDataFieldsToActivity(t,r),this.activity.success=e,this.activity.setResult(t),i.KV&&this.activity.endNow())}addInt64DataField(e,t){var r;const o=(0,n.Ug)(e,Math.floor(t));this.activity&&(null!==(r=this.activity)&&void 0!==r&&r.dataFields?this.activity.dataFields.push(o):this.activity.dataFields=[o])}addStringDataField(e,t){const r=(0,n.m9)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}addBooleanDataField(e,t){const r=(0,n.LK)(e,t);this.activity&&(this.activity.dataFields?this.activity.dataFields.push(r):this.activity.dataFields=[r])}}},53783:(e,t,r)=>{"use strict";r.d(t,{Ej:()=>i,ZY:()=>o,qb:()=>n,vU:()=>s});var o=function(e){return e.IframeLoadFailed="IframeLoadFailed",e.ContainerUpgradeRequired="ContainerUpgradeRequired",e.ComponentNotFound="ComponentNotFound",e}({}),n=function(e){return e.RootComponentCreateFailed="RootComponentCreateFailed",e.RaasNotSupported="RaasNotSupported",e}({});class i extends Error{constructor(e,t,r,o){if(super(e),this.internalError=r,this.name=t,o)try{this.stack=o}catch(n){}}}class s extends i{constructor(e,t,r,o){super(e,"ComponentNotFound",t,o),this.code=r}}},53815:(e,t,r)=>{"use strict";var o,n,i,s,a;r.d(t,{BO:()=>s,Dn:()=>o,bi:()=>n,fF:()=>a,s:()=>i}),function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(o||(o={})),function(e){e.Arabic="'".concat(o.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(o.Cyrillic,"'"),e.EastEuropean="'".concat(o.EastEuropean,"'"),e.Greek="'".concat(o.Greek,"'"),e.Hebrew="'".concat(o.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(o.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(o.Vietnamese,"'"),e.WestEuropean="'".concat(o.WestEuropean,"'"),e.Armenian="'".concat(o.Armenian,"'"),e.Georgian="'".concat(o.Georgian,"'")}(n||(n={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(i||(i={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(s||(s={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(a||(a={}))},53986:(e,t,r)=>{"use strict";function o(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;r[o]=e[o]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}r.d(t,{A:()=>o})},54733:(e,t,r)=>{"use strict";r.d(t,{n:()=>y,S:()=>b});var o,n=r(36294),i=r(15217),s=r(96516),a=r(86748),c=r(52389),d=r(77565),l=r(11502),u=r(55651);function h(e){return void 0!==e&&"number"===typeof e.pendingMessageId&&("add"===e.type||"edit"===e.type)}function g(e){return void 0!==e&&"clear"===e.type&&"number"===typeof e.pendingMessageId}class p{get size(){return this.data.size}constructor(e,t,r,o,n){this.serializer=e,this.handle=t,this.submitMessage=r,this.isAttached=o,this.eventEmitter=n,this.messageHandlers=new Map,this.data=new Map,this.pendingKeys=new Map,this.nextPendingMessageId=0,this.pendingClearMessageIds=[],this.messageHandlers=this.getMessageHandlers()}keys(){return this.data.keys()}entries(){const e=this.data.entries();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:[t.value[0],t.value[1].value],done:!1}},[Symbol.iterator](){return this}}}values(){const e=this.data.values();return{next(){const t=e.next();return t.done?{value:void 0,done:!0}:{value:t.value.value,done:!1}},[Symbol.iterator](){return this}}}[Symbol.iterator](){return this.entries()}forEach(e){this.data.forEach((t,r,o)=>{e(t.value,r,o)})}get(e){const t=this.data.get(e);return void 0===t?void 0:t.value}has(e){return this.data.has(e)}set(e,t){if(void 0===e||null===e)throw new Error("Undefined and null keys are not supported");const r=this.setCore(e,{value:t},!0);if(!this.isAttached())return;const o={key:e,type:"set",value:{type:l.e[l.e.Plain],value:t}};this.submitMapKeyMessage(o,r)}delete(e){const t=this.deleteCore(e,!0);if(!this.isAttached())return void 0!==t;const r={key:e,type:"delete"};return this.submitMapKeyMessage(r,t),void 0!==t}clear(){const e=this.isAttached()?new Map(this.data):void 0;if(this.clearCore(!0),this.pendingKeys.clear(),!this.isAttached())return;this.submitMapClearMessage({type:"clear"},e)}getSerializedStorage(e){const t={};for(const[r,o]of this.data.entries())t[r]=(0,u.Q)(o.value,e,this.handle);return t}populateFromSerializable(e){for(const[t,r]of Object.entries(this.serializer.decode(e)))(0,u.R)(r,this.serializer,this.handle),this.data.set(t,{value:r.value})}trySubmitMessage(e,t){const r=this.messageHandlers.get(e.type);return void 0!==r&&(r.submit(e,t),!0)}tryApplyStashedOp(e){switch(e.type){case"clear":this.clear();break;case"delete":this.delete(e.key);break;case"set":(0,u.R)(e.value,this.serializer,this.handle),this.set(e.key,e.value.value);break;default:(0,d.$)(e)}}tryProcessMessage(e,t,r){const o=this.messageHandlers.get(e.type);return void 0!==o&&(o.process(e,t,r),!0)}rollback(e,t){if(void 0===(r=t)||"number"!==typeof r.pendingMessageId||"add"!==r.type&&"edit"!==r.type&&"clear"!==r.type)throw new Error("Invalid localOpMetadata");var r;if("clear"===e.type&&"clear"===t.type){if(void 0===t.previousMap)throw new Error("Cannot rollback without previous map");for(const[r,o]of t.previousMap.entries())this.setCore(r,o,!0);const e=this.pendingClearMessageIds.pop();if(void 0===e||e!==t.pendingMessageId)throw new Error("Rollback op does match last clear")}else{if("delete"!==e.type&&"set"!==e.type)throw new Error("Unsupported op for rollback");{if("add"===t.type)this.deleteCore(e.key,!0);else{if("edit"!==t.type||void 0===t.previousValue)throw new Error("Cannot rollback without previous value");this.setCore(e.key,t.previousValue,!0)}const r=this.pendingKeys.get(e.key),o=null===r||void 0===r?void 0:r.pop();if(!r||o!==t.pendingMessageId)throw new Error("Rollback op does not match last pending");0===r.length&&this.pendingKeys.delete(e.key)}}}setCore(e,t,r){const o=this.data.get(e),n=null===o||void 0===o?void 0:o.value;return this.data.set(e,t),this.eventEmitter.emit("valueChanged",{key:e,previousValue:n},r,this.eventEmitter),o}clearCore(e){this.data.clear(),this.eventEmitter.emit("clear",e,this.eventEmitter)}deleteCore(e,t){const r=this.data.get(e),o=null===r||void 0===r?void 0:r.value;return this.data.delete(e)&&this.eventEmitter.emit("valueChanged",{key:e,previousValue:o},t,this.eventEmitter),r}clearExceptPendingKeys(){const e=new Map;for(const t of this.pendingKeys.keys())this.data.has(t)&&e.set(t,this.data.get(t));this.clearCore(!1);for(const[t,r]of e.entries())this.setCore(t,r,!0)}needProcessKeyOperation(e,t,r){if(void 0!==this.pendingClearMessageIds[0])return t&&(0,i.vA)(void 0!==r&&h(r)&&r.pendingMessageId<this.pendingClearMessageIds[0],19),!1;const o=this.pendingKeys.get(e.key);return void 0!==o?(t&&((0,i.vA)(void 0!==r&&h(r),20),(0,i.vA)(o[0]===r.pendingMessageId,762),o.shift(),0===o.length&&this.pendingKeys.delete(e.key)),!1):!t}getMessageHandlers(){const e=new Map;return e.set("clear",{process:(e,t,r)=>{if(t){(0,i.vA)(g(r),21);const e=this.pendingClearMessageIds.shift();return void(0,i.vA)(e===r.pendingMessageId,763)}this.pendingKeys.size>0?this.clearExceptPendingKeys():this.clearCore(t)},submit:(e,t)=>{(0,i.vA)(g(t),764);const r=this.pendingClearMessageIds.shift();(0,i.vA)(r===t.pendingMessageId,765),this.submitMapClearMessage(e,t.previousMap)}}),e.set("delete",{process:(e,t,r)=>{this.needProcessKeyOperation(e,t,r)&&this.deleteCore(e.key,t)},submit:(e,t)=>{this.resubmitMapKeyMessage(e,t)}}),e.set("set",{process:(e,t,r)=>{this.needProcessKeyOperation(e,t,r)&&((0,u.R)(e.value,this.serializer,this.handle),this.setCore(e.key,{value:e.value.value},t))},submit:(e,t)=>{this.resubmitMapKeyMessage(e,t)}}),e}getMapClearMessageId(){const e=this.nextPendingMessageId++;return this.pendingClearMessageIds.push(e),e}submitMapClearMessage(e,t){const r=function(e,t,r){return{type:"clear",pendingMessageId:t,previousMap:r}}(0,this.getMapClearMessageId(),t);this.submitMessage(e,r)}getMapKeyMessageId(e){const t=this.nextPendingMessageId++,r=this.pendingKeys.get(e.key);return void 0===r?this.pendingKeys.set(e.key,[t]):r.push(t),t}submitMapKeyMessage(e,t){const r=function(e,t,r){return r?{type:"edit",pendingMessageId:t,previousValue:r}:{type:"add",pendingMessageId:t}}(0,this.getMapKeyMessageId(e),t);this.submitMessage(e,r)}resubmitMapKeyMessage(e,t){(0,i.vA)(h(t),766);const r=this.pendingKeys.get(e.key);if(void 0===r)return;const o=r.indexOf(t.pendingMessageId);if(-1===o)return;r.splice(o,1),0===r.length&&this.pendingKeys.delete(e.key);const n=this.getMapKeyMessageId(e),s="edit"===t.type?{type:"edit",pendingMessageId:n,previousValue:t.previousValue}:{type:"add",pendingMessageId:n};this.submitMessage(e,s)}}const f="header";class m extends n.T6{constructor(e,t,r){super(e,t,r,"fluid_map_"),this[o]="SharedMap",this.kernel=new p(this.serializer,this.handle,(e,t)=>this.submitLocalMessage(e,t),()=>this.isAttached(),this)}keys(){return this.kernel.keys()}entries(){return this.kernel.entries()}values(){return this.kernel.values()}[(o=Symbol.toStringTag,Symbol.iterator)](){return this.kernel.entries()}get size(){return this.kernel.size}forEach(e){this.kernel.forEach(e)}get(e){return this.kernel.get(e)}has(e){return this.kernel.has(e)}set(e,t){return this.kernel.set(e,t),this}delete(e){return this.kernel.delete(e)}clear(){this.kernel.clear()}summarizeCore(e,t){let r=0,o=0,n={};const i=[],s=new c.qt,a=this.kernel.getSerializedStorage(e);for(const[c,l]of Object.entries(a))if(l.value&&l.value.length>=8192){const e="blob".concat(o);o++,i.push(e);const t={[c]:{type:l.type,value:JSON.parse(l.value)}};s.addBlob(e,JSON.stringify(t))}else{if(r+=l.type.length+21,l.value&&(r+=l.value.length),r>16384){const e="blob".concat(o);o++,i.push(e),s.addBlob(e,JSON.stringify(n)),n={},r=0}n[c]={type:l.type,value:void 0===l.value?void 0:JSON.parse(l.value)}}const d={blobs:i,content:n};return s.addBlob(f,JSON.stringify(d)),s.getSummaryTree()}async loadCore(e){const t=await(0,a.P)(e,f),r=t;if(Array.isArray(r.blobs)){this.kernel.populateFromSerializable(r.content);const t=await Promise.all(r.blobs.map(async t=>(0,a.P)(e,t)));for(const e of t)this.kernel.populateFromSerializable(e)}else this.kernel.populateFromSerializable(t)}onDisconnect(){}reSubmitCore(e,t){this.kernel.trySubmitMessage(e,t)}applyStashedOp(e){this.kernel.tryApplyStashedOp(e)}processCore(e,t,r){e.type===s.Go.Operation&&(0,i.vA)(this.kernel.tryProcessMessage(e.contents,t,r),2738)}rollback(e,t){this.kernel.rollback(e,t)}}var v=r(90876);class y{get type(){return y.Type}get attributes(){return y.Attributes}async load(e,t,r,o){const n=new m(t,e,o);return await n.load(r),n}create(e,t){const r=new m(t,e,y.Attributes);return r.initializeLocal(),r}}y.Type="https://graph.microsoft.com/types/map",y.Attributes={type:y.Type,snapshotFormatVersion:"0.2",packageVersion:v.z};const b=(0,n.Bm)(y)},54813:(e,t,r)=>{"use strict";r.d(t,{E9:()=>b,Gi:()=>m,OI:()=>p,Tj:()=>g,WA:()=>o,YU:()=>y,c_:()=>h,d8:()=>d,dw:()=>f,gb:()=>l,ix:()=>v,sc:()=>a,yi:()=>u});var o,n=r(27051),i=r(87804),s=r(39521);function a(){return"object"===typeof navigator&&null!==navigator&&"boolean"===typeof navigator.onLine?navigator.onLine?o.Online:o.Offline:o.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(o||(o={}));class c extends s.iq{constructor(e,t,r){super(e,r),this.canRetry=t,this.errorType=i.a.genericNetworkError}}class d extends s.iq{constructor(e,t){super(e,t),this.errorType=i.a.fluidInvalidSchema,this.canRetry=!1}}class l extends s.iq{constructor(e,t,r){super(e,(0,n.A)((0,n.A)({},t),{},{statusCode:400})),this.errorType=l.errorType,this.canRetry=!1,this.storageOnlyReason=r}}l.errorType=i.a.deltaStreamConnectionForbidden;class u extends s.iq{constructor(e,t,r,o){void 0!==t&&(o.claims=t),void 0!==r&&(o.tenantId=r),super(e,o,new Set(["claims","tenantId"])),this.errorType=i.a.authorizationError,this.canRetry=!1}}class h extends s.iq{constructor(e,t,r){super(e,r,new Set(["redirectUrl"])),this.redirectUrl=t,this.errorType=i.a.locationRedirection,this.canRetry=!1}}class g extends s.iq{constructor(e,t,r,o){super(e,o),this.errorType=t,this.canRetry=r}}class p extends g{constructor(e,t,r){super(e,t,!1,r),this.errorType=t}}class f extends g{constructor(e,t,r){super(e,t,!0,r),this.errorType=t}}class m extends s.iq{constructor(e,t,r){super(e,r),this.retryAfterSeconds=t,this.errorType=i.a.throttlingError,this.canRetry=!0}}function v(e,t,r){return void 0!==t.retryAfterMs&&t.canRetry?new m(e,t.retryAfterMs/1e3,r):new c(e,t.canRetry,r)}const y=e=>!0===(null===e||void 0===e?void 0:e.canRetry),b=e=>void 0!==(null===e||void 0===e?void 0:e.retryAfterSeconds)?1e3*e.retryAfterSeconds:void 0},55651:(e,t,r)=>{"use strict";r.d(t,{Q:()=>i,R:()=>s});var o=r(16026),n=r(11502);const i=(e,t,r)=>{const i=(0,o.KC)(e,t,r);return{type:n.e[n.e.Plain],value:i}},s=(e,t,r)=>{if(e.type===n.e[n.e.Shared]){e.type=n.e[n.e.Plain];const i={type:"__fluid_handle__",url:e.value};e.value=t.encode((0,o.Zb)(i,t),r)}}},56142:(e,t,r)=>{"use strict";r.d(t,{Rm:()=>a,sF:()=>i,vV:()=>s});var o=r(58443);let n;function i(e){n=o.yz||e}function s(e){!0===n&&console.error(e)}async function a(e){!0===n&&console.log(e)}},56851:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>x,__assign:()=>i,__asyncDelegator:()=>T,__asyncGenerator:()=>P,__asyncValues:()=>E,__await:()=>w,__awaiter:()=>p,__classPrivateFieldGet:()=>B,__classPrivateFieldIn:()=>O,__classPrivateFieldSet:()=>L,__createBinding:()=>m,__decorate:()=>a,__disposeResources:()=>R,__esDecorate:()=>d,__exportStar:()=>v,__extends:()=>n,__generator:()=>f,__importDefault:()=>D,__importStar:()=>F,__makeTemplateObject:()=>I,__metadata:()=>g,__param:()=>c,__propKey:()=>u,__read:()=>b,__rest:()=>s,__rewriteRelativeImportExtension:()=>_,__runInitializers:()=>l,__setFunctionName:()=>h,__spread:()=>S,__spreadArray:()=>k,__spreadArrays:()=>C,__values:()=>y,default:()=>H});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},i.apply(this,arguments)};function s(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function a(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function c(e,t){return function(r,o){t(r,o,e)}}function d(e,t,r,o,n,i){function s(e){if(void 0!==e&&"function"!==typeof e)throw new TypeError("Function expected");return e}for(var a,c=o.kind,d="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?o.static?e:e.prototype:null,u=t||(l?Object.getOwnPropertyDescriptor(l,o.name):{}),h=!1,g=r.length-1;g>=0;g--){var p={};for(var f in o)p[f]="access"===f?{}:o[f];for(var f in o.access)p.access[f]=o.access[f];p.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(e||null))};var m=(0,r[g])("accessor"===c?{get:u.get,set:u.set}:u[d],p);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!==typeof m)throw new TypeError("Object expected");(a=s(m.get))&&(u.get=a),(a=s(m.set))&&(u.set=a),(a=s(m.init))&&n.unshift(a)}else(a=s(m))&&("field"===c?n.unshift(a):u[d]=a)}l&&Object.defineProperty(l,o.name,u),h=!0}function l(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function u(e){return"symbol"===typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"===typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})}function f(e,t){var r,o,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var m=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function y(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)s.push(o.value)}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return s}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function C(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,n++)o[n]=i[s];return o}function k(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),i=[];return o=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,d)}}),o[Symbol.asyncIterator]=function(){return this},o;function s(e,t){n[e]&&(o[e]=function(t){return new Promise(function(r,o){i.push([e,t,r,o])>1||a(e,t)})},t&&(o[e]=t(o[e])))}function a(e,t){try{(r=n[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,d):l(i[0][2],r)}catch(o){l(i[0][3],o)}var r}function c(e){a("next",e)}function d(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function T(e){var t,r;return t={},o("next"),o("throw",function(e){throw e}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:w(e[o](t)),done:!1}:n?n(t):t}:n}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise(function(o,n){(function(e,t,r,o){Promise.resolve(o).then(function(t){e({value:t,done:r})},t)})(o,n,(t=e[r](t)).done,t.value)})}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},A=function(e){return A=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},A(e)};function F(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=A(e),o=0;o<r.length;o++)"default"!==r[o]&&m(t,e,r[o]);return N(t,e),t}function D(e){return e&&e.__esModule?e:{default:e}}function B(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function L(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function O(e,t){if(null===t||"object"!==typeof t&&"function"!==typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"===typeof e?t===e:e.has(t)}function x(e,t,r){if(null!==t&&void 0!==t){if("object"!==typeof t&&"function"!==typeof t)throw new TypeError("Object expected.");var o,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose],r&&(n=o)}if("function"!==typeof o)throw new TypeError("Object not disposable.");n&&(o=function(){try{n.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:o,async:r})}else r&&e.stack.push({async:!0});return t}var M="function"===typeof SuppressedError?SuppressedError:function(e,t,r){var o=new Error(r);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function R(e){function t(t){e.error=e.hasError?new M(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,o=0;return function n(){for(;r=e.stack.pop();)try{if(!r.async&&1===o)return o=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return o|=2,Promise.resolve(i).then(n,function(e){return t(e),n()})}else o|=1}catch(s){t(s)}if(1===o)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function _(e,t){return"string"===typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,o,n,i){return r?t?".jsx":".js":!o||n&&i?o+n+"."+i.toLowerCase()+"js":e}):e}const H={__extends:n,__assign:i,__rest:s,__decorate:a,__param:c,__esDecorate:d,__runInitializers:l,__propKey:u,__setFunctionName:h,__metadata:g,__awaiter:p,__generator:f,__createBinding:m,__exportStar:v,__values:y,__read:b,__spread:S,__spreadArrays:C,__spreadArray:k,__await:w,__asyncGenerator:P,__asyncDelegator:T,__asyncValues:E,__makeTemplateObject:I,__importStar:F,__importDefault:D,__classPrivateFieldGet:B,__classPrivateFieldSet:L,__classPrivateFieldIn:O,__addDisposableResource:x,__disposeResources:R,__rewriteRelativeImportExtension:_}},57471:(e,t,r)=>{"use strict";function o(e){let t="".concat(e.siteUrl,"?driveId=").concat(encodeURIComponent(e.driveId),"&itemId=").concat(encodeURIComponent(e.itemId),"&path=").concat(encodeURIComponent(e.dataStorePath));return e.containerPackageName&&(t+="&containerPackageName=".concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(t+="&fileVersion=".concat(encodeURIComponent(e.fileVersion))),t}r.d(t,{m:()=>o})},57833:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var o=r(85851);const n=(e,t,r)=>{let n,i;return{start:()=>{n=performance.now(),i=Date.now()},end:()=>{(0,o.F)(()=>{if(!n||!i)return;const o=performance.now(),s=Math.round(o-n),a={renderStage:e,startTime:i,durationMs:s,endTime:i+s,telemetryMetadataOverride:r};t.emit("onRenderStageComplete",a)},document.visibilityState)}}}},58358:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});var o=r(85038);function n(e){return(0,o.vA)(!!e,2358),{Authorization:e}}},58443:(e,t,r)=>{"use strict";r.d(t,{A2:()=>u,CZ:()=>S,Ct:()=>i,FT:()=>m,KV:()=>d,L0:()=>g,Nu:()=>l,R0:()=>a,UH:()=>p,a8:()=>b,bY:()=>s,g4:()=>n,l1:()=>h,pY:()=>y,s:()=>v,sz:()=>f,xu:()=>o,yz:()=>c});const o="fluidElement",n=".fluid",i=".loop",s="animatedSplashScreen",a="FluidHostWin32",c=!1,d=!0,l=!1,u=100,h="FormsLoop",g="fluidLink",p="componentPartHostingElementId",f=864e5,m=290,v=835,y=245,b="white solid 1px",S="black solid 1px"},58511:(e,t,r)=>{"use strict";r.d(t,{L:()=>o});const o={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},59091:(e,t,r)=>{"use strict";r.d(t,{kx:()=>j,FM:()=>q,Om:()=>U});var o=r(83125),n=r(33788),i=r(47373),s=r(75460),a=r(16135),c=r(82963),d=r(32896);const l="FluidOdspDriver";var u=r(53783),h=r(63990);const g="fluidDevOverrides";var p=r(74411),f=r(49750),m=r(93537),v=r(37805);const y="odspDriverManifestUrl";var b=r(27051),S=r(52841);const C="fluidOdspDriverManifestCache_";function k(e){return C+(e||"Prod")}const w="v1",P="/odsp-driver/versionless/deploymentManifestOdspDriver.json";let T=24192e5;async function E(e){const t=function(e){try{const t=function(e){var t;const r=null===(t=(0,S.Ar)())||void 0===t?void 0:t.getItem(k(e));return r?JSON.parse(r):null}(e);if(!t)return null;return Date.now()-t.lastUpdatedTime>T?null:t}catch(t){return null}}(e);return t?(function(e){(0,S.Ar)()&&(0,h.l)(()=>I(e,"low").catch(()=>{}))}(e),t):await I(e)}async function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"high";const r=function(e){try{var t;return null===(t=window.top[g])||void 0===t?void 0:t[e]}catch(r){return}}(y)||(0,p.o)(e)+P,o={method:"GET",priority:t};try{const t=await(0,m.J5)(r,o,{maxRetries:3,filter:(0,m.sC)([709,710]),backoffFn:(0,v.FT)(500)});if(t.result.ok){const r=await t.result.json();return function(e,t){var r;if(!(0,S.Ar)())return;const o=(0,b.A)((0,b.A)({},e),{},{lastUpdatedTime:Date.now()});null===(r=(0,S.Ar)())||void 0===r||r.setItem(k(t),JSON.stringify(o))}(r,e),r}throw new f.o('Invalid response of "'.concat(t.result.statusText,'" with status ').concat(t.result.status,", isUserDefinitelyOffline: ").concat("undefined"!==typeof navigator&&!navigator.onLine),t.result)}catch(n){const e=n instanceof Error?n.message:void 0;throw new u.Ej("Error fetching ODSP Driver manifest".concat(" with message "+e),"OdspDriverFetchError",n)}}async function N(e){return function(e){return e.jsBaseUrl+"/"+e[w].index}(await E(e))}const A={GetOdspCode:"GetOdspCode"},F="OdspDriverCodeLoader",D="getServiceDeliveredOdspCode",B="Could not load service-delivered ODSP Driver Code";async function L(e){let{windowContext:t,environment:r,logger:i,trustedTypesPolicy:u,disposeOnCompletion:h}=e;const g=i&&new o.p(F,i),p=n.m.start(A.GetOdspCode,g,{addUserTiming:!0}),f=t;f[l]||(f[l]={});const m=f[l];try{var v;if(m.getDocumentServiceFactory)return p.setResult(!0,{message:"Namespace already loaded."}),m;if(m.scriptLoadingStarted){const e=new s.c;return m.pending||(m.pending=[]),m.pending.push({promise:e,logger:g}),await e,p.setResult(!0,{message:"Loaded from existing call."}),m}m.scriptLoadingStarted=!0;const e=(0,a.Rs)(r),t=await N(e),o=(0,c.c)(e),n=u&&{trustedTypesPolicy:await u,allowedOrigins:o};return await(0,d.a)(f,t,n),null===(v=m.pending)||void 0===v||v.forEach(e=>e.promise.resolve()),delete m.pending,p.setResult(!0,{message:"Loaded from first call."}),m}catch(b){var y;const e=new Error(B);throw b instanceof Error&&O(g,b),delete m.scriptLoadingStarted,null===(y=m.pending)||void 0===y||y.forEach(t=>{b instanceof Error&&O(t.logger,b),t.promise.reject(e)}),delete m.pending,p.setResult(!1,void 0,e),e}finally{h&&function(e){delete e[l]}(f)}}function O(e,t){e&&(0,i.hO)(e,{eventName:D},t)}var x=r(58443),M=r(69235),R=r(51655),_=r(81918),H=r(90846);let U=!1;class j{constructor(e,t){this.urlResolver=e,this.documentServiceFactory=t}get DriverImplementation(){return this}}async function q(e,t,r,n,i,s,a){var c;const d=3*x.sz,l=s?new H.f({partitionKey:a,logger:r,maxCacheItemAge:d}):void 0,u=t.environment,h=null!==(c=t.hostStoragePolicy)&&void 0!==c?c:{},g=r;h.enableRedeemFallback=!0;try{return U=!0,await async function(e){let{windowContext:t,environment:r,tokenProvider:n,trustedTypesPolicy:i,logger:s,driverCache:a,hostStoragePolicy:c,disposeOnCompletion:d}=e;const l=s&&new o.p(F,s);return(await L({windowContext:t,environment:r,logger:l,trustedTypesPolicy:i,disposeOnCompletion:d})).getDocumentServiceFactory({tokenProvider:n,logger:l,driverCache:a,hostStoragePolicy:c})}({windowContext:window,driverCache:l,environment:u,hostStoragePolicy:h,logger:g,tokenProvider:i,settingsProvider:n,disposeOnCompletion:!0,trustedTypesPolicy:void 0})}catch(p){(0,M.c2)("getDocumentServiceFactory()",new M.uV("getServiceDeliveredDocumentServiceFactory() failed.",p))}try{U=!1,e.odspModuleImportTracker=new R.q;const t=await e.odspModuleImportTracker.measure(()=>(0,_.Al)());return(await t.getNpmSharepointDriver(i,g,l,h,{appName:void 0},n)).documentServiceFactory}catch(p){(0,M.c2)("getSharepointDriver()",(0,M.oD)(p))}throw new M.uV("Unable to get the document service factory.")}},59526:(e,t,r)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}r.d(t,{A:()=>n})},60119:(e,t,r)=>{"use strict";r.d(t,{a:()=>d});var o=r(91947),n=r(6971),i=r(24921);let s,a=[],c=!1;const d=new class{get LoopTelemetrySink(){return this}async sendTelemetryEvent(e){var t;void 0===s&&(s=await(0,n.E)());const r=JSON.stringify(e),d=null!==(t=s.telemetryBatchDurationMs)&&void 0!==t?t:0;d>0?(a.push(r),async function(e){if(!c){c=!0,await(0,i.y)(e),c=!1;const t=a;a=[],(0,o.wW)(t)}}(d)):(0,o.wW)([r])}}},60138:(e,t,r)=>{"use strict";r.d(t,{z:()=>h});var o=r(58443),n=r(40118),i=r(56142),s=r(69235),a=r(51655),c=r(24921),d=r(91947),l=r(51492),u=r(6971);class h{constructor(){this.getTokenCallCount=0,this.getTokenTotalDuration=0,this.getTokenSucceededAfterRetryCount=0,this.retryEnabledPromise=void 0,this.identityType="Enterprise"}get TokenProvider(){return this}getAppId(){return o.R0}async getToken(e,t){++this.getTokenCallCount;const r=a.q.startNew(),c=await(0,u.E)();if(e&&e.length>0){let a;var d;if(e[0]&&e[0].indexOf("/")>=0)try{const t=new URL(e[0]),r=t.pathname.lastIndexOf("/");if(r>0){const e=t.pathname.substring(0,r);t.pathname=e,a=t.href}else a="".concat(t.protocol,"//").concat(t.hostname)}catch(h){throw(0,s.c2)("getToken()",new s.uV("scopes resource url is invalid",h)),new s.uV("scopes resource url is invalid")}else a=null!==(d=c.graphEndpoint)&&void 0!==d?d:"https://graph.microsoft.com";try{var l;const e=null===t||void 0===t?void 0:t.claims,o=null!==(l=null===t||void 0===t?void 0:t.forceRefresh)&&void 0!==l&&l,i=await n.n.GetInstance().getToken(a,e,o);return r.setSuccess(),this.getTokenTotalDuration+=r.getDuration(),"fromCache"in i?{token:i.token,fromCache:i.fromCache}:{token:i.token}}catch(h){throw o.Nu||(0,i.vV)(h),h}}throw new s.uV("No scopes provided to getToken")}async getTokenWithRetries(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3;let o=0,n=1e3<r?1e3:r;for(;;)try{const r=await this.getToken(e,t);return o>0&&++this.getTokenSucceededAfterRetryCount,r}catch(i){this.retryEnabledPromise||(this.retryEnabledPromise=(0,d.PA)(l.u.OEP,"ChangeGate.FluidHost.TokenRetryOnError"));if(!await this.retryEnabledPromise)throw i;++o;const e=this.decorateErrorPerErrorCode(i,o);if(!e.canRetry)throw e.canRetry,e;if(o>=25)throw e;n>0&&await(0,c.y)(n),n=2*n>r?r:2*n}}decorateErrorPerErrorCode(e,t){const r=e;switch(r.attemptCount=t,null===r||void 0===r?void 0:r.errorCode){case 12007:r.canRetry=!0;break;case 13002:r.canRetry=!1,r.isExpected=!0;break;case 13001:case 13003:case 13005:r.canRetry=!1}return r}}},60257:(e,t,r)=>{"use strict";r.d(t,{q:()=>o});const o=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t}},60295:(e,t,r)=>{"use strict";var o;r.d(t,{NM:()=>i,RN:()=>n,nL:()=>o}),function(e){e[e.FromSummary=0]="FromSummary",e[e.FromAttach=1]="FromAttach",e[e.Local=2]="Local"}(o||(o={}));const n="BlobCount",i="TotalBlobSize"},60835:(e,t,r)=>{"use strict";r.d(t,{OF:()=>u,g2:()=>p,qT:()=>g,sN:()=>l});var o=r(27051),n=r(29018),i=r(40635),s=r(74405),a=r(72376),c=r(47373);const d=new Map;function l(e,t,r,l,u,h){const g=(0,n.$)(t),p="".concat(g,"_").concat(r,"_").concat(l);if(!d.has(p)){const n=async()=>{var n,f;const m={getToken:n=>{if(n){const i=(0,o.A)((0,o.A)({},n),{},{siteUrl:t,driveId:r,itemId:l});return e.getToken(["".concat(g,"/files.readwrite.all")],i)}throw Error("Options must be specified")},url:"".concat(g,"/_api/v2.0/drives/").concat(r,"/items/").concat(l,"?select=sharepointIds"),tenantId:h,requestInit:{method:"GET"},retryPolicy:a._9,tokenPolicy:(0,a.N$)(e)},v=u?(0,i.g)((0,o.A)((0,o.A)({},m),{},{logger:u,nameForLogging:"GetFileSharepointIds",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,s.u)(e)})):(0,i.y)(m);let y;try{y=(await v).result}catch(S){}if(null!==(n=y)&&void 0!==n&&n.ok){var b;let e;try{e=await y.json()}catch(C){u&&(0,c.hO)(u,{eventName:"GetFileSharepointIdsResponseParseError"},C)}if(null!==(b=e)&&void 0!==b&&b.sharepointIds)return e.sharepointIds;u&&(0,c.hO)(u,{eventName:"GetFileSharepointIdsUnexpectedResponse"},new Error("sharepointIds is missing from response body"))}404!==(null===(f=y)||void 0===f?void 0:f.status)&&d.delete(p)};d.set(p,n())}return d.get(p).then()}async function u(e,t,r,o,n,i,s){return h(e,t,r,o,void 0,n,i,s)}async function h(e,t,r,d,l,u,h,g){var p;const f=(0,n.$)(t),m=void 0!==l?":/".concat(encodeURIComponent(l),":/"):"",v={getToken:n=>{if(n){const i=(0,o.A)((0,o.A)({},n),{},{siteUrl:t,driveId:r,itemId:d});return e.getToken(["".concat(f,"/files.readwrite.all")],i)}throw Error("Options must be specified")},url:"".concat(f,"/_api/v2.0/drives/").concat(r,"/items/").concat(d).concat(m,"/?select=webUrl,webDavUrl,name,sharepointIds,parentReference"),tenantId:h,requestInit:{method:"GET",signal:g},retryPolicy:a._9,tokenPolicy:(0,a.N$)(e)},y=u?(0,i.g)((0,o.A)((0,o.A)({},v),{},{logger:u,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,s.u)(e)})):(0,i.y)(v);let b;try{b=(await y).result}catch(S){}if(null!==(p=b)&&void 0!==p&&p.ok)try{return await b.json()}catch(C){u&&(0,c.hO)(u,{eventName:"GetFileItemLiteResponseParseError"},C)}}const g=async(e,t,r,o,n)=>{if(p(e))return u(t,e.siteUrl,e.driveId,e.itemId,r,o,n).then(e=>{const t=null===e||void 0===e?void 0:e.webDavUrl.lastIndexOf("/");if(void 0!==t&&t>0)return null===e||void 0===e?void 0:e.webDavUrl.substring(0,t)})},p=e=>"driveId"in e&&"siteUrl"in e&&"itemId"in e},61376:(e,t,r)=>{"use strict";t.b=void 0;var o=r(87987);Object.defineProperty(t,"b",{enumerable:!0,get:function(){return o.EventEmitter}})},62231:(e,t,r)=>{"use strict";function o(){return r.e(26853).then(r.bind(r,52564)).then(e=>e.getInstance())}r.d(t,{H:()=>o})},62951:(e,t,r)=>{"use strict";r.d(t,{M:()=>c});var o=r(87615),n=r(14365),i=r(54813),s=r(93586),a=r(91119);async function c(e,t,r,c){let d=1e3;const l=(0,o.l)();let u;for(let p=1;;p++){void 0!==c&&c();try{const n=await e();return p>1&&r.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:p,duration:(0,o.l)()-l},u),n}catch(g){var h;const e=(0,i.YU)(g),c=!0===(null===g||void 0===g?void 0:g[a.Cj]),f=(null===g||void 0===g?void 0:g.errorType)===s.E.serviceReadOnly;if(1===p&&r.sendTelemetryEvent({eventName:"".concat(t,"_firstFailed"),callName:t,attempts:p,duration:(0,o.l)()-l},g),!c&&!f||!e)throw g;if(5===p)throw r.sendErrorEvent({eventName:c?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:p,duration:(0,o.l)()-l},g),g.canRetry=!1,g;d=null!==(h=(0,i.E9)(g))&&void 0!==h?h:d,await(0,n.c)(Math.floor(d)),d+=d/4*(1+Math.random()),u=g}}}},63520:(e,t,r)=>{"use strict";r.d(t,{CL:()=>v,G0:()=>h,Ln:()=>p,fG:()=>f,uz:()=>g});var o=r(27051),n=r(20258),i=r(27250);const s=new n.d(()=>c(u())),a={getRawConfig:()=>{}},c=e=>void 0!==e&&null!==e?new h(void 0,{getRawConfig:t=>{try{var r,o;return null===(r=l(null!==(o=e.getItem(t))&&void 0!==o?o:void 0))||void 0===r?void 0:r.raw}catch(n){return}}}):a;function d(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function l(e){let t,r=e;if("string"===typeof e)try{r=JSON.parse(e),t={raw:e,string:e}}catch(i){}if(void 0===r)return t;const n=typeof r;if(d(n))return(0,o.A)((0,o.A)({},t),{},{raw:e,[n]:r});if(Array.isArray(r)){const n=typeof r[0];if(!d(n))return t;for(const e of r)if(typeof e!==n)return t;return(0,o.A)((0,o.A)({},t),{},{raw:e,["".concat(n,"[]")]:r})}return t}const u=()=>{try{var e;return null!==(e=globalThis.sessionStorage)&&void 0!==e?e:void 0}catch(t){return}};class h{constructor(e){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const t=new Set;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=[...o];for(;i.length>0;){const e=i.shift();void 0!==e&&m(e)&&!t.has(e)&&(t.add(e),e instanceof h?i.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.boolean}getNumber(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.number}getString(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.string}getBooleanArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["boolean[]"]}getNumberArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["number[]"]}getStringArray(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t["string[]"]}getRawConfig(e){var t;return null===(t=this.getCacheEntry(e))||void 0===t?void 0:t.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const r of this.orderedBaseProviders){const n=l(null===r||void 0===r?void 0:r.getRawConfig(e));var t;if(void 0!==n)return this.configCache.set(e,n),null===(t=this.logger)||void 0===t||t.send((0,o.A)({category:"generic",eventName:"ConfigRead"},(0,i.Df)({configName:e,configValue:JSON.stringify(n)}))),n}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function g(e){const t=e;return m(null===t||void 0===t?void 0:t.config)&&void 0!==(null===t||void 0===t?void 0:t.logger)}function p(e){return g(e)?e:f(e,s.value)}function f(e){if(g(e))throw new Error("Logger is already a monitoring context");const t=e;for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return t.config=new h(e,...o),t.logger=e,t}function m(e){return"function"===typeof(null===e||void 0===e?void 0:e.getRawConfig)}function v(e){return p((0,i.pW)(e))}},63722:(e,t,r)=>{"use strict";r.d(t,{nr:()=>h});var o,n=r(56851),i=r(96752),s=0,a=1,c=2,d="__stylesheet__",l="undefined"!==typeof navigator&&/rv:11.0/.test(navigator.userAgent),u={};try{u=window||{}}catch(g){}var h=function(){function e(e,t){var r,o,i,c,d,l;this._rules=[],this._preservedRules=[],this._counter=0,this._keyToClassName={},this._onInsertRuleCallbacks=[],this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,n.__assign)({injectionMode:"undefined"===typeof document?s:a,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._classNameToArgs=null!==(r=null===t||void 0===t?void 0:t.classNameToArgs)&&void 0!==r?r:this._classNameToArgs,this._counter=null!==(o=null===t||void 0===t?void 0:t.counter)&&void 0!==o?o:this._counter,this._keyToClassName=null!==(c=null!==(i=this._config.classNameCache)&&void 0!==i?i:null===t||void 0===t?void 0:t.keyToClassName)&&void 0!==c?c:this._keyToClassName,this._preservedRules=null!==(d=null===t||void 0===t?void 0:t.preservedRules)&&void 0!==d?d:this._preservedRules,this._rules=null!==(l=null===t||void 0===t?void 0:t.rules)&&void 0!==l?l:this._rules}return e.getInstance=function(t){if(o=u[d],u[i.Se])return u[i.Se].getInstance(t);if(!o||o._lastStyleElement&&o._lastStyleElement.ownerDocument!==document){var r=(null===u||void 0===u?void 0:u.FabricConfig)||{},n=new e(r.mergeStyles,r.serializedStylesheet);o=n,u[d]=n}return o},e.prototype.serialize=function(){return JSON.stringify({classNameToArgs:this._classNameToArgs,counter:this._counter,keyToClassName:this._keyToClassName,preservedRules:this._preservedRules,rules:this._rules})},e.prototype.setConfig=function(e){this._config=(0,n.__assign)((0,n.__assign)({},this._config),e)},e.prototype.onReset=function(e){var t=this;return this._onResetCallbacks.push(e),function(){t._onResetCallbacks=t._onResetCallbacks.filter(function(t){return t!==e})}},e.prototype.onInsertRule=function(e){var t=this;return this._onInsertRuleCallbacks.push(e),function(){t._onInsertRuleCallbacks=t._onInsertRuleCallbacks.filter(function(t){return t!==e})}},e.prototype.getClassName=function(e){var t=this._config.namespace,r=e||this._config.defaultPrefix;return"".concat(t?t+"-":"").concat(r,"-").concat(this._counter++)},e.prototype.cacheClassName=function(e,t,r,o){this._keyToClassName[this._getCacheKey(t)]=e,this._classNameToArgs[e]={args:r,rules:o}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[this._getCacheKey(e)]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t,r){void 0===r&&(r=i.P6);var o=this._config.injectionMode,n=o!==s?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),n)switch(o){case a:this._insertRuleIntoSheet(n.sheet,e);break;case c:n.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e),this._onInsertRuleCallbacks.forEach(function(t){return t({key:r,sheet:n?n.sheet:void 0,rule:e})})},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")},e.prototype.reset=function(){this._rules=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach(function(e){return e()})},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._createStyleElement=function(){var e,t=(null===(e=this._config.window)||void 0===e?void 0:e.document)||document,r=t.head,o=t.createElement("style"),n=null;o.setAttribute("data-merge-styles","true");var i=this._config.cspSettings;if(i&&i.nonce&&o.setAttribute("nonce",i.nonce),this._lastStyleElement)n=this._lastStyleElement.nextElementSibling;else{var s=this._findPlaceholderStyleTag();n=s?s.nextElementSibling:r.childNodes[0]}return r.insertBefore(o,r.contains(n)?n:null),this._lastStyleElement=o,o},e.prototype._insertRuleIntoSheet=function(e,t){if(!e)return!1;try{return e.insertRule(t,e.cssRules.length),!0}catch(r){}return!1},e.prototype._getCacheKey=function(e){return e},e.prototype._getStyleElement=function(){var e=this;this._styleElement||(this._styleElement=this._createStyleElement(),l||(this._config.window||window).requestAnimationFrame(function(){e._styleElement=void 0}));return this._styleElement},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}()},63854:(e,t,r)=>{"use strict";function o(e){return n(e)}function n(e){switch(e){case"ar-sa":case"fa-ir":case"he-il":case"ug-cn":case"ur-pk":return"rtl";default:return"ltr"}}r.d(t,{Gz:()=>o})},63990:(e,t,r)=>{"use strict";r.d(t,{M:()=>a,l:()=>s});let o=[],n=!1,i=!1;function s(e,t){o.push({ensureExecution:!0===(null===t||void 0===t?void 0:t.ensureExecution),task:e}),null!==t&&void 0!==t&&t.ensureExecution&&!i&&("object"===typeof document?document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&u()}):u(),i=!0),c()}function a(e){const t=o.findIndex(t=>t.task===e);-1!==t&&o.splice(t,1)}function c(){if(!n){if("function"===typeof requestIdleCallback)requestIdleCallback(l);else{const e=Date.now()+50;setTimeout(()=>l({timeRemaining:()=>Math.max(e-Date.now(),0),didTimeout:!1}),0)}n=!0}}function d(e,t){const r=[];for(let n=0;n<o.length;n+=1){if(t&&!t()){r.push(...o.slice(n));break}const i=o[n];e&&!e(i)?r.push(i):i.task()}o=r}function l(e){d(void 0,()=>e.timeRemaining()>10),n=!1,o.length>0&&c()}function u(){d(e=>e.ensureExecution)}},64580:(e,t,r)=>{"use strict";r.d(t,{$:()=>h,G:()=>u});var o=r(5482),n=r(56142),i=r(91947),s=r(40684),a=r(97232),c=r(37513),d=r(94794),l=r(41395);function u(e){const t={[d.D.clientSessionExpiredError]:a.d.Error_FluidContainer_ClientSessionExpiredError,[d.D.dataCorruptionError]:a.d.Error_FluidContainer_DataCorruption,[d.D.dataProcessingError]:a.d.Error_FluidContainer_DataProcessingError,[d.D.genericError]:a.d.Error_FluidContainer_GeneralError,[d.D.throttlingError]:a.d.Error_FluidContainer_ThrottlingError,[d.D.usageError]:a.d.Error_FluidContainer_UsageError,[o.qb.RootComponentCreateFailed]:a.d.Error_FluidContainerLoad_RootComponentCreateFailed,[o.qb.RaasNotSupported]:a.d.Error_FluidContainerLoad_RaasNotSupported,[c.a.authorizationError]:a.d.ExpectedError_FluidDriver_AuthorizationError,[c.a.deltaStreamConnectionForbidden]:a.d.Error_FluidDriver_DeltaStreamConnectionForbidden,[c.a.fetchFailure]:a.d.ExpectedError_FluidDriver_FetchFailure,[c.a.fileNotFoundOrAccessDeniedError]:a.d.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied,[c.a.fileOverwrittenInStorage]:a.d.Error_FluidDriver_FileOverwrittenInStorage,[c.a.fluidInvalidSchema]:a.d.Error_FluidDriver_FluidInvalidSchema,[c.a.genericError]:a.d.Error_FluidDriver_GenericError,[c.a.genericNetworkError]:a.d.Error_FluidDriver_GenericNetworkError,[c.a.incorrectServerResponse]:a.d.Error_FluidDriver_IncorrectServerResponse,[c.a.locationRedirection]:a.d.Error_FluidDriver_LocationRedirection,[c.a.offlineError]:a.d.ExpectedError_FluidDriver_OfflineError,[c.a.throttlingError]:a.d.Error_FluidDriver_ThrottlingError,[c.a.usageError]:a.d.Error_FluidDriver_UsageError,[c.a.unsupportedClientProtocolVersion]:a.d.Error_FluidDriver_UnsupportedClientProtocolVersion,[c.a.writeError]:a.d.Error_FluidDriver_WriteError,[c.a.fileIsLocked]:a.d.Error_FluidDriver_FileIsLocked,[l.E.cannotCatchUp]:a.d.Error_FluidOdsp_CannotCatchUp,[l.E.fetchTimeout]:a.d.Error_FluidOdsp_FetchTimeout,[l.E.fetchTokenError]:a.d.Error_FluidOdsp_FetchTokenError,[l.E.fluidNotEnabled]:a.d.ExpectedError_FluidOdsp_FluidNotEnabled,[l.E.invalidFileNameError]:a.d.Error_FluidOdsp_InvalidFileNameError,[l.E.outOfStorageError]:a.d.Error_FluidOdsp_OutOfStorageError,[l.E.serviceReadOnly]:a.d.Error_FluidOdsp_ServiceReadOnly,[l.E.snapshotTooBig]:a.d.Error_FluidOdsp_SnapshotTooBig,[l.E.blockedIPAddress]:a.d.Error_FluidOdsp_BlockedIPAddress,[o.ZY.ComponentNotFound]:a.d.Error_FluidOWH_ComponentNotFound,[o.ZY.ContainerUpgradeRequired]:a.d.Error_FluidOWH_ContainerUpgradeRequired,[o.ZY.IframeLoadFailed]:a.d.Error_FluidOWH_IFrameLoadFailed,[o.v6]:a.d.Error_Fluid_UnknownError};return e?t[e]:a.d.Error_Fluid_Undefined}function h(e){const t=function(e){switch(e){case a.d.Success_Hydrated:case a.d.Success_NoFluidUrl:case a.d.ExpectedError_FluidDriver_AuthorizationError:case a.d.ExpectedError_FluidDriver_FetchFailure:case a.d.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied:case a.d.ExpectedError_FluidDriver_OfflineError:case a.d.ExpectedError_FluidOdsp_FluidNotEnabled:case a.d.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest:return!0;default:return!1}}(e);return(0,n.Rm)("Hydrate ".concat(t?"succeeded":"failed",": ").concat(a.d[e]," (").concat(e,").")),(0,i.Jn)(s.QK.Hydrate,t,e)}},64643:(e,t,r)=>{"use strict";var o;r.d(t,{q:()=>a});var n=r(899),i=r(16281);let s;async function a(){const e=(0,n.Mg)();try{return s||(s=await r(65606)("./".concat(e,"/strings.json"))),s}catch(t){return o||(o=r.t(i,2))}}},65043:(e,t,r)=>{"use strict";e.exports=r(14202)},65199:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});const o="2.23.0"},65317:(e,t,r)=>{"use strict";r.d(t,{ku:()=>o});function o(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com|.sharepoint-mil.us|-my.sharepoint-mil.us|.sharepoint.us|-my.sharepoint.us)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com|preview.loop.microsoft.com|loop.cloud.microsoft|loop.cloud-dev.microsoft)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}},65606:(e,t,r)=>{var o={"./af-ZA/strings.json":[90976,90976],"./am-ET/strings.json":[79327,79327],"./ar-SA/strings.json":[36077,36077],"./as-IN/strings.json":[6471,6471],"./az-Latn-AZ/strings.json":[69110,69110],"./bg-BG/strings.json":[41514,41514],"./bn-IN/strings.json":[11299,11299],"./bs-Latn-BA/strings.json":[59108,59108],"./ca-ES/strings.json":[89520,89520],"./ca-Es-VALENCIA/strings.json":[69698,69698],"./cs-CZ/strings.json":[94751,94751],"./cy-GB/strings.json":[66561,66561],"./da-DK/strings.json":[57940,57940],"./de-DE/strings.json":[2338,2338],"./el-GR/strings.json":[88974,88974],"./en-GB/strings.json":[10572,10572],"./en-US/strings.json":[16281],"./es-ES/strings.json":[38428,38428],"./es-MX/strings.json":[23329,23329],"./et-EE/strings.json":[55953,55953],"./eu-ES/strings.json":[52326,52326],"./fa-IR/strings.json":[58888,58888],"./fi-FI/strings.json":[4474,4474],"./fil-PH/strings.json":[17925,17925],"./fr-CA/strings.json":[93892,93892],"./fr-FR/strings.json":[26748,26748],"./ga-IE/strings.json":[55346,55346],"./gd-gb/strings.json":[43164,43164],"./gl-ES/strings.json":[77873,77873],"./gu-IN/strings.json":[14183,14183],"./he-IL/strings.json":[97244,97244],"./hi-IN/strings.json":[7374,7374],"./hr-HR/strings.json":[93420,93420],"./hu-HU/strings.json":[36738,36738],"./hy-AM/strings.json":[13039,13039],"./id-ID/strings.json":[22362,22362],"./is-IS/strings.json":[85916,85916],"./it-IT/strings.json":[79450,79450],"./ja-JP/strings.json":[3201,3201],"./ka-GE/strings.json":[76128,76128],"./kk-KZ/strings.json":[85031,85031],"./km-KH/strings.json":[19347,19347],"./kn-IN/strings.json":[96900,96900],"./ko-KR/strings.json":[3763,3763],"./kok-IN/strings.json":[61374,61374],"./lb-LU/strings.json":[57397,57397],"./lt-LT/strings.json":[15520,15520],"./lv-LV/strings.json":[45092,45092],"./mi-NZ/strings.json":[65662,65662],"./mk-MK/strings.json":[12156,12156],"./ml-IN/strings.json":[10632,10632],"./mr-IN/strings.json":[32870,32870],"./ms-MY/strings.json":[40738,40738],"./mt-MT/strings.json":[49306,49306],"./nb-NO/strings.json":[20559,20559],"./ne-NP/strings.json":[41717,41717],"./nl-NL/strings.json":[28688,6307],"./nn-NO/strings.json":[50787,50787],"./or-IN/strings.json":[65156,65156],"./pa-IN/strings.json":[85902,85902],"./pl-PL/strings.json":[62200,62200],"./pt-BR/strings.json":[95164,95164],"./pt-PT/strings.json":[38328,15947],"./quz-PE/strings.json":[5891,5891],"./ro-RO/strings.json":[11354,11354],"./ru-RU/strings.json":[68346,68346],"./sk-SK/strings.json":[10672,10672],"./sl-SI/strings.json":[37801,37801],"./sq-AL/strings.json":[53205,53205],"./sr-Cyrl-BA/strings.json":[7911,7911],"./sr-Cyrl-RS/strings.json":[25621,25621],"./sr-Latn-RS/strings.json":[26676,26676],"./sv-SE/strings.json":[98595,98595],"./ta-IN/strings.json":[9858,9858],"./te-IN/strings.json":[56510,56510],"./th-TH/strings.json":[11072,11072],"./tr-TR/strings.json":[96444,96444],"./tt-RU/strings.json":[12481,12481],"./ug-CN/strings.json":[89441,89441],"./uk-UA/strings.json":[55874,55874],"./ur-PK/strings.json":[18196,18196],"./uz-Latn-UZ/strings.json":[28566,28566],"./vi-VN/strings.json":[89559,89559],"./zh-CN/strings.json":[77771,77771],"./zh-TW/strings.json":[56295,56295]};function n(e){if(!r.o(o,e))return Promise.resolve().then(()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=o[e],n=t[0];return Promise.all(t.slice(1).map(r.e)).then(()=>r.t(n,19))}n.keys=()=>Object.keys(o),n.id=65606,e.exports=n},65922:(e,t,r)=>{"use strict";r.d(t,{oZ:()=>o});const o={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"}},66267:(e,t,r)=>{"use strict";r.d(t,{C:()=>a,J:()=>c});var o=r(19813),n=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function s(e){try{c(o.next(e))}catch(t){i(t)}}function a(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}c((o=o.apply(e,t||[])).next())})},i=function(e,t){var r,o,n,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]},s=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},s=function(){function e(){}return e.prototype.canLoad=function(e){return e.packageName===c},e.prototype.load=function(e){return n(this,void 0,void 0,function(){return i(this,function(t){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return[2,Promise.all([r.e(97950),r.e(2977),r.e(84807)]).then(r.bind(r,61687)).then(function(t){return{module:t,details:e}})]})})},e}(),a={instantiateLoopCodeLoader:function(e){return Promise.resolve(new s)}},c=o.JL},68180:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});function o(e){try{const t=new URL(e),r=t.searchParams.get("nav");if(!r)return e;const o=window.atob(r),n=new URLSearchParams(o),i=n.get("c");if((null===i||void 0===i||!i.includes("deepLinkInfo"))&&(null===i||void 0===i||!i.includes("minified")))return e;n.set("c","");const s=n.toString(),a=window.btoa(s);return t.searchParams.set("nav",a),t.toString()}catch(t){return e}}},68194:(e,t,r)=>{"use strict";r.d(t,{AH:()=>n,O0:()=>i});var o=r(41818);const n=e=>o.Ss.from(e,"base64").toString("utf8"),i=e=>o.Ss.from(e,"utf8").toString("base64")},69235:(e,t,r)=>{"use strict";r.d(t,{aK:()=>h,c2:()=>g,oD:()=>l,u1:()=>u,uV:()=>d});var o=r(37450),n=r(90589),i=r(58443),s=r(82645),a=r(56142),c=r(97232);class d extends Error{constructor(e,t,r){super(e),this.name=void 0,this.message=void 0,this.innerError=void 0,this.hydrateResult=void 0,this.name="AppError",this.message=e,this.innerError=t,this.hydrateResult=null!==r&&void 0!==r?r:c.d.Error_FluidHostWebApp_Exception}}function l(e){return e instanceof d?e:new d(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Exception occurred.",e)}function u(e){return"string"===typeof e?e:e instanceof Error?e.message:e instanceof PromiseRejectionEvent?e.reason:"".concat(e)}function h(e){return e instanceof d?e.message:""}function g(e,t){if(i.yz){const e=u(t);(0,a.vV)("UNEXPECTED ERROR: ".concat(e))}else{const r={eventName:"Office.Extensibility.Fluid.HostWebAppErrors",eventFlags:{dataCategories:o.o.DataCategories.ProductServiceUsage,diagnosticLevel:o.o.DiagnosticLevel.FullEvent},dataFields:[(0,n.m9)("Message",h(t)),(0,n.m9)("Source",e)]};i.Nu||s.u.sendTelemetryEvent(r)}}},69649:(e,t,r)=>{"use strict";r.d(t,{P2:()=>v});var o=r(27051);const n=(e,t)=>t.some(t=>e instanceof t);let i,s;const a=new WeakMap,c=new WeakMap,d=new WeakMap,l=new WeakMap,u=new WeakMap;let h={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return f(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function g(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(m(this),r),f(a.get(this))}:function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return f(e.apply(m(this),r))}:function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];const i=e.call(m(this),t,...o);return d.set(i,t.sort?t.sort():[t]),f(i)}}function p(e){return"function"===typeof e?g(e):(e instanceof IDBTransaction&&function(e){if(c.has(e))return;const t=new Promise((t,r)=>{const o=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",i),e.removeEventListener("abort",i)},n=()=>{t(),o()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",n),e.addEventListener("error",i),e.addEventListener("abort",i)});c.set(e,t)}(e),n(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e)}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const o=()=>{e.removeEventListener("success",n),e.removeEventListener("error",i)},n=()=>{t(f(e.result)),o()},i=()=>{r(e.error),o()};e.addEventListener("success",n),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&a.set(t,e)}).catch(()=>{}),u.set(t,e),t}(e);if(l.has(e))return l.get(e);const t=p(e);return t!==e&&(l.set(e,t),u.set(t,e)),t}const m=e=>u.get(e);function v(e,t){let{blocked:r,upgrade:o,blocking:n,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),a=f(s);return o&&s.addEventListener("upgradeneeded",e=>{o(f(s.result),e.oldVersion,e.newVersion,f(s.transaction))}),r&&s.addEventListener("blocked",()=>r()),a.then(e=>{i&&e.addEventListener("close",()=>i()),n&&e.addEventListener("versionchange",()=>n())}).catch(()=>{}),a}const y=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],S=new Map;function C(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(S.get(t))return S.get(t);const r=t.replace(/FromIndex$/,""),o=t!==r,n=b.includes(r);if(!(r in(o?IDBIndex:IDBObjectStore).prototype)||!n&&!y.includes(r))return;const i=async function(e){const t=this.transaction(e,n?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,a=new Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];return o&&(i=i.index(a.shift())),(await Promise.all([i[r](...a),n&&t.done]))[0]};return S.set(t,i),i}h=(e=>(0,o.A)((0,o.A)({},e),{},{get:(t,r,o)=>C(t,r)||e.get(t,r,o),has:(t,r)=>!!C(t,r)||e.has(t,r)}))(h)},70354:(e,t,r)=>{"use strict";r.d(t,{F:()=>h,M:()=>d});var o=r(87615),n=r(14365),i=r(87804),s=r(83533),a=r(54813),c=r(65199);async function d(e,t,r,s){let d,l=!1,u=500,g=0;const p=(0,o.l)();let f;do{try{d=await e(s.cancel),l=!0}catch(v){var m;if(!(0,a.YU)(v))throw r.sendTelemetryEvent({eventName:"".concat(t,"_cancel"),retry:g,duration:(0,o.l)()-p,fetchCallName:t},v),v;if(!0===(null===(m=s.cancel)||void 0===m?void 0:m.aborted))throw r.sendTelemetryEvent({eventName:"".concat(t,"_runWithRetryAborted"),retry:g,duration:(0,o.l)()-p,fetchCallName:t,reason:s.cancel.reason},v),new a.OI("runWithRetry was Aborted",i.a.genericError,{driverVersion:c.z,fetchCallName:t,reason:s.cancel.reason});0===g&&r.sendTelemetryEvent({eventName:"".concat(t,"_firstFailed"),duration:(0,o.l)()-p,fetchCallName:t},v),g++,f=v,u=h(u,v),s.onRetry&&s.onRetry(u,v),await(0,n.c)(u)}}while(!l);return g>0&&r.sendTelemetryEvent({eventName:"".concat(t,"_lastError"),retry:g,duration:(0,o.l)()-p,fetchCallName:t},f),d}const l=6e4,u=8e3;function h(e,t){const r=(0,a.E9)(t);let o=Math.max(null!==r&&void 0!==r?r:0,2*e);return o=Math.min(o,(0,s.X)(t)&&!0===t.getTelemetryProperties().endpointReached?l:u),o}},70530:(e,t,r)=>{"use strict";r.d(t,{z6:()=>_,wF:()=>F,wL:()=>I,bP:()=>P,bf:()=>C,cr:()=>S,ZR:()=>b,nb:()=>H,Q1:()=>L,Yn:()=>w,gO:()=>y,TV:()=>v,IU:()=>O,$o:()=>k,vh:()=>x,K3:()=>A,xP:()=>D,jL:()=>B,JH:()=>N,bJ:()=>T,yI:()=>E,Ss:()=>M});var o=r(27051),n=r(87615),i=r(85038),s=r(54813),a=r(84295),c=r(93586);const d=e=>null===e||"string"===typeof e?e:void 0===e?null:e.token,l=e=>{if("object"===typeof e&&void 0!==(null===e||void 0===e?void 0:e.authorizationHeader))return e.authorizationHeader;const t=d(e);return null!==t?"Bearer ".concat(t):null},u=e=>null===e||"string"===typeof e?void 0:e.fromCache;var h=r(20611),g=r(27250),p=r(39521),f=r(50349),m=r(27612);const v="getWithRetryForTokenRefreshRepeat";async function y(e){return e({refresh:!1}).catch(async t=>{const r={refresh:!0,previousError:t};switch(t.errorType){case c.E.authorizationError:{const n=t;return e((0,o.A)((0,o.A)({},r),{},{claims:n.claims,tenantId:n.tenantId}))}case c.E.incorrectServerResponse:case c.E.fetchTokenError:return e(r);default:if(!0===t[v])return e(r);throw t}})}async function b(e,t){const r=(0,n.l)();return fetch(e,t).then(async e=>{const t=e;if(!t)throw new s.OI("No response from ODSP fetch call",c.E.incorrectServerResponse,{driverVersion:m.z});(!t.ok||t.status<200||t.status>=300)&&(0,a.lJ)("ODSP fetch error [".concat(t.status,"]"),t.status,t,await t.text());const o=function(e){const t=new Map;for(const[r,o]of e.entries())t.set(r,o);return t}(t.headers);return{content:t,headers:o,propsToLog:(0,a.qw)(o),duration:(0,n.l)()-r}},e=>{const t=(0,s.sc)(),r={value:"".concat(e),tag:g.mc.UserData},o=r.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new s.dw("Fetch Timeout (AbortError)",c.E.fetchTimeout,{driverVersion:m.z});if(o.includes("ETIMEDOUT"))throw new s.dw("Fetch Timeout (ETIMEDOUT)",c.E.fetchTimeout,{driverVersion:m.z});throw t===s.WA.Offline?new s.dw("ODSP fetch failure (Offline): ".concat(o),c.E.offlineError,{driverVersion:m.z,rawErrorMessage:r}):new s.dw("ODSP fetch failure: ".concat(o),c.E.fetchFailure,{driverVersion:m.z,rawErrorMessage:r})})}async function S(e,t){const{content:r,headers:o,propsToLog:n,duration:i}=await b(e,t);let s;try{s=await r.arrayBuffer()}catch(c){(0,a.lJ)("Error while parsing fetch response",a.TX,r,void 0,n)}return n.bodySize=s.byteLength,{headers:o,content:s,propsToLog:n,duration:i}}async function C(e,t){const{content:r,headers:o,propsToLog:n,duration:i}=await b(e,t);let s;try{s=await r.text()}catch(c){(0,a.lJ)("Error while parsing fetch response",a.TX,r,s,n)}n.bodySize=s.length;return{headers:o,content:JSON.parse(s),propsToLog:n,duration:i}}function k(e){return void 0===e.type||"New"===e.type}function w(e){return(0,i.vA)(!0===e.odspResolvedUrl,478),e}b.fetch=fetch;const P=e=>(0,g.pW)({logger:e,namespace:"OdspDriver",properties:{all:{driverVersion:m.z}}});function T(e,t,r){return E(e,t,r,!0,!1)}function E(e,t,r,n,i){return async function(a,h){let f=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return g.Bt.timedExecAsync(e,{eventName:"".concat(h,"_GetToken"),attempts:a.refresh?2:1,hasClaims:!!a.claims,hasTenantId:!!a.tenantId},async e=>r((0,o.A)((0,o.A)({},a),t)).then(t=>{const r=i?d(t):l(t);if((f||e.duration>=32)&&e.end({fromCache:u(t),isNull:null===r}),null===r&&n)throw new s.OI("The Host-provided token fetcher returned null",c.E.fetchTokenError,{method:h,driverVersion:m.z});return r},e=>{const t=null===e||void 0===e?void 0:e.canRetry;throw(0,p.J4)(e,e=>new s.Tj("The Host-provided token fetcher threw an error",c.E.fetchTokenError,"boolean"===typeof t&&t,{method:h,errorMessage:e,driverVersion:m.z}))}),{cancel:"generic"})}}function I(e,t){var r;return{type:t?h.W3:h.o1,key:null!==(r=e.fileVersion)&&void 0!==r?r:"",file:{resolvedUrl:e,docId:e.hashedDocumentId}}}function N(e){return e.getBoolean("Fluid.Container.UseLoadingGroupIdForSnapshotFetch2")}const A=79872;function F(e){if(!e)return;const t=e.scope;let r="createLinkScope=".concat(t);const o=e.role;return r=o?"".concat(r,"&createLinkRole=").concat(o):r,r}function D(e){const t=(0,n.l)();return[e(),(0,n.l)()-t]}async function B(e){const t=(0,n.l)();return[await e(),(0,n.l)()-t]}function L(e){return"".concat(e.hashedDocumentId,"/joinsession")}function O(e){return void 0!==e&&"snapshotFormatV"in e&&1===e.snapshotFormatV}function x(e){return void 0!==e&&e.length>0}function M(e){return void 0===e}const R=e=>"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.name)&&"object"===typeof(null===e||void 0===e?void 0:e.fluid);function _(e,t,r,o){var n;const i=new URL(e),s=r||(null!==(n=t.dataStorePath)&&void 0!==n?n:"");return(0,f.Cu)(i,{siteUrl:t.siteUrl,driveId:t.driveId,itemId:t.itemId,dataStorePath:s,appName:t.appName,containerPackageName:o,fileVersion:t.fileVersion,context:t.context}),i.href}function H(e){let t;return t=e&&"name"in e?e.name:R(null===e||void 0===e?void 0:e.package)?null===e||void 0===e?void 0:e.package.name:null===e||void 0===e?void 0:e.package,t}},71724:e=>{"use strict";function t(e){if(this._capacity=o(e),this._length=0,this._front=0,r(e)){for(var t=e.length,n=0;n<t;++n)this[n]=e[n];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),r=this._front,o=this._capacity,n=0;n<e;++n)t[n]=this[r+n&o-1];return t},t.prototype.push=function(e){var t=arguments.length,r=this._length;if(t>1){var o=this._capacity;if(r+t>o){for(var n=0;n<t;++n){this._checkCapacity(r+1),this[i=this._front+r&this._capacity-1]=arguments[n],r++,this._length=r}return r}for(var i=this._front,n=0;n<t;++n)this[i+r&o-1]=arguments[n],i++;return this._length=r+t,r+t}return 0===t?r:(this._checkCapacity(r+1),this[n=this._front+r&this._capacity-1]=e,this._length=r+1,r+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,r=this[t];return this[t]=void 0,this._length=e-1,r}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,r=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,r}},t.prototype.unshift=function(e){var t=this._length,r=arguments.length;if(r>1){if(t+r>(n=this._capacity)){for(var o=r-1;o>=0;o--){this._checkCapacity(t+1);var n=this._capacity;this[s=(this._front-1&n-1^n)-n]=arguments[o],t++,this._length=t,this._front=s}return t}var i=this._front;for(o=r-1;o>=0;o--){var s;this[s=(i-1&n-1^n)-n]=arguments[o],i=s}return this._front=i,this._length=t+r,t+r}if(0===r)return t;this._checkCapacity(t+1);n=this._capacity;return this[o=(this._front-1&n-1^n)-n]=e,this._length=t+1,this._front=o,t+1},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var r=this._length;if(t<0&&(t+=r),!(t<0||t>=r))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,r=this._capacity,o=0;o<e;++o)this[t+o&r-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(o(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var r=this._front,o=this._length;r+o>t&&function(e,t,r,o,n){for(var i=0;i<n;++i)r[i+o]=e[i+t],e[i+t]=void 0}(this,0,this,t,r+o&t-1)};var r=Array.isArray;function o(e){if("number"!==typeof e){if(!r(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}e.exports=t},72376:(e,t,r)=>{"use strict";r.d(t,{N$:()=>d,_9:()=>s});var o=r(27051),n=r(37805),i=r(93537);const s={maxRetries:2,backoffFn:(0,n.FT)(500),filter:(0,i.sC)([408,409,503]),respectRetryAfterHeader:!0},a={queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},c={preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function d(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r="Consumer"===e.identityType?c:a;return(0,o.A)((0,o.A)({},r),{},{preferAuthorizationInMultipartFormBody:t})}},73370:(e,t,r)=>{"use strict";r.d(t,{p:()=>a,Y:()=>s});var o=r(27051),n=r(51238);function i(e,t,r){e.headers instanceof Headers?e.headers.set(t,r):e.headers=(0,o.A)((0,o.A)({},e.headers),{},{[t]:r})}const s="Bearer";function a(e,t,r,a,c){const d=new URL(e),l=a.startsWith(s);let u=!1;l&&c.queryParam&&(d.searchParams.set(c.queryParam,r),u=!c.doNotExceedQueryParamsLength||d.search.length<=c.doNotExceedQueryParamsLength,u||d.searchParams.delete(c.queryParam));let h=t;if(!u){h=(0,o.A)({},t);let e=!1;if(l){const r=null!==t&&void 0!==t&&t.method?t.method.toUpperCase():"GET";if(c.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(r)){h.method="POST";const o=(0,n.A)(),s=[];s.push("--".concat(o)),s.push("Authorization: ".concat(a)),s.push("X-HTTP-Method-Override: ".concat(r)),s.push("_post: 1"),null!==t&&void 0!==t&&t.body&&s.push("\r\n".concat(t.body,"\r\n")),s.push("\r\n--".concat(o,"--"));const l=s.join("\r\n");e=!c.doNotExceedMultipartFormBodyLength||l.length<=c.doNotExceedMultipartFormBodyLength,e&&(h.body=l,i(h,"Content-Type","multipart/form-data;boundary=".concat(o)),d.searchParams.set("ump","1"))}}e||i(h,"Authorization",a)}return{url:d.href,request:h}}},73895:(e,t,r)=>{"use strict";function o(){return"undefined"!==typeof window&&!(!window.document||!window.document.createElement)}r.d(t,{S:()=>o})},74405:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});const o=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function n(e){const t={};return null!==e&&void 0!==e&&e.headers&&o.forEach(r=>{const o=e.headers.get(r.headerName);o&&(t[r.logName]=o)}),t}},74411:(e,t,r)=>{"use strict";r.d(t,{o:()=>s,V:()=>a});var o=r(16135);const n={Automation:"https://res.cdn.office.net/fluid/prod",Development:"https://res-sdf.cdn.office.net/fluid/stg",DoD:"https://res-dod.cdn.office.net/fluid/dod",Dogfood:"https://res.cdn.office.net/fluid/df",GCC:"https://res.cdn.office.net/fluid/gcc","GCC-High":"https://res-gcch.cdn.office.net/fluid/gcch",Local:"https://res.cdn.office.net/fluid/prod",Microsoft:"https://res.cdn.office.net/fluid/prod",Preview:"https://res.cdn.office.net/fluid/prod",Production:"https://res.cdn.office.net/fluid/prod",Staging:"https://res-sdf.cdn.office.net/fluid/stg",SyntheticTraffic:"https://res.cdn.office.net/fluid/prod",USNat:"",USSec:"",Bleu:"",Delos:"",Gallatin:"https://res-cn.cdn.partner.office365.cn/fluid/gallatin"},i={Automation:"https://res-sdp.public.cdn.office.net/fluid/prod",Development:"https://res-sdp.sdf.cdn.office.net/fluid/stg",DoD:"https://res-sdp.dod.cdn.office.net/fluid/dod",Dogfood:"https://res-sdp.public.cdn.office.net/fluid/df",GCC:"https://res-sdp.gcc.cdn.office.net/fluid/gcc","GCC-High":"https://res-sdp.gcch.cdn.office.net/fluid/gcch",Local:"https://res-sdp.public.cdn.office.net/fluid/prod",Microsoft:"https://res-sdp.public.cdn.office.net/fluid/prod",Preview:"https://res-sdp.public.cdn.office.net/fluid/prod",Production:"https://res-sdp.public.cdn.office.net/fluid/prod",Staging:"https://res-sdp.sdf.cdn.office.net/fluid/stg",SyntheticTraffic:"https://res-sdp.public.cdn.office.net/fluid/prod",USNat:"",USSec:"",Bleu:"",Delos:"",Gallatin:""};function s(e){const t=(0,o.mo)(null!==e&&void 0!==e?e:"Prod");return r=t.audience,n[r];var r}function a(e){const t=(0,o.mo)(null!==e&&void 0!==e?e:"Prod");return r=t.audience,i[r];var r}},75097:(e,t,r)=>{"use strict";r.d(t,{M:()=>u});var o,n=r(56851),i=r(50406),s=r(29900),a=r(90589),c=function(e){var t="Error",r=[];return r.push((0,a.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),r.push((0,a.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&r.push((0,a.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&r.push((0,a.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&r.push((0,a.Ug)("".concat(t,".Count"),e.count)),r},d=r(82770),l=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var u=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.baseCv=function(){if(!o){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],r=0;r<22;r++)t.push(e.charAt(Math.floor(64*Math.random())));o=new l(t.join(""))}return o}(),i}return(0,n.__extends)(t,e),t.prototype.createActivity=function(e){return(0,s.E)({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,r,o){return this.sendTelemetryEvent({eventName:e,eventContract:{name:d.Il.contractName,dataFields:d.Il.getFields(t)},dataFields:r,eventFlags:o})},t.prototype.sendError=function(e){var t=c(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return(0,s.E)({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(i.GV)},75335:(e,t,r)=>{"use strict";r.d(t,{WN:()=>u,xl:()=>l,yb:()=>d});const o=new Map;let n=!1,i=0;function s(){if(document.hidden){const e=Date.now();o.forEach((t,r)=>{-1===t&&o.set(r,e)}),a()}}function a(){n=!1,document.removeEventListener("visibilitychange",s)}function c(e){document.hidden?o.set(e,0):(n||(n=!0,document.addEventListener("visibilitychange",s)),o.set(e,-1))}function d(){return i+=1,c(i),i}function l(e,t){const r=o.get(e);return t&&u(e),r}function u(e){o.delete(e),0===o.size&&n&&a()}},75368:(e,t,r)=>{"use strict";r.d(t,{$3:()=>y,A8:()=>k,Ft:()=>A,GO:()=>l,HA:()=>o,HY:()=>N,Jv:()=>I,KS:()=>n,MK:()=>D,PC:()=>B,Ph:()=>s,Py:()=>w,RG:()=>c,Tl:()=>b,UJ:()=>d,Xc:()=>u,Z6:()=>E,_w:()=>F,bG:()=>S,bh:()=>m,fM:()=>f,hL:()=>P,i5:()=>a,j4:()=>i,k4:()=>v,kW:()=>g,kx:()=>h,rf:()=>C,v3:()=>p,xH:()=>T});const o="Card",n="Code",i="Copilot",s="Date",a="Image",c="List",d="Person",l="RichText",u="Tabular",h="Task",g="URL",p="application/vnd.microsoft.card.adaptive",f="application/vnd.microsoft.card.hero",m="application/vnd.microsoft.card.thumbnail",v="application/vnd.microsoft.teams.card.o365connector",y="SignInCard",b="JITInstallCard",S="ErrorCard",C="Label",k="Quote",w="Callout",P="application/vnd.microsoft.activity.loginRequest",T="TokenProvider",E="SettingsProvider",I="CardChannelProvider",N="MetaOSProvider",A="UrlHandlerProvider",F="LinkService",D="OfficePolicyProvider",B="FileMetaTagProvider"},75460:(e,t,r)=>{"use strict";r.d(t,{c:()=>o});class o{constructor(){this[Symbol.toStringTag]="Deferred",this.isPending=!0,this.p=new Promise((e,t)=>{this.res=e,this.rej=t})}then(e,t){return this.p.then(e,t)}catch(e){return this.p.catch(e)}resolve(e){this.isPending=!1,this.res(e)}reject(e){this.isPending=!1,this.rej(e)}pending(){return this.isPending}finally(e){return this.p.finally(e)}}},75812:(e,t,r)=>{"use strict";r.d(t,{R:()=>s});var o=r(27051),n=r(93537),i=r(47373);function s(e,t,r,o,i,s){let c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=arguments.length>7?arguments[7]:void 0;return(0,n.J5)(e,t,s,c).then(async e=>o&&r?((!i&&e.result.ok||!e.result.ok)&&await a(r,!0,e.result,e.tries.length+1,o,d),await Promise.all(e.tries.map(async(e,t)=>await a(r,!1,e,t+1,o,d))),e):e)}async function a(e,t,r,n,s,a){var c;const d=a&&await a(r,t).catch(()=>({getAdditionalPropsError:!0}));(0,i.Ot)(s,(0,o.A)({subCategory:"Request",eventName:e,isFinalAttempt:t,status:r.status,durationMs:r.durationMs,size:(null===(c=r.headers)||void 0===c?void 0:c.get("Content-Length"))||-1,attempt:n},d))}},75964:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var o=r(47373);function n(e,t,r){try{return JSON.parse(e,t)}catch(n){return void(r&&(0,o.hO)(r.logger,r.event,n))}}},76522:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let o=0,n=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(o++,"%c"===e&&(n=o))}),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(35237)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},76528:(e,t,r)=>{"use strict";r.d(t,{_y:()=>n,eP:()=>o});const o=()=>"undefined"===typeof window,n=()=>{var e;return!(null===(e=window.chrome)||void 0===e||!e.webview)}},76899:(e,t,r)=>{"use strict";r.d(t,{Fr:()=>d});var o=r(76528);let n,i,s;const a=function(){return void 0===n&&(n=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),n},c=function(){if(void 0===i){const e=navigator.userAgentData;i=null!==e&&void 0!==e&&e.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return i},d=function(){if((0,o.eP)())return!1;if(void 0===s){const e=navigator.userAgentData;if(null!==e&&void 0!==e&&e.mobile)return!0;s=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||a()||c()}return s}},77432:(e,t,r)=>{"use strict";r.d(t,{F:()=>y});const o="https://hubblecontent.osi.office.net/contentsvc/",n="https://cdn.hubblecontent.osi.office.net/",i={aadAuthority:"https://login.microsoftonline.us",loki:"https://dod.loki.office365.us",graph:"https://dod-graph.microsoft.us",substrate:"https://substrate-dod.office365.us",outlook:"https://outlook-dod.office365.us",augloop:"https://augloop.dod.online.office365.us",augloopOld:"https://augloop.dod.online.office365.us",ocps:"https://clients.config.dod.office365.us",fs:"https://fs.microsoft.com",editor:"nleditor.osi.apps.mil",editorSynonyms:"editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.apps.mil/ocs",ecs:"https://config.ecs.dod.teams.microsoft.us",project:"https://project.apps.mil/",teamsTasks:"",plannerOld:"https://tasks.osi.apps.mil",plannerNew:"",centro:"",iris:"",teams:"https://dod.teams.microsoft.us",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"",roaming:"https://roaming.osi.apps.mil",roamingToken:"https://api.osi.apps.mil",mruToken:"https://api.osi.apps.mil"},s={aadAuthority:"https://login.microsoftonline.us",loki:"https://gcchigh.loki.office365.us",graph:"https://graph.microsoft.us",substrate:"https://substrate.office365.us",outlook:"https://outlook.office365.us",augloop:"https://augloop.gov.online.office365.us",augloopOld:"https://augloop.gov.online.office365.us",ocps:"https://clients.config.high.office365.us",fs:"https://fs.microsoft.com",editor:"nleditor.osi.office365.us",editorSynonyms:"editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.office365.us/ocs",ecs:"https://config.ecs.gov.teams.microsoft.us",project:"https://project.office365.us",plannerOld:"https://tasks.office365.us",plannerNew:"",teamsTasks:"",centro:"",iris:"",teams:"https://gov.teams.microsoft.us",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"",roaming:"https://roaming.osi.office365.us",roamingToken:"https://api.osi.office365.us",mruToken:"https://api.osi.office365.us"},a={aadAuthority:"https://login.microsoftonline.com",loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",substrate:"https://substrate.office.com",outlook:"https://outlook.office.com",augloop:"https://gcc.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-gcc.office.com",ocps:"https://clients.config.gcc.office.net",fs:"https://fs.microsoft.com",editor:"nleditor.gcc.osi.office365.us",editorSynonyms:"editor-gccm-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.officeapps.live.com/ocs",ecs:"https://ecs.office.com",project:"https://gcc.project.microsoft.com",teamsTasks:"https://tasks.gcc.teams.microsoft.com",plannerOld:"https://tasks.office.com",plannerNew:"",centro:"",iris:"",teams:"https://teams.microsoft.com",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},c={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.eaglex.ic.gov",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.osi.eaglex.ic.gov",roamingToken:"https://officeapps.live.com",mruToken:"https://officeapps.live.com"},d={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.microsoft.scloud",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.osi.microsoft.scloud",roamingToken:"https://officeapps.live.com",mruToken:"https://officeapps.live.com"},l={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://sip.clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},u={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},h={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},g={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},p={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming-df.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},f={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},m={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:o,hubbleStorage:n,toDo:"https://to-do.office.com",roaming:"https://roaming.officeapps.live.com",roamingToken:"https://api.office.net",mruToken:"https://api.office.net"},v={aadAuthority:"https://login.chinacloudapi.cn",loki:"https://loki.office365.cn",graph:"https://microsoftgraph.chinacloudapi.cn",substrate:"https://substrate.partner.outlook.cn",outlook:"https://outlook.partner.outlook.cn",augloop:"https://augloop.microsoftonline.cn",augloopOld:"https://augloop.microsoftonline.cn",ocps:"",fs:"https://fs.microsoft.com",editor:"",editorSynonyms:"",mru:"https://ocws.officeapps.partner.office365.cn/ocs",ecs:"https://mooncake.ecs.office.com",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:"",toDo:"",roaming:"https://roaming.officeapps.partner.office365.cn",roamingToken:"https://api.partner.office365.cn",mruToken:"https://api.partner.office365.cn"};function y(e,t){switch(t){case"Local":return l[e];case"Automation":return u[e];case"Development":return h[e];case"Staging":return g[e];case"SyntheticTraffic":case"Dogfood":return p[e];case"Microsoft":return m[e];case"Preview":case"Production":return f[e];case"GCC":return a[e];case"GCC-High":return s[e];case"DoD":return i[e];case"USNat":return c[e];case"USSec":return d[e];case"Gallatin":return v[e];case"Bleu":case"Delos":throw new Error("Unsupported audience: ".concat(t))}}},77565:(e,t,r)=>{"use strict";function o(e){throw new Error(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unreachable Case")}r.d(t,{$:()=>o})},78632:(e,t,r)=>{"use strict";function o(e,t){return new Promise(r=>{const o=setTimeout(()=>r(),e);null===t||void 0===t||t.addEventListener("abort",()=>{clearTimeout(o),r()})})}function n(e,t){const r=o(e).then(e=>!0),n=t.map(e=>e.then(e=>!1).catch(e=>!1));return Promise.race([r,...n])}r.d(t,{c:()=>o,t:()=>n})},78702:(e,t,r)=>{"use strict";var o,n;r.d(t,{Qq:()=>i,Tp:()=>n,hB:()=>o}),function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity",e.DNM="DNM"}(o||(o={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(n||(n={}));const i={Bool:"Bool",Int64:"Int64",Double:"Double"}},78796:(e,t,r)=>{"use strict";r.d(t,{W:()=>n,i:()=>o});const o="https://my.microsoftpersonalcontent.com",n="https://1drv.ms"},78945:(e,t,r)=>{"use strict";r.d(t,{I:()=>n,d:()=>o});class o{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}class n{get[Symbol.toStringTag](){return"[object LazyPromise]"}constructor(e){this.execute=e}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},81793:(e,t,r)=>{"use strict";r.d(t,{N2:()=>i});var o=r(41395),n=r(37513);function i(e){if("object"===typeof e){const t=e;if(function(e){return e.errorType===o.E.outOfStorageError}(t))return o.E.outOfStorageError;if(function(e){return e.errorType===o.E.invalidFileNameError}(t))return o.E.invalidFileNameError;if(function(e){return e.errorType===o.E.snapshotTooBig}(t))return o.E.snapshotTooBig;if(function(e){return e.errorType===o.E.fetchTimeout}(t))return o.E.fetchTimeout;if(function(e){return e.errorType===o.E.fluidNotEnabled}(t))return o.E.fluidNotEnabled;if(function(e){return e.errorType===n.a.fileOverwrittenInStorage}(t))return n.a.fileOverwrittenInStorage}}},81918:(e,t,r)=>{"use strict";async function o(){return Promise.all([r.e(97950),r.e(57833),r.e(50924)]).then(r.bind(r,60724))}async function n(){return Promise.all([r.e(5899),r.e(2440)]).then(r.bind(r,36713))}async function i(){return Promise.all([r.e(97950),r.e(63843),r.e(26922),r.e(5053),r.e(66859),r.e(46548),r.e(53312),r.e(19779)]).then(r.bind(r,98123))}r.d(t,{Al:()=>n,Cw:()=>o,vJ:()=>i})},82645:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});var o=r(75097),n=r(60119);const i=function(){const e=new o.M;return e.addSink(n.a),e.setTenantToken("Office.Extensibility","db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",1755),e}()},82770:(e,t,r)=>{"use strict";r.d(t,{EW:()=>p,Il:()=>l,KJ:()=>u,Kz:()=>C,Nn:()=>m,OD:()=>c,ay:()=>g,qw:()=>f,rh:()=>h});var o=r(90589);function n(e,t){return e?e+"."+t:t}function i(e,t,r,i,s){void 0===s&&(s=4),i&&e.push((0,o.m9)("".concat(n(t,r)),i,s))}function s(e,t,r,i){"boolean"===typeof i&&e.push((0,o.LK)("".concat(n(t,r)),i))}function a(e,t,r,i){if("number"===typeof i){var s=Math.round(i);e.push((0,o.Ug)("".concat(n(t,r)),s))}}var c,d=function(e){var t="Activity.Result",r=[];return a(r,t,"Code",e.code),i(r,t,"Type",e.type),a(r,t,"Tag",e.tag),s(r,t,"IsExpected",e.isExpected),r.push((0,o.m9)("zC.Activity.Result","Office.System.Result")),r},l={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return i(r,t,"CV",e.cV),a(r,t,"Duration",e.duration),a(r,t,"Count",e.count),a(r,t,"AggMode",e.aggMode),s(r,t,"Success",e.success),e.result&&r.push.apply(r,d(e.result)),r.push((0,o.m9)("zC.Activity",this.contractName)),r}},u={getFields:function(e){var t="User",r=[];return i(r,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(r,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(r,t,"TenantId",e.tenantId,1),i(r,t,"TenantGroup",e.tenantGroup,1),s(r,t,"IsAnonymous",e.isAnonymous),s(r,t,"IsSignedIn",e.isSignedIn),i(r,t,"TelemetryRegion",e.telemetryRegion),r}},h={getFields:function(e,t){var r=[];return i(r,e,"Name",t.name),i(r,e,"State",t.state),r}},g={getFields:function(e){var t="UserAction",r=[];return a(r,t,"Id",e.id),i(r,t,"Name",e.name),i(r,t,"CommandSurface",e.commandSurface),i(r,t,"ParentName",e.parentName),i(r,t,"TriggerMethod",e.triggerMethod),a(r,t,"TimeOffsetMs",e.timeOffsetMs),r}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.Mac="Mac",e.iOS="iOS",e.Android="Android"}(c||(c={}));var p,f={getFields:function(e){var t="App",r=[];return i(r,t,"Name",e.name,1),i(r,t,"Platform",e.platform,1),i(r,t,"Version",e.version,1),r}},m={getFields:function(e){var t="Session",r=[];return i(r,t,"Id",e.id,1),i(r,t,"EcsETag",e.ecsETag,1),r}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(p||(p={}));var v,y,b,S,C={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas",e.SuggestionsPane="Suggestions Pane",e.Backstage="Backstage"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),e.getFields=function(e){var r=[];return i(r,t,"FeatureActionType",e.featureActionType),s(r,t,"IsUserInitiated",e.isUserInitiated),i(r,t,"FeatureName",e.featureName),i(r,t,"SubFeatureName",e.subFeatureName),i(r,t,"Capability",e.capability),s(r,t,"IsThumbsUp",e.isThumbsUp),i(r,t,"EntryPoint",e.entryPoint),i(r,t,"Verb",e.verb),i(r,t,"InteractionId",e.interactionId),i(r,t,"ConversationId",e.conversationId),r.push((0,o.m9)("zC.".concat(t),"Office.System.Copilot")),r}}(v||(v={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var r=[];return i(r,t,"EventType",e.eventType),i(r,t,"Pillar",e.pillar),i(r,t,"Scenario",e.scenario),i(r,t,"Veto",e.veto),i(r,t,"Error",e.error),s(r,t,"InStaging",e.inStaging),s(r,t,"IsSessionEndingError",e.isSessionEndingError),s(r,t,"IsIntentional",e.isIntentional),s(r,t,"IsInternal",e.isInternal),r.push((0,o.m9)("zC.".concat(t),"Office.System.Asha")),r}}(y||(y={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push((0,o.m9)("".concat(e,".Name"),t.name)),void 0!==t.platform&&r.push((0,o.m9)("".concat(e,".Platform"),t.platform)),void 0!==t.version&&r.push((0,o.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push((0,o.m9)("".concat(e,".SessionId"),t.sessionId)),void 0!==t.immediateHost&&r.push((0,o.m9)("".concat(e,".ImmediateHost"),t.immediateHost)),void 0!==t.subModuleName&&r.push((0,o.m9)("".concat(e,".SubModuleName"),t.subModuleName)),void 0!==t.context&&r.push((0,o.m9)("".concat(e,".Context"),t.context)),void 0!==t.referrer&&r.push((0,o.m9)("".concat(e,".Referrer"),t.referrer)),r}}(b||(b={})),function(e){var t="ContentIdentifier";e.getFields=function(e){var r=[];return r.push((0,o.m9)("".concat(t,".ContentType"),e.contentType)),r.push((0,o.m9)("".concat(t,".ContentId"),e.contentId)),void 0!==e.subContentType&&r.push((0,o.m9)("".concat(t,".SubContentType"),e.subContentType)),void 0!==e.subContentId&&r.push((0,o.m9)("".concat(t,".SubContentId"),e.subContentId)),r.push((0,o.m9)("zC.".concat(t),"Office.System.ContentIdentifier")),r}}(S||(S={}))},82963:(e,t,r)=>{"use strict";r.d(t,{c:()=>b,M:()=>y});var o=r(47373);const n=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],i=["https://res-gcch.cdn.office.net","https://whiteboard.office365.us"],s=["https://res-dod.cdn.office.net","https://whiteboard.apps.mil"],a=["https://res-cn.cdn.partner.office365.cn"],c=["https://whiteboard.eaglex.ic.gov"],d=["https://whiteboard.microsoft.scloud"],l=[...n,...i,...s,...c,...d,...a],u=[{origin:["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],paths:["fluid/dev","fluid/df","fluid/stg","fluid/prod","fluid/gcc","fluid/gcch","fluid/dod","fluid/local-redirect-container"]},{origin:["https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com"],paths:void 0}],h=[{origin:["https://res-gcch.cdn.office.net"],paths:["fluid/gcch"]},{origin:["https://whiteboard.office365.us"],paths:void 0}],g=[{origin:["https://res-dod.cdn.office.net"],paths:["fluid/dod"]},{origin:["https://whiteboard.apps.mil"],paths:void 0}],p=[{origin:["https://res-cn.cdn.partner.office365.cn"],paths:["fluid/gallatin"]}],f=[{origin:["https://whiteboard.eaglex.ic.gov"],paths:void 0}],m=[{origin:["https://whiteboard.microsoft.scloud"],paths:void 0}],v=[...u,...h,...g,...f,...m,...p],y=(e,t)=>{var r;if(null!==(r=null===t||void 0===t?void 0:t.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0))&&void 0!==r&&!r)return v;switch(e){case"GccHigh":return h;case"DoD":return g;case"USNat":return f;case"USSec":return m;case"Gallatin":return p;default:return u}},b=(e,t,r)=>{var u;if(null===(u=null===t||void 0===t?void 0:t.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0))||void 0===u||u){let t;switch(e){case"DoD":t=s;break;case"GccHigh":t=i;break;case"USNat":t=c;break;case"USSec":t=d;break;case"Gallatin":t=a;break;default:t=n}return r&&((0,o.Ot)(r,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===t.length&&(0,o.hO)(r,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),t}return l}},83125:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var o=r(27051);class n{get NamespaceLogger(){return this}get PersistedProperties(){return this}get Disposable(){return this}dispose(){this.logger=null}constructor(e,t,r){if(this.namespace=e,t instanceof n){const e=(0,o.A)((0,o.A)({},t.getPersistedProperties()),r);this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=r;this.baseLogger=t}addPersistedProperties(e){this.persistedProperties=(0,o.A)((0,o.A)({},this.getPersistedProperties()),e)}getPersistedProperties(){var e,t;return(0,o.A)((0,o.A)({},null===(e=this.baseLogger.PersistedProperties)||void 0===e||null===(t=e.getPersistedProperties)||void 0===t?void 0:t.call(e)),this.persistedProperties)}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){var r;null===(r=this.logger)||void 0===r||r.sendWithNamespace((0,o.A)((0,o.A)({},this.persistedProperties),e),t)}getNamespace(){return this.namespace}}},83397:(e,t,r)=>{"use strict";r.d(t,{N:()=>i});var o=r(47373);const n=["mousemove","keydown","wheel","DOMMouseScroll","mouseWheel","mousedown","touchstart","touchmove","MSPointerDown","MSPointerMove","visibilitychange"];class i{constructor(e,t,r){this.timeoutMs=e,this.onUserActivityStateChange=t,this.logger=r,this.isActive=!0,this.userActivityCallback=()=>{this.onUserActivityDetected()},n.forEach(e=>{document.addEventListener(e,this.userActivityCallback,{passive:!0,capture:!1})}),this.startUserInactiveTimer()}get isUserActive(){return this.isActive}dispose(){this.isActive=!0,clearTimeout(this.userInactiveTimerId),n.forEach(e=>{document.removeEventListener(e,this.userActivityCallback,{capture:!1})})}onUserActivityDetected(){this.isActive||(this.isActive=!0,this.onUserActivityStateChange(!0),this.logger&&(0,o.Ot)(this.logger,{eventName:"UserActive"})),this.resetUserInactiveTimer()}resetUserInactiveTimer(){clearTimeout(this.userInactiveTimerId),this.startUserInactiveTimer()}startUserInactiveTimer(){this.userInactiveTimerId=setTimeout(()=>{this.isActive=!1,this.onUserActivityStateChange(!1),this.logger&&(0,o.Ot)(this.logger,{eventName:"UserInactive"})},this.timeoutMs)}}},83533:(e,t,r)=>{"use strict";r.d(t,{X:()=>i,f:()=>n});const o=e=>"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties)&&"function"===typeof(null===e||void 0===e?void 0:e.addTelemetryProperties),n=e=>"string"===typeof(null===e||void 0===e?void 0:e.errorInstanceId);function i(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&n(e)&&o(e)}},83736:(e,t,r)=>{"use strict";r.d(t,{b:()=>d});var o=r(45799),n=r(31482),i=r(91608),s=r(96826);const a={10:"#050106",20:"#211029",30:"#37154A",40:"#4A1866",50:"#5E1984",60:"#7219A2",70:"#802CB0",80:"#8D40B7",90:"#9853BE",100:"#A465C5",110:"#AF76CC",120:"#BA88D3",130:"#C59ADA",140:"#D0ABE1",150:"#DABDE7",160:"#E5CFEE"},c={10:"#020304",20:"#14171D",30:"#1E2631",40:"#263241",50:"#2F3E53",60:"#384B65",70:"#405878",80:"#49668B",90:"#52749F",100:"#5C82B3",110:"#6590C7",120:"#6E9FDC",130:"#7CAEEE",140:"#96BCF2",150:"#AECAF5",160:"#C5D9F8"};function d(e,t){let r;"OneNote"===e&&(r=a),"Word"===e&&(r=c);const d=r?(0,o.a)(r):n.o,l=r?(0,i.W)(r):s.C;return{fluentThemeV9:t?l:d,brandVariants:r}}},84295:(e,t,r)=>{"use strict";r.d(t,{jB:()=>m,TX:()=>h,qw:()=>p,Q3:()=>y,lJ:()=>v});var o=r(27051),n=r(87804),i=r(54813),s=r(93586),a=r(27250),c=r(39521);const d="2.23.0";var l=r(68194);const u="Bearer";const h=712,g="serviceReadOnly";function p(e){const t={sprequestduration:(0,a.ZK)(e.get("sprequestduration")),contentsize:(0,a.ZK)(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach(r=>{const o=e.get(r.headerName);void 0!==o&&null!==o&&(t[r.logName]=o)});const r=e.get("x-fluid-telemetry");if(void 0!==r&&null!==r){t.xFluidTelemetry=r;const e=r.split(",").map(e=>e.split("="));for(const[r,o]of e)if("Origin"===r.trim()){let e;switch(null===o||void 0===o?void 0:o.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=null===o||void 0===o?void 0:o.trim()}t["responseOrigin"]=e;break}}return t}class f extends c.iq{constructor(e,t,r){super(e,r,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=n.a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function m(e,t,r,a,c){var m;let v,y=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const b=function(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=null===e||void 0===e?void 0:e.error;return"string"===typeof(null===t||void 0===t?void 0:t.message)&&(void 0===(null===t||void 0===t?void 0:t.code)||"string"===typeof(null===t||void 0===t?void 0:t.code))}(t))return{success:!0,errorResponse:t}}}catch(t){}return{success:!1}}(c);let S,C,k;if(b.success){const e=b.errorResponse;y.responseMessage=e.error.message,S=function(e){const t=[];let r=e.error;for(;"object"===typeof r&&null!==r;)void 0!==r.code&&t.unshift(r.code),r=r.innerError;return t}(e),void 0!==S&&(C=S[0],y.innerMostErrorCode=C)}const w=(0,o.A)({driverVersion:d,statusCode:t},y);switch(t){case 301:case 302:case 303:case 307:case 308:if(k=null!==(m=null===a||void 0===a?void 0:a.headers.get("Location"))&&void 0!==m?m:void 0,void 0!==k){v=new f(e,k,w);break}case 400:if("fluidInvalidSchema"===C){v=new i.d8(e,w);break}v=new i.OI(e,n.a.genericNetworkError,w);break;case 401:case 403:if(C===g)v=new i.dw(e,s.E.serviceReadOnly,w);else if("blockedIPAddress"===C||"conditionalAccessPolicyEnforced"===C)v=new i.OI("IP Address is blocked",s.E.blockedIPAddress,w);else{const t=null!==a&&void 0!==a&&a.headers?function(e){const t=e.get("www-authenticate");if(!t)return;let r,o=!1;return t.split(",").map(e=>{const t=e.split("=");t.length>=2&&(o||"error"!==t[0].trim().toLowerCase()?r||"claims"!==t[0].trim().toLowerCase()||(r=(0,l.AH)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):o="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))}),o?r:void 0}(a.headers):void 0,r=null!==a&&void 0!==a&&a.headers?function(e){const t=e.get("www-authenticate");if(!t)return;const r=t.indexOf(u);if(r<0)return;let o;return t.substring(r+u.length).split(",").map(e=>{if(!o){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(o=JSON.parse(t[1].trim()))}}),o}(a.headers):void 0;v=new i.yi(e,t,r,w)}break;case 404:if(b.success){var P;const t=null===b||void 0===b||null===(P=b.errorResponse)||void 0===P?void 0:P.error;if(k=null===t||void 0===t?void 0:t["@error.redirectLocation"],void 0!==k){v=new f(e,k,w);break}}v=new i.OI(e,n.a.fileNotFoundOrAccessDeniedError,w);break;case 406:v=new i.OI(e,n.a.unsupportedClientProtocolVersion,w);break;case 410:v=new i.OI(e,s.E.cannotCatchUp,w);break;case 409:v=new i.OI(e,n.a.fileOverwrittenInStorage,w);break;case 412:v=new i.OI(e,n.a.genericNetworkError,w);break;case 413:v=new i.OI(e,s.E.snapshotTooBig,w);break;case 414:v=new i.OI(e,s.E.invalidFileNameError,w);break;case 423:if("resourceLocked"===C||"resourceCheckedOut"===C){v=new i.OI(e,n.a.fileIsLocked,w);break}case 500:v=new i.dw(e,n.a.genericNetworkError,w);break;case 501:v=new i.OI(e,s.E.fluidNotEnabled,w);break;case 507:v=new i.OI(e,n.a.outOfStorageError,w);break;case h:v=new i.OI(e,n.a.incorrectServerResponse,w);break;default:const t=void 0!==r?1e3*r:void 0;v=(0,i.ix)(e,{canRetry:!0,retryAfterMs:t},w)}return v.addTelemetryProperties({endpointReached:!0}),function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.online=i.WA[(0,i.sc)()],void 0!==r&&(e.facetCodes=r);if(t&&(o.responseType=t.type,t.headers)){var n;const r=p(t.headers);for(const e of Object.keys(r))o[e]=r[e];e.serverEpoch=null!==(n=t.headers.get("x-fluid-epoch"))&&void 0!==n?n:void 0}e.addTelemetryProperties(o)}(v,a,S,void 0),v}function v(e,t,r,o,n){const i=m(e,t,function(e){if(null===e)return;const t=Number(e);if(Number.isNaN(t))return;return t}(r.headers.get("retry-after")),r,o,n);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}function y(e){return Array.isArray(null===e||void 0===e?void 0:e.facetCodes)}},85038:(e,t,r)=>{"use strict";function o(e,t){e||function(e){throw new Error("number"===typeof e?"0x".concat(e.toString(16).padStart(3,"0")):e)}(t)}r.d(t,{vA:()=>o})},85851:(e,t,r)=>{"use strict";function o(e,t){"visible"===t&&requestAnimationFrame(e)}r.d(t,{F:()=>o})},85874:(e,t,r)=>{"use strict";r.d(t,{CE:()=>V,E7:()=>T,Ix:()=>x,LV:()=>i,M6:()=>F,N1:()=>M,SU:()=>L,Wy:()=>R,ZU:()=>q,e9:()=>I,gX:()=>P,hP:()=>B,i4:()=>H,jP:()=>N,md:()=>U,p3:()=>A,s5:()=>j,s7:()=>_,vY:()=>O,y6:()=>E,yg:()=>D});var o=r(48680);const n="mip.getLabel",i="mip.setLabel",s="mip.getDlp",a="mip.increaseRetries",c="mip.noDefaultOnGet",d="mip.makeVroomCall",l="mip.guestComponentInheritLabel",u="mip.filterUDPLabels",h="mip.fileIdUsedForDlpTip",g="mip.enforceReadOnlyEnabled",p="mip.enforceMandatoryLabelingEnabled",f="mip.canGetLabelIdWithoutTenantFiltering",m="mip.shouldStopIfCLPNotSupported",v="mip.newGetPolicySettings",y="mip.logEvaluateLabelRequest",b="mip.stopCallingEvaluate",S="mip.useMeInUrls",C="mip.retryOn404ForVroom",k="mip.getDefaultLabelFromLabelsCall",w="mip.assignedModeSupported";function P(e){return(0,o.AU)(n,!0,e)}function T(e){return(0,o.AU)(i,!1,e)}function E(e){return(0,o.AU)(s,!0,e)}function I(e){return(0,o.AU)(a,!0,e)}function N(e){return(0,o.AU)(c,!0,e)}function A(e){return(0,o.AU)(d,!0,e)}function F(e){return(0,o.AU)(l,!0,e)}function D(e){return(0,o.AU)(u,!0,e)}function B(e){return(0,o.AU)(h,!0,e)}function L(e){return(0,o.AU)(g,!1,e)}function O(e){return(0,o.AU)(p,!0,e)}function x(e){return(0,o.AU)(f,!0,e)}function M(e){return(0,o.AU)(m,!0,e)}function R(e){return(0,o.AU)(v,!0,e)}function _(e){return(0,o.AU)(y,!0,e)}function H(e){return(0,o.AU)(b,!0,e)}function U(e){return(0,o.AU)(S,!0,e)}function j(e){return(0,o.AU)(C,!0,e)}function q(e){return(0,o.AU)(k,!0,e)}function V(e){return(0,o.AU)(w,!0,e)}},86748:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var o=r(26631);async function n(e,t){const r=await e.readBlob(t),n=(0,o.JR)(r,"utf8");return JSON.parse(n)}},87416:(e,t,r)=>{"use strict";r.d(t,{Xd:()=>u,p7:()=>s});var o=r(78796),n=r(48116),i=r(26308);const s="-my",a="-admin",c=".sharepoint.",d=".sharepoint-df.",l=".onmicrosoft.";function u(e){const t=new URL(e);if([o.i,n.t].includes(t.origin.toLowerCase()))return"consumers";const r=t.hostname.toLowerCase(),u=(0,i.v6)(r);if(u)return u.hostname;let h=r.substring(0,r.indexOf(".")),g=r.substring(h.length),p=!1;0===g.indexOf(c)?g="".concat(l).concat(g.substring(c.length)):0===g.indexOf(d)?g="".concat(l).concat(g.substring(d.length)):p=!0,h.endsWith(s)?h=h.substring(0,h.length-s.length):h.endsWith(a)&&(h=h.substring(0,h.length-a.length));const f=p?void 0:"".concat(h).concat(g);return(0,i.b6)(r,{hostname:f}),f}},87615:(e,t,r)=>{"use strict";r.d(t,{l:()=>o});const o=()=>globalThis.performance.now()},87804:(e,t,r)=>{"use strict";r.d(t,{a:()=>d});var o=r(27051),n=r(53986),i=r(34023);const{dataCorruptionError:s,dataProcessingError:a}=i.k,c=(0,n.A)(i.k,["dataCorruptionError","dataProcessingError"]),d=(0,o.A)((0,o.A)({},c),{},{genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"})},87987:e=>{"use strict";var t,r="object"===typeof Reflect?Reflect:null,o=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise(function(r,o){function n(r){e.removeListener(t,i),o(r)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}f(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&f(e,"error",t,r)}(e,n,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function d(e,t,r,o){var n,i,s,d;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"===typeof s?s=i[t]=o?[r,s]:[s,r]:o?s.unshift(r):s.push(r),(n=c(e))>0&&s.length>n&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,d=l,console&&console.warn&&console.warn(d)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=l.bind(o);return n.listener=r,o.wrapFn=n,n}function h(e,t,r){var o=e._events;if(void 0===o)return[];var n=o[t];return void 0===n?[]:"function"===typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):p(n,n.length)}function g(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),o=0;o<t;++o)r[o]=e[o];return r}function f(e,t,r,o){if("function"===typeof e.on)o.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function n(i){o.once&&e.removeEventListener(t,n),r(i)})}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||n(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"===typeof c)o(c,this,t);else{var d=c.length,l=p(c,d);for(r=0;r<d;++r)o(l[r],this,t)}return!0},i.prototype.addListener=function(e,t){return d(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return d(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,o,n,i,s;if(a(t),void 0===(o=this._events))return this;if(void 0===(r=o[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(n=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,n=i;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(o[e]=r[0]),void 0!==o.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,o;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var n,i=Object.keys(r);for(o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},i.prototype.listeners=function(e){return h(this,e,!0)},i.prototype.rawListeners=function(e){return h(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},i.prototype.listenerCount=g,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},89092:(e,t,r)=>{"use strict";r.d(t,{FX:()=>n});var o=r(53783);function n(e){if("object"===typeof e){const t=e;if(function(e){return e.name===o.ZY.IframeLoadFailed}(t))return o.ZY.IframeLoadFailed;if(function(e){return e.name===o.ZY.ComponentNotFound}(t))return o.ZY.ComponentNotFound}}},90293:(e,t,r)=>{"use strict";r.d(t,{br:()=>ot,NK:()=>st,Wu:()=>nt,b6:()=>ct,Z:()=>tt,$r:()=>Ye,Ng:()=>rt,ig:()=>et,Sk:()=>it,ux:()=>$e,ZG:()=>Ze,OX:()=>Xe});var o=r(46212),n=r(51309),i=r(27284),s=r(39888);const a="sans-serif",c="Segoe UI",d="Segoe UI Emoji",l="--ms-themeColorHeadingText",u={Neutral:{neutralPrimary:"var(".concat("--ms-themeColorPaletteNeutralPrimary",", #323130)")}},h="--ms-themeFontFamilyHeading1",g="--ms-themeFontSizeHeading1",p="--ms-themeFontSizeHeading2",f="--ms-themeFontSizeHeading3",m="--ms-themeFontFamilyBody",v="--ms-themeFontFamilyHeading2",y="--ms-themeFontFamilyHeading3",b="--ms-themeFontSizeBody",S="--ms-themeFontWeightBody",C="--ms-themeFontWeightHeading1",k="--ms-themeFontWeightHeading2",w="--ms-themeFontWeightHeading3",P="--ms-themeColorBodyText",T="--ms-themeColorBodyBackground",E="--ms-themeMarginTopHeading1",I="--ms-themeMarginTopHeading2",N="--ms-themeMarginTopHeading3",A="--ms-themeLineHeightBody",F="--ms-themeLineHeightHeading1",D="--ms-themeLineHeightHeading2",B="--ms-themeLineHeightHeading3",L="--ms-themeOutlineBody",O="--ms-themeOutlineHeading1",x="--ms-themeOutlineHeading2",M="--ms-themeOutlineHeading3",R="--colorNeutralForeground1",_="--colorNeutralBackground1",H="--fontFamilyBase",U="--fontSizeBase300",j="--fontSizeBase500",q="--fontSizeBase600",V="--fontSizeHero800",z="--fontWeightRegular",G="--fontWeightSemibold",W="--fontWeightBold",J="--lineHeightBase400",K="--lineHeightBase500",Q="--lineHeightBase600",$="--lineHeightHero800",Z="var(".concat(H,", var(").concat(m,", ").concat(c,", ").concat(d,", ").concat(a,"))"),Y="var(".concat(R,", var(").concat(P,", ").concat(u.Neutral.neutralPrimary,"))"),X=[["Heading 1",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:"var(".concat(h,", ").concat(Z,")")}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:V,fallbackValue:"var(".concat(g,", 24px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:W,fallbackValue:"var(".concat(C,", 700)")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:l,fallbackValue:Y}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:E,fallbackValue:"24px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:$,fallbackValue:"var(".concat(F,", normal)")}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"1"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:O}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(T,", transparent)")}}]],["Heading 2",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:"var(".concat(v,", ").concat(Z,")")}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:q,fallbackValue:"var(".concat(p,", 20px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:W,fallbackValue:"var(".concat(k,", 700)")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:l,fallbackValue:Y}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:I,fallbackValue:"20px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:Q,fallbackValue:"var(".concat(D,", normal)")}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"2"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:x}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(T,", transparent)")}}]],["Heading 3",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:"--fontFamilyBaseDisplay",fallbackValue:"var(".concat(y,", ").concat(Z,")")}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:j,fallbackValue:"var(".concat(f,", 14px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:G,fallbackValue:"var(".concat(w,", 700)")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:l,fallbackValue:Y}},{name:"marginTop",cssPropertyName:"margin-top",value:{customPropertyName:N,fallbackValue:"16px"}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:K,fallbackValue:"var(".concat(B,", normal)")}},{name:"role",cssPropertyName:"role",value:"heading"},{name:"ariaLevel",cssPropertyName:"aria-level",value:"3"},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:M}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(T,", transparent)")}}]],["Body",[{name:"fontFamily",cssPropertyName:"font-family",value:{customPropertyName:H,fallbackValue:Z}},{name:"fontSize",cssPropertyName:"font-size",value:{customPropertyName:U,fallbackValue:"var(".concat(b,", 14px)")}},{name:"fontWeight",cssPropertyName:"font-weight",value:{customPropertyName:z,fallbackValue:"var(".concat(S,")")}},{name:"color",cssPropertyName:"color",value:{customPropertyName:R,fallbackValue:"var(".concat(P,", ").concat(u.Neutral.neutralPrimary,")")}},{name:"lineHeight",cssPropertyName:"line-height",value:{customPropertyName:J,fallbackValue:"var(".concat(A,", normal)")}},{name:"outline",cssPropertyName:"outline",value:{customPropertyName:L}},{name:"backgroundColor",cssPropertyName:"background-color",value:{customPropertyName:_,fallbackValue:"var(".concat(T,", transparent)")}}]]];class ee extends i.EventEmitter{get Disposable(){return this}dispose(){delete this._themeName,delete this.appThemeProperties,delete this.appTextStyles}get Theming(){return this}get themeName(){return this._themeName}set themeName(e){e!==this._themeName&&(this._themeName=e,this.emit("themeNameChanged"))}set themeProperties(e){this.setThemeProperties(new Map(e))}constructor(){super(),this.setMaxListeners(0),this.appTextStyles=new Map(X)}get StylingProvider(){return this}get themeProperties(){return this.appThemeProperties}get textStyles(){return this.appTextStyles}setThemeProperties(e){const t=this.appThemeProperties?new Map(this.appThemeProperties):void 0;this.appThemeProperties=e,this.emit(s.j.themePropertiesChanged,t)}setTextStyles(e){const t=this.appTextStyles?new Map(this.appTextStyles):void 0;this.appTextStyles=e,this.emit(s.j.textStylesChanged,t)}}var te=r(31942),re=r(27051),oe=r(53986);const ne=["category"],ie=1e4;class se{get NamespaceLogger(){return this}get PersistedProperties(){return this}constructor(e,t){this.namespace=t,this.persistentProps=e||{},this.namespace=t}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){const r=t||this.namespace;let o=(0,re.A)((0,re.A)({},this.persistentProps),e),{category:n}=o,i=(0,oe.A)(o,ne),s=!1;i.sampleEvent&&(s=Boolean(i.sampleEvent),delete i.sampleEvent);const a=Object.keys(i).length>100;"error"!==n&&"Error"!==n||(i=(e=>{let t;return"string"===typeof e.message&&e.message.length>ie&&(t="message",e.message=e.message.substr(0,ie)),"string"===typeof e.stack&&e.stack.length>ie&&(t=t?t.concat(", stack"):"stack",e.stack=e.stack.substr(0,ie)),t?(0,re.A)((0,re.A)({},e),{},{cappedFields:t}):e})(i)),this.logEvent({category:n,props:(0,re.A)((0,re.A)({},i),{},{exceedsMaxAllowedFields:a}),sampleEvent:s,namespace:r})}addPersistedProperties(e){this.persistentProps=(0,re.A)((0,re.A)({},this.persistentProps),e)}getPersistedProperties(){return(0,re.A)({},this.persistentProps)}}var ae=r(78702);const ce=new class{logEvent(e){if(e.category===ae.hB.Error)console.error("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e));else console.log("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e))}setSessionId(e){this.sessionId=e}setUserContext(e){}shutdown(){}loadFull(){return Promise.resolve()}loadAsha(){}constructor(){this.sessionId=""}};var de=r(50406),le=r(90589),ue=r(37450),he=r(12283),ge=r(82770),pe=r(93916);const fe="VetoMissingClassification",me=[{pillar:"Open",vetos:["LoadFailed"]},{pillar:"Interruptions",vetos:["UnhandledError","UnhandledRejection"]}];function ve(e){for(const t of me)if(t.vetos.includes(e))return t.pillar;return fe}const ye={token:"6a8929bcfc6d44e9b13fee392ada9cf0-4dea6a88-32c5-404b-8af1-4a43b94ef559-7393",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},be={token:"742fa5a288b045e5beab1a2b8e445a71-66618038-43f3-4a1f-a680-59d90da7d572-7251",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},Se={token:"954f09bf2c8a4321823cdeae34562b5c-d0886c33-e264-4c84-8ae5-a767e01b42cb-7479",namespacePrefix:"Office.Fluid.Workspaces"};function Ce(e){return function(){let e=!1;try{e=!!localStorage.getItem("FluidCodeDetailsOverride")}catch(t){}return e}()||function(e){return"Local"===e||"Automation"===e||"SyntheticTraffic"===e||"Development"===e}(e)?be:ye}const ke=["durationMs","succeeded","resultType"],we=["eventName","actionId","commandSurface","parentName","triggerMethod","timeOffsetMs"];class Pe{constructor(e,t,r){this.initialPersistentProps=t,this.ashaLoadStarted=!1,this.telemetryLogger=new de.GV(void 0,void 0,this.getTelemetryConfig(e)),this.telemetryLogger.partAFields.push((0,le.m9)("Loop.Audience",e)),null!==r&&void 0!==r&&r.useFluidWorkspacesAriaInfo?this.ariaInfo=Se:this.ariaInfo=Ce(e),this.telemetryLogger.setTenantToken(this.ariaInfo.namespacePrefix,this.ariaInfo.token,de.di),this.isNonProductionAudience(e)&&this.registerOtelErrorsListener()}async logEvent(e){let{namespace:t,category:r,props:o,sampleEvent:n}=e;if(r===ae.hB.UserAction)this.logUserActionEventToOtel(e);else if(r===ae.hB.Activity)this.logActivityEventToOtel(e);else if(r===ae.hB.DNM)this.ariaInfo.directNumericMeasurementToken&&this.logDNMEventToOTel(e);else{var i;if(["AshaPillarAdd","AshaPillarRemove","AshaError"].includes(o.eventName))return this.loadAsha(),void(null===(i=this.ashaUtils)||void 0===i||i.then(t=>{let{handleAshaEvent:r}=t;return r(e)}).catch(()=>{this.logDefaultEventToOtel({category:ae.hB.Error,namespace:t,props:{eventName:"".concat(o.eventName,"Failure")},sampleEvent:n})}));r===ae.hB.Error&&function(e){return"eventName"in e&&"veto"in e}(o)&&(o=function(e){var t,r,o,n,i;return(0,re.A)((0,re.A)({},e),{},{pillar:null!==(t=e.pillar)&&void 0!==t?t:ve(e.veto),isIntentional:null!==(r=e.isIntentional)&&void 0!==r&&r,isInternal:null===(o=e.isInternal)||void 0===o||o,alertOnPillar:null===(n=e.alertOnPillar)||void 0===n||n,isSessionEndingError:null!==(i=e.isSessionEndingError)&&void 0!==i&&i})}(o)),this.logDefaultEventToOtel({namespace:t,category:r,props:o,sampleEvent:n})}}shutdown(){var e;null===(e=this.ashaUtils)||void 0===e||e.then(e=>{let{shutdownAshaForFluid:t}=e;return t()}).catch(()=>{this.logDefaultEventToOtel({category:ae.hB.Error,props:{eventName:"AshaShutdownFailure"}})})}logDefaultEventToOtel(e){this.logEventToOtelInternal(e,t=>{this.prepareDefaultOtelEvent(t,e)})}logActivityEventToOtel(e){this.logEventToOtelInternal(e,t=>{this.prepareActivityOtelEvent(t,(0,re.A)({},e.props))})}logUserActionEventToOtel(e){this.logEventToOtelInternal(e,t=>{this.prepareUserActionOtelEvent(t,(0,re.A)({},e.props),e.namespace)})}logDNMEventToOTel(e){const t=e.props.eventName,r=e.props.dataName,o=e.props.dataMeasurement;if("string"!==typeof t||"string"!==typeof r||"number"!==typeof o&&"boolean"!==typeof o)return;const n={eventName:t,dataName:r,dataMeasurement:o,dataType:e.props.dataType,interval:e.props.interval};this.logDirectNumericMeasurementEvent(n)}logDirectNumericMeasurementEvent(e){const t=[];switch(e.dataType){case ae.Qq.Bool:t.push((0,le.LK)(e.dataName,e.dataMeasurement));break;case ae.Qq.Double:t.push((0,le.ip)(e.dataName,e.dataMeasurement));break;case ae.Qq.Int64:t.push((0,le.Ug)(e.dataName,e.dataMeasurement))}if(!e.eventName||0===e.eventName.length)return;const r=e.eventName[0].toUpperCase()+e.eventName.slice(1),o={telemetryProperties:{dnmToken:this.ariaInfo.directNumericMeasurementToken,dnmInterval:e.interval,dnmAllowedPartA:[3,4,5,1]},eventName:"Office.DNM.Loop."+r,eventFlags:{dataCategories:ue.o.DataCategories.ProductServicePerformance,diagnosticLevel:ue.o.DiagnosticLevel.RequiredServiceData},dataFields:t};this.telemetryLogger.sendDirectNumericEvent(o)}getTelemetryConfig(e){const t={enableQueue:!0};return this.isNonProductionAudience(e)?t:(0,re.A)((0,re.A)({},t),{},{disableValidation:!0})}isNonProductionAudience(e){return"Automation"===e||"Local"===e||"Staging"===e}registerOtelErrorsListener(){(0,he.d$)().addListener(e=>{0===e.category&&0===e.level&&console.error(e.message())})}getDataFieldsFromProps(e){const t=[];if(Object.keys(e).forEach(r=>{const o=(0,pe.R)(e[r],r);o&&t.push(o)}),e.dataFields){const r=e.dataFields;t.push(...r)}return t}logEventToOtelInternal(e,t){const r=this.getBasicOtelEvent(e);t(r),this.telemetryLogger.sendTelemetryEvent(r)}getBasicOtelEvent(e){let t=e.category&&"".concat(e.category.charAt(0).toUpperCase()).concat(e.category.substring(1));e.props.subCategory&&e.category===ae.hB.Generic&&(t+=".".concat(e.props.subCategory.charAt(0).toUpperCase()).concat(e.props.subCategory.substring(1)));let r=!1;return e.sampleEvent&&(r=e.sampleEvent),{eventName:"".concat(this.ariaInfo.namespacePrefix).concat(e.namespace?"."+e.namespace:"",".").concat(t),eventFlags:{diagnosticLevel:ue.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:r?ue.o.SamplingPolicy.Measure:void 0}}}prepareDefaultOtelEvent(e,t){e.eventFlags.dataCategories=ue.o.DataCategories.ProductServicePerformance,e.dataFields=this.getDataFieldsFromProps((0,re.A)({},t.props))}mapActivityResultTypeToCode(e){switch(e){case ae.Tp.Failure:return 0;case ae.Tp.Success:return 1;case ae.Tp.Cancelled:return 2}}prepareBaseActivityOtelEvent(e,t,r){t.durationMs||(t.durationMs=0);const o=Math.floor(1e3*t.durationMs),{durationMs:n,succeeded:i,resultType:s}=t,a=(0,oe.A)(t,ke);return e.eventContract={name:ge.Il.contractName,dataFields:ge.Il.getFields({duration:o,count:1,aggMode:0,success:i,result:!r&&s?{code:this.mapActivityResultTypeToCode(s),type:s}:void 0})},a}prepareActivityOtelEvent(e,t){const r=t.eventName;e.eventName+=".".concat(r.charAt(0).toUpperCase()).concat(r.substring(1)),e.eventFlags.dataCategories=ue.o.DataCategories.ProductServicePerformance;const o=this.prepareBaseActivityOtelEvent(e,t,!1);e.dataFields=this.getDataFieldsFromProps(o||{})}prepareUserActionOtelEvent(e,t,r){const o=t.eventName;e.eventName+=".".concat(o.charAt(0).toUpperCase()).concat(o.substring(1)),e.eventFlags.dataCategories=ue.o.DataCategories.ProductServiceUsage;const n=ge.rh.getFields("Funnel",{name:r,state:"Successful"}),i=t,s=ge.ay.getFields({id:i.actionId,name:o,commandSurface:i.commandSurface,parentName:i.parentName,triggerMethod:i.triggerMethod,timeOffsetMs:i.timeOffsetMs}),a=this.prepareBaseActivityOtelEvent(e,t,!0),{eventName:c,actionId:d,commandSurface:l,parentName:u,triggerMethod:h,timeOffsetMs:g}=a,p=(0,oe.A)(a,we);e.dataFields=[...n,...s,...this.getDataFieldsFromProps(p||{})]}loadAsha(){this.ashaLoadStarted||(this.ashaLoadStarted=!0,this.ashaUtils=r.e(59941).then(r.bind(r,93401)),this.ashaUtils.then(e=>{let{initializeAshaForFluid:t}=e;return t(this.ariaInfo.namespacePrefix,this.initialPersistentProps,e=>{delete e.eventContract,this.telemetryLogger.sendTelemetryEvent(e)})}).catch(()=>{this.ashaLoadStarted=!1,this.logDefaultEventToOtel({category:ae.hB.Error,props:{eventName:"AshaLoadFailure"}})}))}}class Te extends Pe{constructor(e,t,r,o){super(t,r,o),this.hostTelemetrySink=e,this.loadFullCalled=!1}setUserContext(e){}replaceTelemetrySink(e){this.hostTelemetrySink=e,this.telemetryLogger.telemetrySinks.pop(),this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}async loadFull(){if(!this.loadFullCalled){this.loadFullCalled=!0;try{const e=await this.hostTelemetrySink;this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}catch(e){this.logDefaultEventToOtel({category:ae.hB.Error,props:{eventName:"FailedToLoadTelemetrySink",message:"".concat(e)}})}}}}class Ee{constructor(e){this.telemetrySink=e}get Disposable(){return this}dispose(){}get LoopTelemetrySink(){return this}sendTelemetryEvent(e,t){this.telemetrySink.sendTelemetryEvent(e,t)}sendCustomerContent(e){var t,r;null===(t=(r=this.telemetrySink).sendCustomerContent)||void 0===t||t.call(r,e)}sendNonStandardEvent(e,t){var r,o;null===(r=(o=this.telemetrySink).sendNonStandardEvent)||void 0===r||r.call(o,e,t)}}var Ie=r(47373);class Ne extends Pe{constructor(e,t){const r=(0,Ie.LJ)(e.audience),o=r?t:(0,re.A)((0,re.A)({},t),{},{hostCorrelationId:""});super(e.audience,o),this.context=e,this.loadFullCalled=!1,this.allowedToLogEupi=!1,this.loopTelemetrySinkPromise=new Promise(e=>this.loopTelemetrySinkPromiseResolve=e),this.allowedToLogEupi=r,this.scrubContextIfNecessary()}getLoopTelemetrySinkPromise(){return this.loopTelemetrySinkPromise.then()}async logEvent(e){return this.allowedToLogEupi||(e.props=(0,re.A)((0,re.A)({},e.props),{},{hostCorrelationId:""})),e.category===ae.hB.Error&&(this.loadFullCalled||this.loadFull().catch(()=>{})),super.logEvent(e)}scrubContextIfNecessary(){this.allowedToLogEupi||(this.context.sessionId="",this.context.user=void 0)}setUserContext(e){var t;this.context=(0,re.A)((0,re.A)({},this.context),e),this.scrubContextIfNecessary(),null===(t=this.telemetrySink)||void 0===t||t.setPartADataFields(this.context)}shutdown(){super.shutdown(),this.loadFull().then(()=>{var e;return null===(e=this.telemetrySink)||void 0===e?void 0:e.shutdown()}).catch(()=>{})}async loadFull(){this.loadFullCalled||(this.loadFullCalled=!0,Promise.all([r.e(55307),r.e(26873)]).then(r.bind(r,14698)).then(e=>{var t;this.telemetrySink=new e.OfficeFluidOneDsSink(this.context);const r=this.telemetrySink.createOneDsSink();this.telemetryLogger.addSink(r),this.telemetryLogger.flushQueue(),null===(t=this.loopTelemetrySinkPromiseResolve)||void 0===t||t.call(this,new Ee(r))}).catch(e=>{this.logDefaultEventToOtel({category:ae.hB.Error,props:{eventName:"LoggerLoadFailure",message:e.message,stack:e.stack}})}))}}class Ae extends se{get Disposable(){return this}get PersistedProperties(){return this}getTelemetrySinkPromise(){return this.telemetrySinkPromise.then()}constructor(e){const t=e.hostTelemetryContext,r=(0,re.A)((0,re.A)({},e.persistentProps),{},{hostCorrelationId:t.hostCorrelationId,hostScenarioName:[t.hostScenarioLifecycle,t.hostScenarioName,t.hostScenarioEntryPoint].filter(e=>e).join("_"),hostName:t.hostName,hostScenarioStartTime:t.hostScenarioStartTime,loopAudience:e.audience,hostSessionId:t.hostSessionId,hostAppVersion:t.hostAppVersion,hostAppPlatform:t.hostAppPlatform});super(r,e.namespace),this.forceTelemetryToConsole=!1,this.dispose=()=>{this.logProcessors.forEach(e=>e.shutdown())},this.shutdown=()=>{this.Disposable.dispose()};const{delayLoadLogger:o,hostTelemetrySink:n}=e;this.audience=e.audience,this.logProcessors=[...e.additionalLogProcessors||[]];try{this.forceTelemetryToConsole="1"===localStorage.getItem("debugPurple"),this.forceTelemetryToConsole&&(ce.setSessionId(e.hostTelemetryContext.hostSessionId),this.logProcessors.push(ce))}catch(s){}if(n)this.telemetrySinkPromise=Promise.resolve(n).then(e=>new Ee(e)),this.logProcessors.push(new Te(n,this.audience,r,{useFluidWorkspacesAriaInfo:e.useFluidWorkspacesAriaInfo}));else{var i;this.sendWithNamespace({eventName:"HostPassedTelemetrySinkNotPassed",sinkPassed:!1,category:"Error",sampleEvent:!0},"HostPassedTelemetrySink");const o=new Ne({appPlatform:t.hostAppPlatform,appName:t.hostAppName,appVersion:t.hostAppVersion,user:null===(i=t.userContext)||void 0===i?void 0:i.user,sessionId:t.hostSessionId,audience:this.audience,uiLanguage:e.hostTelemetryContext.uiLanguage},r);this.telemetrySinkPromise=o.getLoopTelemetrySinkPromise(),this.logProcessors.push(o)}if(o||this.loadFull().catch(()=>{}),e.hostMetadata&&!e.skipInitializationLogs){const{hostMetadata:t}=e,r=t.hostFlights,o=t.hostFlightsMetadata;this.sendWithNamespace({eventName:"HostMetadata",hostRing:t.hostRing,hostFlights:r&&JSON.stringify(r),hostFlightsMetadata:o&&JSON.stringify(o),category:"Generic"},"HostMetadata")}}async loadFull(){try{await Promise.allSettled([this.logProcessors.map(e=>e.loadFull())])}catch(e){}}setUserContext(e){this.logProcessors.forEach(t=>t.setUserContext(e))}logEvent(e){this.logProcessors.forEach(t=>t.logEvent(e));if("Local"===this.audience){const t="UnhandledError"!==e.props.eventName&&"UnhandledRejection"!==e.props.eventName,r=e.category===ae.hB.Error||e.category===ae.hB.Activity&&!1===e.props.succeeded;t&&r&&!this.forceTelemetryToConsole&&console.error("OfficeFluidLogger %s %s event:",e.props.eventName,e.category,e.props,e.props.stack)}}addPersistedProperties(e){super.addPersistedProperties(e),r.e(59941).then(r.bind(r,93401)).then(t=>{let{updateAshaAdditionalPartCEventDataFromTelemetryProperties:r}=t;return r(e)}).catch(()=>{this.send({category:"Error",eventName:"AshaUpdatePartCEventDataFailure"})})}}var Fe=r(52563),De=r(63854);function Be(e){var t;t=null===e||void 0===e?void 0:e.dir,document.documentElement.setAttribute("dir",t||(0,De.Gz)(Fe.q)),document.documentElement.setAttribute("lang",(null===e||void 0===e?void 0:e.lang)||Fe.q),document.documentElement.setAttribute("translate","no")}var Le=r(58443),Oe=r(69235),xe=r(899),Me=r(64643),Re=r(56142),_e=r(91947),He=r(4311),Ue=r(6971),je=r(24921);class qe{get notify(){return this._notify}set notify(e){this._notify=e,this.notifySizeChanged()}get currentHeight(){return this.height}constructor(e,t,r,o,n){this.beforeNotify=void 0,this.useDevicePixelRatio=void 0,this.hasSizeChanged=!1,this.width=0,this.height=0,this.isNotifying=!1,this.layoutMode=te.S.fixedByHost,this._notify=!0,this.resizeObserver=void 0,this.sizeChanged=void 0,this.loopWidth=0,this.loopDiv=void 0,this.useLoopContentWidth=!1,this.savedDevicePixelRatio=0,this.beforeNotify=this.waitBeforeNotifying,this.layoutMode=t,this.notify=r,this.sizeChanged=o,this.useLoopContentWidth=null!==n&&void 0!==n&&n,this.observeResize(e)}observeWidthChangeFromLoop(e){this.useLoopContentWidth&&(this.loopDiv=e,this.updateAndNotify(this.width,this.height))}updateAndNotify(e,t){let r=0;if(this.loopDiv){const e=20,t=this.loopDiv.offsetWidth;if(r=(t+e)*(this.useDevicePixelRatio?devicePixelRatio:1),this.useDevicePixelRatio){if(this.savedDevicePixelRatio>0&&devicePixelRatio>=this.savedDevicePixelRatio){const e=this.loopWidth*devicePixelRatio/this.savedDevicePixelRatio;e>r&&(r=e)}this.savedDevicePixelRatio=devicePixelRatio}(0,Re.Rm)("content width: ".concat(t,", adjusted: ").concat(r,", devicePixelRatio: ").concat(this.savedDevicePixelRatio))}t==this.height&&r==this.loopWidth&&e==this.width||(this.width=e,this.height=t,this.loopWidth=r,this.hasSizeChanged=!0,this.notifySizeChanged())}async notifySizeChanged(){if(this.layoutMode!=te.S.fixedByHost&&!this.isNotifying)for(;this.notify&&this.hasSizeChanged;){this.hasSizeChanged=!1,this.isNotifying=!0;try{await this.beforeNotify(),this.hasSizeChanged&&(qe.isVerboseLoggingEnabled&&(0,Re.Rm)("Size changed while waiting."),this.hasSizeChanged=!1),qe.isVerboseLoggingEnabled&&(0,Re.Rm)("Notifying about size change (".concat(this.width," x ").concat(this.height,"), loopWidth: ").concat(this.loopWidth,"...")),this.useLoopContentWidth?await this.sizeChanged(this.loopWidth,this.height,this.layoutMode):await this.sizeChanged(this.width,this.height,this.layoutMode)}catch(e){}this.isNotifying=!1}}observeResize(e){this.layoutMode!=te.S.fixedByHost&&e&&(this.resizeObserver=new ResizeObserver(async e=>{await this.resizeObserverCallback(e)}),this.resizeObserver.observe(e))}async resizeObserverCallback(e){if(void 0===this.useDevicePixelRatio){var t;const e=await(0,Ue.E)();this.useDevicePixelRatio=null!==(t=null===e||void 0===e?void 0:e.useDevicePixelRatio)&&void 0!==t&&t}if(e.length>0){const t=e[e.length-1];let n,i;var r,o;if(this.useDevicePixelRatio){if(n=Math.ceil(t.contentRect.height*devicePixelRatio),i=Math.ceil(t.contentRect.width*devicePixelRatio),qe.isVerboseLoggingEnabled)(0,Re.Rm)("Device pixel ratio: ".concat(devicePixelRatio)),(0,Re.Rm)("ResizeObserverEntry:"),(0,Re.Rm)("  .contentRect =                    ".concat(t.contentRect.width," W x ").concat(t.contentRect.height," H")),null===(r=t.contentBoxSize)||void 0===r||r.forEach((e,t)=>(0,Re.Rm)("  .contentBoxSize[".concat(t,"] =              ").concat(e.inlineSize," W x ").concat(e.blockSize," H"))),null===(o=t.devicePixelContentBoxSize)||void 0===o||o.forEach((e,t)=>(0,Re.Rm)("  .devicePixelContentBoxSize[".concat(t,"] =   ").concat(e.inlineSize," W x ").concat(e.blockSize," H"))),(0,Re.Rm)("  .contentRect * devicePixelRatio = ".concat(t.contentRect.width*devicePixelRatio," W x ").concat(t.contentRect.height*devicePixelRatio," H"))}else n=Math.ceil(t.contentRect.height),i=Math.ceil(t.contentRect.width);if(this.useLoopContentWidth)return this.updateAndNotify(i,n);if(n!=this.height||i!=this.width)return this.height=n,this.width=i,this.hasSizeChanged=!0,Le.Nu||(0,Re.Rm)("Observed size change. ".concat(this.width," W x ").concat(this.height," H  (devicePixelRatio: ").concat(devicePixelRatio,")")),this.notifySizeChanged()}}setBeforeNotifyFunction(e){this.beforeNotify=e}async waitBeforeNotifying(){qe.isVerboseLoggingEnabled&&(0,Re.Rm)("Waiting for ".concat(qe.delayBeforeSizeChanged," ms before notifying about size change (").concat(this.width," x ").concat(this.height,", content width: ").concat(this.loopWidth,")...")),await(0,je.y)(qe.delayBeforeSizeChanged),qe.isVerboseLoggingEnabled&&(0,Re.Rm)("Finished waiting.")}}qe.delayBeforeSizeChanged=10,qe.isVerboseLoggingEnabled=!1;var Ve=r(60119),ze=r(90662),Ge=r(96826),We=r(31482),Je=r(98679),Ke=r(83736);class Qe extends i.EventEmitter{constructor(){super(),this.setMaxListeners(0)}get Disposable(){return this}dispose(){delete this.appThemeName,delete this.appThemeProperties}get Theming(){return this}get themeName(){return this.appThemeName}set themeName(e){e!==this.appThemeName&&(this.appThemeName=e,this.emit("themeNameChanged"))}get themeProperties(){return this.appThemeProperties}set themeProperties(e){this.appThemeProperties=e,this.emit("themePropertiesChanged")}}let $e;function Ze(e){switch(e){case"fixed":return te.S.fixedByHost;case"grow":return te.S.grow;default:return te.S.growHeight}}function Ye(e){const t=new RegExp(/\.(fluid|loop)$/,"i");return e.replace(t,"")}function Xe(e){if(!e)throw new Oe.uV("A Loop url was not provided.");let t;try{t=new URL(e)}catch(o){throw new Oe.uV("The Loop url that was provided is not a valid url.")}const r=t.protocol;if(!r||"https:"!==r.toLowerCase())throw new Oe.uV("The Loop url must use the HTTPS protocol.")}function et(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&!e.ctrlKey&&(e.preventDefault(),(0,_e.Jc)()),r&&!e.ctrlKey&&e.preventDefault()}async function tt(e){const t=(0,Fe.rv)(e.toLowerCase()),r=(0,De.Gz)(t);Be({lang:t,dir:r});const o=await(0,Me.q)(),n="OneNote"===at((0,xe.xE)().appName);return{localization:{locale:t,localeDirection:r,stringOverrides:{permissionsPanelPeopleOutsideWithLinkText:n?o.CustomPermissionsPanelPeopleOutsideWithLinkText_OneNote:o.CustomPermissionsPanelPeopleOutsideWithLinkText_Default,permissionsPanelSpecificPermissionText:n?o.CustomPermissionsPanelSpecificPermissionText_OneNote:o.CustomPermissionsPanelSpecificPermissionText_Default,permissionsPanelPeopleOutsideText:n?o.CustomPermissionsPanelPeopleOutsideText_OneNote:o.CustomPermissionsPanelPeopleOutsideText_Default,permissionsPanelSomePeopleText:n?o.CustomPermissionsPanelSomePeopleText_OneNote:o.CustomPermissionsPanelSomePeopleText_Default}},internationalizationContext:{get InternationalizationContext(){return this},uiLocale:t,defaultContentDirection:r}}}function rt(e,t,r){const o=function(e){const t={};if(null!==e&&void 0!==e&&e.audienceGroup||null!==e&&void 0!==e&&e.channel){var r,o;const n=null!==(r=null===e||void 0===e?void 0:e.audienceGroup)&&void 0!==r?r:"Unknown",i=null!==(o=null===e||void 0===e?void 0:e.channel)&&void 0!==o?o:"Unknown";t.hostRing="".concat(n,"/").concat(i)}return t}(t);return new Ae({hostTelemetryContext:e,hostTelemetrySink:Ve.a,audience:r,hostMetadata:o})}function ot(e,t,r,i){const s=(0,ze.h2)(t),a=new Map(s.properties);let c;if(r){const r=(0,Ke.b)(e,t);c=(0,Je.m)(r)}else c=(0,Je.m)({fluentThemeV9:t?Ge.C:We.o});const d=new Map;c.forEach(e=>{d.set(e.name,e.value)});const l=new Map([...d.entries(),...a.entries()]);let u,h;var g;i?(u=new Qe,u.themeProperties=l):(h=new ee,null===(g=h)||void 0===g||g.setThemeProperties(l));const p=[];for(const[o,n]of a)p.push({name:o,value:n});const f=p.concat(c),m=(0,o.x)(f),v=(0,n.w)(f);var y,b;t&&(null===(y=document)||void 0===y||null===(b=y.body)||void 0===b||b.style.setProperty("background-color",ze.kc));return{stylingProvider:h,initialTheme:m,initialThemeV9:v,theming:u}}async function nt(e,t){return await(0,He.RG)(new URL(e)).catch(e=>((0,Re.vV)("Unable to get fluid file name from Sharepoint.\n".concat((0,Oe.u1)(e))),null))||function(e){try{const t=/^.*[/\\]([^/\\]+)$/,r=new URL(e).pathname,o=t.exec(r);if(o&&o.length>1){const e=decodeURIComponent(o[1]);if(e.endsWith(Le.g4)||e.endsWith(Le.Ct))return e}}catch(t){}return null}(e)||t||""}function it(e,t){const r=document.documentElement;$e=r?new qe(r,e,!1,_e.CQ,t):void 0}function st(e){switch(e){case"Automation":case"Local":case"Staging":case"SyntheticTraffic":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Microsoft":return{audience:"Microsoft"};case"Preview":return{audience:"Preview"};case"DoD":case"GCC":case"GCC-High":case"Production":return{audience:"Production"};default:return Le.Nu||(0,Re.vV)("Audience ".concat(e," is not a known value.")),{audience:"Production"}}}function at(e){switch(e){case"Demo App":case"Demo Host":case"Fluid Preview App":case"Loop App":case"Office.com":case"OfficeMobile":case"OneNote":case"Outlook":case"Scriptor Pad":case"Teams":case"Whiteboard":case"Word":return e;default:return Le.Nu||(0,Re.Rm)('"'.concat(e,'" is not a valid app name, set to Unknown')),"Unknown"}}function ct(e,t,r,o){const n=(0,xe.xE)(),i=function(e){switch(null===e||void 0===e?void 0:e.toLowerCase()){case"android":return"Android";case"ios":return"iOS";case"mac":return"Mac";case"web":return"Web";case"win32":return"Win32";default:throw new Error('"'.concat(e,'" is not a valid app platform.'))}}(n.platform),s=at(n.appName);return(0,Re.Rm)("Fluid host context: {\n"+"  correlationId: ".concat(t,", \n")+"  hostAppName: ".concat(s," \n")+"  hostAppPlatform: ".concat(i," \n")+"  hostAppVersion: ".concat(n.appVersion,", \n")+"  scenarioLifecycle: ".concat(o.lifecycle,", \n")+"  scenarioName: ".concat(o.name,", \n")+"  scenarioEntryPoint: ".concat(o.entryPoint,", \n")+"}"),{hostName:"".concat(n.appName,"_").concat(i),hostAppName:s,hostAppPlatform:i,hostSessionId:e,hostCorrelationId:t,uiLanguage:r,hostAppVersion:n.appVersion,hostScenarioEntryPoint:o.entryPoint,hostScenarioLifecycle:o.lifecycle,hostScenarioName:o.name,hostScenarioStartTime:o.startTime,userContext:{}}}},90589:(e,t,r)=>{"use strict";function o(e,t,r){return a(e,1,t,r)}function n(e,t,r){return a(e,2,t,r)}function i(e,t,r){return a(e,3,t,r)}function s(e,t,r){return a(e,0,t,r)}function a(e,t,r,o){return{name:e,dataType:t,value:r,classification:o||4}}r.d(t,{LK:()=>o,Ug:()=>n,ip:()=>i,m9:()=>s})},90662:(e,t,r)=>{"use strict";r.d(t,{kc:()=>d,h2:()=>g,mz:()=>s,d8:()=>c,D8:()=>a,g4:()=>h,fB:()=>p});r(899);var o=r(16218);let n=function(e){return e[e.Default=0]="Default",e[e.Dark=1]="Dark",e}({});const i=new Map([[n[n.Default],{name:"Default Theme",properties:[]}],[n[n.Dark],{name:"Dark Theme",properties:[[o.Ve.black,"#ffffff"],[o.Ve.white,"#262626"],[o.Ve.neutralDark,"#ffffff"],[o.Ve.neutralPrimary,"#ffffff"],[o.Ve.neutralPrimaryAlt,"#f8f8f8"],[o.Ve.neutralSecondary,"#f4f4f4"],[o.Ve.neutralTertiary,"#eaeaea"],[o.Ve.neutralTertiaryAlt,"#c8c8c8"],[o.Ve.neutralQuaternary,"#2e2e2e"],[o.Ve.neutralLight,"#000000"],[o.Ve.neutralQuaternaryAlt,"#2e2e2e"],[o.Ve.neutralLighter,"#212121"],[o.Ve.neutralLighterAlt,"#363636"],[o.Ve.redDark,"#e81123"],[o.Ve.purple,"#9c89e9"],[o.Ve.themeDarker,"#cfd3d5"],[o.Ve.themeDark,"#bcd6e6"],[o.Ve.themeDarkAlt,"#afd8f0"],[o.Ve.themePrimary,"#79b0c8"],[o.Ve.themeSecondary,"#588b9e"],[o.Ve.themeTertiary,"#597c87"],[o.Ve.themeLight,"#495e66"],[o.Ve.themeLighter,"#485b60"],[o.Ve.themeLighterAlt,"#3c4547"],[o.Ve.EntityRecognitionUnderline,"#8a8886"],[o.Ve.EntityRecognitionHoverHighlight,"#3b3a39"],[o.Ve.TaskRecognitionUnderline,"#8a8886"],[o.Ve.TaskRecognitionHoverHighlight,"#3b3a39"],[o._D.ThemeName,o.aM.Dark],[o.KM.MessageText,"#323130"],[o.KM.ErrorBackground,"#FDE7E9"],[o.KM.ErrorIcon,"#F75E75"],[o.KM.SuccessBackground,"#262626"],[o.KM.SuccessIcon,"#107C10"],[o.KM.WarningBackground,"#FFF4CE"],[o.KM.WarningIcon,"#797775"],[o.KM.SevereWarningBackground,"#FED9CC"],[o.KM.SevereWarningIcon,"#D83B01"],[o.KM.InfoBackground,"#292929"],[o.KM.InfoIcon,"#605e5c"]]}]]),s="#e49fff",a="#EB0000",c="#FF4D4D",d="#262626",l="#ffffff";let u=function(e){return e[e.Colorful=0]="Colorful",e[e.VeryDark=1]="VeryDark",e[e.Black=2]="Black",e[e.Fresh=3]="Fresh",e}({});function h(e){return e===u.Black}function g(e){return e?i.get(n[n.Dark])||{name:"Default Theme",properties:[]}:i.get(n[n.Default])||{name:"Default Theme",properties:[]}}function p(e){var t,r;null===(t=document)||void 0===t||null===(r=t.body)||void 0===r||r.style.setProperty("background-color",e?d:l)}},90846:(e,t,r)=>{"use strict";r.d(t,{f:()=>S});var o=r(27051),n=r(15217);const i=432e6;var s=r(50178),a=r(39773),c=r(69649);const d="fluidDriverCache",l="driverStorage.V3",u={1:"diverStorage",2:"diverStorage.V2"};function h(e){return"".concat(e.file.docId,"_").concat(e.type,"_").concat(e.key)}function g(e){return new Promise((t,r)=>{(0,c.P2)(d,3,{upgrade:(t,r)=>{try{const e=u[r];e&&t.deleteObjectStore(e)}catch(n){(0,s.pW)({logger:e}).sendErrorEvent({eventName:"FluidCacheDeleteOldDbError"},n)}const o=t.createObjectStore(l);o.createIndex("createdTimeMs","createdTimeMs"),o.createIndex("lastAccessTimeMs","lastAccessTimeMs"),o.createIndex("partitionKey","partitionKey"),o.createIndex("fileId","fileId")},blocked:()=>{r(new Error("Could not open DB since it is blocked by an older client that has the DB open"))}}).then(t,r)})}const p="2.43.0";let f=[],m=!1;function v(e){f.push({task:e}),y(2e3)}function y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!m){if(self.requestIdleCallback)self.requestIdleCallback(b);else{const t=Date.now()+50;self.setTimeout(()=>b({timeRemaining:()=>Math.max(t-Date.now(),0),didTimeout:!1}),e)}m=!0}}function b(e){!function(e,t){const r=[];for(const[o,n]of f.entries()){if(t&&!t()){r.push(...f.slice(o));break}e&&!e(n)?r.push(n):n.task()}f=r}(void 0,()=>e.timeRemaining()>10),m=!1,f.length>0&&y()}class S{constructor(e){this.closeDbImmediately=!0,this.dbReuseCount=-1;const{logger:t,partitionKey:r,maxCacheItemAge:o,closeDbAfterMs:n}=e;if(this.logger=(0,s.pW)({logger:t}),this.partitionKey=r,o>i){const e=new a.eb("maxCacheItemAge(".concat(o,") cannot be greater than ").concat(i),{maxCacheItemAge:o,maximumCacheDurationMs:i,pkgVersion:p});this.logger.sendErrorEvent({eventName:"maxCacheItemAgeTooLarge",subCategory:"FluidCache"},e)}this.maxCacheItemAge=Math.min(o,i),this.closeDbAfterMs=null!==n&&void 0!==n?n:0,this.closeDbAfterMs>0&&(this.closeDbImmediately=!1),v(async()=>{var e;if(null!==(e=navigator.storage)&&void 0!==e&&e.estimate){const e=await navigator.storage.estimate();let t;"usageDetails"in e&&(t=e.usageDetails.indexedDB),this.logger.sendTelemetryEvent({eventName:"FluidCacheStorageInfo",subCategory:"FluidCache",quota:e.quota,usage:e.usage,indexedDBSize:t,pkgVersion:p})}}),v(async()=>{let e;try{e=await g(this.logger);const t=e.transaction(l,"readwrite"),r=t.store.index("createdTimeMs"),o=await r.getAllKeys(IDBKeyRange.upperBound((new Date).getTime()-this.maxCacheItemAge));await Promise.all(o.map(e=>t.store.delete(e))),await t.done}catch(r){this.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:p},r)}finally{var t;null===(t=e)||void 0===t||t.close()}})}async openDb(){if(this.closeDbImmediately)return g(this.logger);if(void 0===this.db){const e=await g(this.logger);if(void 0!==this.db)return e.close(),this.dbReuseCount+=1,this.db;this.dbReuseCount=-1,this.db=e,this.db.onversionchange=e=>{var t;null===(t=this.db)||void 0===t||t.close(),this.db=void 0,clearTimeout(this.dbCloseTimer),this.dbCloseTimer=void 0},this.db.addEventListener("close",e=>{clearTimeout(this.dbCloseTimer),this.dbCloseTimer=void 0,this.db=void 0}),(0,n.vA)(void 0===this.dbCloseTimer,1734),this.dbCloseTimer=setTimeout(()=>{var e;null===(e=this.db)||void 0===e||e.close(),this.db=void 0,this.dbCloseTimer=void 0},this.closeDbAfterMs)}return(0,n.vA)(void 0!==this.db,1735),this.dbReuseCount+=1,this.db}closeDb(e){this.closeDbImmediately&&(null===e||void 0===e||e.close())}async removeEntries(e){let t;try{t=await this.openDb();const r=t.transaction(l,"readwrite"),o=r.store.index("fileId"),n=await o.getAllKeys(e.docId);await Promise.all(n.map(e=>r.store.delete(e))),await r.done}catch(r){this.logger.sendErrorEvent({eventName:"FluidCacheDeleteOldEntriesError",pkgVersion:p},r)}finally{this.closeDb(t)}}async get(e){const t=performance.now(),r=await this.getItemFromCache(e);return this.logger.sendPerformanceEvent({eventName:"FluidCacheAccess",cacheHit:void 0!==r,type:e.type,duration:performance.now()-t,dbOpenPerf:null===r||void 0===r?void 0:r.dbOpenPerf,dbReuseCount:this.dbReuseCount,pkgVersion:p}),null===r||void 0===r?void 0:r.cachedObject}async getItemFromCache(e){let t;try{const r=h(e),n=performance.now();t=await this.openDb();const i=performance.now()-n,s=await t.get(l,r);if(!s)return void this.closeDb(t);if(s.partitionKey!==this.partitionKey)return this.logger.sendTelemetryEvent({eventName:"FluidCachePartitionKeyMismatch",subCategory:"FluidCache",pkgVersion:p}),void this.closeDb(t);return(new Date).getTime()-s.createdTimeMs>this.maxCacheItemAge?void this.closeDb(t):(this.closeDb(t),(0,o.A)((0,o.A)({},s),{},{dbOpenPerf:i}))}catch(r){return this.logger.sendErrorEvent({eventName:"FluidCacheGetError",pkgVersion:p},r),void this.closeDb(t)}}async put(e,t){let r;try{r=await this.openDb();const o=(new Date).getTime();await r.put(l,{cachedObject:t,fileId:e.file.docId,type:e.type,cacheItemId:e.key,partitionKey:this.partitionKey,createdTimeMs:o,lastAccessTimeMs:o},h(e)),this.closeDb(r)}catch(o){this.logger.sendErrorEvent({eventName:"FluidCachePutError",pkgVersion:p},o)}finally{this.closeDb(r)}}}},90876:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});const o="2.43.0"},91119:(e,t,r)=>{"use strict";r.d(t,{Cj:()=>b,iJ:()=>k});var o=r(27051),n=r(85038),i=r(8018),s=r(21673),a=r(54813),c=r(20611),d=r(93586),l=r(63520),u=r(83533),h=r(39521),g=r(27250),p=r(14826),f=r(24217),m=r(93220),v=r(70530);var y=r(27612);const b="Odsp409Error";class S{constructor(e,t,r,o){this.cache=e,this.fileEntry=t,this.logger=r,this.clientIsSummarizer=o,this.driverId=(0,p.A)(),this.networkCallNumber=1,this.rateLimiter=new s.v(24),this.snapshotCacheExpiryTimeoutMs=(0,l.Ln)(r).config.getBoolean("Fluid.Driver.Odsp.TestOverride.DisableSnapshotCache")?0:c.Pb}setEpoch(e,t,r){(0,n.vA)(void 0===this._fluidEpoch,475),this._fluidEpoch=e,this.logger.sendTelemetryEvent({eventName:"EpochLearnedFirstTime",epoch:e,fetchType:r,fromCache:t})}async get(e){try{const r=await this.cache.get(this.fileEntryFromEntry(e));if(void 0===r||r.version!==f.F)return;if((0,n.vA)(void 0!==r.fluidEpoch,476),void 0===this._fluidEpoch)this.setEpoch(r.fluidEpoch,!0,"cache");else if(this._fluidEpoch!==r.fluidEpoch)return;if(e.type===c.o1||e.type===c.W3){var t;const e=null===(t=r.value)||void 0===t?void 0:t.cacheEntryTime,o=Date.now();if(void 0===e||o-e>=this.snapshotCacheExpiryTimeoutMs)return this.logger.sendTelemetryEvent({eventName:"odspVersionsCacheExpired",duration:o-e,maxCacheAgeMs:this.snapshotCacheExpiryTimeoutMs}),void await this.removeEntries()}return r.value}catch(r){return void this.logger.sendErrorEvent({eventName:"cacheFetchError",type:e.type},r)}}async put(e,t){var r;((0,n.vA)(void 0!==this._fluidEpoch,477),e.type===c.o1||e.type===c.W3)&&(t.cacheEntryTime=null!==(r=t.cacheEntryTime)&&void 0!==r?r:Date.now());const o={value:t,version:f.F,fluidEpoch:this._fluidEpoch};return this.cache.put(this.fileEntryFromEntry(e),o).catch(t=>{throw this.logger.sendErrorEvent({eventName:"cachePutError",type:e.type},t),t})}async removeEntries(){try{return await this.cache.removeEntries(this.fileEntry)}catch(e){this.logger.sendErrorEvent({eventName:"removeCacheEntries"},e)}}get fluidEpoch(){return this._fluidEpoch}async validateEpoch(e,t){(0,n.vA)(void 0!==e,1412);try{this.validateEpochFromResponse(e,t)}catch(r){throw await this.checkForEpochError(r,e,t),r}}async fetchAndParseAsJSON(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,v.bf,r,o,n)}async fetch(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,v.ZR,r,o,n)}async fetchCore(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;const c=this.formatClientCorrelationId(s);let l;return this.addEpochInRequest(t,i,c),this.rateLimiter.schedule(async()=>r(e,t)).then(e=>(l=e.headers.get("x-fluid-epoch"),this.validateEpochFromResponse(l,n),e.propsToLog.XRequestStatsHeader=c,e)).catch(async e=>{throw void 0===l&&(l=e.serverEpoch),await this.checkForEpochError(e,l,n),e}).catch(e=>{if((0,u.X)(e)&&e.errorType===d.E.fileNotFoundOrAccessDeniedError){const t=e.redirectLocation;if(void 0!==t){const r=function(e,t){const r=(0,o.A)({},(0,v.Yn)(e)),n=new URL(t).origin,i="".concat(n).concat(new URL(r.siteUrl).pathname);return r.siteUrl=i,r}(this.fileEntry.resolvedUrl,t),n=new a.c_(e.message,r,{driverVersion:y.z,redirectLocation:t});throw n.addTelemetryProperties(e.getTelemetryProperties()),n}}throw e}).catch(e=>{throw(0,h.cQ)(e,{props:{XRequestStatsHeader:c}})})}async fetchArray(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;return this.fetchCore(e,t,v.cr,r,o,n)}addEpochInRequest(e,t,r){const i=(0,v.Yn)(this.fileEntry.resolvedUrl).isClpCompliantApp;if(t){const t={};t["X-RequestStats"]=r,void 0!==this.fluidEpoch&&(t["x-fluid-epoch"]=this.fluidEpoch),i&&(t[m.t.isClpCompliantApp]=i.toString()),this.addParamInBody(e,t)}else{const t=(t,r)=>{e.headers=(0,o.A)({},e.headers),(0,n.vA)(void 0!==e.headers,642),e.headers[t]=r};t("X-RequestStats",r),void 0!==this.fluidEpoch&&t("x-fluid-epoch",this.fluidEpoch),i&&t(m.t.isClpCompliantApp,i.toString())}}addParamInBody(e,t){const r=e.body;(0,n.vA)("string"===typeof r,541);const o=r.split("\r\n"),i=o.shift();(0,n.vA)(!0===(null===i||void 0===i?void 0:i.startsWith("--")),542);const s=[i];for(const[n,a]of Object.entries(t))s.push("".concat(n,": ").concat(a));for(const n of o)s.push(n);e.body=s.join("\r\n")}formatClientCorrelationId(e){const t=["driverId=".concat(this.driverId),"RequestNumber=".concat(this.networkCallNumber++),"driverVersion=".concat(y.z),"isSummarizer=".concat(this.clientIsSummarizer)];return void 0!==e&&t.push("fetchReason=".concat(e)),t.join(", ")}validateEpochFromResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=this.checkForEpochErrorCore(e);if(void 0!==o)throw o;void 0!==e&&void 0===this._fluidEpoch&&this.setEpoch(e,r,t)}async checkForEpochError(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((0,u.X)(e)&&e.errorType===d.E.fileOverwrittenInStorage){const n=this.checkForEpochErrorCore(t);if(void 0!==n)throw n.addTelemetryProperties({fromCache:o,fetchType:r}),this.logger.sendErrorEvent({eventName:"fileOverwrittenInStorage"},n),await this.removeEntries(),n;throw(0,h.J4)(e,e=>new a.Gi("Coherency 409: ".concat(e),1,{[b]:!0,driverVersion:y.z}))}}checkForEpochErrorCore(e){if(this.fluidEpoch&&e&&this.fluidEpoch!==e)return new a.OI("Epoch mismatch",d.E.fileOverwrittenInStorage,{driverVersion:y.z,serverEpoch:e,clientEpoch:this.fluidEpoch})}fileEntryFromEntry(e){return(0,o.A)((0,o.A)({},e),{},{file:this.fileEntry})}}class C extends S{constructor(e,t,r,o){super(e,t,r,o),this.cache=e,this.fileEntry=t,this.logger=r,this.clientIsSummarizer=o,this.treesLatestDeferral=new i.c,this.treesLatestDeferral.promise.catch(()=>{})}validateEpochFromResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super.validateEpochFromResponse(e,t,r),this.treesLatestDeferral.resolve()}async get(e){let t=super.get(e);return e.type!==c.o1&&e.type!==c.W3||(t=t.then(e=>(void 0!==e&&this.treesLatestDeferral.resolve(),e)).catch(e=>{throw this.treesLatestDeferral.reject(e),e})),t}async fetchAndParseAsJSON(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0;const i=this.treesLatestDeferral.isCompleted;try{return await super.fetchAndParseAsJSON(e,t,r,o,n)}catch(s){if("treesLatest"===r&&this.treesLatestDeferral.reject(s),"joinSession"!==r||s.statusCode<401||s.statusCode>404||i)throw s}return await g.Bt.timedExecAsync(this.logger,{eventName:"JoinSessionSyncWait"},async e=>{let t;const r=new Promise(e=>{t=setTimeout(()=>{e(51)},15e3)});51===await Promise.race([r,this.treesLatestDeferral.promise.finally(()=>clearTimeout(t))])&&e.cancel()},{start:!0,end:!0,cancel:"generic"}),super.fetchAndParseAsJSON(e,t,r,o)}}function k(e,t,r,n,i){const s=new C(e,r,n,i);return{cache:(0,o.A)((0,o.A)({},t),{},{persistedCache:s}),epochTracker:s}}},91608:(e,t,r)=>{"use strict";r.d(t,{W:()=>b});var o=r(27051),n=r(51497),i=r(43927),s=r(6390);const a=i.TQ.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background1")]:n.yd[t].shade40,["colorPalette".concat(r,"Background2")]:n.yd[t].shade30,["colorPalette".concat(r,"Background3")]:n.yd[t].primary,["colorPalette".concat(r,"Foreground1")]:n.yd[t].tint30,["colorPalette".concat(r,"Foreground2")]:n.yd[t].tint40,["colorPalette".concat(r,"Foreground3")]:n.yd[t].tint20,["colorPalette".concat(r,"BorderActive")]:n.yd[t].tint30,["colorPalette".concat(r,"Border1")]:n.yd[t].primary,["colorPalette".concat(r,"Border2")]:n.yd[t].tint20};return Object.assign(e,o)},{});a.colorPaletteRedForeground3=n.yd.red.tint30,a.colorPaletteRedBorder2=n.yd.red.tint30,a.colorPaletteGreenForeground3=n.yd.green.tint40,a.colorPaletteGreenBorder2=n.yd.green.tint40,a.colorPaletteDarkOrangeForeground3=n.yd.darkOrange.tint30,a.colorPaletteDarkOrangeBorder2=n.yd.darkOrange.tint30,a.colorPaletteRedForegroundInverted=n.yd.red.primary,a.colorPaletteGreenForegroundInverted=n.yd.green.primary,a.colorPaletteYellowForegroundInverted=n.yd.yellow.shade30;const c=i.dt.reduce((e,t)=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={["colorPalette".concat(r,"Background2")]:n.cc[t].shade30,["colorPalette".concat(r,"Foreground2")]:n.cc[t].tint40,["colorPalette".concat(r,"BorderActive")]:n.cc[t].tint30};return Object.assign(e,o)},{});c.colorPaletteDarkRedBackground2=n.cc.darkRed.shade20,c.colorPalettePlumBackground2=n.cc.plum.shade20;const d=(0,o.A)((0,o.A)({},a),c),l=Object.entries(s.s).reduce((e,t)=>{let[r,o]=t;const i=r.slice(0,1).toUpperCase()+r.slice(1),s={["colorStatus".concat(i,"Background1")]:n.Ul[o].shade40,["colorStatus".concat(i,"Background2")]:n.Ul[o].shade30,["colorStatus".concat(i,"Background3")]:n.Ul[o].primary,["colorStatus".concat(i,"Foreground1")]:n.Ul[o].tint30,["colorStatus".concat(i,"Foreground2")]:n.Ul[o].tint40,["colorStatus".concat(i,"Foreground3")]:n.Ul[o].tint20,["colorStatus".concat(i,"BorderActive")]:n.Ul[o].tint30,["colorStatus".concat(i,"ForegroundInverted")]:n.Ul[o].shade10,["colorStatus".concat(i,"Border1")]:n.Ul[o].primary,["colorStatus".concat(i,"Border2")]:n.Ul[o].tint20};return Object.assign(e,s)},{});l.colorStatusDangerBackground3Hover=n.Ul[s.s.danger].shade10,l.colorStatusDangerBackground3Pressed=n.Ul[s.s.danger].shade20,l.colorStatusDangerForeground3=n.Ul[s.s.danger].tint40,l.colorStatusDangerBorder2=n.Ul[s.s.danger].tint30,l.colorStatusSuccessForeground3=n.Ul[s.s.success].tint40,l.colorStatusSuccessBorder2=n.Ul[s.s.success].tint40,l.colorStatusWarningForegroundInverted=n.Ul[s.s.warning].shade20;var u=r(43483);var h=r(17483),g=r(95829),p=r(45882),f=r(92708),m=r(27586),v=r(58511),y=r(91809);const b=e=>{const t=(e=>({colorNeutralForeground1:u.ON,colorNeutralForeground1Hover:u.ON,colorNeutralForeground1Pressed:u.ON,colorNeutralForeground1Selected:u.ON,colorNeutralForeground2:u.Oh[84],colorNeutralForeground2Hover:u.ON,colorNeutralForeground2Pressed:u.ON,colorNeutralForeground2Selected:u.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:u.Oh[68],colorNeutralForeground3Hover:u.Oh[84],colorNeutralForeground3Pressed:u.Oh[84],colorNeutralForeground3Selected:u.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:u.Oh[60],colorNeutralForegroundDisabled:u.Oh[36],colorNeutralForegroundInvertedDisabled:u.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:u.Oh[84],colorNeutralForeground2LinkHover:u.ON,colorNeutralForeground2LinkPressed:u.ON,colorNeutralForeground2LinkSelected:u.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:u.Oh[14],colorNeutralForegroundStaticInverted:u.ON,colorNeutralForegroundInverted:u.Oh[14],colorNeutralForegroundInvertedHover:u.Oh[14],colorNeutralForegroundInvertedPressed:u.Oh[14],colorNeutralForegroundInvertedSelected:u.Oh[14],colorNeutralForegroundInverted2:u.Oh[14],colorNeutralForegroundOnBrand:u.ON,colorNeutralForegroundInvertedLink:u.ON,colorNeutralForegroundInvertedLinkHover:u.ON,colorNeutralForegroundInvertedLinkPressed:u.ON,colorNeutralForegroundInvertedLinkSelected:u.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:u.Oh[16],colorNeutralBackground1Hover:u.Oh[24],colorNeutralBackground1Pressed:u.Oh[12],colorNeutralBackground1Selected:u.Oh[22],colorNeutralBackground2:u.Oh[12],colorNeutralBackground2Hover:u.Oh[20],colorNeutralBackground2Pressed:u.Oh[8],colorNeutralBackground2Selected:u.Oh[18],colorNeutralBackground3:u.Oh[8],colorNeutralBackground3Hover:u.Oh[16],colorNeutralBackground3Pressed:u.Oh[4],colorNeutralBackground3Selected:u.Oh[14],colorNeutralBackground4:u.Oh[4],colorNeutralBackground4Hover:u.Oh[12],colorNeutralBackground4Pressed:u.Ql,colorNeutralBackground4Selected:u.Oh[10],colorNeutralBackground5:u.Ql,colorNeutralBackground5Hover:u.Oh[8],colorNeutralBackground5Pressed:u.Oh[2],colorNeutralBackground5Selected:u.Oh[6],colorNeutralBackground6:u.Oh[20],colorNeutralBackgroundInverted:u.ON,colorNeutralBackgroundStatic:u.Oh[24],colorNeutralBackgroundAlpha:u.ti[50],colorNeutralBackgroundAlpha2:u.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:u.Oh[22],colorSubtleBackgroundPressed:u.Oh[18],colorSubtleBackgroundSelected:u.Oh[20],colorSubtleBackgroundLightAlphaHover:u.Xv[80],colorSubtleBackgroundLightAlphaPressed:u.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:u.Q1[10],colorSubtleBackgroundInvertedPressed:u.Q1[30],colorSubtleBackgroundInvertedSelected:u.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:u.Oh[8],colorNeutralBackgroundInvertedDisabled:u.c8[10],colorNeutralStencil1:u.Oh[34],colorNeutralStencil2:u.Oh[20],colorNeutralStencil1Alpha:u.c8[10],colorNeutralStencil2Alpha:u.c8[5],colorBackgroundOverlay:u.Q1[50],colorScrollbarOverlay:u.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:u.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:u.Oh[20],colorNeutralCardBackgroundHover:u.Oh[24],colorNeutralCardBackgroundPressed:u.Oh[18],colorNeutralCardBackgroundSelected:u.Oh[22],colorNeutralCardBackgroundDisabled:u.Oh[8],colorNeutralStrokeAccessible:u.Oh[68],colorNeutralStrokeAccessibleHover:u.Oh[74],colorNeutralStrokeAccessiblePressed:u.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:u.Oh[40],colorNeutralStroke1Hover:u.Oh[46],colorNeutralStroke1Pressed:u.Oh[42],colorNeutralStroke1Selected:u.Oh[44],colorNeutralStroke2:u.Oh[32],colorNeutralStroke3:u.Oh[24],colorNeutralStrokeSubtle:u.Oh[4],colorNeutralStrokeOnBrand:u.Oh[16],colorNeutralStrokeOnBrand2:u.ON,colorNeutralStrokeOnBrand2Hover:u.ON,colorNeutralStrokeOnBrand2Pressed:u.ON,colorNeutralStrokeOnBrand2Selected:u.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:u.Oh[26],colorNeutralStrokeInvertedDisabled:u.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:u.c8[10],colorNeutralStrokeAlpha2:u.c8[20],colorStrokeFocus1:u.Ql,colorStrokeFocus2:u.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return(0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)((0,o.A)({},h.V),g.GR),g.lm),g.aI),g.NM),p.k),y.b),y.F),m.S),v.L),t),d),l),(0,f.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey)),(0,f.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand"))}},91809:(e,t,r)=>{"use strict";r.d(t,{F:()=>f,b:()=>p});const o="0",n="2px",i="4px",s="6px",a="8px",c="10px",d="12px",l="16px",u="20px",h="24px",g="32px",p={spacingHorizontalNone:o,spacingHorizontalXXS:n,spacingHorizontalXS:i,spacingHorizontalSNudge:s,spacingHorizontalS:a,spacingHorizontalMNudge:c,spacingHorizontalM:d,spacingHorizontalL:l,spacingHorizontalXL:u,spacingHorizontalXXL:h,spacingHorizontalXXXL:g},f={spacingVerticalNone:o,spacingVerticalXXS:n,spacingVerticalXS:i,spacingVerticalSNudge:s,spacingVerticalS:a,spacingVerticalMNudge:c,spacingVerticalM:d,spacingVerticalL:l,spacingVerticalXL:u,spacingVerticalXXL:h,spacingVerticalXXXL:g}},91947:(e,t,r)=>{"use strict";r.d(t,{CE:()=>g,CQ:()=>R,Ht:()=>l,Jc:()=>M,Jn:()=>B,KE:()=>w,KJ:()=>x,PA:()=>E,UT:()=>O,Vp:()=>_,XQ:()=>H,Y0:()=>b,_d:()=>u,a5:()=>U,a7:()=>D,eH:()=>k,gf:()=>P,hw:()=>p,kF:()=>y,lW:()=>h,nA:()=>v,n_:()=>C,nt:()=>N,sQ:()=>f,wL:()=>A,wW:()=>L,w_:()=>T,x$:()=>S,xh:()=>m,y7:()=>F});var o=r(58443),n=r(69235),i=r(51492),s=r(56142),a=r(6971),c=r(40684);let d=function(e){return e[e.boolean=0]="boolean",e[e.integer=1]="integer",e[e.string=2]="string",e}({});async function l(e){await(0,c.zr)(c.tR.CaretPositionChanged,[e])}async function u(){await I(c.tR.ClearYCaretCoordinate)&&await(0,c.zr)(c.tR.ClearYCaretCoordinate,[])}async function h(e){await(0,c.zr)(c.tR.CursUpDownFromE2o,[e?1:-1])}async function g(e){try{if(await I(c.tR.GetOcps)){const[t]=await(0,c.zr)(c.tR.GetOcps,[e]);return t}return}catch(t){return}}async function p(){await I(c.tR.Dehydrate)&&await(0,c.zr)(c.tR.Dehydrate,[])}async function f(e,t){await(0,c.zr)(c.tR.FluidComponentCreated,[e,t])}async function m(e){await I(c.tR.FluidComponentCreateFailed)&&await(0,c.zr)(c.tR.FluidComponentCreateFailed,[e])}async function v(){await I(c.tR.FluidComponentEdited)&&await(0,c.zr)(c.tR.FluidComponentEdited,[])}async function y(){try{await I(c.tR.FluidHostIsReady)&&await(0,c.zr)(c.tR.FluidHostIsReady,[])}catch(e){(0,n.c2)("fluidHostIsReady()",(0,n.oD)(e))}}async function b(){if(await I(c.tR.GetDataForCreate)){const[e]=await(0,c.zr)(c.tR.GetDataForCreate,[]);if("string"!==typeof e)throw new n.uV("The data returned is not a string.");return e}return""}async function S(e,t){const r=[(0,i.dK)(e,t),d.boolean],[n]=await(0,c.zr)(c.tR.GetFeature,r).catch(e=>(o.Nu||(0,s.vV)(e),[!1]));return"boolean"===typeof n&&n}async function C(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!Number.isInteger(r))throw new n.uV("The default value must be an integer.");const a=[(0,i.dK)(e,t),d.integer,r],[l]=await(0,c.zr)(c.tR.GetFeature,a).catch(e=>(o.Nu||(0,s.vV)(e),[r]));return"number"===typeof l?l:r}async function k(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=[(0,i.dK)(e,t),d.string,r],[a]=await(0,c.zr)(c.tR.GetFeature,n).catch(e=>(o.Nu||(0,s.vV)(e),[r]));return"string"===typeof a?a:r}async function w(){const[e]=await(0,c.zr)(c.tR.GetNativeInfo,[]).catch(()=>["{}"]);if("string"!==typeof e)throw new Error("A string should be returned.");const t=JSON.parse(e);if(!t)throw new Error("Unable to parse the native info json.");return t}async function P(e,t){const r=[e,null!==t&&void 0!==t?t:"",!0],[o]=await(0,c.zr)(c.tR.GetToken,r);if("string"!==typeof o)throw new n.uV("Token should be a string.");return o}async function T(e,t){if(await I(c.tR.InvokeMessageExtensionCommand)){const[r]=await(0,c.zr)(c.tR.InvokeMessageExtensionCommand,[e,JSON.stringify(t)]);if("string"!==typeof r)throw new n.uV("The data returned is not a string.");return JSON.parse(r)}}async function E(e,t){if(!await I(c.tR.IsChangeGateEnabled))return!0;const[r]=await(0,c.zr)(c.tR.IsChangeGateEnabled,[e,t]).catch(e=>(o.Nu||(0,s.vV)(e),[!0]));return"boolean"!==typeof r||r}async function I(e){const t=await(0,a.E)();if(!t.version)return!1;switch(e){case c.tR.GetFeature:case c.tR.GetNativeInfo:case c.tR.GetToken:case c.tR.GetUserIdentity:case c.tR.ReportActivityResult:case c.tR.SendTelemetry:return t.version>=1;case c.tR.ShowPermissionCallout:return t.version>=2;case c.tR.CaretPositionChanged:return t.version>=3;case c.tR.OnAtMention:return t.version>=4;case c.tR.OnInvokeFromInjectedScript:return t.version>=8;case c.tR.FluidComponentCreated:return t.version>=9;case c.tR.IsChangeGateEnabled:return t.version>=10;case c.tR.FluidHostIsReady:return t.version>=12;case c.tR.PassKeyToHost:return t.version>=13;case c.tR.GetDataForCreate:return t.version>=15;case c.tR.SetCanProvideDataToSave:case c.tR.ProvideDataToSave:case c.tR.FluidComponentEdited:return t.version>=16;case c.tR.TeachingCalloutDismissed:case c.tR.TeachingCalloutShown:return t.version>=17;case c.tR.FluidComponentCreateFailed:return t.version>=18;case c.tR.InvokeMessageExtensionCommand:return t.version>=22;case c.tR.Dehydrate:return t.version>=24;case c.tR.SaveEmbeddedData:return t.version>=25;case c.tR.UpdateLoopInfo:return t.version>=26;case c.tR.CursUpDownFromE2o:return t.version>=28;case c.tR.GetOcps:return t.version>=32;case c.tR.ScrollHost:return t.version>=33;default:return!1}}async function N(e,t){await(0,c.zr)(c.tR.OnAtMention,[e,t])}async function A(e){const t=function(e){const t=27;if("Escape"===e)return t;return void(0,s.vV)("Unsupported key: ".concat(e))}(e);t&&await(0,c.zr)(c.tR.PassKeyToHost,[t])}async function F(e,t){await I(c.tR.ScrollHost)&&await(0,c.zr)(c.tR.ScrollHost,[e,t])}async function D(e,t,r,o){await I(c.tR.ProvideDataToSave)&&await(0,c.zr)(c.tR.ProvideDataToSave,[e,t,r,o])}async function B(e,t,r){const o=[e,t,r];await(0,c.zr)(c.tR.ReportActivityResult,o).catch(s.vV)}async function L(e){await(0,c.zr)(c.tR.SendTelemetry,e)}async function O(e){await I(c.tR.SetCanProvideDataToSave)&&await(0,c.zr)(c.tR.SetCanProvideDataToSave,[e])}async function x(e){await I(c.tR.SaveEmbeddedData)&&await(0,c.zr)(c.tR.SaveEmbeddedData,[e])}async function M(){await(0,c.zr)(c.tR.ShowPermissionCallout,[])}async function R(e,t,r){o.Nu||(0,s.Rm)("Size changed: ".concat(e," x ").concat(t)),await(0,c.zr)(c.tR.SizeChanged,[e,t,(0,c.qH)(r)])}async function _(e){await(0,c.zr)(c.tR.TeachingCalloutDismissed,[e])}async function H(){await(0,c.zr)(c.tR.TeachingCalloutShown,[])}async function U(e){if(await I(c.tR.UpdateLoopInfo)){const t=JSON.stringify(e);await(0,c.zr)(c.tR.UpdateLoopInfo,[t])}}},92708:(e,t,r)=>{"use strict";function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return{["shadow2".concat(r)]:"0 0 2px ".concat(e,", 0 1px 2px ").concat(t),["shadow4".concat(r)]:"0 0 2px ".concat(e,", 0 2px 4px ").concat(t),["shadow8".concat(r)]:"0 0 2px ".concat(e,", 0 4px 8px ").concat(t),["shadow16".concat(r)]:"0 0 2px ".concat(e,", 0 8px 16px ").concat(t),["shadow28".concat(r)]:"0 0 8px ".concat(e,", 0 14px 28px ").concat(t),["shadow64".concat(r)]:"0 0 8px ".concat(e,", 0 32px 64px ").concat(t)}}r.d(t,{t:()=>o})},92756:(e,t,r)=>{"use strict";var o;r.d(t,{d:()=>o}),function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(o||(o={}))},93023:(e,t,r)=>{"use strict";r.d(t,{X:()=>n});var o=r(61376);class n extends o.b{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}},93220:(e,t,r)=>{"use strict";var o,n;r.d(t,{O:()=>o,t:()=>n}),function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(o||(o={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(n||(n={}))},93537:(e,t,r)=>{"use strict";r.d(t,{$e:()=>h,J5:()=>g,sC:()=>u});var o=r(27051),n=r(37805);const i=709,s=710,a=707,c=711;function d(){return"undefined"===typeof navigator||!1!==navigator.onLine}const l={durationMs:-1,body:null,bodyUsed:!1,headers:new Headers,ok:!1,redirected:!1,status:d()?s:i,statusText:"",type:"error",url:"",arrayBuffer:()=>Promise.resolve(new ArrayBuffer(0)),blob:()=>Promise.resolve(new Blob(void 0)),formData:()=>Promise.resolve(new FormData(void 0)),json:()=>Promise.resolve(void 0),text:()=>Promise.resolve(""),clone:()=>new Response};function u(e){return t=>e.includes(t.status)}function h(e){return t=>!e.includes(t.status)}function g(e,t,r){var u;let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:18e4,g=r;null!==r&&void 0!==r&&r.respectRetryAfterHeader&&(g=(0,o.A)({},r),g.backoffFn=(e,t)=>{if(429===t.status||503===t.status){const e=t.headers.get("Retry-After");if(e){const t=parseInt(e,10);if(!isNaN(t))return 1e3*t}}return r.backoffFn(e,t)});const p=new AbortController;var f;null!==t&&void 0!==t&&null!==(u=t.signal)&&void 0!==u&&u.aborted?p.abort(t.signal.reason):null===t||void 0===t||null===(f=t.signal)||void 0===f||f.addEventListener("abort",function(){p.abort(this.reason)});const m=(0,o.A)((0,o.A)({},t),{},{signal:p.signal});let v,y=!1;return"undefined"!==typeof window&&window.self!==window.top&&(v=e=>{e.persisted||(y=!0)},window.addEventListener("pagehide",v)),(0,n.pb)(()=>{const t="undefined"!==typeof performance?performance.now():Date.now();return fetch(e,m).then(e=>{const r=e;return r.durationMs=Math.round(performance.now()-t),r}).catch(e=>{if(function(e,t){return e===(null===t||void 0===t?void 0:t.reason)||"object"===typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,m.signal))throw e;let r="Error does not provide a message";e.name&&e.message?r="Error type: ".concat(e.name,", ").concat(e.message):e.name?r="Error type: ".concat(e.name):e.message&&(r="Error message: ".concat(e.message));const n=d()?y?c:s:i;return(0,o.A)((0,o.A)({},l),{},{status:n,ok:!1,durationMs:Math.round(performance.now()-t),statusText:r})})},g,{timeoutMs:h,onTimeout:()=>(p.abort(),(0,o.A)((0,o.A)({},l),{},{status:a,ok:!1,durationMs:h}))}).finally(()=>{"undefined"!==typeof window&&window.self!==window.top&&v&&window.removeEventListener("pagehide",v)})}},93586:(e,t,r)=>{"use strict";r.d(t,{E:()=>i});var o=r(27051),n=r(87804);const i=(0,o.A)((0,o.A)({},n.a),{},{invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"})},93916:(e,t,r)=>{"use strict";r.d(t,{R:()=>n});var o=r(90589);const n=(e,t)=>{const r=function(e){const{value:t,tag:r}=null!==e&&"object"===typeof e?e:{value:e,tag:void 0};switch(r){case void 0:case"PackageData":case"CodeArtifact":return t;case"UserData":return"REDACTED (tag: UserData)";default:return"REDACTED (tag: ".concat(r,")")}}(e);if(void 0!==r)return"string"===typeof r?(0,o.m9)(t,r):"number"===typeof r?(0,o.ip)(t,r):(0,o.LK)(t,r)}},94115:(e,t,r)=>{"use strict";r.d(t,{i:()=>g,y:()=>h});var o=r(60138),n=r(25573),i=r(64580),s=r(97232),a=r(53450),c=r(51655),d=r(26140),l=r(59091),u=r(69235);let h=function(e){return e[e.Success=0]="Success",e[e.LoadComponentError=1]="LoadComponentError",e[e.RenderComponentError_PromiseRejected=2]="RenderComponentError_PromiseRejected",e[e.RenderComponentError_NoComponent=3]="RenderComponentError_NoComponent",e[e.RenderComponentError_CannotRender=4]="RenderComponentError_CannotRender",e}({});class g extends a.r{constructor(e,t,r,o){super("ShowComponent",e),this.WebAppMainPerfTracker=void 0,this.LoadPerfTracker=void 0,this.InitialRenderPerfTracker=void 0,this.AppLazyImportTracker=void 0,this.AppLazyStartTracker=void 0,this.ComponentRenderPerfTracker=void 0,this.GetTokenCount=void 0,this.GetTokenTotalDuration=void 0,this.GetTokenSucceededAfterRetryCount=void 0,this.EndTime=void 0,this.EnforceInformationProtectionPerfTracker=void 0,this.odspModuleImportTracker=void 0,this.addStringDataField("ScenarioName",t),this.addStringDataField("Fluid_Audience",r),this.setWebAppMainPerfTracker(o)}setWebAppMainPerfTracker(e){this.WebAppMainPerfTracker=c.q.startNew(e)}setLoadPerfTracker(){this.LoadPerfTracker=c.q.startNew()}setInitialRenderPerfTracker(){this.InitialRenderPerfTracker=c.q.startNew()}setAppLazyImportPerfTracker(){this.AppLazyImportTracker=c.q.startNew()}setAppLazyStartPerfTracker(){this.AppLazyStartTracker=c.q.startNew()}setComponentRenderPerfTracker(){this.ComponentRenderPerfTracker=c.q.startNew()}setEnforceInformationProtectionPerfTracker(){this.EnforceInformationProtectionPerfTracker=c.q.startNew()}onLoadComplete(e){var t;null===(t=this.LoadPerfTracker)||void 0===t||t.setSuccess(),e instanceof o.z&&(this.GetTokenCount=e.getTokenCallCount,this.GetTokenTotalDuration=e.getTokenTotalDuration,this.GetTokenSucceededAfterRetryCount=e.getTokenSucceededAfterRetryCount)}addResourceMetrics(){const e=(0,d.T)(),t=e.find(e=>e.name.match("https://fa000000084.resources.office.net/static/js/268.(.*).chunk.js")),r=e.find(e=>e.name.match("https://fa000000084.resources.office.net/static/js/main.(.*).chunk.js"));t&&(void 0!=t.startTime&&this.addInt64DataField("LoadResourceBundleStart",t.startTime),void 0!=t.duration&&this.addInt64DataField("LoadResourceBundleDuration",t.duration)),r&&(void 0!=r.startTime&&this.addInt64DataField("LoadResourceMainStart",r.startTime),void 0!=r.duration&&this.addInt64DataField("LoadResourceMainDuration",r.duration))}async sendTelemetryForSuccess(){await this.endActivity(!0,h.Success),this.EndTime=(0,n.W)(),(0,i.$)(s.d.Success_Hydrated)}async sendTelemetryForFailure(e,t,r){const o=null===r||void 0===r?void 0:r.errorType,s=null===r||void 0===r?void 0:r.name,a=(0,u.aK)(r)||o||s;await this.endActivity(!1,e,a),this.EndTime=(0,n.W)(),(0,i.$)(t)}async addDataFieldsToActivity(e,t){var r,o,n,i,s,a,c,d,u,g,p,f,m,v,y;(null===(r=this.WebAppMainPerfTracker)||void 0===r?void 0:r.startTime)&&this.addInt64DataField("WebAppMainStartTime",this.WebAppMainPerfTracker.startTime),(null===(o=this.WebAppMainPerfTracker)||void 0===o?void 0:o.getDuration)&&this.addInt64DataField("WebAppMainDuration",this.WebAppMainPerfTracker.getDuration()),this.WebAppMainPerfTracker&&this.addBooleanDataField("WebAppMainSuccess",this.WebAppMainPerfTracker.isSuccess),(null===(n=this.LoadPerfTracker)||void 0===n?void 0:n.startTime)&&this.addInt64DataField("LoadStartTime",this.LoadPerfTracker.startTime),(null===(i=this.LoadPerfTracker)||void 0===i?void 0:i.getDuration)&&this.addInt64DataField("LoadDuration",this.LoadPerfTracker.getDuration()),this.LoadPerfTracker&&this.addBooleanDataField("LoadSuccess",this.LoadPerfTracker.isSuccess),(null===(s=this.AppLazyImportTracker)||void 0===s?void 0:s.startTime)&&this.addInt64DataField("AppLazyImportStartTime",this.AppLazyImportTracker.startTime),(null===(a=this.AppLazyImportTracker)||void 0===a?void 0:a.getDuration)&&this.addInt64DataField("AppLazyImportDuration",this.AppLazyImportTracker.getDuration()),this.AppLazyImportTracker&&this.addBooleanDataField("AppLazyImportSuccess",this.AppLazyImportTracker.isSuccess),(null===(c=this.AppLazyStartTracker)||void 0===c?void 0:c.startTime)&&this.addInt64DataField("AppLazyStartStartTime",this.AppLazyStartTracker.startTime),(null===(d=this.AppLazyStartTracker)||void 0===d?void 0:d.getDuration)&&this.addInt64DataField("AppLazyStartDuration",this.AppLazyStartTracker.getDuration()),this.AppLazyStartTracker&&this.addBooleanDataField("AppLazyStartSuccess",this.AppLazyStartTracker.isSuccess),(null===(u=this.InitialRenderPerfTracker)||void 0===u?void 0:u.startTime)&&this.addInt64DataField("InitialRenderStartTime",this.InitialRenderPerfTracker.startTime),(null===(g=this.InitialRenderPerfTracker)||void 0===g?void 0:g.getDuration)&&this.addInt64DataField("InitialRenderDuration",this.InitialRenderPerfTracker.getDuration()),this.InitialRenderPerfTracker&&this.addBooleanDataField("InitialRenderSuccess",this.InitialRenderPerfTracker.isSuccess),(null===(p=this.ComponentRenderPerfTracker)||void 0===p?void 0:p.startTime)&&this.addInt64DataField("ComponentRenderStartTime",this.ComponentRenderPerfTracker.startTime),(null===(f=this.ComponentRenderPerfTracker)||void 0===f?void 0:f.getDuration)&&this.addInt64DataField("ComponentRenderDuration",this.ComponentRenderPerfTracker.getDuration()),this.ComponentRenderPerfTracker&&this.addBooleanDataField("ComponentRenderSuccess",this.ComponentRenderPerfTracker.isSuccess),(null===(m=this.EnforceInformationProtectionPerfTracker)||void 0===m?void 0:m.getDuration)&&this.addInt64DataField("EnforceInformationProtectionDuration",this.EnforceInformationProtectionPerfTracker.getDuration()),this.addBooleanDataField("IsUsingServiceDeliveredODSPDriver",l.Om),this.GetTokenCount&&this.addInt64DataField("GetTokenCount",this.GetTokenCount),this.GetTokenTotalDuration&&this.addInt64DataField("GetTokenTotalDuration",this.GetTokenTotalDuration),this.GetTokenSucceededAfterRetryCount&&this.addInt64DataField("GetTokenSucceededAfterRetryCount",this.GetTokenSucceededAfterRetryCount),(null===(v=this.odspModuleImportTracker)||void 0===v?void 0:v.startTime)&&this.addInt64DataField("OdspModuleImportStartTime",this.odspModuleImportTracker.startTime),(null===(y=this.odspModuleImportTracker)||void 0===y?void 0:y.getDuration)&&this.addInt64DataField("OdspModuleImportDuration",this.odspModuleImportTracker.getDuration()),this.addResourceMetrics(),this.addStringDataField("ResultType",h[e]),t&&this.addStringDataField("ErrorMessage",t)}}},94794:(e,t,r)=>{"use strict";r.d(t,{D:()=>i});var o=r(27051),n=r(488);const i=(0,o.A)((0,o.A)({},n.k),{},{clientSessionExpiredError:"clientSessionExpiredError"})},95663:(e,t,r)=>{"use strict";r.d(t,{iq:()=>T,i5:()=>E,AV:()=>f,oD:()=>b,aX:()=>S,vt:()=>w,dy:()=>m,qp:()=>P,cQ:()=>v,J4:()=>C});var o=r(27051);const n={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i;const s=new Uint8Array(16);function a(){if(!i&&(i="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(s)}const c=[];for(let N=0;N<256;++N)c.push((N+256).toString(16).slice(1));function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]}const l=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const o=(e=e||{}).random||(e.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=o[e];return t}return d(o)},u=e=>"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties)&&"function"===typeof(null===e||void 0===e?void 0:e.addTelemetryProperties),h=e=>"string"===typeof(null===e||void 0===e?void 0:e.errorInstanceId);var g=r(50178);const p=e=>null!==e&&!Array.isArray(e)&&"object"===typeof e;function f(e,t){const r={message:"string"===typeof(null===e||void 0===e?void 0:e.message)?e.message:String(e)};if(p(e)){const{errorType:o,stack:n,name:i}=e;if("string"===typeof o&&(r.errorType=o),"string"===typeof n){const e="string"===typeof i?i:void 0;r.stack=((e,r)=>{if(!t)return e;const o=e.split("\n");return o.shift(),void 0!==r&&o.unshift(r),o.join("\n")})(n,e)}}return r}const m=e=>"function"===typeof(null===e||void 0===e?void 0:e.getTelemetryProperties);function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;if(function(e){return"string"===typeof(null===e||void 0===e?void 0:e.errorType)&&"string"===typeof(null===e||void 0===e?void 0:e.message)&&h(e)&&u(e)}(e))return e.addTelemetryProperties(null!==(r=t.props)&&void 0!==r?r:{}),e;const{message:n,stack:i}=f(e,!1),s=new I({message:n,stack:i});if("object"===typeof e&&null!==e){const t=e;let r;"canRetry"in e&&(null!==r&&void 0!==r||(r={}),r.canRetry=t.canRetry),"retryAfterSeconds"in e&&(null!==r&&void 0!==r||(r={}),r.retryAfterSeconds=t.retryAfterSeconds),void 0!==r&&Object.assign(s,r)}"object"!==typeof e&&s.addTelemetryProperties({typeofError:typeof e});const a=T.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return s.addTelemetryProperties((0,o.A)((0,o.A)({},a),t.props)),s}let y;function b(e){const t=Error,r=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const o=new Error("<<generated stack>>");if(void 0===y&&(y=void 0!==o.stack),y)return t.stackTraceLimit=r,o;try{throw o}catch(n){return t.stackTraceLimit=r,n}}function S(e){return b(e).stack}function C(e,t){const{message:r,stack:o}=f(e,!1),n=t(r);return void 0!==o&&k(n,o),w(e)&&n.addTelemetryProperties({untrustedOrigin:1}),h(e)&&(n.overwriteErrorInstanceId(e.errorInstanceId),n.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),m(e)&&n.addTelemetryProperties(e.getTelemetryProperties()),n}function k(e,t){try{Object.assign(e,{stack:t})}catch(r){e.addTelemetryProperties({stack2:t})}}function w(e){if(T.typeCheck(e)){if(e.errorType===E){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}function P(e){return"string"===typeof(null===e||void 0===e?void 0:e.tag)}class T extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;super(e),this.omitPropsFromLogging=r,this._errorInstanceId=l(),r.add("omitPropsFromLogging"),r.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"===typeof e&&null!==e&&("function"===typeof e.addTelemetryProperties&&"function"===typeof e.getTelemetryProperties&&"string"===typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[r,o]of Object.entries(t))void 0===e[r]&&(e[r]=o)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const r=this[t];e[t]=(0,g.fV)(r)}return(0,o.A)((0,o.A)({},e),{},{stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId})}}const E="genericError";class I extends T{constructor(e){super(e.message),this.errorType=E,void 0!==e.stack&&k(this,e.stack)}}},95720:(e,t,r)=>{"use strict";r.d(t,{A8:()=>u,Ak:()=>k,BN:()=>w,F7:()=>c,P:()=>d,Qk:()=>g,Qn:()=>l,TK:()=>p,Ug:()=>C,_H:()=>S,a$:()=>s,bU:()=>o,ih:()=>n,ii:()=>y,m1:()=>h,md:()=>m,ol:()=>a,ps:()=>b,tR:()=>i,uT:()=>f,ul:()=>v});const o="LoadComponentInDiv",n="GetDriver",i="LoadContainer",s="LoadComponentFromContainer",a="RequestComponent",c="GetTemplateContent",d="RehydrateFromTemplateContent",l="LoadCodeFromHint",u="FetchComponentManifest",h="GetLoopComponentCore",g="ContainerPostBootError",p="ContainerPackagePreCacheError",f="GetTemplateContentError",m="UndefinedTemplateContentError",v="ComponentNotSerializableError",y="ComponentSerializationError",b="ComponentManifestFetchError",S="LoadComponentCancelledByHost",C="CodeHintExists",k="OfficeWebHost",w="LoopExperiences"},95829:(e,t,r)=>{"use strict";r.d(t,{GR:()=>o,NM:()=>i,aI:()=>s,lm:()=>n});const o={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},n={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},i={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},s={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"}},96076:(e,t,r)=>{"use strict";r.d(t,{C:()=>d});var o=r(54733),n=r(21856),i=r(93023),s=r(15217),a=r(19984);class c extends i.X{get id(){return this.runtime.id}get IFluidLoadable(){return this}get IFluidHandle(){return this.handle}get handle(){return(0,s.vA)(void 0!==this.runtime.entryPoint,1131),this.runtime.entryPoint}static async getDataObject(e){return await e.entryPoint.get()}constructor(e){super(),this.runtime=e.runtime,this.context=e.context,this.providers=e.providers,this.initProps=e.initProps}async request(e){return""===e.url||"/"===e.url||e.url.startsWith("/?")?{mimeType:"fluid/object",status:200,value:this}:(0,a.or)(e)}async finishInitialization(e){var t;return null!==(t=this.initializeP)&&void 0!==t||(this.initializeP=this.initializeInternal(e)),this.initializeP}async initializeInternal(e){var t;(await this.preInitialize(),e)?((0,s.vA)(void 0===this.initProps,190),await this.initializingFromExisting()):await this.initializingFirstTime(null!==(t=this.context.createProps)&&void 0!==t?t:this.initProps);await this.hasInitialized()}async preInitialize(){}async initializingFirstTime(e){}async initializingFromExisting(){}async hasInitialized(){}}class d extends c{constructor(){super(...arguments),this.rootDirectoryId="root"}get root(){if(!this.internalRoot)throw new Error(this.getUninitializedErrorString("root"));return this.internalRoot}async initializeInternal(e){e?(this.internalRoot=await this.runtime.getChannel(this.rootDirectoryId),this.internalRoot.attributes.type===o.n.Type&&this.runtime.logger.send({category:"generic",eventName:"MapDataObject",message:"Legacy document, SharedMap is masquerading as SharedDirectory in DataObject"})):(this.internalRoot=n.B.create(this.runtime,this.rootDirectoryId),this.internalRoot.bindToContext()),await super.initializeInternal(e)}getUninitializedErrorString(e){return"".concat(e," must be initialized before being accessed.")}}},96516:(e,t,r)=>{"use strict";var o,n,i;r.d(t,{Go:()=>o}),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(o||(o={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(n||(n={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(i||(i={}))},96689:(e,t,r)=>{"use strict";r.d(t,{Cx:()=>a,II:()=>i,JL:()=>o,K$:()=>n});const o="@fluidx/video-playback",n="@fluidx/video-playback-extended",i="@fluidx/video-notes-msa";class s{canLoad(e){const{packageName:t}=e;return t===o||t===i||t===n}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return Promise.all([r.e(97950),r.e(63843),r.e(26922),r.e(5053),r.e(66859),r.e(46548),r.e(53312),r.e(3280)]).then(r.bind(r,53312)).then(t=>({module:t,details:e}))}}const a={instantiateLoopCodeLoader:e=>Promise.resolve(new s)}},96752:(e,t,r)=>{"use strict";r.d(t,{HD:()=>s,P6:()=>o,Se:()=>n,db:()=>a,ou:()=>i});var o="__global__",n="__shadow_dom_stylesheet__",i={stylesheetKey:o,inShadow:!1,window:void 0,__isShadowConfig__:!0},s=function(e,t,r){return{stylesheetKey:e,inShadow:t,window:r,__isShadowConfig__:!0}},a=function(e){return!(!e||!function(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)}(e))&&!0===e.__isShadowConfig__}},96826:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var o=r(91608),n=r(65922);const i=(0,o.W)(n.oZ)},97232:(e,t,r)=>{"use strict";r.d(t,{d:()=>o});let o=function(e){return e[e.Success_Hydrated=0]="Success_Hydrated",e[e.Success_E2oNotViewed=1]="Success_E2oNotViewed",e[e.Success_NoFluidUrl=2]="Success_NoFluidUrl",e[e.Success_Aborted=3]="Success_Aborted",e[e.Error_FluidHostWebApp_Exception=500]="Error_FluidHostWebApp_Exception",e[e.ExpectedError_FluidHostWebApp_CannotFetchContainerManifest=501]="ExpectedError_FluidHostWebApp_CannotFetchContainerManifest",e[e.Error_Fluid_Undefined=1e3]="Error_Fluid_Undefined",e[e.Error_Fluid_UnknownError=1001]="Error_Fluid_UnknownError",e[e.Error_RenderFailed=1002]="Error_RenderFailed",e[e.Error_FluidContainer_DataCorruption=2e3]="Error_FluidContainer_DataCorruption",e[e.Error_FluidContainer_GeneralError=2001]="Error_FluidContainer_GeneralError",e[e.Error_FluidContainer_ThrottlingError=2002]="Error_FluidContainer_ThrottlingError",e[e.Error_FluidContainer_DataProcessingError=2003]="Error_FluidContainer_DataProcessingError",e[e.Error_FluidContainer_UsageError=2004]="Error_FluidContainer_UsageError",e[e.Error_FluidContainer_ClientSessionExpiredError=2005]="Error_FluidContainer_ClientSessionExpiredError",e[e.ExpectedError_FluidDriver_AuthorizationError=3e3]="ExpectedError_FluidDriver_AuthorizationError",e[e.ExpectedError_FluidDriver_FetchFailure=3001]="ExpectedError_FluidDriver_FetchFailure",e[e.ExpectedError_FluidDriver_FileNotFoundOrAccessDenied=3002]="ExpectedError_FluidDriver_FileNotFoundOrAccessDenied",e[e.Error_FluidDriver_GenericError=3003]="Error_FluidDriver_GenericError",e[e.Error_FluidDriver_GenericNetworkError=3004]="Error_FluidDriver_GenericNetworkError",e[e.Error_FluidDriver_IncorrectServerResponse=3005]="Error_FluidDriver_IncorrectServerResponse",e[e.ExpectedError_FluidDriver_OfflineError=3006]="ExpectedError_FluidDriver_OfflineError",e[e.Error_FluidDriver_ThrottlingError=3007]="Error_FluidDriver_ThrottlingError",e[e.Error_FluidDriver_UnsupportedClientProtocolVersion=3008]="Error_FluidDriver_UnsupportedClientProtocolVersion",e[e.Error_FluidDriver_WriteError=3009]="Error_FluidDriver_WriteError",e[e.Error_FluidDriver_FileOverwrittenInStorage=3010]="Error_FluidDriver_FileOverwrittenInStorage",e[e.Error_FluidDriver_DeltaStreamConnectionForbidden=3011]="Error_FluidDriver_DeltaStreamConnectionForbidden",e[e.Error_FluidDriver_LocationRedirection=3012]="Error_FluidDriver_LocationRedirection",e[e.Error_FluidDriver_FluidInvalidSchema=3013]="Error_FluidDriver_FluidInvalidSchema",e[e.Error_FluidDriver_UsageError=3014]="Error_FluidDriver_UsageError",e[e.Error_FluidDriver_FileIsLocked=3015]="Error_FluidDriver_FileIsLocked",e[e.Error_FluidOdsp_CannotCatchUp=4e3]="Error_FluidOdsp_CannotCatchUp",e[e.Error_FluidOdsp_FetchTimeout=4001]="Error_FluidOdsp_FetchTimeout",e[e.ExpectedError_FluidOdsp_FluidNotEnabled=4002]="ExpectedError_FluidOdsp_FluidNotEnabled",e[e.Error_FluidOdsp_InvalidFileNameError=4003]="Error_FluidOdsp_InvalidFileNameError",e[e.Error_FluidOdsp_OutOfStorageError=4004]="Error_FluidOdsp_OutOfStorageError",e[e.Error_FluidOdsp_SnapshotTooBig=4005]="Error_FluidOdsp_SnapshotTooBig",e[e.Error_FluidOdsp_FetchTokenError=4006]="Error_FluidOdsp_FetchTokenError",e[e.Error_FluidOdsp_ServiceReadOnly=4007]="Error_FluidOdsp_ServiceReadOnly",e[e.Error_FluidOdsp_BlockedIPAddress=4008]="Error_FluidOdsp_BlockedIPAddress",e[e.Error_FluidOWH_ContainerUpgradeRequired=5e3]="Error_FluidOWH_ContainerUpgradeRequired",e[e.Error_FluidOWH_IFrameLoadFailed=5001]="Error_FluidOWH_IFrameLoadFailed",e[e.Error_FluidOWH_ComponentNotFound=5002]="Error_FluidOWH_ComponentNotFound",e[e.Error_FluidContainerLoad_RootComponentCreateFailed=6e3]="Error_FluidContainerLoad_RootComponentCreateFailed",e[e.Error_FluidContainerLoad_RaasNotSupported=6001]="Error_FluidContainerLoad_RaasNotSupported",e}({})},97340:e=>{var t=1e3,r=60*t,o=60*r,n=24*o,i=7*n,s=365.25*n;function a(e,t,r,o){var n=t>=1.5*r;return Math.round(e/r)+" "+o+(n?"s":"")}e.exports=function(e,c){c=c||{};var d=typeof e;if("string"===d&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*o;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===d&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=n)return a(e,i,n,"day");if(i>=o)return a(e,i,o,"hour");if(i>=r)return a(e,i,r,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=n)return Math.round(e/n)+"d";if(i>=o)return Math.round(e/o)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},97423:(e,t,r)=>{"use strict";var o,n;r.d(t,{$:()=>n,S:()=>o}),function(e){e.File="100644",e.Executable="100755",e.Directory="040000",e.Symlink="120000"}(o||(o={})),function(e){e.Blob="Blob",e.Tree="Tree",e.Attachment="Attachment"}(n||(n={}))},97813:(e,t,r)=>{"use strict";r.d(t,{$:()=>o});const o={verbose:10,default:20,error:30}},98123:(e,t,r)=>{"use strict";function o(){return i}r.r(t),r.d(t,{addReferralParamsToStreamUrl:()=>s,getNpmCodeLoader:()=>o});class n{canLoad(e){return"@fluidx/video-playback"===e.packageName}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");return{module:await Promise.all([r.e(97950),r.e(63843),r.e(26922),r.e(5053),r.e(66859),r.e(46548),r.e(53312),r.e(19779)]).then(r.bind(r,54918)),details:e}}}const i={instantiateLoopCodeLoader:()=>Promise.resolve(new n)};function s(e,t){if("MailCompose"!==t&&"MailRead"!==t)return e;const r=new URL(e);if(r.searchParams.has("url"))return e;return function(e,t,r,o){const n="".concat(t,".").concat(r),i=e.searchParams.getAll("referrer"),s=e.searchParams.getAll("referrerScenario");if(i.length>0&&i[i.length-1]===n){if(!o)return;if(o&&s.length>0&&s[s.length-1]===o)return}e.searchParams.append("referrer",n),o&&e.searchParams.append("referrerScenario",o)}(r,"Outlook","Win32","email-linkwithembed"),r.toString()}},98483:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});var o=r(15894),n=r(24907);class i extends o.SA{get isAttached(){return this.routeContext.isAttached}get visible(){return this.isAttached||this.locallyVisible}constructor(e,t,r){super(),this.value=e,this.path=t,this.routeContext=r,this.pendingHandlesToMakeVisible=new Set,this.locallyVisible=!1,this.absolutePath=(0,n.a)(t,this.routeContext)}async get(){return this.value}attachGraph(){if(!this.visible){this.locallyVisible=!0;for(const e of this.pendingHandlesToMakeVisible)e.attachGraph();this.pendingHandlesToMakeVisible.clear(),this.routeContext.attachGraph()}}bind(e){this.visible?e.attachGraph():this.pendingHandlesToMakeVisible.add(e)}}},98581:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});const o=["#C239B3","#CA5010","#E3008C","#A4262C","#498205","#69797E","#881798","#D13438","#0078D4","#038387","#750B1C","#986F0B","#4F6BED","#8764B8","#0B6A0B","#7A7574","#5C2E91","#005B70","#8E562E"],n=["#DC8990","#DA846B","#ECC26E","#B5CC99","#78C9A0","#85ACB8","#7FA3D0","#CC87B1","#E47CA1","#BF9D8C"],i="--ms-themeColorThemeName",s="dark";class a{get PresenceColorProvider(){return this}get Disposable(){return this.disposable}constructor(e){var t;this.theming=e,this.nextColorToAssignIndex=0,this.colorAssignmentInFlight=new Set,this.deferredColorAssignment={},this.assignedColors=new Map,this.colorPalette=o,this.disposable={get Disposable(){return this},dispose:()=>{this.theming&&this.theming.off("themePropertiesChanged",this.themePropertiesChangedListener),this.colorAssignmentInFlight.clear(),this.assignedColors.clear()}},this.themePropertiesChangedListener=()=>{const e=this.getColorPaletteForTheme();e!==this.colorPalette&&(this.colorPalette=e,this.assignedColors.clear(),this.nextColorToAssignIndex=0)},null===(t=this.theming)||void 0===t||t.on("themePropertiesChanged",this.themePropertiesChangedListener),this.colorPalette=this.getColorPaletteForTheme()}getColorPaletteForTheme(){var e,t,r;return(null!==(e=null===(t=this.theming)||void 0===t?void 0:t.themeName)&&void 0!==e?e:null===(r=this.theming)||void 0===r||null===(r=r.themeProperties)||void 0===r?void 0:r.get(i))===s?n:o}dispose(){this.Disposable.dispose()}async getPresenceColorForUser(e){const t=this.assignedColors.get(e);if(t)return Promise.resolve(t);if(this.colorAssignmentInFlight.has(e))return new Promise(t=>{this.deferredColorAssignment[e].push(t)});this.colorAssignmentInFlight.add(e);const r=this.colorPalette[this.nextColorToAssignIndex];if(this.nextColorToAssignIndex=(this.nextColorToAssignIndex+1)%this.colorPalette.length,this.assignedColors.set(e,r),this.colorAssignmentInFlight.delete(e),void 0!==this.deferredColorAssignment[e])for(const o of this.deferredColorAssignment[e])o(r);return delete this.deferredColorAssignment[e],Promise.resolve(r)}}},98679:(e,t,r)=>{"use strict";r.d(t,{m:()=>i});var o=r(16218);const n="--";function i(e){const t=[];e.black&&t.push([o.Ve.black,e.black]),e.white&&t.push([o.Ve.white,e.white]),e.greys&&t.push([o.Ve.neutralDark,e.greys[8]],[o.Ve.neutralPrimary,e.greys[14]],[o.Ve.neutralPrimaryAlt,e.greys[22]],[o.Ve.neutralSecondary,e.greys[36]],[o.Ve.neutralSecondaryAlt,e.greys[52]],[o.Ve.neutralTertiary,e.greys[62]],[o.Ve.neutralTertiaryAlt,e.greys[78]],[o.Ve.neutralQuaternary,e.greys[82]],[o.Ve.neutralQuaternaryAlt,e.greys[88]],[o.Ve.neutralLight,e.greys[92]],[o.Ve.neutralLighter,e.greys[96]],[o.Ve.neutralLighterAlt,e.greys[98]]),e.brandVariants&&t.push([o.Ve.themeDarker,e.brandVariants[40]],[o.Ve.themeDark,e.brandVariants[60]],[o.Ve.themeDarkAlt,e.brandVariants[70]],[o.Ve.themePrimary,e.brandVariants[80]],[o.Ve.themeSecondary,e.brandVariants[90]],[o.Ve.themeTertiary,e.brandVariants[120]],[o.Ve.themeLight,e.brandVariants[140]],[o.Ve.themeLighter,e.brandVariants[150]],[o.Ve.themeLighterAlt,e.brandVariants[160]]),Object.entries(e.fluentThemeV9).forEach(e=>{let[r,o]=e;const i=(s=r).startsWith(n)?s:"".concat(n).concat(s);var s;t.push([i,o.toString()])});const r=[];for(const o of t)r.push({name:o[0],value:o[1]});return r}},99282:(e,t,r)=>{"use strict";r.d(t,{Jf:()=>o,RC:()=>n,RG:()=>a,be:()=>c,hW:()=>s,kZ:()=>i});const o={colorNeutralForeground1:"--colorNeutralForeground1",colorNeutralForeground1Hover:"--colorNeutralForeground1Hover",colorNeutralForeground1Pressed:"--colorNeutralForeground1Pressed",colorNeutralForeground1Selected:"--colorNeutralForeground1Selected",colorNeutralForeground2:"--colorNeutralForeground2",colorNeutralForeground2Hover:"--colorNeutralForeground2Hover",colorNeutralForeground2Pressed:"--colorNeutralForeground2Pressed",colorNeutralForeground2Selected:"--colorNeutralForeground2Selected",colorNeutralForeground2BrandHover:"--colorNeutralForeground2BrandHover",colorNeutralForeground2BrandPressed:"--colorNeutralForeground2BrandPressed",colorNeutralForeground2BrandSelected:"--colorNeutralForeground2BrandSelected",colorNeutralForeground3:"--colorNeutralForeground3",colorNeutralForeground3Hover:"--colorNeutralForeground3Hover",colorNeutralForeground3Pressed:"--colorNeutralForeground3Pressed",colorNeutralForeground3Selected:"--colorNeutralForeground3Selected",colorNeutralForeground3BrandHover:"--colorNeutralForeground3BrandHover",colorNeutralForeground3BrandPressed:"--colorNeutralForeground3BrandPressed",colorNeutralForeground3BrandSelected:"--colorNeutralForeground3BrandSelected",colorNeutralForeground4:"--colorNeutralForeground4",colorNeutralForegroundDisabled:"--colorNeutralForegroundDisabled",colorBrandForegroundLink:"--colorBrandForegroundLink",colorBrandForegroundLinkHover:"--colorBrandForegroundLinkHover",colorBrandForegroundLinkPressed:"--colorBrandForegroundLinkPressed",colorBrandForegroundLinkSelected:"--colorBrandForegroundLinkSelected",colorNeutralForeground2Link:"--colorNeutralForeground2Link",colorNeutralForeground2LinkHover:"--colorNeutralForeground2LinkHover",colorNeutralForeground2LinkPressed:"--colorNeutralForeground2LinkPressed",colorNeutralForeground2LinkSelected:"--colorNeutralForeground2LinkSelected",colorCompoundBrandForeground1:"--colorCompoundBrandForeground1",colorCompoundBrandForeground1Hover:"--colorCompoundBrandForeground1Hover",colorCompoundBrandForeground1Pressed:"--colorCompoundBrandForeground1Pressed",colorNeutralForegroundOnBrand:"--colorNeutralForegroundOnBrand",colorNeutralForegroundInverted:"--colorNeutralForegroundInverted",colorNeutralForegroundInvertedHover:"--colorNeutralForegroundInvertedHover",colorNeutralForegroundInvertedPressed:"--colorNeutralForegroundInvertedPressed",colorNeutralForegroundInvertedSelected:"--colorNeutralForegroundInvertedSelected",colorNeutralForegroundInverted2:"--colorNeutralForegroundInverted2",colorNeutralForegroundStaticInverted:"--colorNeutralForegroundStaticInverted",colorNeutralForegroundInvertedLink:"--colorNeutralForegroundInvertedLink",colorNeutralForegroundInvertedLinkHover:"--colorNeutralForegroundInvertedLinkHover",colorNeutralForegroundInvertedLinkPressed:"--colorNeutralForegroundInvertedLinkPressed",colorNeutralForegroundInvertedLinkSelected:"--colorNeutralForegroundInvertedLinkSelected",colorNeutralForegroundInvertedDisabled:"--colorNeutralForegroundInvertedDisabled",colorBrandForeground1:"--colorBrandForeground1",colorBrandForeground2:"--colorBrandForeground2",colorNeutralForeground1Static:"--colorNeutralForeground1Static",colorBrandForegroundInverted:"--colorBrandForegroundInverted",colorBrandForegroundInvertedHover:"--colorBrandForegroundInvertedHover",colorBrandForegroundInvertedPressed:"--colorBrandForegroundInvertedPressed",colorBrandForegroundOnLight:"--colorBrandForegroundOnLight",colorBrandForegroundOnLightHover:"--colorBrandForegroundOnLightHover",colorBrandForegroundOnLightPressed:"--colorBrandForegroundOnLightPressed",colorBrandForegroundOnLightSelected:"--colorBrandForegroundOnLightSelected",colorNeutralBackground1:"--colorNeutralBackground1",colorNeutralBackground1Hover:"--colorNeutralBackground1Hover",colorNeutralBackground1Pressed:"--colorNeutralBackground1Pressed",colorNeutralBackground1Selected:"--colorNeutralBackground1Selected",colorNeutralBackground2:"--colorNeutralBackground2",colorNeutralBackground2Hover:"--colorNeutralBackground2Hover",colorNeutralBackground2Pressed:"--colorNeutralBackground2Pressed",colorNeutralBackground2Selected:"--colorNeutralBackground2Selected",colorNeutralBackground3:"--colorNeutralBackground3",colorNeutralBackground3Hover:"--colorNeutralBackground3Hover",colorNeutralBackground3Pressed:"--colorNeutralBackground3Pressed",colorNeutralBackground3Selected:"--colorNeutralBackground3Selected",colorNeutralBackground4:"--colorNeutralBackground4",colorNeutralBackground4Hover:"--colorNeutralBackground4Hover",colorNeutralBackground4Pressed:"--colorNeutralBackground4Pressed",colorNeutralBackground4Selected:"--colorNeutralBackground4Selected",colorNeutralBackground5:"--colorNeutralBackground5",colorNeutralBackground5Hover:"--colorNeutralBackground5Hover",colorNeutralBackground5Pressed:"--colorNeutralBackground5Pressed",colorNeutralBackground5Selected:"--colorNeutralBackground5Selected",colorNeutralBackground6:"--colorNeutralBackground6",colorNeutralBackgroundInverted:"--colorNeutralBackgroundInverted",colorNeutralBackgroundStatic:"--colorNeutralBackgroundStatic",colorSubtleBackground:"--colorSubtleBackground",colorSubtleBackgroundHover:"--colorSubtleBackgroundHover",colorSubtleBackgroundPressed:"--colorSubtleBackgroundPressed",colorSubtleBackgroundSelected:"--colorSubtleBackgroundSelected",colorSubtleBackgroundLightAlphaHover:"--colorSubtleBackgroundLightAlphaHover",colorSubtleBackgroundLightAlphaPressed:"--colorSubtleBackgroundLightAlphaPressed",colorSubtleBackgroundLightAlphaSelected:"--colorSubtleBackgroundLightAlphaSelected",colorSubtleBackgroundInverted:"--colorSubtleBackgroundInverted",colorSubtleBackgroundInvertedHover:"--colorSubtleBackgroundInvertedHover",colorSubtleBackgroundInvertedPressed:"--colorSubtleBackgroundInvertedPressed",colorSubtleBackgroundInvertedSelected:"--colorSubtleBackgroundInvertedSelected",colorTransparentBackground:"--colorTransparentBackground",colorTransparentBackgroundHover:"--colorTransparentBackgroundHover",colorTransparentBackgroundPressed:"--colorTransparentBackgroundPressed",colorTransparentBackgroundSelected:"--colorTransparentBackgroundSelected",colorNeutralBackgroundDisabled:"--colorNeutralBackgroundDisabled",colorNeutralBackgroundInvertedDisabled:"--colorNeutralBackgroundInvertedDisabled",colorNeutralStencil1:"--colorNeutralStencil1",colorNeutralStencil2:"--colorNeutralStencil2",colorNeutralStencil1Alpha:"--colorNeutralStencil1Alpha",colorNeutralStencil2Alpha:"--colorNeutralStencil2Alpha",colorBackgroundOverlay:"--colorBackgroundOverlay",colorScrollbarOverlay:"--colorScrollbarOverlay",colorBrandBackground:"--colorBrandBackground",colorBrandBackgroundHover:"--colorBrandBackgroundHover",colorBrandBackgroundPressed:"--colorBrandBackgroundPressed",colorBrandBackgroundSelected:"--colorBrandBackgroundSelected",colorCompoundBrandBackground:"--colorCompoundBrandBackground",colorCompoundBrandBackgroundHover:"--colorCompoundBrandBackgroundHover",colorCompoundBrandBackgroundPressed:"--colorCompoundBrandBackgroundPressed",colorBrandBackgroundStatic:"--colorBrandBackgroundStatic",colorBrandBackground2:"--colorBrandBackground2",colorBrandBackground2Pressed:"--colorBrandBackground2Pressed",colorBrandBackground2Hover:"--colorBrandBackground2Hover",colorBrandBackgroundInverted:"--colorBrandBackgroundInverted",colorBrandBackgroundInvertedHover:"--colorBrandBackgroundInvertedHover",colorBrandBackgroundInvertedPressed:"--colorBrandBackgroundInvertedPressed",colorBrandBackgroundInvertedSelected:"--colorBrandBackgroundInvertedSelected",colorNeutralStrokeAccessible:"--colorNeutralStrokeAccessible",colorNeutralStrokeAccessibleHover:"--colorNeutralStrokeAccessibleHover",colorNeutralStrokeAccessiblePressed:"--colorNeutralStrokeAccessiblePressed",colorNeutralStrokeAccessibleSelected:"--colorNeutralStrokeAccessibleSelected",colorNeutralStrokeAlpha:"--colorNeutralStrokeAlpha",colorNeutralStroke1:"--colorNeutralStroke1",colorNeutralStroke1Hover:"--colorNeutralStroke1Hover",colorNeutralStroke1Pressed:"--colorNeutralStroke1Pressed",colorNeutralStroke1Selected:"--colorNeutralStroke1Selected",colorNeutralStroke2:"--colorNeutralStroke2",colorNeutralStroke3:"--colorNeutralStroke3",colorNeutralStrokeOnBrand:"--colorNeutralStrokeOnBrand",colorNeutralStrokeOnBrand2:"--colorNeutralStrokeOnBrand2",colorNeutralStrokeOnBrand2Hover:"--colorNeutralStrokeOnBrand2Hover",colorNeutralStrokeOnBrand2Pressed:"--colorNeutralStrokeOnBrand2Pressed",colorNeutralStrokeOnBrand2Selected:"--colorNeutralStrokeOnBrand2Selected",colorBrandStroke1:"--colorBrandStroke1",colorBrandStroke2:"--colorBrandStroke2",colorCompoundBrandStroke:"--colorCompoundBrandStroke",colorCompoundBrandStrokeHover:"--colorCompoundBrandStrokeHover",colorCompoundBrandStrokePressed:"--colorCompoundBrandStrokePressed",colorNeutralStrokeDisabled:"--colorNeutralStrokeDisabled",colorNeutralStrokeInvertedDisabled:"--colorNeutralStrokeInvertedDisabled",colorTransparentStroke:"--colorTransparentStroke",colorTransparentStrokeInteractive:"--colorTransparentStrokeInteractive",colorTransparentStrokeDisabled:"--colorTransparentStrokeDisabled",colorStrokeFocus1:"--colorStrokeFocus1",colorStrokeFocus2:"--colorStrokeFocus2",colorNeutralShadowAmbient:"--colorNeutralShadowAmbient",colorNeutralShadowKey:"--colorNeutralShadowKey",colorNeutralShadowAmbientLighter:"--colorNeutralShadowAmbientLighter",colorNeutralShadowKeyLighter:"--colorNeutralShadowKeyLighter",colorNeutralShadowAmbientDarker:"--colorNeutralShadowAmbientDarker",colorNeutralShadowKeyDarker:"--colorNeutralShadowKeyDarker",colorBrandShadowAmbient:"--colorBrandShadowAmbient",colorBrandShadowKey:"--colorBrandShadowKey",colorPaletteDarkOrangeForeground1:"--colorPaletteDarkOrangeForeground1",colorPaletteRedForeground1:"--colorPaletteRedForeground1",colorPaletteYellowBackground2:"--colorPaletteYellowBackground2",colorPaletteDarkOrangeBorderActive:"--colorPaletteDarkOrangeBorderActive",colorPaletteGrapeBorderActive:"--colorPaletteGrapeBorderActive"},n={fontFamilyBase:"--fontFamilyBase",fontFamilyMonospace:"--fontFamilyMonospace",fontFamilyNumeric:"--fontFamilyNumeric"},i={fontSizeBase100:"--fontSizeBase100",fontSizeBase200:"--fontSizeBase200",fontSizeBase300:"--fontSizeBase300",fontSizeBase400:"--fontSizeBase400",fontSizeBase500:"--fontSizeBase500",fontSizeBase600:"--fontSizeBase600",fontSizeHero700:"--fontSizeHero700",fontSizeHero800:"--fontSizeHero800",fontSizeHero900:"--fontSizeHero900",fontSizeHero1000:"--fontSizeHero1000"},s={fontWeightRegular:"--fontWeightRegular",fontWeightMedium:"--fontWeightMedium",fontWeightSemibold:"--fontWeightSemibold",fontWeightBold:"--fontWeightBold"},a={lineHeightBase100:"--lineHeightBase100",lineHeightBase200:"--lineHeightBase200",lineHeightBase300:"--lineHeightBase300",lineHeightBase400:"--lineHeightBase400",lineHeightBase500:"--lineHeightBase500",lineHeightBase600:"--lineHeightBase600",lineHeightHero700:"--lineHeightHero700",lineHeightHero800:"--lineHeightHero800",lineHeightHero900:"--lineHeightHero900",lineHeightHero1000:"--lineHeightHero1000"},c={colorNeutralBackground7:"--colorNeutralBackground7",colorNeutralBackground7Selected:"--colorNeutralBackground7Selected"}},99671:(e,t,r)=>{"use strict";r.d(t,{Cu:()=>v,Mh:()=>y,kt:()=>f});var o=r(2875),n=r(78796);const i="1",s="fluid",a="s",c="d",d="f",l="c",u="a",h="p",g="v",p="x";function f(e){const t=new URL(e.siteUrl),r=encodeURIComponent(t.pathname),n=encodeURIComponent(e.driveId),f=encodeURIComponent(e.itemId),m=encodeURIComponent(e.dataStorePath);let v="".concat(a,"=").concat(r,"&").concat(c,"=").concat(n,"&").concat(d,"=").concat(f,"&").concat(l,"=").concat(m,"&").concat(s,"=").concat(i);return e.appName&&(v+="&".concat(u,"=").concat(encodeURIComponent(e.appName))),e.containerPackageName&&(v+="&".concat(h,"=").concat(encodeURIComponent(e.containerPackageName))),e.fileVersion&&(v+="&".concat(g,"=").concat(encodeURIComponent(e.fileVersion))),e.context&&(v+="&".concat(p,"=").concat(encodeURIComponent(e.context))),(0,o.O0)(v)}const m="nav";function v(e,t){const r=f(t);e.searchParams.set(m,r)}function y(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.searchParams.get(m);if(!r)return;return function(e,t){var r,n,i,f;let m=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const v=new URLSearchParams((0,o.AH)(e)),y=v.get(s);if(m&&"1"!==y)return;const b=v.get(a),S=v.get(c),C=v.get(d),k=v.get(l),w=null!==(r=v.get(u))&&void 0!==r?r:void 0,P=null!==(n=v.get(h))&&void 0!==n?n:void 0,T=null!==(i=v.get(g))&&void 0!==i?i:void 0,E=null!==(f=v.get(p))&&void 0!==f?f:void 0;if(!b||!S||!C||null===k)return;let I;try{I=new URL(b,t)}catch(N){}return I?{siteUrl:I.href,driveId:S,itemId:C,dataStorePath:k,appName:w,containerPackageName:P,fileVersion:T,context:E}:void 0}(r,e.origin.toLowerCase()===n.W?n.i:e.origin,t)}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=e,r.F={},r.E=e=>{Object.keys(r.F).map(t=>{r.F[t](e)})},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(o,n){if(1&n&&(o=this(o)),8&n)return o;if("object"===typeof o&&o){if(4&n&&o.__esModule)return o;if(16&n&&"function"===typeof o.then)return o}var i=Object.create(null);r.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&o;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>s[e]=()=>o[e]);return s.default=()=>o,r.d(i,s),i}})(),r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,o)=>(r.f[o](e,t),t),[])),r.u=e=>"static/js/"+({170:"InformationProtectionStrings82",361:"shareServiceStrings6",372:"genericLinkStrings84",467:"genericLinkStrings61",470:"genericLinkStrings37",522:"shareServiceStrings36",620:"shareServiceStrings81",1188:"cardloopstrings_ca-es-valencia-json",1214:"InformationProtectionStrings28",1261:"VideoPlaybackStrings59",1303:"graphapi",1686:"cardloopstrings_kok-json",1734:"InformationProtectionStrings15",1994:"cardloopstrings_en-gb-json",2118:"InformationProtectionStrings64",2246:"notificationac",2440:"fluidHost-odsp",2472:"cardloopstrings_sv-json",2544:"shareServiceStrings70",2690:"el-plex-strings-json",2744:"cardloopstrings_vi-json",2892:"InformationProtectionStrings40",3150:"graphservice",3181:"shareServiceStrings2",3280:"videoPlaybackComponent",3304:"genericLinkStrings0",3349:"genericLinkStrings23",3367:"viewtransformsac",3401:"hostUxStrings45",3459:"shareServiceStrings42",3642:"usermodule",3678:"VideoPlaybackStrings52",3900:"hostUxStrings4",4062:"VideoPlaybackStrings85",4085:"cardloopstrings_sq-json",4256:"genericLinkStrings31",4316:"hostUxStrings71",4440:"ar-plex-strings-json",4524:"MTSFoundInPlaces",4554:"InformationProtectionStrings19",4856:"driveitemmodule",4938:"InformationProtectionStrings68",5220:"activityac",5364:"shareServiceStrings74",5520:"InformationProtectionStrings13",5828:"unifiedgroupmodule",5851:"diffsyncmodule",6279:"shareServiceStrings46",6363:"addformrequirementdialog",6373:"InformationProtectionStrings85",6667:"hostUxStrings54",6689:"genericLinkStrings12",6725:"shareServiceStrings31",6830:"genericLinkStrings64",7010:"cardloopstrings_bs-latn-ba-json",7076:"genericLinkStrings35",7135:"genericLinkStrings29",7320:"cardloopstrings_ru-json",7464:"VideoPlaybackStrings54",7902:"cardloopstrings_tk-tm-json",8010:"permissionmodule",8081:"lb-lu-plex-strings-json",8340:"InformationProtectionStrings17",8446:"VideoPlaybackStrings38",8461:"cardloopstrings_km-kh-json",8500:"sr-latn-rs-plex-strings-json",8826:"cardloopstrings_ar-json",8857:"InformationProtectionStrings38",8996:"qps-ploc-plex-strings-json",9350:"VideoPlaybackStrings74",9444:"shareCallout",9496:"settingsac",9507:"genericLinkStrings3",9770:"userac",10041:"bucketmodule",10065:"shareServiceStrings40",10077:"cardloopstrings_quz-pe-json",10119:"nb-no-plex-strings-json",10135:"richtexteditorribbon",10301:"quz-pe-plex-strings-json",10332:"cardloopstrings_el-json",10361:"genericLinkStrings81",10475:"genericLinkStrings18",10506:"hostUxStrings2",10538:"PlannerComponent",10616:"genericLinkStrings62",10720:"gateddirectoryservice",10922:"hostUxStrings77",11133:"summaryModule",11567:"shareServiceStrings77",11966:"hostUxStrings15",11983:"cardloopstrings_sk-json",12870:"hostUxStrings51",12892:"genericLinkStrings17",12956:"socketModule",13170:"shareServiceStrings5",13181:"genericLinkStrings85",13276:"genericLinkStrings66",13279:"genericLinkStrings36",13311:"kk-plex-strings-json",13482:"FluidFramework-HashFallback",13499:"InformationProtectionStrings76",13667:"VideoPlaybackStrings57",14044:"he-plex-strings-json",14094:"InformationProtectionStrings37",14295:"cardloopstrings_eu-json",14427:"cardloopstrings_ko-json",14543:"InformationProtectionStrings14",14664:"telemetrymodule",14708:"hostUxStrings79",14782:"pt-pt-plex-strings-json",15286:"shareServiceStrings29",15353:"shareServiceStrings71",15434:"et-plex-strings-json",15456:"containermodule",15596:"odspservice",15700:"af-plex-strings-json",15797:"sr-cyrl-ba-plex-strings-json",16158:"genericLinkStrings20",16210:"hostUxStrings46",16268:"shareServiceStrings45",16487:"VideoPlaybackStrings53",16709:"hostUxStrings5",16740:"cardloopstrings_bn-bd-json",16766:"cardloopstrings_lo-la-json",16829:"cardloopstrings_zh-hant-json",17065:"genericLinkStrings30",17125:"hostUxStrings70",17620:"card-loop",17740:"cardloopstrings_ja-json",17880:"InformationProtectionStrings31",18106:"shareServiceStrings25",18329:"InformationProtectionStrings12",18407:"shareServiceStrings8",18510:"linksmodule",18623:"cardloopstrings_es-mx-json",18728:"cardloopstrings_fi-json",18848:"bs-latn-ba-plex-strings-json",19411:"gatedtsapi",19498:"genericLinkStrings11",19499:"VideoPlaybackStrings71",19632:"VideoPlaybackStrings29",19639:"genericLinkStrings65",19702:"InformationProtectionStrings73",19779:"fluidHost-videoLoop",19885:"genericLinkStrings34",20273:"VideoPlaybackStrings55",20731:"VideoPlaybackStrings66",20854:"cardloopstrings_bg-json",21139:"cardloopstrings_lb-lu-json",21149:"InformationProtectionStrings16",21211:"nl-plex-strings-json",21702:"cardloopstrings_de-json",21724:"planarchivedstateview",21910:"az-latn-az-plex-strings-json",22316:"genericLinkStrings4",22573:"hostUxStrings41",22874:"shareServiceStrings43",22968:"InformationProtectionStrings80",23170:"genericLinkStrings82",23394:"shareServiceStrings54",23425:"genericLinkStrings63",23488:"InformationProtectionStrings75",23840:"shareServiceStrings49",23852:"bg-plex-strings-json",23945:"genericLinkStrings56",24083:"InformationProtectionStrings32",24251:"hostUxStrings69",24309:"shareServiceStrings22",24376:"shareServiceStrings78",24637:"cardloopstrings_sd-arab-pk-json",24901:"loopappdialogs",25072:"VideoPlaybackStrings1",25115:"VideoPlaybackStrings13",25253:"editformdialog",25416:"pa-plex-strings-json",25701:"genericLinkStrings16",25785:"bucketac",25914:"planmodule",25921:"InformationProtectionStrings56",25979:"shareServiceStrings4",26047:"zh-cn-plex-strings-json",26088:"genericLinkStrings39",26308:"InformationProtectionStrings71",26329:"cardloopstrings_tt-json",26476:"VideoPlaybackStrings50",26584:"hi-plex-strings-json",26660:"cardloopstrings_et-json",26765:"genericLinkStrings52",26853:"playbackStateHandler",26873:"officeFluidOneDsSink",26903:"InformationProtectionStrings36",26934:"VideoPlaybackStrings63",26937:"cardloopstrings_es-json",26983:"cardloopstrings_kk-json",27211:"genericLinkStrings69",27517:"hostUxStrings78",27717:"gu-plex-strings-json",27719:"cardloopstrings_sr-cyrl-json",27837:"th-plex-strings-json",27861:"pl-plex-strings-json",27892:"VideoPlaybackStrings5",28095:"shareServiceStrings28",28162:"shareServiceStrings72",28318:"cardloopstrings_af-json",28391:"card-loop-jitcardview",28522:"VideoPlaybackStrings78",28573:"campaignmodule",28679:"genericLinkStrings7",28688:"InformationProtectionStrings0",28725:"InformationProtectionStrings78",28884:"cardloopstrings_ga-ie-json",29077:"shareServiceStrings44",29171:"InformationProtectionStrings83",29874:"genericLinkStrings33",29888:"genericLinkStrings8",29934:"hostUxStrings73",29936:"cardloopstrings_mi-nz-json",30138:"intelligenceac",30689:"InformationProtectionStrings30",30720:"VideoPlaybackStrings65",30759:"cardloopstrings_cs-json",30813:"es-mx-plex-strings-json",31209:"InformationProtectionStrings27",31318:"VideoPlaybackStrings16",31436:"hostUxStrings48",31487:"cs-plex-strings-json",31508:"InformationProtectionStrings4",31591:"bn-in-plex-strings-json",31902:"or-in-plex-strings-json",32124:"InformationProtectionStrings53",32175:"hostUxStrings29",32182:"shareServiceStrings1",32441:"VideoPlaybackStrings28",32465:"genericLinkStrings1",32511:"InformationProtectionStrings72",33019:"hostUxStrings83",33201:"directoryservice",33274:"hostUxStrings60",33321:"shareServiceStrings13",33477:"ca-plex-strings-json",33540:"VideoPlaybackStrings61",33555:"InformationProtectionStrings18",33720:"hostUxStrings75",33884:"SharepointNotificationService",33892:"cardloopstrings_ml-json",34095:"VideoPlaybackStrings6",34525:"shareServiceStrings75",34624:"ga-ie-plex-strings-json",34905:"ug-plex-strings-json",35104:"VideoPlaybackStrings10",35125:"genericLinkStrings5",35222:"hostUxStrings42",35848:"MTSFoundInPlacesInfo",35910:"InformationProtectionStrings59",35957:"VideoPlaybackStrings68",35968:"shareServiceStrings7",35979:"genericLinkStrings83",36074:"sv-plex-strings-json",36079:"tr-plex-strings-json",36203:"shareServiceStrings55",36234:"genericLinkStrings60",36297:"InformationProtectionStrings74",36754:"genericLinkStrings55",36818:"tasksbyplanviewac",36892:"InformationProtectionStrings35",37118:"shareServiceStrings21",37185:"shareServiceStrings79",37290:"cardloopstrings_gd-gb-json",37308:"taskmodule",37466:"genericLinkStrings77",37678:"VideoPlaybackStrings27",37711:"InformationProtectionStrings7",37881:"VideoPlaybackStrings0",37924:"VideoPlaybackStrings14",38146:"cardloopstrings_gl-json",38328:"cardloopstrings_kn-json",38422:"cardloopstrings_ur-json",38510:"genericLinkStrings15",38529:"cardloopstrings_uk-json",38730:"InformationProtectionStrings55",38788:"shareServiceStrings3",38856:"sl-plex-strings-json",38897:"genericLinkStrings38",39008:"hostUxStrings44",39117:"InformationProtectionStrings70",39477:"hostUxStrings67",39479:"fil-ph-plex-strings-json",39743:"VideoPlaybackStrings62",39862:"id-plex-strings-json",39923:"hostUxStrings76",40044:"card-loop-herocardview",40077:"cardloopstrings_th-json",40104:"apppoweredtasksection",40136:"cardloopstrings_be-by-json",40362:"intelligencemodule",40513:"tsgraphodataapi",40701:"VideoPlaybackStrings4",40856:"cardloopstrings_id-json",40904:"shareServiceStrings27",40971:"shareServiceStrings73",41165:"cardloopstrings_ka-json",41198:"hostUxStrings20",41252:"genericLinkStrings79",41380:"taskac",41464:"VideoPlaybackStrings21",41497:"InformationProtectionStrings1",41886:"shareServiceStrings47",41991:"genericLinkStrings58",42038:"PlannerLinkComponent",42067:"formresponseviewdialog",42296:"genericLinkStrings13",42406:"shareServiceStrings50",42437:"genericLinkStrings67",42503:"LazyPermissionsPopoverTrigger1",42743:"hostUxStrings72",42966:"LazyFluidMessageBannerStack",42967:"gatedconversationsservice",43008:"hostUxStrings80",43280:"cardloopstrings_fa-json",43529:"VideoPlaybackStrings64",43669:"genericLinkStrings70",44127:"VideoPlaybackStrings17",44245:"hostUxStrings49",44285:"ms-plex-strings-json",44317:"InformationProtectionStrings5",44729:"tt-plex-strings-json",44769:"PlannerInsertionComponent",44874:"gatedgraphapi",44933:"InformationProtectionStrings52",44941:"cardloopstrings_cy-json",44984:"hostUxStrings26",44991:"shareServiceStrings0",45274:"genericLinkStrings2",45371:"hostUxStrings47",45590:"LazyLastEdited",45828:"hostUxStrings84",46075:"diffsyncac",46120:"cardloopstrings_it-json",46130:"shareServiceStrings10",46192:"shareServiceStrings56",46349:"VideoPlaybackStrings60",46904:"VideoPlaybackStrings9",47107:"shareServiceStrings24",47169:"cardloopstrings_as-in-json",47174:"shareServiceStrings76",47534:"fa-plex-strings-json",47550:"uz-latn-uz-plex-strings-json",47649:"cardloopstrings_sr-cyrl-ba-json",47665:"qps-ploca-plex-strings-json",47667:"VideoPlaybackStrings22",47913:"VideoPlaybackStrings11",47934:"genericLinkStrings6",48031:"hostUxStrings43",48406:"cardloopstrings_hy-json",48499:"genericLinkStrings10",48547:"shareServiceStrings19",48704:"cardloopstrings_pa-in-json",48719:"InformationProtectionStrings58",48867:"ko-plex-strings-json",49012:"shareServiceStrings52",49106:"InformationProtectionStrings77",49505:"VideoPlaybackStrings46",49563:"genericLinkStrings54",49669:"cardloopstrings_pt-json",49701:"InformationProtectionStrings34",49927:"shareServiceStrings20",50177:"lt-plex-strings-json",50381:"InformationProtectionStrings23",50487:"VideoPlaybackStrings26",50520:"InformationProtectionStrings8",50618:"cardloopstrings_he-json",50690:"VideoPlaybackStrings3",50924:"fluidHost-cardLoop",50932:"mr-plex-strings-json",51187:"hostUxStrings25",51194:"cardloopstrings_no-json",51306:"planac",51319:"genericLinkStrings14",51383:"cardloopstrings_tr-json",51458:"cardloopstrings_fil-json",52253:"fr-plex-strings-json",52286:"hostUxStrings64",52487:"gatedplannerservice",52492:"LazyPermissionsPopoverTrigger2",52493:"shareServiceStrings17",53408:"te-plex-strings-json",53423:"cardloopstrings_ug-cn-json",53713:"shareServiceStrings26",54007:"hostUxStrings21",54014:"shareServiceStrings9",54061:"genericLinkStrings78",54062:"cardloopstrings_prs-json",54101:"cardloopstrings_ky-json",54273:"VideoPlaybackStrings20",54306:"InformationProtectionStrings2",54651:"cardloopstrings_am-json",54793:"VideoPlaybackStrings37",54853:"sq-plex-strings-json",54914:"hostUxStrings33",55215:"shareServiceStrings51",55547:"lv-plex-strings-json",55708:"VideoPlaybackStrings43",55766:"genericLinkStrings51",55807:"km-kh-plex-strings-json",55817:"hostUxStrings81",55892:"shareServiceStrings38",56012:"ur-plex-strings-json",56072:"hostUxStrings62",56176:"de-plex-strings-json",56186:"kn-plex-strings-json",56338:"VideoPlaybackStrings67",56458:"userplansretrievalac",56478:"genericLinkStrings73",56936:"VideoPlaybackStrings18",57339:"cardloopstrings_si-lk-json",57488:"InformationProtectionStrings62",57605:"es-plex-strings-json",57613:"VideoPlaybackStrings33",57628:"cardloopstrings_mt-mt-json",57668:"cardloopstrings_sr-json",57742:"InformationProtectionStrings51",57793:"hostUxStrings27",57877:"cardloopstrings_ca-json",58135:"cardloopstrings_en-us-json",58180:"hostUxStrings40",58555:"shareServiceStrings60",58637:"hostUxStrings85",58800:"cardloopstrings_zu-za-json",59001:"shareServiceStrings57",59007:"sr-cyrl-rs-plex-strings-json",59062:"card-loop-adaptivecardview",59106:"genericLinkStrings46",59432:"VideoPlaybackStrings83",59494:"VideoPlaybackStrings49",59552:"genericLinkStrings57",59713:"VideoPlaybackStrings8",59805:"cy-gb-plex-strings-json",59850:"InformationProtectionStrings33",59858:"hostUxStrings68",59885:"uk-plex-strings-json",59916:"shareServiceStrings23",59941:"AshaUtils",59950:"cardloopstrings_ro-json",60250:"lo-plex-strings-json",60264:"genericLinkStrings75",60308:"InformationProtectionStrings66",60370:"InformationProtectionStrings24",60476:"VideoPlaybackStrings25",60722:"VideoPlaybackStrings12",61082:"InformationProtectionStrings46",61528:"InformationProtectionStrings57",61578:"ml-plex-strings-json",61821:"shareServiceStrings53",62275:"hostUxStrings61",62314:"VideoPlaybackStrings45",62364:"da-plex-strings-json",62372:"genericLinkStrings53",62521:"cardloopstrings_mk-json",62530:"card-loop-signincardview",62547:"cardloopstrings_ne-np-json",62672:"requirementssection",63030:"InformationProtectionStrings20",63056:"hostUxStrings8",63120:"cardloopstrings_ha-latn-ng-json",63329:"InformationProtectionStrings9",63499:"VideoPlaybackStrings2",63605:"qps-plocm-plex-strings-json",63874:"plannerservice",63937:"hostUxStrings38",63996:"hostUxStrings22",64062:"cardloopstrings_mr-json",64238:"shareServiceStrings58",64332:"InformationProtectionStrings79",64720:"VideoPlaybackStrings72",64758:"shareServiceStrings65",64868:"InformationProtectionStrings48",64969:"ne-np-plex-strings-json",65013:"shareServiceStrings80",65095:"hostUxStrings65",65142:"shareServiceStrings14",65354:"SharepointInformationProtectionService",65607:"InformationProtectionStrings29",65635:"VideoPlaybackStrings80",66147:"nn-no-plex-strings-json",66467:"genericLinkStrings76",66511:"InformationProtectionStrings65",66676:"gl-plex-strings-json",66816:"InformationProtectionStrings26",67070:"cardloopstrings_uz-json",67082:"VideoPlaybackStrings23",67085:"VideoPlaybackStrings15",67115:"InformationProtectionStrings3",67285:"InformationProtectionStrings41",67336:"hostUxStrings13",67578:"shareServiceStrings69",67602:"VideoPlaybackStrings34",67723:"hostUxStrings32",67731:"InformationProtectionStrings54",67782:"hostUxStrings28",67846:"it-plex-strings-json",67910:"removeformconfirmationdialog",68054:"ca-es-valencia-plex-strings-json",68240:"hostUxStrings57",68415:"cardloopstrings_nl-json",68455:"VideoPlaybackStrings84",68517:"VideoPlaybackStrings42",68544:"shareServiceStrings63",68575:"genericLinkStrings50",68626:"hostUxStrings82",68701:"shareServiceStrings39",68881:"hostUxStrings63",68928:"shareServiceStrings12",69018:"diffsyncstateac",69287:"genericLinkStrings72",69356:"hu-plex-strings-json",69427:"eu-plex-strings-json",69702:"VideoPlaybackStrings7",69745:"VideoPlaybackStrings19",69807:"zh-tw-plex-strings-json",70297:"InformationProtectionStrings63",70506:"kok-plex-strings-json",70551:"InformationProtectionStrings50",70602:"hostUxStrings24",70915:"cardloopstrings_hr-json",71060:"hostUxStrings53",71118:"shareServiceStrings32",71122:"hostUxStrings19",71364:"shareServiceStrings67",71398:"conversationsservice",71486:"cardloopstrings_sl-json",71528:"genericLinkStrings26",71564:"VideoPlaybackStrings69",71888:"cardloopstrings_zh-hans-json",71915:"genericLinkStrings47",71981:"cardloopstrings_bn-in-json",72241:"VideoPlaybackStrings82",72303:"VideoPlaybackStrings48",72306:"cardloopstrings_da-json",72758:"cardloopstrings_te-json",72839:"VideoPlaybackStrings39",72883:"createNewModule",73073:"genericLinkStrings74",73117:"InformationProtectionStrings67",73179:"InformationProtectionStrings25",73285:"VideoPlaybackStrings24",73318:"InformationProtectionStrings6",73539:"hostUxStrings10",73580:"SharepointShareService",73743:"VideoPlaybackStrings75",73851:"uilayoutac",73926:"hostUxStrings37",74017:"cardloopstrings_lt-json",74332:"genericLinkStrings48",74874:"augloopapi",74904:"shareServiceStrings34",75084:"hostUxStrings66",75107:"hr-plex-strings-json",75291:"shareServiceStrings11",75458:"cardloopstrings_fr-ca-json",75562:"cardloopstrings_hu-json",75563:"cardloopstrings_sw-json",75865:"hostUxStrings9",75990:"formrequirementiframedialog",76359:"hostUxStrings14",76794:"en-gb-plex-strings-json",76805:"hostUxStrings23",76902:"notificationmodule",77047:"shareServiceStrings59",77263:"hostUxStrings50",77529:"VideoPlaybackStrings73",77548:"gd-plex-strings-json",77567:"shareServiceStrings64",77598:"genericLinkStrings59",77677:"InformationProtectionStrings49",77712:"hostUxStrings31",77731:"genericLinkStrings25",77738:"card-loop-thumbnailcardview",77822:"shareServiceStrings83",77878:"ru-plex-strings-json",77951:"shareServiceStrings15",78118:"genericLinkStrings42",78622:"linksac",79094:"vi-plex-strings-json",79276:"genericLinkStrings71",79379:"cardloopstrings_lv-json",80094:"InformationProtectionStrings42",80145:"hostUxStrings12",80198:"cardloopstrings_hi-json",80411:"VideoPlaybackStrings35",80529:"cardloopstrings_fr-json",80532:"hostUxStrings35",80551:"genericLinkStrings21",80616:"cardloopstrings_or-json",80720:"mi-nz-plex-strings-json",80819:"dialogac",81049:"hostUxStrings56",81102:"hostUxStrings6",81107:"shareServiceStrings37",81200:"genericLinkStrings80",81326:"VideoPlaybackStrings41",81353:"shareServiceStrings62",81514:"approvalrequestsection",81608:"shareServiceStrings85",81802:"fr-ca-plex-strings-json",81904:"genericLinkStrings44",82013:"cardloopstrings_nn-no-json",82368:"StreamEmbeddedRenderer",82689:"card-loop-o365connectorscardview",82707:"reactplayer",82722:"InformationProtectionStrings11",83069:"notificationbar",83106:"InformationProtectionStrings60",83479:"tenantmodule",83869:"hostUxStrings52",83880:"InformationProtectionStrings44",83892:"VideoPlaybackStrings76",83927:"shareServiceStrings33",83931:"hostUxStrings18",84006:"fi-plex-strings-json",84173:"shareServiceStrings66",84314:"shareServiceStrings18",84337:"genericLinkStrings27",84465:"formattachmentslist",84666:"VideoPlaybackStrings56",84724:"genericLinkStrings40",84807:"whiteboard-loop-component",84888:"hostUxStrings0",85050:"VideoPlaybackStrings81",85112:"VideoPlaybackStrings47",85164:"ta-plex-strings-json",85411:"as-in-plex-strings-json",85523:"InformationProtectionStrings69",85988:"InformationProtectionStrings22",86286:"hostUxStrings59",86348:"hostUxStrings17",86357:"cardloopstrings_is-json",86614:"VideoPlaybackStrings30",86735:"hostUxStrings36",87141:"genericLinkStrings49",87361:"InformationProtectionStrings81",87397:"mk-plex-strings-json",87713:"shareServiceStrings35",87986:"ja-plex-strings-json",88100:"shareServiceStrings16",88233:"shareServiceStrings48",88452:"VideoPlaybackStrings58",88605:"cardloopstrings_gu-json",89088:"mt-mt-plex-strings-json",89245:"cardloopstrings_pl-json",90083:"InformationProtectionStrings47",90338:"VideoPlaybackStrings70",90400:"VideoPlaybackStrings36",90422:"pt-br-plex-strings-json",90521:"hostUxStrings30",90540:"genericLinkStrings22",90631:"shareServiceStrings82",90791:"sk-plex-strings-json",90869:"VideoPlaybackStrings51",90927:"genericLinkStrings43",91091:"hostUxStrings3",91315:"VideoPlaybackStrings44",91955:"gatedtenantservice",92191:"InformationProtectionStrings21",92345:"is-plex-strings-json",92755:"VideoPlaybackStrings79",92796:"unifiedgroupac",92903:"InformationProtectionStrings43",92954:"hostUxStrings11",92957:"ka-plex-strings-json",93220:"VideoPlaybackStrings32",93341:"hostUxStrings34",93564:"InformationProtectionStrings84",93818:"plantaskboardpage",93858:"hostUxStrings55",93911:"hostUxStrings7",93916:"shareServiceStrings30",94084:"ro-plex-strings-json",94135:"VideoPlaybackStrings40",94162:"shareServiceStrings61",94258:"appLazy",94267:"genericLinkStrings32",94281:"genericLinkStrings9",94326:"genericLinkStrings28",94417:"shareServiceStrings84",94680:"shareDialog",94713:"genericLinkStrings45",95336:"containerac",95416:"cardloopstrings_az-latn-az-json",95531:"InformationProtectionStrings10",95638:"cardloopstrings_pt-pt-json",95915:"InformationProtectionStrings61",96048:"InformationProtectionStrings39",96579:"shareServiceStrings68",96689:"InformationProtectionStrings45",96701:"VideoPlaybackStrings77",96924:"tenantservice",97138:"groupdocumentsac",97146:"genericLinkStrings24",97160:"FluidDocumentServiceFactoryContainer",97256:"shareServiceStrings41",97533:"genericLinkStrings41",97666:"genericLinkStrings19",97697:"hostUxStrings1",97969:"cardloopstrings_ms-json",98050:"genericLinkStrings68",98113:"hostUxStrings74",98400:"cardloopstrings_mn-mn-json",98434:"cardloopstrings_ta-json",98903:"am-et-plex-strings-json",99095:"hostUxStrings58",99157:"hostUxStrings16",99171:"gatedodspservice",99423:"VideoPlaybackStrings31",99544:"hostUxStrings39"}[e]||e)+"."+{170:"39c4735e",361:"f9f516bb",372:"397a76c5",467:"22bf533b",470:"8a014eb3",522:"c7114ae6",620:"02c103a8",1188:"3130413b",1214:"c7500fa7",1261:"58d042b7",1303:"8c5d7866",1686:"940ef5f6",1734:"a7b8ed93",1994:"279b3c84",2118:"2aeb37d6",2246:"3bd884c0",2338:"8e1d76bc",2440:"f905f14a",2472:"23ecda91",2544:"34a67bef",2690:"30b7cc26",2744:"6ef4f9d1",2892:"f660f999",2977:"e574aa90",3150:"edcec5b9",3181:"862e8d68",3201:"d55edb60",3280:"1fd89db2",3304:"c43e398b",3349:"2d73bc7b",3367:"b1834082",3401:"70a5c15c",3459:"57f395a2",3642:"174f6eef",3678:"634ecb60",3763:"28d29712",3900:"d4eb9d45",4004:"106f4345",4062:"d4adb9a2",4085:"5cc393c2",4256:"5fcfc7c2",4316:"f879e96e",4440:"fefdfd0a",4474:"5bc6cf65",4524:"09881ff7",4554:"0eada252",4856:"9f5b70f3",4938:"eddad65b",5053:"487635d5",5220:"fa819d2a",5364:"9288bf8a",5520:"feb3cb53",5828:"cb06039c",5851:"04288888",5891:"c180baa8",5899:"7ee75721",6279:"03c31df8",6307:"b550a112",6363:"508ab8c6",6373:"bce8b01a",6471:"f25812de",6667:"0fe5ada7",6689:"6087d928",6725:"55500ce1",6830:"cce64366",7010:"249d1616",7076:"b0311407",7135:"a605fe82",7320:"a124bacd",7374:"3035317b",7464:"020a45a3",7509:"a6bae871",7670:"ec67a18d",7691:"6a94eb2a",7902:"c34a86e1",7911:"38d001a0",8010:"b85c0ef2",8081:"2f36033d",8088:"a6bb3726",8340:"97939c02",8446:"51f3d695",8461:"b8078869",8500:"f1879814",8826:"2fef37cc",8857:"01eb9218",8928:"641b7e88",8996:"4d67d6bb",9350:"47f4c66e",9444:"2e46da36",9496:"9f1b33d8",9507:"362fba53",9770:"f438bb90",9858:"b74e7c43",10041:"c0565441",10065:"aae827df",10077:"b6b5ef22",10119:"e159284f",10135:"7a38bbd0",10301:"adf0636b",10332:"d7a49b96",10361:"c4754ed2",10475:"b2b16796",10506:"1a1c02b1",10538:"7b17a25e",10572:"41bf68f0",10616:"d5394cd6",10632:"cf14d010",10672:"a1e1cca8",10720:"75662149",10922:"1dfff014",11072:"9f891a55",11133:"f9f25dbf",11299:"ec28828a",11354:"a6f3608e",11567:"0ba50d87",11966:"8a8a62c1",11983:"c07f0ae2",12156:"bc925d77",12481:"2c0aa806",12777:"0d2411ca",12870:"8585791b",12892:"c350578e",12956:"4e44c9ca",13039:"df224177",13170:"66cd85f4",13181:"229eec15",13276:"575797a2",13279:"389697d6",13311:"35ffcf7d",13403:"f86fe760",13482:"63789970",13499:"6aacca8e",13667:"f54b0ec2",14044:"326f8f8b",14094:"fa3e0839",14183:"c860a302",14295:"79bf645d",14427:"5971fa1b",14543:"34a0c87f",14664:"9c04e5ff",14708:"f49b8a66",14782:"8033f558",15286:"2e824b57",15353:"74e78afa",15434:"a53cbe55",15456:"b74bcd32",15520:"765137ef",15596:"050ad489",15700:"126c4217",15797:"040742b7",15947:"c35df54d",16158:"8ba70591",16210:"ec721473",16268:"21238030",16487:"e7e0161b",16709:"e77e4346",16740:"eb065be2",16766:"5f8b242b",16829:"b858b537",17065:"e56e2e83",17122:"675a191c",17125:"0d064527",17323:"b0ea822b",17620:"c5fddb89",17740:"99aa8cd9",17880:"3857d03b",17925:"f05edffd",18095:"672a73fe",18106:"06c344de",18196:"f961a622",18329:"015d8375",18407:"6be4f44c",18510:"effee4cd",18623:"4a2d88cd",18728:"25eab4ba",18848:"abe87bf0",19347:"39bdf0ee",19411:"63dfef99",19498:"0f44580b",19499:"8549e91f",19632:"229e77c2",19639:"6948d1c8",19702:"1829984a",19779:"46028f60",19885:"d805f481",20273:"26b9b78e",20559:"7a785589",20731:"c4932de9",20854:"889f2b7f",21139:"f1f20191",21149:"ff85d63b",21211:"af13fe8d",21702:"cf3ebee5",21724:"34dc0817",21910:"a1566708",22316:"49ddfb97",22362:"a9c9d3d4",22514:"eb74b89b",22573:"feef3758",22874:"66adc056",22968:"b56b0503",23170:"66374bfd",23329:"9c6fe0b9",23394:"597aa001",23425:"7aaf8389",23488:"2337d790",23840:"99e458d6",23852:"d244f7e0",23945:"ecb6a8ec",24083:"45e08e11",24251:"d858b2fa",24309:"95fadcc4",24376:"9d895ddf",24637:"555ebe0b",24901:"02b2a19e",25072:"e30a0122",25115:"7b789335",25253:"705dc3fa",25416:"caa983ff",25621:"4e779645",25701:"6c0661da",25785:"1cf8dae3",25914:"1da607cf",25921:"96a64c6e",25979:"c104abfd",26047:"2ecdf555",26088:"78fb6521",26308:"d6119616",26329:"08d3d155",26476:"562813e6",26584:"32354de1",26660:"170813d5",26676:"5aebfdfd",26748:"69495e46",26765:"01b00a1f",26853:"fee39518",26873:"e8fac0c4",26903:"4975ad27",26922:"fd3f9751",26934:"d7bd2b71",26937:"c4d129e1",26983:"9d14dcd1",27211:"365fe64f",27443:"9b7fbe86",27517:"10c2d26e",27717:"7c043ca2",27719:"c7c607b8",27837:"91a2d486",27861:"5db9f3c0",27892:"f03d0587",28095:"b4eba634",28162:"a483b340",28318:"c862b7e4",28391:"99361ae2",28522:"57a93f5f",28566:"f541d9d4",28573:"8629ecd8",28679:"654db585",28688:"30b0b48b",28725:"f04b5f28",28884:"0095d748",29077:"0d9ff76b",29171:"70152794",29874:"bee628d5",29888:"38be1336",29934:"1b0a1bda",29936:"c5e6e698",30138:"cadaf023",30479:"e7ca3e01",30689:"3b13bd8b",30720:"eb53ecea",30759:"dbc3e55c",30769:"3a9c0fd9",30813:"cef86744",31209:"584a87cf",31318:"b34045aa",31436:"14b5ae7f",31487:"0614cb3b",31508:"db6774fe",31591:"0d495cc0",31902:"3b1578f0",32124:"8b519a69",32175:"1619da92",32182:"bd7b93e4",32441:"1ce0c677",32465:"d2dd5ff2",32511:"5bbe43fc",32870:"e379689c",33019:"b7978672",33201:"480aeb48",33274:"37694f60",33321:"23fc727b",33477:"ba05bece",33540:"d3f32f77",33555:"16e2eddd",33720:"b4453f18",33884:"8214ec30",33892:"fb84da9a",34095:"a09aeb52",34167:"acaf98c6",34525:"35cae828",34624:"3399d235",34905:"d1bc9941",35104:"bfa95e47",35125:"4beea734",35222:"4e12413d",35848:"00a509c6",35910:"143f5ba6",35957:"7e00c6a6",35968:"1a3e88a7",35979:"211cd000",36074:"054903ea",36077:"23fb8799",36079:"2c48372c",36203:"a4f07062",36234:"6ac5a287",36297:"c40daa29",36738:"4614f74e",36754:"c2ffc3b7",36818:"d8a0f0d2",36892:"ad1813dd",36965:"ee0fa650",37118:"5134ef1a",37185:"f5fb70e8",37290:"251e252d",37308:"9269ce0d",37466:"b1fd3f46",37678:"50ab1d79",37711:"a49fe2ee",37801:"de524dc3",37881:"92482127",37924:"333bcdcd",38146:"259bba44",38328:"eccd63d2",38422:"0999da05",38428:"30e40dd6",38510:"ec0775b8",38529:"76b41aaa",38730:"82b4ddc9",38788:"f4079ee1",38856:"cbdc5182",38897:"0383b7ac",39008:"69df10d6",39117:"c75099e3",39477:"bdfe2ab9",39479:"aafdf716",39743:"6304f6ba",39862:"a6d105b0",39923:"b0ed018a",40044:"97cf6917",40077:"0ac3267b",40086:"0115004f",40104:"76b3ce5c",40135:"8fe51d5b",40136:"3ade7473",40362:"57d5ccc9",40513:"384916b9",40701:"92369cb3",40738:"3376e04c",40856:"7a2835b0",40904:"e2a8b0a6",40971:"993805b8",41165:"2e8ac0d8",41198:"1acb8447",41252:"0fbe0daa",41380:"806788d9",41464:"a39223d8",41497:"d7e1ad7f",41514:"f32f009d",41717:"3f0933e2",41886:"5ac30849",41991:"d062f4c5",42038:"eaaa4bec",42067:"b43d3a49",42296:"7264db42",42406:"374a5094",42437:"50c8ddbd",42503:"5f2c415d",42743:"a1be4bd7",42966:"8f30cad4",42967:"a748abe9",43008:"c01290c8",43164:"40e2375e",43280:"bc9e064c",43529:"d25c388c",43669:"00909551",44127:"2e6cb74f",44245:"b49b1898",44285:"3d5ba410",44317:"539949de",44729:"9ea2be9e",44769:"e0088522",44874:"dc64b0f6",44933:"cad5cecc",44941:"cd3f9bc7",44984:"e3a6cb93",44991:"aa7370d7",45092:"2be87bb0",45274:"3f39ca7c",45371:"591e4dc7",45590:"1e47a005",45828:"62b2bd9d",46075:"fcdbd70e",46120:"50278da8",46130:"27b6487b",46192:"805fc2b0",46349:"e3b1499a",46441:"0cc15476",46548:"c6b67e9c",46867:"b8e50248",46904:"8836400f",47107:"53d8a9f0",47169:"805a405e",47174:"a2e83bdd",47534:"42587659",47550:"700e25bd",47649:"43c6be34",47665:"bf03c6fb",47667:"e8176ca5",47880:"65e16e3a",47913:"6388ad98",47934:"351e3bf5",48031:"ec4bd4e4",48406:"d0654a62",48453:"624770b0",48499:"97c5732d",48547:"b725b29b",48704:"98cfda0f",48719:"5cccb587",48867:"15f871f9",49012:"a3c15f72",49106:"0856bbb1",49306:"d56fd805",49505:"ea8cf1b4",49563:"990f55d8",49669:"fa8b5915",49701:"c7411edf",49927:"8b569464",50177:"d637f120",50381:"9977f76a",50487:"ad90ec31",50520:"56f2c9d7",50618:"57f7516c",50690:"3c11a30b",50787:"ca64e9ed",50924:"68935303",50932:"2c721589",51187:"3bac2c88",51194:"374f1e10",51306:"e2bed88d",51319:"e950b7a5",51383:"cbb4d767",51458:"7ab60d0e",52253:"6de8ca41",52286:"2347b295",52326:"89b278e9",52487:"13c0c4b2",52492:"a1b31f6f",52493:"7a8bf844",52753:"a29c406a",53205:"5a7f09b0",53312:"0d8c468a",53408:"b823afb3",53423:"037c96a2",53713:"c7f6951d",54007:"35e69f20",54014:"4b144c86",54061:"50560c49",54062:"0d9c862d",54101:"54acb04c",54273:"51cc121c",54306:"74d7d9ae",54651:"8f34269f",54793:"ac590c8e",54853:"baa0f30c",54914:"b1891bf7",55198:"329005c8",55215:"12e12b69",55307:"7afae35f",55346:"12a380f1",55547:"56f56229",55708:"cd4779dc",55766:"16380b2f",55807:"d97e0fc8",55817:"b34c287f",55874:"9ef270e9",55892:"f929f683",55953:"38ef062d",56012:"31e09227",56072:"aa75ea13",56176:"14df32bd",56186:"f5368652",56295:"1429c05b",56338:"7651dc2b",56458:"1e54b943",56478:"93585a52",56510:"46acbf19",56936:"0e7acf5a",57339:"5a17e22e",57365:"fe205aee",57397:"c01d2eb7",57488:"2b714680",57605:"d120837a",57613:"85e71fb4",57628:"39dbb7d9",57668:"316013bc",57742:"9b731d5f",57793:"402f539e",57833:"8c505fb8",57877:"0f4dc581",57939:"e352e15c",57940:"c49f0d7b",58135:"44be16d4",58180:"3b94cb75",58555:"e68931f1",58637:"7382928f",58800:"aabc9ad9",58888:"657da5f2",59001:"0f154fa1",59007:"04d7639a",59062:"22805101",59106:"48f6a6ef",59108:"593ba1a1",59432:"e094877f",59494:"d75da880",59508:"687f1b0b",59552:"267f488a",59713:"69b56005",59805:"967c2e41",59850:"73cdabac",59858:"ec6c566a",59885:"ff2cb0ea",59916:"f891e96e",59941:"76734510",59950:"555aaf29",60250:"9671ed49",60264:"74eb9a67",60308:"705073e3",60370:"34fd4f17",60476:"b1925687",60722:"207caffe",61082:"8ee035d2",61374:"ee1b3c43",61528:"79a301ba",61578:"b8283078",61821:"b33d85b0",62200:"8f399125",62275:"4d5cb65a",62314:"b267829f",62364:"80a3440b",62372:"d07aa3f9",62521:"a982cef7",62530:"8441d7b0",62547:"7142b364",62672:"c9a4b927",63030:"1e2cfabb",63056:"5a85a963",63120:"41920302",63329:"58fc2b1c",63499:"8ca357d0",63605:"a92ef0e9",63843:"13037d77",63874:"2d2cde20",63937:"473c246a",63996:"ec77cfbc",64062:"e0ebe9a5",64238:"a04ea059",64332:"d3fb1ff3",64720:"568ad867",64758:"e6eb48a0",64868:"0d3b4467",64969:"185caf1d",65013:"0356b37e",65095:"92d7263a",65142:"43485757",65156:"af5194fd",65354:"d0d5bae8",65607:"2de13068",65635:"314dd8f2",65662:"f10dbc8f",66147:"6344bdfa",66390:"42f07539",66467:"fe3ad198",66511:"11302571",66561:"e945d044",66676:"09d6321e",66816:"b645cd58",66859:"824d41a7",67070:"ff287912",67082:"050cb2cf",67085:"5b69a4ae",67115:"718350cc",67285:"8f39573e",67336:"ce66b958",67578:"2d08216c",67602:"d47ecc08",67723:"1c989671",67731:"c338f894",67782:"b195b2c9",67846:"86414de8",67910:"147d2de8",68054:"b8aec4b9",68212:"b872c8bb",68240:"eaf76a36",68346:"e797a10a",68415:"28543865",68455:"6ab6ef6d",68517:"439eedb8",68544:"323c1ac2",68575:"f763254b",68626:"0843b0eb",68701:"d15c341a",68881:"2d7490c2",68928:"520609a5",69018:"db61a3cc",69110:"4e922c11",69287:"4f8350e3",69356:"cd4c705b",69427:"a71e92c5",69698:"997502e6",69702:"a368c353",69745:"601c10bf",69807:"ff41603e",70297:"861ce64b",70506:"55b2f704",70551:"ff8de472",70602:"f53ef749",70915:"79f5e4e9",71060:"97bfc7b4",71118:"21a04e5e",71122:"ca8a0073",71364:"cd63b3db",71398:"10d765a7",71486:"bcd3544e",71528:"01015989",71564:"f995eb4e",71888:"c6f16485",71915:"f36cfc7d",71981:"42d80f73",72241:"e6caccad",72303:"55e41237",72306:"1fa529f5",72520:"2d4fb51c",72567:"c88505f3",72758:"72e48e72",72839:"c51cfedd",72883:"0eb57762",73073:"1f78a31a",73117:"8529d352",73179:"776a686f",73285:"22345db7",73318:"a9120e82",73539:"80ce7e52",73580:"bc4c24d2",73743:"30c1677e",73851:"b6f1bb82",73926:"46262e46",74017:"02364360",74332:"f086e8f9",74874:"4320f6a7",74904:"161e9f53",75084:"9873e4d4",75107:"cf886dd7",75291:"68483bc3",75458:"44494e90",75562:"7afde610",75563:"b7760b05",75865:"f4cfe319",75990:"7347d444",76115:"a97d7113",76128:"ce8ae84d",76359:"1faa8086",76794:"a7b4c0e0",76805:"d28f1455",76902:"659f5592",77047:"cf19f472",77263:"669edd2a",77529:"4144f884",77548:"1cc28361",77567:"8f8d5cd7",77598:"9ef9bfc6",77677:"86e273bf",77712:"17a8168a",77731:"cfb83fca",77738:"51dec469",77771:"b3432227",77822:"85f7be41",77873:"7ce95b64",77878:"5b4a45fa",77951:"369ba8e9",78118:"311acb53",78622:"78d47304",79094:"caeb52b6",79276:"c0dc370f",79327:"81370b48",79379:"4904c15e",79450:"a70b5825",80094:"fb6b2e83",80145:"850e236b",80198:"49208d9a",80411:"e1af4613",80529:"bd60c492",80532:"72b131d9",80551:"cf2ebc92",80616:"650fd0d9",80708:"d7e5108c",80720:"d166fb9a",80819:"6ea138f3",81049:"e874db3a",81102:"3634949a",81107:"8e5fb4f8",81200:"01372665",81326:"f8cada36",81353:"1b724ff3",81514:"808fd845",81540:"6fe1efc2",81608:"05621f6e",81802:"38a2fd52",81904:"5305318a",82013:"dde0396d",82270:"679ed71e",82368:"82b05519",82440:"1e01a4de",82689:"275133f7",82707:"39e19a3d",82722:"cf9a540c",83069:"f5edaba1",83106:"25bdd5d6",83479:"5f795c41",83869:"cd185715",83880:"d9f47e6c",83892:"8615d993",83927:"2b460341",83931:"ef37db87",84006:"b21309d5",84173:"640f8e3c",84314:"fbed26f1",84337:"1fdef56e",84465:"2f282961",84666:"be8cf3c3",84724:"30281c0d",84807:"f1a18832",84888:"7919071b",85031:"0ce7295b",85050:"d4c4c25e",85112:"b1e2b5e9",85164:"ffa9b723",85411:"34e5d7cc",85523:"7830d57a",85902:"296ac372",85916:"2be57f66",85988:"0b6d0999",86286:"2087df35",86348:"bf2a5f02",86357:"30222245",86614:"54011a49",86735:"516c49f2",87141:"6224f417",87361:"5d4f3791",87397:"44fb94c7",87713:"9e4d446a",87986:"7a44cbf6",88100:"2461ad78",88233:"f09a2260",88452:"3771cd13",88605:"d2e39040",88652:"4ac694e5",88974:"225c0a5e",89088:"b91f0930",89245:"258199eb",89441:"52f0d00b",89520:"a43b6e93",89559:"0f161f9f",90083:"d5c4bb98",90338:"7dcef79c",90400:"04a4244a",90422:"a05e9608",90521:"d42b73fb",90540:"4388930d",90631:"d5f19a28",90791:"dec2fb86",90869:"ff658012",90927:"3d12454c",90976:"d40afd37",91091:"1ed403b7",91315:"6d1972f9",91955:"cbcf84e8",92191:"8949750d",92345:"0b9e4bbc",92755:"f89c2390",92796:"ff2cd28a",92903:"e95444be",92954:"026891db",92957:"c44f208d",92970:"491eda47",93220:"051d9790",93341:"029bb5aa",93420:"4fc4a4e0",93564:"b73a9d4a",93818:"38336c42",93858:"0401a6e9",93892:"add3f91b",93911:"c185d25b",93916:"8f120f1b",94084:"a99afffc",94135:"43e42eab",94162:"96a6f610",94258:"5deb1ebd",94267:"c1a4ee55",94281:"6bd2467c",94326:"b1055cd5",94417:"7702d0cd",94680:"4a7274bc",94713:"17836e3f",94751:"ca562659",95164:"4996ae12",95336:"e963e4d4",95416:"a8130e93",95531:"60d2dc56",95638:"532a2521",95915:"b66a395b",96048:"7234ea01",96444:"cfb31c5a",96579:"a52df0f2",96689:"6179fb13",96701:"284ed88e",96900:"f643bd38",96924:"3f8de0ef",97138:"f0114207",97146:"b427c302",97160:"285bf148",97244:"5d3385b7",97256:"e467eae0",97533:"357d834f",97666:"efac4242",97697:"08a7f41a",97950:"f226ceff",97969:"8a6fd5ef",98050:"7496c3c8",98113:"bcf902fa",98400:"11c773e0",98434:"df6db274",98595:"cda3b347",98903:"b678a0a4",99095:"d580125e",99157:"adac327b",99171:"e3df130e",99423:"b1a07e62",99544:"2d96f3ea"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="fluidhost:";r.l=(o,n,i,s)=>{if(e[o])e[o].push(n);else{var a,c;if(void 0!==i)for(var d=document.getElementsByTagName("script"),l=0;l<d.length;l++){var u=d[l];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+i){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+i),a.src=o),e[o]=[n];var h=(t,r)=>{a.onerror=a.onload=null,clearTimeout(g);var n=e[o];if(delete e[o],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach(e=>e(r)),t)return t(r)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="./",(()=>{var e={38792:0};r.f.j=(t,o)=>{var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var i=new Promise((r,o)=>n=e[t]=[r,o]);o.push(n[2]=i);var s=r.p+r.u(t),a=new Error;r.l(s,o=>{if(r.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var i=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,n[1](a)}},"chunk-"+t,t)}},r.F.j=t=>{if(!r.o(e,t)||void 0===e[t]){e[t]=null;var o=document.createElement("link");o.charset="utf-8",r.nc&&o.setAttribute("nonce",r.nc),o.rel="prefetch",o.as="script",o.href=r.p+r.u(t),document.head.appendChild(o)}};var t=(t,o)=>{var n,i,s=o[0],a=o[1],c=o[2],d=0;if(s.some(t=>0!==e[t])){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);if(c)c(r)}for(t&&t(o);d<s.length;d++)i=s[d],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0},o=self.webpackChunkfluidhost=self.webpackChunkfluidhost||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),(()=>{var e={73580:[46441,72567,94680,9444]};r.f.prefetch=(t,o)=>Promise.all(o).then(()=>{var o=e[t];Array.isArray(o)&&o.map(r.E)})})(),(()=>{"use strict";var e=r(27051),t=r(99671),o=r(83125),n=r(33788),i=r(85874);var s=r(26631),a=r(34445);async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SHA-1",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";if(void 0===crypto.subtle)return r.e(13482).then(r.bind(r,37711)).then(async r=>r.hashFile(e,t,o));const n=await async function(e,t){const r=await crypto.subtle.digest(t,e);return new Uint8Array(r)}(e,t);return function(e,t){switch(t){case"hex":return Array.prototype.map.call(e,e=>e.toString(16).padStart(2,"0")).join("");case"base64":return a.fromByteArray(e)}}(n,o)}async function d(e,t,r,i,a){(async function(e,t){const r=s.Ss.from("".concat(e,"_").concat(t));return encodeURIComponent(await c(r,"SHA-256","base64"))})(r,i).then(s=>{!function(e,t,r){(async(e,t)=>{const i=r?new o.p("InformationProtectionService",r):void 0,s=n.m.start("precacheInformationProtection",i,{addUserTiming:!0,isAPerformanceMetric:!0});try{const r=await e;await Promise.all([r.getIrmInformation(t),r.getWatermarkInformation(t)])}catch(a){s.setResult(!1)}s.setResult(!0)})(e,t)}(e,{siteUrl:t,driveId:r,itemId:i,odspResolvedUrl:!0,hashedDocumentId:s,type:"fluid",id:"",url:"",tokens:{},endpoints:{snapshotStorageUrl:"",attachmentPOSTStorageUrl:"",attachmentGETStorageUrl:"",deltaStorageUrl:""},fileName:"",summarizer:!1,fileVersion:""},a)}).catch(()=>{})}var l=r(98581),u=r(31942),h=r(47373),g=r(52841),p=r(93537),f=r(3503),m=r(37805);const v={maxRetries:3,filter:(0,p.sC)([429,500,503]),backoffFn:(0,m.Ed)(500)},y=/.+\S\([^\(\)]+\)$/;function b(e){const t=f.f.get(e);if(null!==t&&void 0!==t)return k(t)}function S(e){var t;const r=null===(t=(0,g.Ar)())||void 0===t?void 0:t.getItem(e);if(null!==r&&void 0!==r)return k(r)}function C(e){return 2===(e.cacheVersion||0)&&void 0!==e.expires&&e.expires.valueOf()>Date.now()}function k(e){if(null!==e&&void 0!==e){let r;try{r=JSON.parse(e)}catch(t){}const o=void 0!==r?r:e;return"on"===o||"off"===o?"on"===o:o}}var w;class P{constructor(e,t){this.ecsClientConfiguration=e,this.previouslyAccessedEcsSettings=new Map,this._settingsFetchedFromEcs=!1,this._loadedEcsReponseEventSent=!1,this.logger=t&&new o.p("EcsClient",t),this.loadAndClearCache(),this.ecsClientConfiguration.enableLogSettingsWithSource&&setInterval(()=>{this.logSettingsMetadata()},P.settingsMetadataLoggingInterval)}get settingsFetchedFromEcs(){return this._settingsFetchedFromEcs}async fetch(){if(this.ecsClientConfiguration.alwaysFetchNewSettings||void 0===this.ecsResponseFromCache||!C(this.ecsResponseFromCache)||this.ecsResponseFromCache.sessionId!==this.ecsClientConfiguration.sessionId){const e=function(e){const t=new URLSearchParams;if(t.append("agents",e.teamNames.join(",")),e.guestAgents){const r={};for(let t=0;t<e.guestAgents.length;t+=1){const o=e.guestAgents[t].substring(e.guestAgents[t].indexOf("(")+1,e.guestAgents[t].indexOf(")")),n=e.guestAgents[t].substring(0,e.guestAgents[t].indexOf("("));r[o]=r[o]?"".concat(r[o],",").concat(n):n}Object.entries(r).forEach(e=>{let[r,o]=e;t.append("guestAgents","".concat(o,"(").concat(r,")"))})}Object.entries(e.filters).forEach(e=>{let[r,o]=e;void 0!==o&&t.append(r,o)});const r=t.toString();return"".concat(e.host,"/config/v1/").concat(e.clientName,"/").concat(e.clientVersion).concat(""!==r?"?".concat(r):"")}(this.ecsClientConfiguration);return this.ecsResponsePromise||(this.ecsResponsePromise=this.fetchAndParse(e),this.ecsResponsePromise.then(e=>{e&&this.cacheEcsResponse(e),this._settingsFetchedFromEcs=!0}).catch(()=>{})),this.ecsResponsePromise}}getSettingKey(e,t){return"".concat(e,"_").concat(t)}getSetting(e,t,r){return this.maybeLogLoadedEcsResponseFromCache(),this.getSettingInternal(e,t,r)}maybeLogLoadedEcsResponseFromCache(){!this._loadedEcsReponseEventSent&&this.ecsResponseFromCache&&(this.logger&&(0,h.Ot)(this.logger,{eventName:"loadedEcsResponseFromCache",settings:JSON.stringify(this.ecsResponseFromCache.ecsTeamsSettings),eTag:this.ecsResponseFromCache.eTag,configIds:JSON.stringify(this.ecsResponseFromCache.configIDs)}),this._loadedEcsReponseEventSent=!0)}logSettingsMetadata(){0!==P.settingMetadataToBeLogged.length&&(this.logger&&(0,h.Ot)(this.logger,{eventName:"ECSSettingMetadatas",settings:JSON.stringify(P.settingMetadataToBeLogged)}),P.settingMetadataToBeLogged=[])}async getLiveSetting(e,t,r){return this.maybeLogLoadedEcsResponseFromCache(),this.getLiveSettingInternal(e,t,r)}getSettingInternal(e,t,r){let o;const n=this.getSettingKey(e,r);if(void 0!==(o=this.previouslyAccessedEcsSettings.get(n)))return o;let i="";var s,a;(void 0!==(o=b(e))?i="QueryParam":void 0!==(o=S(e))?i="LocalStorage":void 0!==(o=this.getSettingFromCachedEcsResponse(e,r))?i="CachedEcsResponse":(i="DefaultValue",o=t),this.previouslyAccessedEcsSettings.set(n,o),this.ecsClientConfiguration.enableLogSettingsWithSource&&!P.previouslyLoggedSettingMetadata.has(e))&&(P.previouslyLoggedSettingMetadata.add(e),P.settingMetadataToBeLogged.push({settingName:e,settingValue:null!==(s=null===(a=o)||void 0===a?void 0:a.toString())&&void 0!==s?s:"",settingSource:i}));return o}async getLiveSettingInternal(e,t,r){var o,n;let i;const s=this.getSettingKey(e,r);if(void 0!==(i=this.previouslyAccessedEcsSettings.get(s)))return i;if(void 0!==(i=b(e))||(i=S(e)),void 0!==i)return this.previouslyAccessedEcsSettings.set(s,i),i;const a=this._settingsFetchedFromEcs?null===(o=this.getAllCachedEcsResponses())||void 0===o?void 0:o[this.ecsClientConfiguration.cacheKey]:await this.fetch();return void 0!==(i=null===a||void 0===a||null===(n=a.ecsTeamsSettings[r])||void 0===n?void 0:n[e])||(i=t),this.previouslyAccessedEcsSettings.set(s,i),i}getSettingFromCachedEcsResponse(e,t){var r;return null===(r=this.ecsResponseFromCache)||void 0===r||null===(r=r.ecsTeamsSettings[t])||void 0===r?void 0:r[e]}async fetchAndParse(e){const t=n.m.start("EcsFetch",this.logger,{addUserTiming:!0});let r;try{r=await(0,p.J5)(e,void 0,v)}catch(i){return void t.setResult(!1,void 0,i)}if(200!==r.result.status){const e=new Error("Failed to Fetch from ECS. Response is not 200");return void t.setResult(!1,{status:r.result.status,statusText:r.result.statusText},e)}const o=this.parseResponseToEcsResponse(r);return o.then(r=>{let o;performance.getEntriesByName(e).map(e=>{e.name.includes(this.ecsClientConfiguration.host)&&(o=e.duration)}),t.setResult(!0,{eTag:r.eTag,networkDurationMs:o,configIds:JSON.stringify(r.configIDs)})}).catch(e=>{t.setResult(!1,void 0,e)}),o}async parseResponseToEcsResponse(e){var t;const r=await e.result.json(),o=[...this.ecsClientConfiguration.teamNames],n={};null===(t=this.ecsClientConfiguration.guestAgents)||void 0===t||t.forEach(e=>{if(y.test(e)){const t=e.substring(0,e.indexOf("("));o.push(t)}else this.logger&&(0,h.hO)(this.logger,{eventName:"ecsTeamFormat"},new Error("".concat(e," doesn't match the format <EcsTeam>(<EcsClient>)")))});for(let c=0;c<o.length;c+=1)r[o[c]]&&(n[o[c]]=r[o[c]]);const i=e.result.headers.get("ETag")||"",s=r.ConfigIDs||{};let a;if(this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin)a=new Date(Date.now()+6e4*this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin);else{const t=e.result.headers.get("Expires");a=t?new Date(t):void 0}return{ecsTeamsSettings:n,eTag:i,configIDs:s,expires:a,cacheVersion:2,sessionId:this.ecsClientConfiguration.sessionId}}cacheEcsResponse(e){const t=(0,g.Ar)();if(t)try{const r=this.getAllCachedEcsResponses()||{};r[this.ecsClientConfiguration.cacheKey]=e,t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(r))}catch(r){this.logger&&(0,h.hO)(this.logger,{eventName:"cacheEcsResponse"},r)}}getAllCachedEcsResponses(){try{const e=(0,g.Ar)(),t=null===e||void 0===e?void 0:e.getItem(this.ecsClientConfiguration.responsesCacheKey),r=t&&JSON.parse(t);if(!r||0===Object.keys(r).length)return;return Object.entries(r).forEach(e=>{let[t,r]=e;"string"===typeof r.expires&&(r.expires=new Date(r.expires))}),r}catch(e){this.logger&&(0,h.hO)(this.logger,{eventName:"getAllCachedEcsResponses"},e)}}loadAndClearCache(){const e=this.getAllCachedEcsResponses();if(e){const t=e[this.ecsClientConfiguration.cacheKey];t&&(this.ecsResponseFromCache=t),this.clearExpiredEcsResponsesFromCache(e)}}clearExpiredEcsResponsesFromCache(e){try{const t=(0,g.Ar)();if(!t)return;const r={};Object.entries(e).forEach(e=>{let[t,o]=e;(C(o)||t===this.ecsClientConfiguration.cacheKey)&&(r[t]=o)}),t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(r))}catch(t){this.logger&&(0,h.hO)(this.logger,{eventName:"clearExpiredEcsResponsesFromCache"},t)}}}(w=P).previouslyLoggedSettingMetadata=new Set,w.settingMetadataToBeLogged=[],w.settingsMetadataLoggingInterval=1e4;var T=r(77432);function E(e){return(0,T.F)("ecs",e)}function I(e){return"teamNames"in e}class N{get SettingsProvider(){return this}get settingsFetchedFromEcs(){return this.ecsClient.settingsFetchedFromEcs}constructor(e,t){this.ecsClient=I(e)?new P(e,t):new P(function(e){var t,r;const{ecsFilters:o,hostName:n,sessionId:i,responsesCacheKeyOverride:s,cacheExpiresDurationOverrideInMin:a,fetchFluidExperiencesSettings:c=!0,fetchHostExperiencesSettings:d=!0,fetchSegmentationSettings:l=!0,alwaysFetchNewSettings:u,enableLogSettingsWithSource:h=!1}=e,{userContext:g}=o,p=function(e){return"Development"===e?"Staging":e}(o.audience),f=null===(t=g.user)||void 0===t?void 0:t.id,m={audience:p,userId:f,tenantId:null===(r=g.user)||void 0===r?void 0:r.tenantId,hostName:n},v="".concat(f).concat(n).concat(p),y=s||"FluidEcsClientResponses",b=[];return c&&b.push("FluidExperiences"),d&&b.push("HostExperiences"),l&&b.push("Segmentation"),{host:E(p),clientName:"Fluid",clientVersion:"0.0.0.1",teamNames:b,filters:m,cacheKey:v,responsesCacheKey:y,cacheExpiresDurationOverrideInMin:a,sessionId:i,alwaysFetchNewSettings:u,enableLogSettingsWithSource:h}}(e),t),this.audience=I(e)?e.filters.audience:e.ecsFilters.audience,this.fetchSettings().catch(()=>{})}get Disposable(){return this}dispose(){}async fetchSettings(){await this.ecsClient.fetch()}getSetting(e,t,r){return this.ecsClient.getSetting(e,t,r)}async getLiveSetting(e,t,r){return this.ecsClient.getLiveSetting(e,t,r)}}var A=r(68180),F=r(23989),D=r(29967),B=r(58443),L=r(51655),O=r(56142);var x=r(78945),M=r(14818);class R{get IFluidDependencySynthesizer(){return this}constructor(){this.providers=new Map;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.parents=t.filter(e=>void 0!==e)}register(e,t){if(this.providers.has(e))throw new Error("Attempting to register a provider of type ".concat(String(e)," that already exists"));this.providers.set(e,t)}unregister(e){this.providers.has(e)&&this.providers.delete(e)}synthesize(e,t){const r={};return this.generateRequired(r,t),this.generateOptional(r,e),Object.defineProperty(r,M.x,{get:()=>this}),r}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some(t=>t.has(e))}getProvider(e){if(this.has(e)){if(this.providers.has(e))return this.providers.get(e);for(const t of this.parents){if(t instanceof R)return t.getProvider(e);{const r=t;if(void 0!==(null===r||void 0===r?void 0:r.getProvider))return r.getProvider(e)}}}}generateRequired(e,t){if(void 0!==t)for(const r of Object.keys(t)){const t=this.resolveProvider(r);if(void 0===t)throw new Error("Object attempted to be created without registered required provider ".concat(String(r)));Object.defineProperty(e,r,t)}}generateOptional(e,t){if(void 0!==t)for(const o of Object.keys(t)){var r;const t=null!==(r=this.resolveProvider(o))&&void 0!==r?r:{get:async()=>{}};Object.defineProperty(e,o,t)}}resolveProvider(e){const t=this.providers.get(e);if(void 0!==t)return"function"===typeof t?{get(){if(t&&"function"===typeof t)return Promise.resolve(this[M.x]).then(async e=>t(e)).then(t=>null===t||void 0===t?void 0:t[e])}}:{get(){if(t)return new x.I(async()=>Promise.resolve(t).then(t=>{if(t)return t[e]}))}};for(const r of this.parents){const t={[e]:e},o=r.synthesize(t,{}),n=Object.getOwnPropertyDescriptor(o,e);if(void 0!==n)return n}}}var _=r(59091),H=r(60119);var U=r(69235),j=r(51492),q=r(6385),V=r(90293),z=r(91947);class G{constructor(e){this.isOptionalConnectedExperiencesEnabled=e}async optionalConnectedExperiencesEnabled(){return this.isOptionalConnectedExperiencesEnabled}async getEnterpriseFeedbackPolicy(){}get OfficePolicyProvider(){return this}async getPolicy(e){if(!await(0,j.PA)(j.u.OEP,"LoopSettings.OcpsPolicyEnabled"))return{value:"0"};const t=await(0,z.CE)(e.policyId);return void 0===t?void 0:{value:t?"1":"0"}}}class W{constructor(e,t,r){this.defaultProvider=void 0,this.settingOverrides=void 0,this.audience=void 0,this.SettingsProvider=void 0,this.defaultProvider=t,this.SettingsProvider=this,this.audience=e,this.settingOverrides=r,void 0===this.settingOverrides&&async function(){const e=await(0,j.eH)(j.u.OEP,"FluidHost.FluidSettingOverrides","");if(e)try{return JSON.parse(e)}catch(t){(0,U.c2)("HostSettingsProvider",new U.uV("Unable to parse value of FluidHost.FluidSettingsOverride."))}return{}}().then(e=>{this.settingOverrides=e})}getSetting(e,t,r){var o,n;if(this.settingOverrides){const r=this.settingOverrides[e];if(void 0!==r){const o=typeof r,n=typeof t;if(o===n)return(0,O.Rm)("Override setting: ".concat(e," = ").concat(r)),r;console.warn("Cannot override setting ".concat(e,". The override type (").concat(o,") is different than the setting type (").concat(n,")."))}}return null!==(o=null===(n=this.defaultProvider)||void 0===n?void 0:n.getSetting(e,t,r))&&void 0!==o?o:t}}var J=r(34805),K=r(64643),Q=r(81918),$=r(16460),Z=r(6971),Y=r(60138),X=r(899);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ee=r(4311),te=r(24921),re=r(27377),oe=r(64580),ne=r(97232),ie=r(94115),se=r(25573),ae=r(40118),ce=r(27901);let de;var le=r(62231),ue=r(98123);"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{(0,O.vV)(e.message)}),(0,$.Vg)(),(0,Z.E)(),async function(s){var a,c,h,g,p,f,m,v,y;B.yz&&await(0,j.x$)(j.u.OEP,"FluidHost.Debugger.BreakAtMain");const b=L.q.getTimePoint();let{layoutMode:S}=s;const{uiLanguage:C}=s,k=await(0,Z.E)(),w=(null===k||void 0===k?void 0:k.loopInfo)||{},P=s.componentTypeToCreate||"",T=P==B.l1,E="@fluidx/video-playback"===w.registrationId;if((0,O.sF)(null===k||void 0===k?void 0:k.consoleLogEnabled),!w.linkUrl&&w.loopData){var I;const e=JSON.parse(w.loopData);w.linkUrl="string"===typeof e.webUrl?e.webUrl:null===(I=e.webUrl)||void 0===I?void 0:I.href}var x;w.linkText||(w.linkText=s.loopLinkText||(null===k||void 0===k||null===(x=k.createParams)||void 0===x?void 0:x.loopFileName)||"");w.linkUrl||(w.linkUrl=s.loopLinkUrl||"");w.registrationId||(w.registrationId=T?J.IG:s.loopRegistrationId||"");const M=!w.registrationId||"@fluidx/office-fluid-container"===w.registrationId,he=w.registrationId===J.B2,ge=null===k||void 0===k?void 0:k.fluidSettingOverrides,pe=null===k||void 0===k?void 0:k.hydrateId,fe=null!==(a=null===k||void 0===k?void 0:k.isDarkBackground)&&void 0!==a&&a,me=null!==(c=null===k||void 0===k?void 0:k.isInEditableDocument)&&void 0!==c&&c,ve=null!==k&&void 0!==k&&k.linkProblemState||null!==k&&void 0!==k&&k.isPermissionError?$.$R.Error:$.$R.None,ye=null!==(h=null===k||void 0===k?void 0:k.useTokenCache)&&void 0!==h&&h;ae.n.GetInstance().isCacheEnabled=ye;const be=await async function(){if(!B.KV&&(B.Nu||await(0,j.PA)(j.u.OEP,"ChangeGate.LocalAudience")))return"Local";const e="Production",t=await(0,j.eH)(j.u.OEP,"FluidHost.Audience",e);switch(t){case"Automation":case"Dogfood":case"Local":case"Microsoft":case"Preview":case"Production":case"Staging":case"SyntheticTraffic":return t;default:return(0,U.c2)("determineAudience()",new U.uV('Unexpected value for OEP.FluidHost.Audience ("'.concat(t,'").'))),e}}(),Se=function(e){e.name&&"MailComponent"!==e.name||(e.name="Component");e.entryPoint||(e.entryPoint="Mail");e.lifecycle||(e.lifecycle="Load");return e}({entryPoint:null!==(g=null===k||void 0===k?void 0:k.hydrateScenarioEntryPoint)&&void 0!==g?g:s.scenarioEntryPoint,name:s.scenarioName,lifecycle:s.scenarioLifecycle,startTime:null!==(p=null===k||void 0===k?void 0:k.scenarioStartTime)&&void 0!==p?p:(0,se.W)()}),Ce="Create"==Se.lifecycle,ke=(0,j.x$)(j.u.OEP,"FluidHost.MIP"),we=(0,j.x$)(j.u.OEP,"FluidHost.AppWaitForDriver"),Pe="".concat(Se.lifecycle,"_").concat(Se.name,"_").concat(Se.entryPoint),Te=null!==(f=(null===k||void 0===k?void 0:k.showTeachingCallout)&&M)&&void 0!==f&&f,Ee=await(0,K.q)(),Ie={buttonText:Ee.GotIt,descriptionText:Ee.CalloutDescription,headerText:Ee.CalloutTitle,officeTheme:null===k||void 0===k?void 0:k.officeTheme,calloutColors:null===k||void 0===k?void 0:k.teachingCalloutColors},Ne=null!==(m=null===k||void 0===k?void 0:k.useNewAnimatedSplashScreen)&&void 0!==m&&m,Ae=null!==(v=null===k||void 0===k?void 0:k.enableShowLoopGlowBorderEvent)&&void 0!==v&&v,Fe=null!==(y=null===k||void 0===k?void 0:k.enableRightToLeftSplashScreen)&&void 0!==y&&y;(0,j.lb)(),(0,j.MO)(),E&&w.linkUrl&&(w.linkUrl=(0,ue.addReferralParamsToStreamUrl)(w.linkUrl,k.hydrateScenarioEntryPoint));if((0,O.Rm)("Audience: ".concat(be)),(0,O.Rm)("Scenario: ".concat(Pe)),(0,O.Rm)("LayoutMode: ".concat(S)),(0,O.Rm)("UI Language: ".concat(C)),(0,O.Rm)("Native info: ".concat(JSON.stringify(k,void 0,"  "))),(0,O.Rm)("Loop info: ".concat(JSON.stringify(w,void 0,"  "))),(0,O.Rm)("Is Fluid Loop: ".concat(M)),!M||w.linkUrl||Ce){var De,Be,Le,Oe;const s=new ie.i(pe||"",Pe,be,b),a=!Ce||await(0,j.xB)()&&!M?Promise.resolve(""):null!==k&&void 0!==k&&null!==(De=k.createParams)&&void 0!==De&&De.loopFolderName?Promise.resolve(k.createParams.loopFolderName):(0,ee.ZQ)("attachments"),c=Promise.resolve(Ce?w.linkText:"");let h;Ce||((0,V.OX)(w.linkUrl),"Paste"===Se.lifecycle&&(w.linkUrl=(0,A.c)(w.linkUrl)),M&&(h=(0,t.Mh)(new URL(w.linkUrl)),h||(0,O.vV)("Unable to get the SharePoint locator from the Fluid url.")));const{localization:g,internationalizationContext:p}=await(0,V.Z)(C),f=document.getElementById(B.xu),m=document.getElementById(B.bY);f&&(f.hidden=!0),null===m||void 0===m||m.removeAttribute("hidden");const v=null===m||void 0===m?void 0:m.clientWidth,y=v?Math.min(v,B.s):B.s,{background:T,shimmer:I}=(0,re.O)(fe,Ne),x=document.createElement("div");x.className="combined";const K=document.createElement("object");K.data=T,K.width=(null===v||void 0===v?void 0:v.toString())||"",K.height=Ne?B.pY.toString():B.FT.toString();const $=document.createElement("object");$.data=I,$.width=y.toString(),$.height=Ne?B.pY.toString():B.FT.toString(),Fe&&"rtl"==g.localeDirection&&($.style.transform="scale(-1, 1)"),$.onload=()=>{setTimeout(()=>{(0,z.kF)()},200)},$.onerror=()=>{m&&(m.hidden=!0),null===f||void 0===f||f.removeAttribute("hidden"),(0,U.c2)("main()",new U.uV("Failed to load animated Svg.")),(0,z.kF)()},x.append(K,$),null===m||void 0===m||m.append(x);const Z=(0,X.u0)().replace(/[{}]/g,"").toLowerCase(),te=null!==pe&&void 0!==pe?pe:(0,ce._)(),oe=(0,V.b6)(Z,te,C,Se),ne={get TelemetryConfig(){return this},hostCorrelationId:te,hostSessionId:Z},se=new Y.z,ae=(0,V.Ng)(oe,k,be),ue=F._.startScenario(ae,Se.lifecycle),ye=new N({ecsFilters:{audience:be,userContext:{}},hostName:oe.hostName},ae),Re=await j.y,_e=new W(be,ye,ge),He=await(0,j.PA)(j.u.OEP,"ChangeGate.FluidHost.UseAppTheming"),{stylingProvider:Ue,initialTheme:je,initialThemeV9:qe,theming:Ve}=(0,V.br)(oe.hostAppName,fe,Re,He),ze=M&&await ke,Ge=ze?function(t){if("Consumer"===t.tokenProvider.identityType)return;let s;if((0,i.gX)(t.settingsProvider)&&(s=r.e(65354).then(r.bind(r,83126)).then(r=>{const n=new r.SharepointInformationProtectionService((0,e.A)((0,e.A)({},t),{},{logger:t.logger?new o.p("InformationProtectionService",t.logger):void 0}));return n.initialize("PO"),n})),t.logger){const e=new o.p("InformationProtectionService",t.logger);n.m.start("getInformationProtectionServiceForSharepoint",e).setResult(void 0!==s,{isGetLabelEnabled:(0,i.gX)(t.settingsProvider),isSetLabelEnabled:(0,i.E7)(t.settingsProvider),settingsProviderExists:void 0!==t.settingsProvider})}return s}({tokenProvider:se,settingsProvider:_e,logger:ae,locale:g.locale}):void 0;if(ze&&void 0===Ge&&(0,U.c2)("main()",new U.uV("getInformationProtectionServiceForSharepoint() failed.")),ze&&Ge&&h)try{d(Ge,h.siteUrl,h.driveId,h.itemId,ae)}catch(xe){(0,U.c2)("preCacheInformationProtectionWithSharePointIds()",new U.uV("Exception occurred.",xe))}const We=new l.R(He?Ve:Ue);let Je,Ke,Qe;const $e=void 0!==(null===k||void 0===k?void 0:k.isOptionalConnectedExperiencesEnabled),Ze=void 0!==(null===k||void 0===k?void 0:k.isOptionalConnectedExperiencesEnabled)?new G($e):void 0;if(he){const e=await(0,Q.Cw)();Qe=e.getUrlHandlerProvider(),Ke=e.getMetaOSProvider(),Je=null!==k&&void 0!==k&&k.isCardChannelProviderEnabled?e.getCardChanelProvider():void 0}const Ye={environment:(0,V.NK)(be),logger:ae},Xe=(null===k||void 0===k?void 0:k.partitionCacheKey)||null,et=k&&""!==k.partitionCacheKey;let tt,rt;M&&(tt=(0,_.FM)(s,Ye,ae,_e,se,et,Xe),rt=(0,D.o)(se,ae));const ot=(0,le.H)(),nt=w.registrationId?await(0,J.Zj)(w.registrationId):void 0,it=await async function(e){let{cardChannelProvider:t,documentServiceFactory:r,informationProtectionServicePromise:o,internationalizationContext:n,metaOSProvider:i,officeFluidLogger:s,optionalConnectedProvider:a,presenceColorProvider:c,settingsProvider:d,stylingProvider:l,telemetryConfig:u,tokenProvider:h,urlHandlerProvider:g,urlResolver:p,playbackStateHandlerPromise:f,loopCodeLoaderFactory:m,theming:v,isThemingEnabled:y}=e;const b=new R;return t&&b.register("CardChannelProvider",t),b.register("InternationalizationContext",n),o&&b.register("InformationProtectionService",o),b.register("LoopTelemetrySink",H.a),i&&b.register("MetaOSProvider",i),b.register("NamespaceLogger",s),a&&b.register("OfficePolicyProvider",a),b.register("PresenceColorProvider",c),b.register("SettingsProvider",d),y&&v?b.register("Theming",v):l&&b.register("StylingProvider",l),b.register("TelemetryConfig",u),b.register("TokenProvider",h),g&&b.register("UrlHandlerProvider",g),r&&p&&b.register("DriverImplementation",new _.kx(p,r)),f&&b.register("PlaybackStateHandler",f),m&&b.register("LoopCodeLoaderFactoryProvider",m),b}({cardChannelProvider:Je,documentServiceFactory:tt,informationProtectionServicePromise:Ge,metaOSProvider:Ke,officeFluidLogger:ae,optionalConnectedProvider:Ze,playbackStateHandlerPromise:ot,presenceColorProvider:We,settingsProvider:_e,stylingProvider:Ue,tokenProvider:se,urlHandlerProvider:Qe,urlResolver:rt,internationalizationContext:p,telemetryConfig:ne,loopCodeLoaderFactory:nt,theming:Ve,isThemingEnabled:He}),st={url:w.linkUrl,headers:{isSharingLinkToRedeem:!0}};ze&&(st.headers=(0,e.A)((0,e.A)({},st.headers),{},{"X-CLP-Compliant-App":!0}));const at=await c,ct="Mac"!==oe.hostAppPlatform;s.setLoadPerfTracker();const dt=(0,q.h)(Ce,P,a,at,w,Ye,oe,pe,st,it,ae,s,tt,rt);dt.then(()=>{var e;s.onLoadComplete(se);const t=null===(e=s.LoadPerfTracker)||void 0===e?void 0:e.getDurationInSeconds();(0,O.Rm)("Fluid component loaded. (".concat(null!==t&&void 0!==t?t:"??"," s)")),w.loopData&&(0,O.Rm)("  Data: ".concat(w.loopData)),w.loopIconUrl&&(0,O.Rm)("  Icon: ".concat(w.loopIconUrl)),w.loopName&&(0,O.Rm)("  Name: ".concat(w.loopName)),w.loopTitle&&(0,O.Rm)("  Title: ".concat(w.loopTitle)),w.linkText&&(0,O.Rm)("  Link Text: ".concat(w.linkText)),w.linkUrl&&(0,O.Rm)("  Link Url: ".concat(w.linkUrl))}),Ce&&dt.catch(async()=>{await(0,j.PA)(j.u.OEP,"ChangeGate.FluidHost.CreateFailed")&&(0,z.xh)(P)}),async function(e){"Mac"!=e.hostAppPlatform&&(0,j.PA)(j.u.OEP,"ChangeGate.FluidOutlook.FixBorderWithMargin").then(e=>{if(e)document.documentElement.style.marginRight="1px";else{const e=document.getElementById(B.xu);e&&(e.style.paddingRight="1px")}})}(oe),(0,V.Sk)(S,k.useLoopContentWidthEnabled),E&&(S=u.S.grow);const lt=function(e,t){return de?e.isInEditableDocument&&(de.delegateToHostAppForNotification=!0,de.useCustomSharedService=!0):(de={delegateToHostAppForNotification:!1,disableSingleClickOpenHeaderLink:!1,shouldDisableEscapeKey:!1,useCustomSharedService:!1},("MailCompose"===e.hydrateScenarioEntryPoint||void 0===e.hydrateScenarioEntryPoint&&e.isInEditableDocument)&&(de.delegateToHostAppForNotification=!0,de.useCustomSharedService=!0,t&&(de.shouldDisableEscapeKey=!0)),"WordDocument"===e.hydrateScenarioEntryPoint&&(de.disableSingleClickOpenHeaderLink=!0)),de}(k,!(null===k||void 0===k||!k.version)&&(null===k||void 0===k?void 0:k.version)>=28),ut={followLinkToolTip:me||lt.disableSingleClickOpenHeaderLink?Ee.ControlClickToFollowLink:Ee.ClickToFollowLink,isDarkBackground:fe,shouldDisableEscapeKey:lt.shouldDisableEscapeKey,linkProblemState:ve,linkText:w.linkText,linkUrl:null!==(Be=w.safeLinkWrappedUrl)&&void 0!==Be?Be:w.linkUrl,onClick:e=>{(0,V.ig)(e,me,lt.disableSingleClickOpenHeaderLink)},textForEmptyUrl:Ee.GettingThisReady,updateTheme:void 0};if(s.setInitialRenderPerfTracker(),tt){if(await we)try{await tt}catch(Me){}}(async function(e){const t=e.showComponentActivity;(0,O.Rm)("appLazyStart() started."),t.AppLazyImportTracker=new L.q,t.AppLazyStartTracker=new L.q;const o=await t.AppLazyImportTracker.measure(()=>Promise.all([r.e(97950),r.e(63843),r.e(17122),r.e(26922),r.e(5053),r.e(13403),r.e(48453),r.e(47880),r.e(40086),r.e(81540),r.e(65354),r.e(8088),r.e(59508),r.e(94258)]).then(r.bind(r,78003)));t.AppLazyStartTracker.measure(()=>o.lazyStart(e));const n=t.AppLazyImportTracker.getDurationInSeconds(),i=t.AppLazyStartTracker.getDurationInSeconds();(0,O.Rm)("appLazyStart() completed.  (Import: ".concat(n," s,  Lazy start: ").concat(i," s)"))})({canSetFocusToLink:ct,containerRequest:st,dependencySynthesizer:it,documentServiceFactory:tt,enableShowLoopGlowBorderEvent:Ae,giveComponentFocus:Ce,headerProps:ut,hostConfig:Ye,hostContext:oe,informationProtectionServicePromise:Ge,initialTheme:je,initialThemeV9:qe,isAppThemeBrandingEnabled:Re,isInEditableDocument:me,isMIPEnabled:ze,layoutMode:S,loadCompletePromise:dt,localization:g,loopInfo:w,officeFluidLogger:ae,presenceColorProvider:We,scenarioTracker:ue,settingsProvider:_e,showComponentActivity:s,stylingProvider:Ue,teachingProps:Ie,tokenProvider:se,urlResolver:rt,wantToShowTeachingCallout:Te,webAppConfigOverride:lt,theming:Ve,isThemingEnabled:He}).catch(e=>{(0,U.c2)("appLazyStart()",(0,U.oD)(e))}),null===(Le=s.WebAppMainPerfTracker)||void 0===Le||Le.setSuccess();const ht=null===(Oe=s.WebAppMainPerfTracker)||void 0===Oe?void 0:Oe.getDurationInSeconds();(0,O.Rm)("WebApp main complete. (".concat(null!==ht&&void 0!==ht?ht:"??"," s)"))}else{const e=1e3,t=await(0,j.n_)(j.u.OEP,"FluidHost.DelayTimeWhenNoFluidUrl",e);await(0,te.y)(t),await(0,oe.$)(ne.d.Success_NoFluidUrl)}}(function(e){const t=function(e){const t=e.search?e.search:e.hash;return new URLSearchParams("#"==t[0]?t.substring(1):t)}(e),r=t.get("create"),o=null!==r,n=null!==t.get("paste");return{componentTypeToCreate:r,layoutMode:(0,V.ZG)(t.get("layout")),loopRegistrationId:t.get("loopId"),loopLinkText:t.get("linkText")||t.get("fileName"),loopLinkUrl:function(e){switch(e){case"1":return"";case"2":return"https://microsoft-my.sharepoint-df.com/:fl:/p/manos/ETK44FqyWS1HmflsrI7osCcBaCWLXvZ-GinnJBsnNU9ZXg?nav=cz0lMkZwZXJzb25hbCUyRm1hbm9zX21pY3Jvc29mdF9jb20mZD1iIVVET05QQU1XQlVLOUU2U3NyT2dwTEdtQjVpYmliR3BNa2d4RG1rYXlnTFYtaUVoOHAwNDhTNTR4YUUxUVh6R3EmZj0wMUJNWFJUSUpTWERRRlZNU1pGVkRaVDZMTVZTSE9STUJIJmM9JTJGNTU2YzVkNjEtNmY4Ny00MTBiLTlkMzctYTM2OTE5N2Y1OGZkJTNGc3RhcnQlM0R1bmRlZmluZWQlMjZlbmQlM0QyZDhjNmIwNS1jYTg3LTQ3OGMtOGJjZC1lMGNiNzZkOTk2MjgmZmx1aWQ9MSZwPSU0MG1zJTJGb2ZmaWNlLWZsdWlkLWNvbnRhaW5lcg%3D%3D"}return null}(t.get("fluidUrlOverride"))||t.get("linkUrl")||t.get("fluidUrl"),scenarioEntryPoint:t.get("sep")||"",scenarioLifecycle:n?"Paste":o?"Create":"Load",scenarioName:t.get("s")||"",uiLanguage:t.get("locale")||(0,X.Mg)()||"en-us"}}(window.location)).catch(e=>{(0,U.c2)("main()",(0,U.oD)(e))})})()})();
//# sourceMappingURL=main.3e6f2fc6.js.map