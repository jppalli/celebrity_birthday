"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[65354],{19352:(e,t,i)=>{i.d(t,{S:()=>s});const s={RefreshTimerTriggered:"RefreshTimerTriggered",MandatoryLabelHandlerSetReadOnly:"MandatoryLabelHandlerSetReadOnly",MandatoryLabelHandlerResetReadOnly:"MandatoryLabelHandlerResetReadOnly",InformationProtectionServiceDisposed:"InformationProtectionServiceDisposed",LogExtractSensitivityDiscrepancy:"LogExtractSensitivityDiscrepancy",InformationProtectionServiceInstantiated:"InformationProtectionServiceInstantiated"}},20057:(e,t,i)=>{i.d(t,{N:()=>s});const s={ConfigureIrmCapabilitiesError:"ConfigureIrmCapabilitiesError",ConfigureMandatoryLabelError:"ConfigureMandatoryLabelError",ComponentLifecycleMissingError:"ComponentLifecycleMissingError",EnforceInformationProtectionError:"EnforceInformationProtectionError",GetAppliedLabelError:"GetAppliedLabelError",GetContainerAssignedLabelError:"GetContainerAssignedLabelError",GetContainerLabelsError:"GetContainerLabelsError",GetContainerPolicySettingsError:"GetContainerPolicySettingsError",GetDlpPolicyTipError:"GetDlpPolicyTipError",GetIrmCapabilitiesError:"GetIrmCapabilitiesError",GetLabelsError:"GetLabelsError",GetPolicySettingsError:"GetPolicySettingsError",GetWatermarkingError:"GetWatermarkingError",InitializationError:"InitializationError",InvalidLabelId:"InvalidLabelId",InvalidResolvedUrl:"InvalidResolvedUrl",InvalidTenantId:"InvalidTenantId",ProcessPolicySettingsError:"ProcessPolicySettingsError",RefreshLabelError:"RefreshLabelError",RemoveLabelError:"RemoveLabelError",SetLabelError:"SetLabelError"}},64993:(e,t,i)=>{i.d(t,{N:()=>s});const s={EnforceInformationProtection:"EnforceInformationProtection",EnforceMandatoryLabelExperience:"EnforceMandatoryLabelExperience",GetAppliedLabel:"GetAppliedLabel",GetDlpPolicyTip:"GetDlpPolicyTip",GetIsProtectionEnabled:"GetIsProtectionEnabled",GetIrmCapabilities:"GetIrmCapabilities",GetWatermarking:"GetWatermarking",RefreshLabel:"RefreshLabel",RemoveLabel:"RemoveLabel",SetLabel:"SetLabel",ProcessPolicySettings:"ProcessPolicySettings",InstantiatedByHost:"InstantiatedByHost",InstantiatedByFactory:"InstantiatedByFactory"}},75740:(e,t,i)=>{i.d(t,{n:()=>s});class s{constructor(e,t){this.ctor=e,this.optionalProviders=t}get IContainerServiceFactoryHelper(){return this}instantiateContainerService(e){const t=e.synthesize(this.optionalProviders,void 0);return new this.ctor(t)}}},83126:(e,t,i)=>{i.r(t),i.d(t,{CacheKeys:()=>z,SharepointInformationProtectionService:()=>X,SharepointInformationProtectionServiceFactory:()=>Z});class s extends Map{set(e,t){return super.set(e,t.then()),this}get(e){var t;return null===(t=super.get(e))||void 0===t?void 0:t.then()}}var r=i(60835),o=i(25532),a=i(27284);function n(e,t){const i=e.filter(e=>e.id===t);return 1===i.length?i[0]:void 0}var l=i(27051),d=i(40635),c=i(74405),u=i(18206),h=i(29018),g=i(37805),v=i(93537),p=i(47860);const m={allowedAttributes:["term","scheme","rel","href","type","m:null","m:type"],allowedNamespaces:["http://www.w3.org/2005/Atom","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata","http://schemas.microsoft.com/ado/2007/08/dataservices","http://www.georss.org/georss","http://www.opengis.net/gml"],allowedTags:["entry","id","category","link","title","updated","author","name","content","m:properties","d:AppliedActionsText","d:ComplianceUrl","d:GeneralText","d:OverrideOptions","d:LastProcessedTime","d:MatchedConditionDescriptions","d:element","d:TwoLetterISOLanguageName","d:GetDlpPolicyTip"]};function b(e,t){const i=e.getElementsByTagName(t);return 1===i.length&&i[0].textContent?i[0].textContent:""}var P=i(85874);const f="None";function y(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=[408,409,503];return e&&(0,P.e9)(e)&&i.push(709,710),t&&(0,P.s5)(e)&&i.push(404),{maxRetries:2,backoffFn:(0,g.FT)(500),filter:(0,v.sC)(i),respectRetryAfterHeader:!0}}function L(e){const t=[503];return e&&(0,P.e9)(e)&&t.push(709,710),{respectRetryAfterHeader:!0,maxRetries:3,filter:(0,v.sC)(t),backoffFn:(0,g.Ed)(100)}}const w="#microsoft.graph.security.addWatermarkAction",I="#microsoft.graph.security.metadataAction",C=2e4;function E(e){var t;const i=null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.filter(e=>{if(e["@odata.type"]===I)return e});return 1===i.length?i[0]:void 0}const S=e=>"".concat((0,p.o)(e),"/beta/"),M=e=>"".concat((0,p.o)(e),"/v1.0/"),A=["InformationProtectionPolicy.Read"];async function T(e,t,i,s,r,o){var a;const n=null===o||void 0===o?void 0:o.user.upn,u=(0,P.yg)(r),h=(0,P.md)(r),g="GetPolicyLabels";const v=u?function(e){var t;const i=new URLSearchParams;return i.append("$filter","applicableTo has 'file'"),M(null!==(t=null===r||void 0===r?void 0:r.audience)&&void 0!==t?t:"Production")+(e&&!h?"users/".concat(e):"me")+"/informationProtection/sensitivityLabels?".concat(i.toString())}(n):S(null!==(a=null===r||void 0===r?void 0:r.audience)&&void 0!==a?a:"Production")+"me/security/informationProtection/sensitivityLabels?$filter=contentFormats/any(s:s eq 'file')",p=W(i,g);u&&p.set("Accept-Language","default");const m=new AbortController,b={getToken:e=>{if(e)return t.getToken(A,e);throw Error("Options must be specified")},url:v,retryPolicy:L(r),timeoutMs:C,additionalRequestHeaders:p,requestInit:{signal:m.signal}},f=s?(0,d.g)((0,l.A)((0,l.A)({},b),{},{logger:s,nameForLogging:g,getAdditionalProps:async(e,t)=>(0,l.A)((0,l.A)({},(0,c.u)(e)),{},{hasUpn:!!n,shouldFilterUDPLabels:u,useMeInUrls:h})})):(0,d.y)(b),y=(await f).result;if(404===y.status)return m.abort(),[];if(!y.ok||200!==y.status)throw m.abort(),new Error("".concat(g," failed with status : ").concat(y.status));const w=await y.json();return u?R(w.value,e):w.value}function R(e,t,i){if(!e)return[];const s=[];for(const r of e)if(t||!D(r.labelActions)){const e=x(r,i);s.push(e,...R(r.sublabels,t,e))}return s}function x(e,t){var i,s,r;return{id:e.id,name:e.displayName,description:null!==(i=e.description)&&void 0!==i?i:"",isActive:e.isEnabled,sensitivity:e.priority,tooltip:null!==(s=e.toolTip)&&void 0!==s?s:"",color:null!==(r=e.color)&&void 0!==r?r:"#000000",parent:t||null,hasProtection:U(e.labelActions),watermark:N(e.labelActions),isDefault:e.isDefault}}function N(e){var t;const i=null===e||void 0===e?void 0:e.find(e=>"#microsoft.graph.addWatermark"===e["@odata.type"]);if(void 0!==(null===i||void 0===i?void 0:i.text))return{fontName:i.fontName,fontColor:null!==(t=i.fontColor)&&void 0!==t?t:"#000000",fontSize:i.fontSize,layout:i.orientation,text:i.text}}function k(e){return"encryptWith"in e}function U(e){return!!e&&e.some(e=>k(e)&&"template"===e.encryptWith)}function D(e){return!!e&&e.some(e=>k(e)&&"userDefinedRights"===e.encryptWith)}function G(e){return{metadata:[{name:"MSIP_Label_".concat(e,"_Enabled"),value:"true"}]}}async function O(e,t,i,s,r,o,a){var n,l;const d=S(null!==(n=null===a||void 0===a?void 0:a.audience)&&void 0!==n?n:"Production")+"me/security/informationProtection/sensitivityLabels/evaluateApplication",c=W(i,"EvaluateApplication"),h={contentInfo:r||G(t),labelingOptions:{labelId:t,downgradeJustification:{isDowngradeJustified:!!s,justificationMessage:s||""}}},g=new AbortController,v=await(0,u.fV)(t=>e.getToken(A,t),d,null!==(l=null===a||void 0===a?void 0:a.audience)&&void 0!==l?l:"Production","EvaluateApplication",o,void 0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h),signal:g.signal},L(a),C,void 0,c);if(!v.ok||200!==v.status){if(g.abort(),400===v.status&&(0,P.s7)(a)){h.labelingOptions.downgradeJustification.justificationMessage="REDACTED";const e=JSON.stringify(h);throw new Error("evaluateLabelApplication failed with status : ".concat(v.status," and payload: ").concat(e))}throw new Error("evaluateLabelApplication failed with status : ".concat(v.status))}const p=await v.json(),m=function(e){var t;const i=null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.filter(e=>{if(e["@odata.type"]===w)return e});return 1===i.length?i[0]:void 0}(p),b=E(p);return null!==b&&void 0!==b&&b.metadataToAdd?{changeLabel:!0,contentInfo:{metadata:b.metadataToAdd},watermark:m}:{changeLabel:!1}}async function H(e,t,i,s,r,o,a,n){const g=(0,P.p3)(n)?await async function(e,t,i,s,r,o,a){const n=(0,h.$)(s),u=W(r,"extractSensitivityLabels"),g=new AbortController,v={getToken:r=>{if(r){const o=(0,l.A)((0,l.A)({},r),{},{siteUrl:s,driveId:i,itemId:t});return e.getToken(["".concat(n,"/files.readwrite.all")],o)}throw Error("Options must be specified")},url:"".concat(n,"/_api/v2.0/drives/").concat(i,"/items/").concat(t,"/oneDrive.extractSensitivityLabels"),requestInit:{method:"POST",headers:{"Content-Type":"application/json"},signal:g.signal},retryPolicy:y(a),timeoutMs:C,additionalRequestHeaders:u},p=o?await(0,d.g)((0,l.A)((0,l.A)({},v),{},{logger:o,nameForLogging:"extractSensitivityLabels",getAdditionalProps:async(e,t)=>(0,c.u)(e)})):await(0,d.y)(v);if(!p.result.ok||200!==p.result.status)throw g.abort(),new Error("extractInformationProtectionContentLabels failed with status : ".concat(p.result.status));const m=await p.result.json();return m}(e,t,i,s,o,a,n):await async function(e,t,i,s,r,o,a,n){var l,d;const c=new URL(s).hostname,h="".concat(M(null!==(l=null===n||void 0===n?void 0:n.audience)&&void 0!==l?l:"Production"),"sites/").concat(c,"/drives/").concat(i,"/items/").concat(t,"/extractSensitivityLabels"),g=t=>e.getToken(["files.readwrite.all"],t),v=W(o,"extractSensitivityLabels"),p=new AbortController,m=await(0,u.fV)(g,h,null!==(d=null===n||void 0===n?void 0:n.audience)&&void 0!==d?d:"Production","extractSensitivityLabels",a,r,{method:"POST",signal:p.signal},L(n),C,void 0,v);if(!m.ok||200!==m.status)throw p.abort(),new Error("extractInformationProtectionContentLabels failed with status : ".concat(m.status));const b=await m.json();return b}(e,t,i,s,r,o,a,n);let v=null===g||void 0===g?void 0:g.labels.find(e=>e.tenantId===r);return!v&&null!==g&&void 0!==g&&g.labels.length&&g.labels.length>0&&(0,P.Ix)(n)&&(v=g.labels[0]),v}async function q(e,t,i,s,o,a,n,u){const g=(0,h.$)(s),v=W(a,"GetDlpPolicyTip"),p=await(0,r.OF)(e,s,i,t,n),f=null===p||void 0===p?void 0:p.sharepointIds.listItemUniqueId,L=null===p||void 0===p?void 0:p.webDavUrl.replace(g,""),w=(0,P.hP)(u),I=w&&f?"".concat(s,"/_api/web/getList('").concat(L,"')/getItemByUniqueId('").concat(f,"')/getDlpPolicyTip"):"".concat(s,"/_api/web/getListItem('").concat(L,"')/getdlppolicytip"),E=new AbortController,S={getToken:r=>{if(r){const o=(0,l.A)((0,l.A)({},r),{},{siteUrl:s,driveId:i,itemId:t});return e.getToken(["".concat(g,"/files.readwrite.all")],o)}throw Error("Options must be specified")},url:I,retryPolicy:y(u),timeoutMs:C,additionalRequestHeaders:v,requestInit:{signal:E.signal}},M=n?await(0,d.g)((0,l.A)((0,l.A)({},S),{},{logger:n,nameForLogging:"GetDlpPolicyTip",getAdditionalProps:async(e,t)=>{const i=(0,c.u)(e);return(0,l.A)((0,l.A)({},i),{},{isFileIdUsedForDlpTip:w,hasGuid:!!f})}})):await(0,d.y)(S);if(!M.result.ok||200!==M.result.status)throw E.abort(),new Error("getDlpTooltip failed with status : ".concat(M.result.status));const A=await M.result.text();return await async function(e,t){let i;i=t?(0,(await t).createXML)(e,m):e;const s=(new DOMParser).parseFromString(i,"text/xml"),r=s.querySelector("parsererror");if(r)throw new Error("parseDlpPolicyTip failed to parse : ".concat(r.textContent));const o=s.querySelector("content");if(o){const e=b(o,"d:GeneralText"),t=b(o,"d:AppliedActionsText"),i=b(o,"d:ComplianceUrl"),s=b(o,"d:OverrideOptions"),r=s?parseInt(s,10):void 0,a=b(o,"d:LastProcessedTime"),n=function(e,t){const i=e.getElementsByTagName(t),s=[];if(1===i.length)for(let r=0;r<i[0].children.length;r+=1){const e=i[0].children[r].textContent;s.push(e||"")}return s}(o,"d:MatchedConditionDescriptions");if([e,t,i,r,a,n.length].every(e=>!e))return;return{generalText:e,appliedActionsText:t,complianceUrl:i,overrideOptions:void 0!==r?r:NaN,lastProcessedTime:a,matchedConditionDescriptions:n}}}(A,o)}function W(e,t){const i="".concat(e.scenario||"InformationProtection","_").concat(e.subScenario||t||"Undefined",",");return new Headers({Application:e.application||"Undefined",Scenario:i,ScenarioType:e.scenarioType,Version:e.appVersion||"0.0.0"})}var F,j=i(20057),J=i(19352),V=i(64993),K=i(83125),_=i(47373),B=i(33788),$=i(75740);const z={AppliedLabel:"AppliedLabel",IrmCapabilities:"IrmCapabilities",IsProtectionEnabled:"IsProtectionEnabled",PolicySettings:"PolicySettings",Watermark:"Watermark",DlpPolicyTip:"DlpPolicyTip",Labels:"Labels",UnfilteredLabels:"UnfilteredLabels",IsMandatoryLabelingRequired:"IsMandatoryLabelingRequired"};function Y(e){return!!e&&"tokenProvider"in e}class X extends a.EventEmitter{constructor(e){var t,i,r,o,a,n,l,d,c,u,h,g;super(),this.propsOrProviders=e,this.disposed=!1,this.assignedMode=!1,this.props=Y(e)?e:void 0,this.providers=Y(e)?void 0:e,this.existingHostLabel=null===(t=this.props)||void 0===t?void 0:t.existingHostLabel,null!==(i=this.providers)&&void 0!==i&&i.InformationProtectionContext&&this.providers.InformationProtectionContext.then(e=>{var t;e&&(this.existingHostLabel=e.inheritedSensitivityLabel,e.assignedMode&&(this.assignedMode=!0,void 0!==e.assignedSensitivityLabelId&&this.setCurrentLabel(void 0,{id:e.assignedSensitivityLabelId,assignmentMethod:"standard",actionSource:"manual"},void 0,!0),void 0!==e.assignedCapabilities&&(this.assignedCapabilities=e.assignedCapabilities),this.supportsCLP=!(null===(t=e.assignedCapabilities)||void 0===t||!t.supportsCLP)))});const v=null===(r=this.providers)||void 0===r||null===(r=r.NamespaceLogger)||void 0===r?void 0:r.then(e=>e?new K.p("InformationProtectionService",e):void 0);if(this.loggerPromise=null!==(o=this.props)&&void 0!==o&&o.logger?Promise.resolve(this.props.logger):v,this.tokenProviderPromise=null!==(a=this.props)&&void 0!==a&&a.tokenProvider?Promise.resolve(this.props.tokenProvider):null===(n=this.providers)||void 0===n?void 0:n.TokenProvider,this.settingsProviderPromise=null!==(l=this.props)&&void 0!==l&&l.settingsProvider?Promise.resolve(this.props.settingsProvider):null===(d=this.providers)||void 0===d?void 0:d.SettingsProvider,this.userContextPromise=null!==(c=this.props)&&void 0!==c&&c.userContext?Promise.resolve(this.props.userContext):null===(u=this.providers)||void 0===u?void 0:u.UserContext,this.trustedTypesPolicyPromise=null!==(h=this.props)&&void 0!==h&&h.trustedTypesPolicy?Promise.resolve(this.props.trustedTypesPolicy):null===(g=this.providers)||void 0===g?void 0:g.LoopTrustedTypesPolicy,this.setMaxListeners(0),this.PromiseCache=new s,this.props)this.props.logger&&(0,_.Ot)(this.props.logger,{eventName:J.S.InformationProtectionServiceInstantiated,scenario:V.N.InstantiatedByHost});else if(this.providers){var p;null===(p=this.providers.NamespaceLogger)||void 0===p||p.then(e=>{e&&(0,_.Ot)(e,{eventName:J.S.InformationProtectionServiceInstantiated,scenario:V.N.InstantiatedByFactory,assignedMode:this.assignedMode})})}}clone(){if(this.props)return new X(this.props);if(this.providers)return new X(this.providers);throw new Error("Either props or providers must be set")}createAttributionHeaders(e){var t,i;return{application:(null===(t=this.props)||void 0===t?void 0:t.applicationName)||"Loop",appVersion:(null===(i=this.props)||void 0===i?void 0:i.appVersion)||"0.0.0",scenarioType:e||"AUO",scenario:"InformationProtection"}}get Disposable(){return this}dispose(){this.disposed=!0,window.clearInterval(this.refreshTimer),window.clearTimeout(this.mandatoryLabelTimeout),this.removeAllListeners(),this.PromiseCache.clear(),this.labelMetadataCache=void 0,delete this.labelMetadataCache,delete this.refreshTimer,delete this.mandatoryLabelTimeout}get InformationProtectionService(){return this}isAssignedMode(e){return!!(0,P.CE)(e)&&this.assignedMode}async getSupportsCLP(e,t){return void 0===this.supportsCLP&&await this.getIrmInformation(e,t),this.supportsCLP}getCacheKey(e,t){if(void 0!==t)return e+"_"+t}async getCurrentLabel(e,t,i){const[s,a,n]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise]),l=B.m.start("GetAppliedLabel",a);if(this.isAssignedMode(n)){if(l.setResult(!0,{sensitivityLabelId:this.assignedSensitivityLabelId,assignedMode:this.assignedMode}),void 0===this.assignedSensitivityLabelId)return;return{sensitivityLabelId:this.assignedSensitivityLabelId,assignmentMethod:"standard",tenantId:""}}if(!e||!(0,r.g2)(e))return void(a&&(0,_.Ot)(a,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.GetAppliedLabel}));if((0,P.N1)(n)){if(!1===await this.getSupportsCLP(e,t))return}const d=this.getCacheKey(z.AppliedLabel,e.hashedDocumentId);let c=d&&this.PromiseCache.get(d);return c||(c=(async()=>{try{const r=await(0,o.J)(e.siteUrl,a);if(!r)return void l.setResult(!1,{errorType:j.N.InvalidTenantId});if(void 0===s)throw new Error("TokenProvider is not available");const d=await H(s,e.itemId,e.driveId,e.siteUrl,r,this.createAttributionHeaders(t),a,n);return this.monitorAppliedLabel(e),i&&!d?void l.setResult(!0,{skipDefaultLabeling:i}):(this.processPolicySettings(e,d,"AUO"),l.setResult(!0,{appliedLabel:!!d,sensitivityLabelId:null===d||void 0===d?void 0:d.sensitivityLabelId,assignmentMethod:null===d||void 0===d?void 0:d.assignmentMethod,assignedMode:this.assignedMode}),d)}catch(r){return d&&this.PromiseCache.delete(d),void l.setResult(!1,{errorType:j.N.GetAppliedLabelError},r)}})(),d&&this.PromiseCache.set(d,c),c.then())}async getHasProtection(e,t){const[i,s]=await Promise.all([this.loggerPromise,this.settingsProviderPromise]);if(this.isAssignedMode(s)){var o,a;if(void 0===this.assignedSensitivityLabelId)return;return null!==(o=null===(a=this.assignedCapabilities)||void 0===a?void 0:a.supportsCLP)&&void 0!==o&&o}if(!e||!(0,r.g2)(e))return void(i&&(0,_.Ot)(i,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.GetIsProtectionEnabled}));if((0,P.N1)(s)){if(!1===await this.getSupportsCLP(e,t))return!1}const l=this.getCacheKey(z.IsProtectionEnabled,e.hashedDocumentId);let d=l&&this.PromiseCache.get(l);if(d)return d;const c=B.m.start("IsProtectionEnabled",i);return d=(async()=>{const[i,s]=await Promise.all([this.getCurrentLabel(e,t),this.getLabels(t,!0)]);if(i&&!s)return c.setResult(!1,{hasProtection:!1,appliedLabel:!!i,allLabels:!!s}),void(l&&this.PromiseCache.delete(l));let r=!1;if(i&&s){const e=n(s,i.sensitivityLabelId);r=!(null===e||void 0===e||!e.hasProtection)}return c.setResult(!0,{appliedLabel:!!i,allLabels:!!s,hasProtection:r}),r})(),l&&this.PromiseCache.set(l,d),d.then()}async setIrmInformation(e,t,i){const[s,r]=await Promise.all([this.settingsProviderPromise,this.loggerPromise]);if(!this.isAssignedMode(s))throw new Error("Setting IRM capabilities is only supported in assigned mode");return B.m.start("SetIrmCapabilities",r).setResult(!0,{supportsCLP:t.supportsCLP,canWrite:t.canWrite,canExtract:t.canExtract,canPrint:t.canPrint,canExport:t.canExport,assignedMode:this.assignedMode}),this.assignedCapabilities=t,!0}async getIrmInformation(e,t){const[i,s,o]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise]),a=B.m.start("GetIrmCapabilities",s);var n,u,g,v,p;if(this.isAssignedMode(o))return a.setResult(!0,{supportsCLP:null===(n=this.assignedCapabilities)||void 0===n?void 0:n.supportsCLP,canWrite:null===(u=this.assignedCapabilities)||void 0===u?void 0:u.canWrite,canExtract:null===(g=this.assignedCapabilities)||void 0===g?void 0:g.canExtract,canPrint:null===(v=this.assignedCapabilities)||void 0===v?void 0:v.canPrint,canExport:null===(p=this.assignedCapabilities)||void 0===p?void 0:p.canExport,assignedMode:this.assignedMode}),this.assignedCapabilities;if(!e||!(0,r.g2)(e))return void(s&&(0,_.Ot)(s,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.GetIrmCapabilities}));const m=this.createAttributionHeaders(t),b=this.getCacheKey(z.IrmCapabilities,e.hashedDocumentId);let P=b&&this.PromiseCache.get(b);return P||(P=(async()=>{try{if(void 0===i)throw new Error("TokenProvider is not available");const t=await async function(e,t,i,s,r,o,a){const n=(0,h.$)(s),u=W(r,"getItemIrmCapabilities"),g=new AbortController,v={getToken:r=>{if(r){const o=(0,l.A)((0,l.A)({},r),{},{siteUrl:s,driveId:i,itemId:t});return e.getToken(["".concat(n,"/files.readwrite.all")],o)}throw Error("Options must be specified")},url:"".concat(s,"/_api/v2.1/drives/").concat(i,"/items/").concat(t,"/opStream/capabilities?$select=canWrite,canPrint,canExtract,canExport,supportsCLP"),retryPolicy:y(a),timeoutMs:C,additionalRequestHeaders:u,requestInit:{signal:g.signal}},p=o?await(0,d.g)((0,l.A)((0,l.A)({},v),{},{logger:o,nameForLogging:"GetItemIrmCapabilities",getAdditionalProps:async(e,t)=>(0,c.u)(e)})):await(0,d.y)(v);if(!p.result.ok||200!==p.result.status)throw g.abort(),new Error("getItemIrmCapabilities failed with status : ".concat(p.result.status));return await p.result.json()}(i,e.itemId,e.driveId,e.siteUrl,m,s,o);return this.supportsCLP=t.supportsCLP,a.setResult(!0,{supportsCLP:t.supportsCLP,canWrite:t.canWrite,canExtract:t.canExtract,canPrint:t.canPrint,canExport:t.canExport,assignedMode:this.assignedMode}),t}catch(t){return b&&this.PromiseCache.delete(b),a.setResult(!1,{errorType:j.N.GetIrmCapabilitiesError},t),void(this.supportsCLP=!1)}})(),b&&this.PromiseCache.set(b,P),P.then())}async getPolicySettings(e){const[t,i,s,r]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise,this.userContextPromise]);let o=this.PromiseCache.get(z.PolicySettings.toString());if(o)return o;const a=B.m.start("GetPolicySettings",i);return o=(async()=>{try{if(void 0===t)throw new Error("TokenProvider is not available");const o=await async function(e,t,i,s,r){var o,a;const n=null===r||void 0===r?void 0:r.user.upn,u=(0,P.Wy)(s),h=(0,P.md)(s),g="GetPolicySettings",v=u?function(e){var t;const i=new URLSearchParams;return i.append("$filter","applicableTo has 'file'"),M(null!==(t=null===s||void 0===s?void 0:s.audience)&&void 0!==t?t:"Production")+(e&&!h?"users/".concat(e):"me")+"/informationProtection/sensitivityPolicySettings?".concat(i.toString())}(n):S(null!==(o=null===s||void 0===s?void 0:s.audience)&&void 0!==o?o:"Production")+"me/security/informationProtection/labelPolicySettings",p=W(t,g),m=new AbortController,b={getToken:t=>{if(t)return e.getToken(A,t);throw Error("Options must be specified")},url:v,retryPolicy:L(s),timeoutMs:C,additionalRequestHeaders:p,requestInit:{signal:m.signal}},f=i?(0,d.g)((0,l.A)((0,l.A)({},b),{},{logger:i,nameForLogging:g,getAdditionalProps:async(e,t)=>(0,l.A)((0,l.A)({},(0,c.u)(e)),{},{hasUpn:!!n,useNewAPI:u,useMeInUrls:h})})):(0,d.y)(b),y=(await f).result;if(404===y.status||204===y.status)return m.abort(),{id:"",moreInfoUrl:"",isDowngradeJustificationRequired:!1,isMandatory:!1,defaultLabelId:""};if(!y.ok||200!==y.status)throw m.abort(),new Error("getPolicySettings failed with status : ".concat(y.status));const w=await y.json();return{id:null===w||void 0===w?void 0:w.id,moreInfoUrl:u?null===w||void 0===w?void 0:w.helpWebUrl:null===w||void 0===w?void 0:w.moreInfoUrl,isDowngradeJustificationRequired:u?null===w||void 0===w?void 0:w.downgradeSensitivityRequiresJustification:null===w||void 0===w?void 0:w.isDowngradeJustificationRequired,isMandatory:null===w||void 0===w?void 0:w.isMandatory,defaultLabelId:u?null===w||void 0===w||null===(a=w.outlookEmailSettings)||void 0===a?void 0:a.defaultLabel:null===w||void 0===w?void 0:w.defaultLabelId}}(t,this.createAttributionHeaders(e),i,s,r);return a.setResult(!0,{infoUrl:!!o.moreInfoUrl,isMandatory:o.isMandatory,isDefault:!!o.defaultLabelId,isDowngradeJustificationRequired:o.isDowngradeJustificationRequired}),o}catch(o){return this.PromiseCache.delete(z.PolicySettings.toString()),void a.setResult(!1,{errorType:j.N.GetPolicySettingsError},o)}})(),this.PromiseCache.set(z.PolicySettings.toString(),o),o.then()}async getWatermarkInformation(e,t){const[i,s,o]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise]);if((0,P.N1)(o)){if(!1===await this.getSupportsCLP(e,t))return}const a=B.m.start("GetWatermarking",s);if(this.isAssignedMode(o)){let e;if(this.assignedSensitivityLabelId){var l;let t;const i=await this.getLabels("AUO",!0);i&&(t=n(i,this.assignedSensitivityLabelId)),e=null===(l=t)||void 0===l?void 0:l.watermark}return a.setResult(!0,{appliedLabel:!!this.assignedSensitivityLabelId,assignedMode:this.assignedMode}),e}if(!e||!(0,r.g2)(e))return void(s&&(0,_.Ot)(s,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.GetWatermarking}));const d=this.getCacheKey(z.Watermark,e.hashedDocumentId);let c=d&&this.PromiseCache.get(d);return c||(c=(async()=>{try{const r=await this.getCurrentLabel(e,t);let l;if(r){if(void 0===i)throw new Error("TokenProvider is not available");if((0,P.i4)(o)){const e=await this.getLabels("AUO",!0);if(e){const t=n(e,r.sensitivityLabelId);l=null===t||void 0===t?void 0:t.watermark,a.setResult(!0,{appliedLabel:!0,isWatermark:!!l})}else d&&this.PromiseCache.delete(d),a.setResult(!1,{errorType:j.N.GetWatermarkingError})}else{const e=await O(i,r.sensitivityLabelId,this.createAttributionHeaders(t),void 0,void 0,s,o);this.labelMetadataCache=e.contentInfo,l=e.watermark,a.setResult(!0,{appliedLabel:!0,isWatermark:!!e.watermark,isContentInfo:!!e.contentInfo})}return l}return void a.setResult(!0,{appliedLabel:!!r})}catch(r){return d&&this.PromiseCache.delete(d),void a.setResult(!1,{errorType:j.N.GetWatermarkingError},r)}})(),d&&this.PromiseCache.set(d,c),c.then())}async overrideDlpPolicyTip(e){throw new Error("Not Implemented..")}async getLabels(e,t){const[i,s,r,o]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise,this.userContextPromise]),a=t?z.UnfilteredLabels.toString():z.Labels.toString();let n=this.PromiseCache.get(a);if(n)return n;const l=B.m.start("GetLabels",s);return n=(async()=>{try{if(void 0===i)throw new Error("TokenProvider is not available");const a=await T(null!==t&&void 0!==t&&t,i,this.createAttributionHeaders(e),s,r,o);return l.setResult(!0),a}catch(n){return this.PromiseCache.delete(a),void l.setResult(!1,{errorType:j.N.GetLabelsError},n)}})(),this.PromiseCache.set(a,n),n.then()}async changeLabel(e,t,i){const[s,o,a]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise]);if(!(0,r.g2)(e))return!1;if((0,P.N1)(a)){if(!1===await this.getSupportsCLP(e,i))return!1}if(void 0===s)throw new Error("TokenProvider is not available");const n=await async function(e,t,i,s,r,o,a,n){const u=(0,h.$)(s),g=W(o,"SetLabel"),v=new AbortController,p={getToken:r=>{if(r){const o=(0,l.A)((0,l.A)({},r),{},{siteUrl:s,driveId:i,itemId:t});return e.getToken(["".concat(u,"/files.readwrite.all")],o)}throw Error("Options must be specified")},url:"".concat(u,"/_api/v2.0/drives/").concat(i,"/items/").concat(t,"/setSensitivityLabel"),requestInit:{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),signal:v.signal},retryPolicy:y(n,!0),timeoutMs:C,additionalRequestHeaders:g},m=a?await(0,d.g)((0,l.A)((0,l.A)({},p),{},{logger:a,nameForLogging:"SetLabel",getAdditionalProps:async(e,t)=>(0,l.A)((0,l.A)({},(0,c.u)(e)),{},{include404:(0,P.s5)(n)})})):await(0,d.y)(p);return v.abort(),200===m.result.status}(s,e.itemId,e.driveId,e.siteUrl,t,this.createAttributionHeaders(i),o,a);return n&&this.refreshAppliedLabel(e,i),n}async isLabelChangeAnUpgrade(e,t,i,s){return(async()=>{const[r,o]=await Promise.all([this.getCurrentLabel(e,s),this.getLabels(s)]);if(!r)return!0;if(!o)return i.addAdditionalProps({setIfUpgradeFailure:"noLabelsFound"}),!1;if(null==t.id)return i.addAdditionalProps({setIfUpgradeFailure:"labelIdMissing"}),!1;const a=n(o,r.sensitivityLabelId),l=n(o,t.id);return l?!a||l.sensitivity>=a.sensitivity||(i.addAdditionalProps({setIfUpgradeFailure:"isSensitivityDowngrade"}),!1):(i.addAdditionalProps({setIfUpgradeFailure:"proposedLabelNotFound"}),!1)})().then()}async setCurrentLabel(e,t,i,s){const[o,a,n]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise]);if(!(0,P.E7)(n)){return B.m.start("SetLabel",a).setResult(!1,{settingName:P.LV,settingValue:(0,P.E7)(n),settingsProviderExists:void 0!==n}),!1}const l=B.m.start("SetLabel",a);if(this.isAssignedMode(n)){var d,c;const s=await this.isLabelChangeAnUpgrade(e,t,l,i);var u;return s?(this.assignedSensitivityLabelId=null!==(d=t.id)&&void 0!==d?d:void 0,l.setResult(s,{changeLabel:!0,changeLabelStatus:!0,setIfUpgrade:!0,sensitivityLabelId:t.id||"",supportsCLP:null===(c=this.assignedCapabilities)||void 0===c?void 0:c.supportsCLP,callingEvaluate:!1,assignedMode:this.assignedMode}),!0):(l.setResult(!1,{errorType:j.N.SetLabelError,setIfUpgrade:s,sensitivityLabelId:t.id||"",supportsCLP:null===(u=this.assignedCapabilities)||void 0===u?void 0:u.supportsCLP,assignedMode:this.assignedMode}),!1)}if(!e||!(0,r.g2)(e))return a&&(0,_.Ot)(a,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.SetLabel}),!1;if(null===t.id)return a&&(0,_.Ot)(a,{eventName:j.N.InvalidLabelId,scenario:V.N.SetLabel}),!1;let h,g=!0;const v=await this.getSupportsCLP(e,i);try{if(void 0===o)throw new Error("TokenProvider is not available");s&&(h=await this.isLabelChangeAnUpgrade(e,t,l,i),l.addAdditionalProps({setIfUpgrade:h}),h||(l.setResult(!1,{errorType:j.N.SetLabelError,assignmentMethod:t.assignmentMethod,actionSource:t.actionSource,sensitivityLabelId:t.id,ifMatchLabelId:t.ifMatchLabelId,supportsCLP:v,assignedMode:this.assignedMode}),g=!1));const r=!(0,P.i4)(n);let d;var p;if(!1!==h)r?(d=await O(o,t.id,this.createAttributionHeaders(i),t.justificationText,this.labelMetadataCache,a,n),d.changeLabel&&!1!==v&&(g=await this.changeLabel(e,t,i))):!1!==v&&(g=await this.changeLabel(e,t,i)),l.setResult(g,{changeLabel:null===(p=d)||void 0===p?void 0:p.changeLabel,changeLabelStatus:g,assignmentMethod:t.assignmentMethod,actionSource:t.actionSource,sensitivityLabelId:t.id,ifMatchLabelId:t.ifMatchLabelId,supportsCLP:v,callingEvaluate:r,assignedMode:this.assignedMode})}catch(m){l.setResult(!1,{errorType:j.N.SetLabelError,assignmentMethod:t.assignmentMethod,actionSource:t.actionSource,sensitivityLabelId:t.id,ifMatchLabelId:t.ifMatchLabelId,supportsCLP:v,assignedMode:this.assignedMode},m),g=!1}return g||!1===h||this.emit("sensitivityError"),g}async removeCurrentLabel(e,t,i){const[s,o,a]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise]);if(!(0,P.E7)(a)){return B.m.start("RemoveLabel",o).setResult(!1,{settingName:P.LV,settingValue:(0,P.E7)(a),settingsProviderExists:void 0!==a}),!1}const n=B.m.start("RemoveLabel",o);if(null===t.id)return o&&(0,_.Ot)(o,{eventName:j.N.InvalidLabelId,scenario:V.N.SetLabel,assignedMode:this.assignedMode}),!1;if(this.isAssignedMode(a))return this.assignedSensitivityLabelId=void 0,n.setResult(!0,{changeLabel:!0,removeCurrentLabelStatus:!0,stopEvaluate:!1,assignedMode:this.assignedMode}),!0;if(!e||!(0,r.g2)(e))return o&&(0,_.Ot)(o,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.RemoveLabel}),!1;let l=!0;const d=await this.getSupportsCLP(e,i);try{var c;if(void 0===s)throw new Error("TokenProvider is not available");const r=(0,P.i4)(a);let g;var h;if(!1!==d)r||(g=await async function(e,t,i,s,r,o,a){var n,l;const d=S(null!==(n=null===a||void 0===a?void 0:a.audience)&&void 0!==n?n:"Production")+"me/security/informationProtection/sensitivityLabels/evaluateRemoval",c=W(i,"EvaluateRemoval"),h={contentInfo:s||G(t),downgradeJustification:{isDowngradeJustified:!!r,justificationMessage:r||""}},g=new AbortController,v=await(0,u.fV)(t=>e.getToken(A,t),d,null!==(l=null===a||void 0===a?void 0:a.audience)&&void 0!==l?l:"Production","EvaluateRemoval",o,void 0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h),signal:g.signal},L(a),C,void 0,c);if(!v.ok||200!==v.status)throw g.abort(),new Error("evaluateLabelRemoval failed with status : ".concat(v.status));const p=E(await v.json());return null!==p&&void 0!==p&&p.metadataToRemove?{changeLabel:!0}:{changeLabel:!1}}(s,t.id,this.createAttributionHeaders(i),this.labelMetadataCache,t.justificationText,o,a)),(null!==(h=g)&&void 0!==h&&h.changeLabel||r)&&(t.id=null,l=await this.changeLabel(e,t,i),l&&(this.labelMetadataCache=void 0));n.setResult(!0,{changeLabel:null===(c=g)||void 0===c?void 0:c.changeLabel,removeCurrentLabelStatus:l,assignmentMethod:t.assignmentMethod,actionSource:t.actionSource,supportsCLP:d,stopEvaluate:r,assignedMode:this.assignedMode})}catch(g){n.setResult(!1,{errorType:j.N.RemoveLabelError,supportsCLP:d,assignedMode:this.assignedMode},g),l=!1}return l||this.emit("sensitivityError"),l}async getDlpTooltip(e,t){const[i,s,o,a]=await Promise.all([this.tokenProviderPromise,this.loggerPromise,this.settingsProviderPromise,this.trustedTypesPolicyPromise]);if(this.isAssignedMode(o))throw new Error("DLP policy tip is not supported in assigned mode");if(!(0,P.y6)(o))return;if(!(0,r.g2)(e))return void(s&&(0,_.Ot)(s,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.GetDlpPolicyTip}));const n=this.getCacheKey(z.DlpPolicyTip,e.hashedDocumentId);let l=n&&this.PromiseCache.get(n);if(l)return l;const d=B.m.start("GetDlpPolicyTip",s);return l=(async()=>{try{if(void 0===i)throw new Error("TokenProvider is not available");const r=await q(i,e.itemId,e.driveId,e.siteUrl,a,this.createAttributionHeaders(t),s,o);return r&&this.emit("dlpPolicyTip",r),d.setResult(!0,{tip:!!r,moreInfoUrl:!(null===r||void 0===r||!r.complianceUrl),overrideOptions:null===r||void 0===r?void 0:r.overrideOptions}),r}catch(r){return n&&this.PromiseCache.delete(n),void d.setResult(!1,{errorType:j.N.GetDlpPolicyTipError},r)}})(),n&&this.PromiseCache.set(n,l),l.then()}async getIsMandatoryLabeling(e,t){const[i,s]=await Promise.all([this.loggerPromise,this.settingsProviderPromise]);if(!(0,P.E7)(s)){return B.m.start("IsMandatoryLabelingRequired",i).setResult(!1,{settingName:P.LV,settingValue:(0,P.E7)(s),settingsProviderExists:void 0!==s}),!1}if(this.isAssignedMode(s))throw new Error("getIsMandatoryLabeling is not supported in assigned mode");if(!(0,r.g2)(e))return void(i&&(0,_.Ot)(i,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.GetIsProtectionEnabled}));if((0,P.N1)(s)){if(!1===await this.getSupportsCLP(e,t))return!1}const o=this.getCacheKey(z.IsMandatoryLabelingRequired,e.hashedDocumentId);let a=o&&this.PromiseCache.get(o);if(a)return a;const n=B.m.start("IsMandatoryLabelingRequired",i);return a=(async()=>{const e=await this.getPolicySettings(t);if(!e)return n.setResult(!1,{policySettings:!!e}),void(o&&this.PromiseCache.delete(o));const i=e.isMandatory;return n.setResult(!0,{isMandatoryLabelingRequired:i}),i})(),o&&this.PromiseCache.set(o,a),a.then()}async enforceMandatoryLabelExperience(e,t){const[i,s]=await Promise.all([this.loggerPromise,this.settingsProviderPromise]);if(!(0,P.E7)(s)||!(0,P.vY)(s))return;if(this.isAssignedMode(s))throw new Error("enforceMandatoryLabelExperience is not supported in assigned mode");if((0,P.N1)(s)){if(!1===await this.getSupportsCLP(e,t))return}if(!(0,r.g2)(e))return void(i&&(0,_.Ot)(i,{eventName:j.N.InvalidResolvedUrl,scenario:V.N.EnforceMandatoryLabelExperience}));const o=B.m.start("EnforceMandatoryLabelExperience",i),[a,n]=await Promise.all([this.getPolicySettings(t),this.getCurrentLabel(e,t)]);null!==a&&void 0!==a&&a.isMandatory&&!n&&(a.defaultLabelId?this.delayExecuteMandatoryLabeling(e,1e4,t):this.executeMandatoryLabeling()),o.setResult(!0)}delayExecuteMandatoryLabeling(e,t,i){this.mandatoryLabelTimeout||(this.mandatoryLabelTimeout=window.setTimeout(async()=>{await this.getCurrentLabel(e,i)||this.executeMandatoryLabeling()},t))}async initialize(e){const[t]=await Promise.all([this.loggerPromise]),i=B.m.start("Initialization",t);await Promise.all([this.getLabels(e),this.getPolicySettings(e)]),i.setResult(!0)}async monitorAppliedLabel(e){const[t]=await Promise.all([this.loggerPromise]);if(window.clearInterval(this.refreshTimer),!this.disposed){const i=9e5;this.refreshTimer=window.setInterval(async()=>{t&&(0,_.Ot)(t,{eventName:J.S.RefreshTimerTriggered}),await this.refreshAppliedLabel(e,"AUO")},i)}}async refreshAppliedLabel(e,t){const[i,s]=await Promise.all([this.loggerPromise,this.settingsProviderPromise]);if(!(0,r.g2)(e))return;if((0,P.N1)(s)){if(!1===await this.getSupportsCLP(e,t))return}const o=B.m.start("RefreshAppliedLabel",i),a=(0,P.jP)(s),n=await this.getCurrentLabel(e,t,a),l=this.getCacheKey(z.AppliedLabel,e.hashedDocumentId);l&&this.PromiseCache.delete(l);const d=await this.getCurrentLabel(e,t,a),c=(null===n||void 0===n?void 0:n.sensitivityLabelId)!==(null===d||void 0===d?void 0:d.sensitivityLabelId);if(c){this.emit("sensitivityLabelChanged",d);const i=this.getCacheKey(z.IrmCapabilities,e.hashedDocumentId);i&&this.PromiseCache.delete(i);const s=this.getCacheKey(z.Watermark,e.hashedDocumentId);s&&this.PromiseCache.delete(s);const[r,o]=await Promise.all([this.getIrmInformation(e,t),this.getWatermarkInformation(e,t)]);this.emit("IrmCapabilitiesChanged",r),this.emit("watermarkingChanged",o);const a=this.getCacheKey(z.IsProtectionEnabled,e.hashedDocumentId);a&&this.PromiseCache.delete(a);const n=await this.getHasProtection(e,t);this.emit("protectionChanged",n)}o.setResult(!0,{isRefreshed:c})}async processPolicySettings(e,t,i){const[s,r]=await Promise.all([this.loggerPromise,this.settingsProviderPromise]),o=B.m.start("ProcessPolicySettings",s);if(!(0,P.E7)(r)||this.isAssignedMode(r))return void o.setResult(!0,{settingName:P.LV,settingValue:(0,P.E7)(r),settingsProviderExists:void 0!==r,assignedMode:this.assignedMode});const a=await this.getPolicySettings(i||"AUO"),n=await this.getLabels(i);if(!a)return void o.setResult(!1,{errorType:j.N.GetPolicySettingsError,scenario:V.N.ProcessPolicySettings});let l=!1;this.existingHostLabel&&(0,P.M6)(r)&&(l=await this.executeInheritedLabeling(e,i),o.addAdditionalProps({executeInheritedLabel:l}));let d,c=!1;d=(0,P.yg)(r)&&(0,P.ZU)(r)?function(e){if(e&&0!==e.length)for(const t of e)if(t.isDefault&&t.id!==f)return t.id}(n):a.defaultLabelId===f?void 0:a.defaultLabelId,l||!d||null!==t&&void 0!==t&&t.sensitivityLabelId||(c=await this.executeDefaultLabeling(e,d,i),o.addAdditionalProps({defaultLabelingStatus:c}));let u=!1;!a.isMandatory||null!==t&&void 0!==t&&t.sensitivityLabelId||!(0,P.vY)(r)||d&&(c||l)||(u=!0,this.executeMandatoryLabeling()),o.setResult(!0,{isDefault:!!d,executeInheritedLabel:l,defaultLabelingStatus:c,isMandatory:a.isMandatory,executeMandatoryLabel:u})}async executeDefaultLabeling(e,t,i){const[s]=await Promise.all([this.settingsProviderPromise]);if(!(0,P.E7)(s))return!1;const r={id:t,assignmentMethod:"standard",actionSource:"defaultLabel"};return await this.setCurrentLabel(e,r,i)}async executeInheritedLabeling(e,t){const[i]=await Promise.all([this.loggerPromise]),s=B.m.start("ExecuteInheritedLabeling",i);if(!this.existingHostLabel)return s.setResult(!1),!1;const r=this.existingHostLabel.sensitivityLabelId,o={id:r,assignmentMethod:"auto",actionSource:"auto"},a=await this.setCurrentLabel(e,o,t);return s.setResult(a,{existingHostLabel:r}),a&&(this.existingHostLabel=void 0),a}async executeMandatoryLabeling(){const[e]=await Promise.all([this.settingsProviderPromise]);(0,P.E7)(e)&&this.emit("mandatoryLabelRequired"),this.mandatoryLabelTimeout&&window.clearTimeout(this.mandatoryLabelTimeout)}}(F=X).serviceFactory=new $.n(F,{TokenProvider:"TokenProvider",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider",UserContext:"UserContext",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",InformationProtectionContext:"InformationProtectionContext"});const Z=X.serviceFactory}}]);
//# sourceMappingURL=SharepointInformationProtectionService.d0d5bae8.chunk.js.map