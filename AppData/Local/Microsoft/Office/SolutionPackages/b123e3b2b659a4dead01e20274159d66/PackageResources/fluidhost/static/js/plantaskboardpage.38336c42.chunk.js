(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[93818],{2112:e=>{e.exports=function(){}},8760:(e,t,o)=>{var n=o(52990),r=o(15857),s=o(88218),i=o(60911),a=o(54052),l=o(90402);e.exports=function(e){return r(function(t){var o=t.length,r=o,c=n.prototype.thru;for(e&&t.reverse();r--;){var p=t[r];if("function"!=typeof p)throw new TypeError("Expected a function");if(c&&!d&&"wrapper"==i(p))var d=new n([],!0)}for(r=d?r:o;++r<o;){p=t[r];var u=i(p),h="wrapper"==u?s(p):void 0;d=h&&l(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?d[i(h[0])].apply(d,h[3]):1==p.length&&l(p)?d[u]():d.thru(p)}return function(){var e=arguments,n=e[0];if(d&&1==e.length&&a(n))return d.plant(n).value();for(var r=0,s=o?t[r].apply(this,e):n;++r<o;)s=t[r].call(this,s);return s}})}},14115:(e,t,o)=>{"use strict";o.d(t,{D:()=>n});const n="Archived for plan conversion"},15857:(e,t,o)=>{var n=o(20819),r=o(55636),s=o(46350);e.exports=function(e){return s(r(e,void 0,n),e+"")}},16841:(e,t,o)=>{"use strict";o.r(t),o.d(t,{PlanTaskBoardPage:()=>Wp});var n,r,s,i,a,l,c=o(27051),p=o(78332),d=o(5099),u=o(64327),h=o(45795),g=o(96891),m=o(38629),C=o(96481);!function(e){e.MyDayNavButton="MyDayNavButton",e.MyDayTaskSuggestionsButton="MyDayTaskSuggestionsButton",e.MyTasksNavButton="MyTasksNavButton",e.MyTasksAllPivot="MyTasksAllPivot",e.MyPlansNavButton="MyPlansNavButton",e.MyPlansRecentPivot="MyPlansRecentPivot",e.MyPortfoliosNavButton="MyPortfoliosNavButton",e.MyPlansNewPlanButton="MyPlansNewPlanButton",e.LeftNavNewPlanButton="LeftNavNewPlanButton",e.BasicPlanGridViewPivot="BasicPlanGridViewPivot",e.BasicPlanBoardViewPivot="BasicPlanBoardViewPivot",e.BasicPlanScheduleViewPivot="BasicPlanScheduleViewPivot",e.BasicPlanChartsViewPivot="BasicPlanChartsViewPivot",e.BasicPlanGridViewSecondColumn="BasicPlanGridViewSecondColumn",e.BasicPlanShareButton="BasicPlanShareButton",e.BasicPlanMoreOptions="BasicPlanMoreOptions",e.BasicPlanFilters="BasicPlanFilters",e.MyTasksFilters="MyTasksFilters",e.BasicTaskDetailsMoreOptions="BasicTaskDetailsMoreOptions",e.BasicTaskDetailsStartDateCalendarIcon="BasicTaskDetailsStartDateCalendarIcon",e.PremiumPlanBoardViewPivot="premiumPlanBoardViewPivot",e.CopilotButton="CopilotButton",e.BottomRight="BottomRight",e.PlanShareButton="PlanShareButton",e.GsdHomeGoalsSection="GsdHomeGoalsSection",e.GsdHomeResourcesSection="GsdHomeResourcesSection"}(n||(n={})),function(e){e.PlannerExternal="88001031",e.PlannerSelfhostInternal="88001030"}(r||(r={})),function(e){e.MyDayOpen="MyDayOpen",e.MyTasksOpen="MyTasksOpen",e.MyPlansOpen="MyPlansOpen",e.BasicPlanViewOpen="BasicPlanViewOpen",e.BasicGridViewOpen="BasicGridViewOpen",e.BasicBoardViewOpen="BasicBoardViewOpen",e.BasicScheduleViewOpen="BasicScheduleViewOpen",e.BasicChartsViewOpen="BasicChartsViewOpen",e.PremiumGridViewOpen="PremiumGridViewOpen",e.PremiumBoardViewOpen="PremiumBoardViewOpen",e.PremiumChartsViewOpen="PremiumChartsViewOpen",e.PremiumGsdHomeViewOpen="PremiumGsdHomeViewOpen",e.PremiumGsdBoardViewOpen="PremiumGsdBoardViewOpen",e.PremiumGoalsViewOpen="PremiumGoalsViewOpen",e.PremiumTimelineViewOpen="PremiumTimelineViewOpen",e.PlanViewOpen="PlanViewOpen"}(s||(s={})),function(e){e.LinkRedirect="LinkRedirect",e.Trial="Trial",e.RequestFlow="RequestFlow",e.Dismiss="Dismiss",e.NextStep="NextStep"}(i||(i={})),function(e){e.IsRequestFlowEligible="IsRequestFlowEligible",e.IsTrialEligible="IsTrialEligible",e.IsNotEligible="IsNotEligible",e.HasPremiumTrial="HasPremiumTrial",e.HasPremiumPaid="HasPremiumPaid"}(a||(a={})),function(e){e.Dismiss="dismiss",e.Click="click",e.Conversion="conversion"}(l||(l={}));var k=o(5586),b=o(81206),T=o(91834);const S=[p.Yc.Bucket,p.Yc.Assignee,p.Yc.Progress,p.Yc.DueDate,p.Yc.Category,p.Yc.Priority];p.Yc.Plan,p.Yc.Progress,p.Yc.DueDate,p.Yc.Priority,p.Yc.Plan,p.Yc.Bucket,p.Yc.Assignee,p.Yc.Progress,p.Yc.DueDate,p.Yc.Priority,p.Yc.Plan,p.Yc.Progress,p.Yc.DueDate,p.Yc.Priority;var P,v,x,y,f,A,w,D,B,E=o(74844);!function(e){e.Dev="dev",e.PreProd="ppe",e.Demo="demo",e.DogfoodDev="dogfood-dev",e.DogfoodStaging="dogfood-staging",e.DogfoodAll="dogfood-all",e.ProdMSIT="production-msit",e.ProdBetaTAP="production-beta-tap",e.ProdAll="production-all",e.Gcc="gcc",e.Gcch="gcch",e.DoD="dod",e.AirGap="krp"}(P||(P={})),function(e){e.PlannerMobile="66375f6b-983f-4c2c-9701-d680650f588f",e.PlannerWeb="09abbdfd-ed23-44ee-a2d9-a627aa1c90f3",e.MSTeamsWeb="5e3ce6c0-2b1f-4285-8d4b-75ee78787346",e.MSTeamsDesktop="1fec8e78-bce4-4aaf-ab1b-5451cc387264",e.MicrosoftTeamsRetailService="75efb5bc-18a1-4e7b-8a66-2ad2503d79c6",e.MicrosoftPlannerClient="75f31797-37c9-498e-8dc9-53c16a36afca",e.DeprecatedSharepoint="00000003-0000-0ff1-ce00-000000000000",e.Sharepoint="08e18876-6177-487e-b8b5-cf950c1e598c",e.ProjectReplicationService="e62ee429-f250-4aef-a588-7b511fa9a67a",e.CentroService="00000006-0000-0ff1-ce00-000000000000",e.ToDo="5754bb84-f388-44f0-b3f7-9233a05bbb34",e.ApprovalApp="7c316234-ded0-4f95-8a83-8453d0876592"}(v||(v={})),function(e){e.Teams="Teams",e.Web="Web",e.Sharepoint="Sharepoint",e.Loop="Loop",e.Dynamics="Dynamics"}(x||(x={})),function(e){e.App="App",e.Tab="Tab",e.ConfigTab="ConfigTab",e.RemoveTab="RemoveTab",e.TaskFromMessage="TaskFromMessage",e.Component="Component"}(y||(y={})),function(e){e.Ppe="Ppe",e.Prod="Prod",e.Gcc="Gcc",e.Gcch="Gcch",e.Dod="Dod",e.Agc="Agc"}(f||(f={})),function(e){e.Eu="EU",e.Row="ROW"}(A||(A={})),function(e){e.SPWeb="SPWeb"}(w||(w={})),function(e){e.Board="Board"}(D||(D={})),function(e){e.Chrome="Chrome",e.Edge="Edge",e.Firefox="Firefox",e.IE="IE",e.Opera="Opera",e.Other="Other",e.Safari="Safari",e.Electron="Electron"}(B||(B={}));var I,F;!function(e){e[e.None=0]="None",e[e.CannotDeleteTasksNotCreatedBySelf=1]="CannotDeleteTasksNotCreatedBySelf"}(I||(I={})),function(e){e.delayOnRetryInMiliseconds=200,e.maxRetryTimeoutInMiliseconds=18e4,e.maxRetryCount=2}(F||(F={}));var L;!function(e){e.Basic="Basic",e.Premium="Premium",e.ToDo="ToDo"}(L||(L={}));class M{}M.RtlCultures=["ar","he","ur","ku","fa"],M.MomentCultures=["ar","ar-ly","ar-ma","ar-sa","ar-tn","bg","ca","cs","cy","da","de","de-at","el","en","en-au","en-ca","en-gb","en-ie","en-in","en-nz","es","es-do","et","eu","fi","fil","fr","fr-ca","fr-ch","gl","he","hi","hr","hu","id","is","it","ja","ka","kk","ko","lt","lv","ml","ms-my","nb","nl","nn","no","pl","pt","pt-br","ro","ru","sr-cyrl","sr","sk","sl","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw"],M.DefaultMomentCulture="en";class N{}var R;N.sensitivityLabels="https://go.microsoft.com/fwlink?linkid=2106748",N.linkedPlans="https://aka.ms/linkedplans",N.lightWeightPlans="https://aka.ms/lightweightplans",N.m365Groups="https://go.microsoft.com/fwlink?linkid=2049051",N.guestAccess="https://go.microsoft.com/fwlink?linkid=871797",N.emailAndNotifications="https://go.microsoft.com/fwlink?linkid=866998",N.copyAndMoveTasks="https://go.microsoft.com/fwlink?linkid=872349",N.getStartedWithProjectForTheWeb="https://support.microsoft.com/office/get-started-with-project-for-the-web-50bf3e29-0f0d-4b7a-9d2c-7c78389b67ad",N.ieDeprecated="https://techcommunity.microsoft.com/t5/microsoft-365-blog/microsoft-365-apps-say-farewell-to-internet-explorer-11-and/ba-p/1591666",N.sharedPlans="https://go.microsoft.com/fwlink?linkid=2228058",N.missingFields="https://go.microsoft.com/fwlink/?linkid=2245039",N.addFormsRequirement="https://go.microsoft.com/fwlink/?linkid=2245040",N.usePlannerComponent="https://go.microsoft.com/fwlink/?linkid=2245448",N.projectP1SubscriptionPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2183548",N.projectP3SubscriptionPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2183549",N.projectP5SubscriptionPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2183649",N.projectLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2261209",N.importPlanLearnMoreUrl="https://go.microsoft.com/fwlink/?linkid=2226056",N.plannerHelp="https://go.microsoft.com/fwlink/?linkid=2260017",N.licenseTerms="https://www.microsoft.com/servicesagreement",N.privacyStatement="https://privacy.microsoft.com/privacystatement",N.joinGroupAsMember="https://go.microsoft.com/fwlink/?linkid=2264502",N.trialTermsOfServiceUrl="https://go.microsoft.com/fwlink?linkid=2204238",N.fre="https://go.microsoft.com/fwlink/?linkid=2283523",N.sensitivityLabelsAndMicrosoft365Copilot="https://learn.microsoft.com/en-us/purview/sensitivity-labels#sensitivity-labels-and-microsoft-365-copilot",function(e){e.Dev="3434be72-1bba-427b-83ca-43daf2ee0d22",e.PPE="9c0fcd8d-7cca-466f-b549-9254dac9c036",e.Prod="com.microsoft.teamspace.tab.planner"}(R||(R={}));new Map([["Agc",[P.AirGap]],["Dod",[P.DoD]],["Gcc",[P.Gcc]],["Gcch",[P.Gcch]],["Ppe",[P.PreProd]],["Prod",[P.Demo,P.Dev,P.DogfoodDev,P.DogfoodStaging,P.DogfoodAll,P.ProdMSIT,P.ProdBetaTAP,P.ProdAll]]]);var U;!function(e){e.AppId=2204}(U||(U={}));var O=o(14115),H=o(45785);const V=o.p+"static/media/person-circle-dismiss-dark.ecaa4be43607c724d663.png",G=o.p+"static/media/person-circle-dismiss-light.9cba0563e2a78a02990c.png",W=o.p+"static/media/searchExclamDark.7df65dbbeef20727f66b.png",_=o.p+"static/media/searchExclamLight.dea5c5a45aaf17d877e4.png";var z=o(65043),Z=o(49634),K=o(9442),q=o(63485),j=o(11638),Q=o(66783),Y=o(52195),J=o(83108);const X="170px",$=(0,Q.J9)((e,t)=>{const o={root:[(0,J.gS)("row"),J.cc,{height:"100%",width:"100%"}],elementContainer:[(0,J.gS)("column"),J.cc,{padding:"10px",maxWidth:"500px","> *":{textAlign:"center"}}],errorImage:{paddingBottom:"8px","> img":{height:"192px",width:"192px"}},errorText:{fontSize:Y.s.size16,paddingBottom:"8px",fontWeight:Y.BO.semibold},errorSubText:{fontSize:Y.s.size14,paddingBottom:"24px"},buttonContainer:[(0,J.gS)("column"),J.cc,{paddingBottom:"16px"}],primaryButton:{marginBottom:"8px",width:X},secondaryButton:{width:X},errorLinkSection:{paddingBottom:"24px",fontSize:Y.s.size12}};return(0,Y.TW)(o,t)}),ee=(0,Q.J9)(e=>({root:(0,Y.Zq)("errorView",e.root),elementContainer:(0,Y.Zq)("elementContainer",e.elementContainer),errorImage:(0,Y.Zq)("errorImage",e.errorImage),errorText:(0,Y.Zq)("errorText",e.errorText),errorSubText:(0,Y.Zq)("errorSubText",e.errorSubText),buttonContainer:(0,Y.Zq)("buttonContainer",e.buttonContainer),primaryButton:(0,Y.Zq)("primaryErrorButton",e.primaryButton),secondaryButton:(0,Y.Zq)("secondaryErrorButton",e.secondaryButton),errorLinkSection:(0,Y.Zq)("errorLinkSection",e.errorLinkSection)}));var te=o(52861);function oe(e){switch(e.name){case te.w.TeamsLight:return!0;case te.w.TeamsDark:case te.w.TeamsContrast:default:return!1}}function ne(e){let{errorText:t,errorSubText:o,imageLight:n,imageDark:r,primaryButtonProps:s,secondaryButtonProps:i,errorLinkDetails:a}=e;const l=(0,Z.D)(),c=ee($(l)),[p,d]=z.useState(!1),u=a?z.createElement("div",{className:c.errorLinkSection},p?z.createElement("span",{className:"error-view-details-message"},a.message):z.createElement(K.N,{className:"error-view-details-link",onClick:()=>{d(!0)}},a.linkText)):void 0;return z.createElement("div",{className:c.root},z.createElement("div",{className:c.elementContainer},z.createElement("div",{className:c.errorImage},z.createElement("img",{src:oe(l)?n:r,alt:"",role:"presentation"})),z.createElement("div",{className:c.errorText,"aria-live":"assertive"},t),z.createElement("div",{className:c.errorSubText,"aria-live":"assertive"},o),u,z.createElement("div",{className:c.buttonContainer},!!s&&z.createElement(q.j,{className:c.primaryButton,onClick:s.onClick},s.label),!!i&&z.createElement(j.Y,{className:c.secondaryButton,onClick:i.onClick},i.label))))}function re(e){let{strings:t,isTeamsTabView:o,isMyPlansPlan:n,planStatus:r,removeFromMyPlansButtonCallback:s,navigateToMyPlansButtonCallback:i}=e;const{planNotFoundText:a,planNotFoundBody:l,planNotFoundBodyTab:c,planInaccessibleText:p,planInaccessibleBody:d,planGenericErrorText:u,planGenericErrorBody:h,navigateToMyPlansButtonText:g,removeFromMyPlansButtonText:m}=t;let C,k,b,T,S=!1;const P=!o;switch(r){case H.Z.NotFound:b=a,T=o?c:l,S=n&&!o,k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAMAAABlApw1AAADAFBMVEVHcEy+vLu+vbu9vLy9vLvBwb+9vLvNxbvIw77Hwr28vLu8vLy+vbu/vbu7u7q/vby8vLu/vr28vLy1tbW1tLW/vbypqqvz8vC+vbyeoKHe2tf+/f3GxcXCvbu+vLvLw7zCv7yjpKX49vXPx8Lu6+jr6ObCvbv39fPi3dvh3NrDvbv7+/rw7Or8+/vs6ebY1dLDv7zCvrzEwL3w7er9/f308e/EwLytq6vv7OrRxr3Cvrurqqrj3dvDv73m3dvg1c6qqqvOtqC3tbP/ekjy8O//d0n08vHs5+Xq5ePw7ez/ekvt6ujo4+Dn4d3v7Onx7+2933W63nHl3Nft6+srweP39fSXiGHq4t3s5eA2xeTk3trg19JByOTXzsnh2tfl2dPdzcXTycPi0cjc0sv/d0fPxL3k1s2SgmHYxrjcyb//f0mYiG/p3NPc1M/Tw7D/c0vs39jLv7e122zHubHCvr2XiGjH5YDC4Xnw6uOjlI65p5uRgnOVhn35mDq7q6K/sKf+hUXUw6ajmZ2um5Gfj4KVkpv/bEjJqqHMsqvfyLixdWXDtqxL0OrWvLOt2WSi1Vj/pG/z7eejfmy4f2/Ou6X/gVOWi42wo56Vd13V7pn6+vrx2NDLtZu7tbT5qD25oYO8kIN/fojN6IoAyumOyk2inqrDmY2GfHbTMBOyq6y8pY/8jD7/jVju5tq95Wz/jEzRx8zVz6zEn5gBn9CmbF6uiXqrln7CiHgdsuHOhWv/tYmEiGhvrTPby9fEsZCEfmn7Yz4AksWHipjri0D6m03wyr9/jQLNp5DkdCXuu6n6rVQAv+GCwzjJdWHd86zjopOrrrnNEgNVjBr/fR/rSTXm2+d/YWR4dHj4l1mbX0v1yVmlkmrcsKWJbE5XsQh9WyTM15ZwlrB6TE3cjX2Wydv7fD7yewV8hTrGtb8z0fBVKiZOjrK+Z1PSYkPB0NnwjBPxSgMhlBLESxcRGBJoyeSswHURy+m5usf8yXmRLykiZY5rts1bYziesZD/ZiRHcEx8GqIcAAABAHRSTlMAKxc2DgolAgQHE0sgG0QvYT17T6FWXtttKk0Q/qiI8ZE9MffDrZ4/c42xF+smm2O8x/bUIFvqeHvi3pHB0tyyoany//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A5wB15QAAIABJREFUeNrsmF1IW2kax4/RmMQYbSxSa611jTYdo9aPKlpqyy6hUXISIe42Nmmi2RBj0UhCEtBEEiZRppLeTBHjRSQjIsVAQXZoGChTwRsveuPN6EUpZUsv6izM1TCF9maf533PidoKO4xutrL55xirqfr8zv/5esMwOeWUU0455ZRTTjnllFNOX7AkohxATjnl9H8pEdGpDj6jU37rTxnD0eGeGoRM+E1ddY3fotqblacIgQu/oPnbQ6pT0hdPQ/y4vNSTqPWTnPCLRuVpIKDxX4F4IexBIiM+EYi6L5+Axl83SaM3Gt2GcYPB4HYbjZSh9gsnIPFLGiFUDYRvMAyN2O3Dw8P2kaFxN0Xo+KIJSPyiQXL7jSaD2T58f3QCNXp/eGTIbXzypROIxPDUSO6+zjBkHx6dmE88f55KpZ7PT9z/+8i4+wnAZT+LfvcUFSFAPalbHdz++xOJVDKZ2koktlLJVAIQgODJk0l06X+00fyO+Ctp/KYh+2gimU7FvF6P1zM/n0gmnwPB0DgQ1GXTAohazOs/QOD/ZBgoVZaF+F2jgacBj00BcsA1Mb+VTHEEk5VZtADDl6AOQRzBIaLxdxmNrBETaDgQ9SoUl1Cd8KFQcAQki7JnAUQFwQtBByDEn6cVNUrCMDojSAcA3pRH4cHw2xChGxCAIDExjJX8JGsWYPxCYQGIQ8gwfEZC4680gQMsANhDHsWlnpaLoJYesKC7GwiSyflR0ovaswRA4sfwub8m4hg+waCCVxjRDYMOACCF7N7uhuqK8nJpefmZipqG64BwSZFIbk3cHxmHMpBkCYDEXyT5/H0myWd2YKYxzBACDLJGg72lQirPJ5LLpWeqW7ovdSsmkqn5OWJBR1YsoAZA/LXn1Gr9ubrmK0rVERxc+JBrjBwBsI0abpWU5uXllaLyS/PlJWcuI0ECcohUQX12AEj8BUyl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",C="data:image/png;base64,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";break;case H.Z.Inaccessible:b=p,T=d,S=n&&!o,k=G,C=V;break;case H.Z.UnableToFetch:default:b=u,T=o||r===H.Z.UnableToFetch?"":h,k=_,C=W}let v,x;return S?(v={label:m,onClick:s},x={label:g,onClick:i}):P&&(v={label:g,onClick:i}),z.createElement(ne,{imageDark:C,imageLight:k,errorText:b,errorSubText:T,primaryButtonProps:v,secondaryButtonProps:x})}var se,ie,ae,le=o(38752),ce=o(77508),pe=o(16112),de=o(65818),ue=o(44430),he=o(76241),ge=o(54320),me=o.n(ge),Ce=o(30210);function ke(e,t){return e>-1&&0!==(e&t)}function be(e,t){return e>-1&&0!==(e&t)}!function(e){e[e.EnableNone=0]="EnableNone",e[e.EnableYammer=1]="EnableYammer",e[e.EnableConversations=2]="EnableConversations",e[e.EnableMembers=4]="EnableMembers",e[e.EnableFiles=8]="EnableFiles",e[e.EnableNotebook=16]="EnableNotebook",e[e.EnableSites=32]="EnableSites",e[e.EnableAll=63]="EnableAll"}(se||(se={})),function(e){e[e.EnableNone=0]="EnableNone",e[e.EnableFavorite=1]="EnableFavorite",e[e.EnableCopy=2]="EnableCopy",e[e.EnableExport=4]="EnableExport",e[e.EnableCopyLink=8]="EnableCopyLink",e[e.EnableSettings=16]="EnableSettings",e[e.EnableCalendar=32]="EnableCalendar",e[e.EnableLeave=64]="EnableLeave",e[e.EnableJoin=128]="EnableJoin",e[e.EnableAll=255]="EnableAll"}(ie||(ie={})),function(e){e.getLinksCapabilitiesForContainer=function(e){return null==e?0:e.containerType===de.K.Group?function(e){const t=e.unifiedGroupDetails;if(null==t)return 0;let o=56;t.isYammerGroup()?o|=1:le.B.isGuestUser||(o|=6);return o}(e):0},e.getLinksCapabilitiesForPlan=function(e,t,o,n){let r=de.K.Invalid;switch(null!=e?r=e.containerType:n&&(r=o),r){case de.K.Group:return function(e){var t,o,n,r,s;if((null===(t=e.unifiedGroupDetails)||void 0===t?void 0:t.currentUserRelationToGroup)===ue.N.NonMember)return e.unifiedGroup.visibility===he.X.Public?128:0;let i=30;e.unifiedGroupDetails&&!e.unifiedGroupDetails.isYammerGroup()&&(i|=1);const a=null!==(o=(null===(n=e.unifiedGroupDetails)||void 0===n?void 0:n.owners)&&e.unifiedGroupDetails.owners.length>1)&&void 0!==o&&o;(e.unifiedGroupDetails&&e.unifiedGroupDetails.currentUserRelationToGroup!==ue.N.Owner||a)&&(i|=64);(null===(r=e.unifiedGroupDetails)||void 0===r?void 0:r.currentUserRelationToGroup)!==ue.N.Owner&&(null===(s=e.unifiedGroupDetails)||void 0===s?void 0:s.currentUserRelationToGroup)!==ue.N.Member||(i|=32);return i}(e);case de.K.DriveItem:return 63;case de.K.User:return 29;case de.K.Roster:return function(e){let t=61;e>1&&(t|=64);return t}(t);default:return 0}},e.getContextLinkMenuItemForPlan=function(e,t,o,n,r){if(!me()(t.contextDetails)){const s=(0,Ce.g)(e.contexts,o),i=me()(s)?null:t.contextDetails[s];if(null!=i&&!me()(i.url))return{key:s,name:n,href:i.url,target:"_blank",onClick:r}}return null}}(ae||(ae={}));var Te,Se=o(22514);!function(e){e[e.DisableAll=0]="DisableAll",e[e.DisableNothing=1]="DisableNothing",e[e.DisablePlanChanges=2]="DisablePlanChanges"}(Te||(Te={}));class Pe extends pe.${componentDidMount(){this.logFloodgateActivity(),this.logSharedContainersTelemetryOnPlanLoad()}componentDidUpdate(e){var t,o;(null===(t=this.props.plan)||void 0===t?void 0:t.id)!==(null===(o=e.plan)||void 0===o?void 0:o.id)&&(this.isSharedContainersTelemetryLogged=!1,this.isMembersListOpenedLogged=!1,this.shouldLogMembersListOpened=!1),e.sharedContainersListProps!==this.props.sharedContainersListProps&&(this.logSharedContainersTelemetryOnPlanLoad(),this.logSharedContainersTelemetryOnMemberListOpen())}logFloodgateActivity(){const{disableMode:e,flights:t,hasAccessViaSharedContainer:o,plan:n,planContainer:r,planMembers:s}=this.props;le.B.clientType!==h.s.Plex||le.B.isUnoContext||Se.q.logFloodgateActivity(g.M.ProgressFilterActivity,this.context.traceLogger),le.B.clientType===h.s.Plex&&!le.B.isUnoContext&&null!==t&&void 0!==t&&t.EnableImageRecommendations&&1===e&&n&&be(ae.getLinksCapabilitiesForPlan(null!==r&&void 0!==r?r:null,s.length,n.container.containerType,null!==o&&void 0!==o&&o),ie.EnableSettings)&&Se.q.logFloodgateActivity(g.M.SmartBackgroundActivity,this.context.traceLogger)}constructor(){super(...arguments),this.isSharedContainersTelemetryLogged=!1,this.isMembersListOpenedLogged=!1,this.shouldLogMembersListOpened=!1,this.headerMoreOptionsButtonRef=z.createRef(),this.openPlanSettingsPanel=(e,t)=>{var o,n;null===(o=(n=this.props.callbacks).openPlanSettingsPanel)||void 0===o||o.call(n,e,t)},this.openLeavePlanDialog=e=>{var t,o;null===(t=(o=this.props.callbacks).openLeavePlanDialog)||void 0===t||t.call(o,e)},this.onOpenMembersCallout=()=>{this.shouldLogMembersListOpened=!0,this.logSharedContainersTelemetryOnMemberListOpen()},this.logSharedContainersTelemetryOnMemberListOpen=()=>{!this.isMembersListOpenedLogged&&this.shouldLogMembersListOpened&&this.isSharedContainersListPropsLoaded()&&(this.isMembersListOpenedLogged=!0,this.context.usageLogger.logData(this.name(),g.M.MembersListOpenedWithSharedContainers,this.getSharedContainerTelemetryExtraData()))},this.logSharedContainersTelemetryOnPlanLoad=()=>{!this.isSharedContainersTelemetryLogged&&this.isSharedContainersListPropsLoaded()&&(this.isSharedContainersTelemetryLogged=!0,this.context.usageLogger.logData(this.name(),g.M.PlanLoadedWithSharedContainers,this.getSharedContainerTelemetryExtraData()))},this.isSharedContainersListPropsLoaded=()=>{const{plan:e,sharedContainersListProps:t}=this.props;return null!=t&&null!=e&&e.sharedWithContainers.length===t.sharedContainerItems.length+t.inaccessibleSharedContainerCount},this.getSharedContainerTelemetryExtraData=()=>{const{plan:e,sharedContainersListProps:t}=this.props;if(null==t||null==e)return;const o={planId:e.id};return t.inaccessibleSharedContainerCount>0&&(o.hasInaccessibleSharedContainers="true"),o}}}var ve=o(53356),xe=o(20751),ye=o(33631),fe=o(77711),Ae=o(52342),we=o(40520),De=o(54845),Be=o(37535),Ee=o(75104),Ie=o(86053);class Fe extends pe.${name(){return"WorkloadProvisioningDialog"}renderComponent(){let e="";switch(this.props.workloadName){case Be.P[Be.P.Conversations]:e=Ie.p.Strings.WorkloadProvisioningDialog_MissingWorkloadConversationsError;break;case Be.P[Be.P.People]:e=Ie.p.Strings.WorkloadProvisioningDialog_MissingWorkloadPeopleError;break;case Be.P[Be.P.Documents]:e=Ie.p.Strings.WorkloadProvisioningDialog_MissingWorkloadFileStorageError;break;case Be.P[Be.P.Notebook]:e=Ie.p.Strings.WorkloadProvisioningDialog_MissingWorkloadNotebookError;break;case Be.P[Be.P.Yammer]:e=Ie.p.Strings.WorkloadProvisioningDialog_MissingWorkloadYammerError;break;default:return null}return z.createElement(Ae.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,type:we.h.normal,styles:(0,Ee.XK)(this.props.theme)},styles:(0,Ee.S9)(this.props.theme),modalProps:{className:this.props.dialogClassName,containerClassName:this.props.dialogContainerClassName,isBlocking:!1}},e,z.createElement(De.E,null,z.createElement(q.j,{onClick:this.props.onDismiss},Ie.p.Strings.WorkloadProvisioningDialog_MissingWorkloadErrorOkBtn)))}constructor(e,t){super(e,t),this.state={}}}var Le=o(50724),Me=o(50605),Ne=o(66151),Re=o(56415),Ue=o(8736),Oe=o(72943);const He="38px",Ve=(0,Q.J9)((e,t,o)=>{const n=[(0,Ne.gS)("column","nowrap"),(0,Ne.aS)(e),(0,Oe.zI)(),{padding:"".concat(Ue.B.TopHeaderPaddingTop," ").concat(Ue.B.TopHeaderHorizontalPadding," ").concat(Ue.B.TopHeaderPaddingBottom),transition:"background 0.3s ease-in-out",height:"100%",overflowX:"auto","&.responsive":{overflowY:"hidden"}},e===ce.Sx.SharePoint&&{backgroundColor:Re.z.SharepointBackgroundColor(),transition:"background 0s linear"}],r=[(0,Ne.gS)("row","nowrap"),{height:"100%"},e===ce.Sx.SharePoint&&{flexBasis:"".concat(He," !important")}],s=[Ne.xK,(0,Ne.Ml)(e),{fontSize:Y.s.small,borderColor:Re.z.NeutralLight,padding:"1px 6px",borderRadius:"5px",border:"1px solid",textDecoration:"none",cursor:"pointer"}],i=[Ne.$Z,(0,Ne.gS)("row","nowrap"),{alignItems:"center","> .delinkIcon":[(0,Ne.gS)("row","nowrap"),{"> .plannerDivider":[{color:Re.z.NeutralQuaternaryAlt}],"> .plannerLinkDismiss":[(0,Ne.bY)(e)]}]}],a=[Ne.xK,(0,Ne.$Z)(),(0,Ne.aS)(e),{height:"32px",width:"32px",padding:"4px",cursor:"pointer"}],l=[(0,Ne.$Z)(),(0,Ne.gS)(),Ne.cc,{marginRight:"2px",marginLeft:"12px",img:{height:"28px",width:"24px"}}],c=[(0,Ne.GD)(),(0,Ne.gS)("column","nowrap"),{"> div":(0,Ne.gS)("row","nowrap")},(0,Ne.aS)(e)],p={".teamsApp:not(.splitUI) &":{display:"none"},display:"inline-block",margin:"0px ".concat("40px"," 0px ").concat("12px"),minWidth:"164px",maxWidth:"250px"},d=[(0,Ne.gS)(),{alignItems:"center",button:[Ne.xK,{paddingRight:"5px !important",display:"inline-block",cursor:"pointer"}],"> .secondaryIconSection":{fontSize:Y.s.size16}}],u=[(0,Ne.gS)("row","nowrap"),{alignItems:"center","> .contextInfoSection":{"> *":(0,Ne.GD)(),".fallbackContextInfoText":[(0,Ne.q0)("ellipsis"),(0,Ne.Ml)(e),{fontSize:Y.s.small}]}}],h=[(0,Ne.$Z)("auto"),(0,Ne.gS)("row","nowrap"),{margin:"0px ".concat("6px"),height:He}],g={root:n,topHeaderLandmark:r,linkedBadgeDropdown:s,linkedBadgeItem:i,pivotsSection:[(0,Ne.$Z)(),(0,Ne.gS)("row","nowrap"),{"> div":(0,Ne.gS)()}],appMoreOptionsButton:a,appLogo:l,nonIcon:c,primarySection:p,primaryTextSectionContainer:d,contextInfoSectionContainer:u,secondarySection:h,rightAlignedSection:[(0,Ne.GD)("auto"),(0,Ne.gS)("row","nowrap"),{alignItems:"center",height:He,"> .joinUnifiedGroup":[(0,Ne.gS)("row","nowrap"),(0,Ne.GD)(),{justifyContent:"flex-end"}],"> div:first-child":{flexGrow:"1",flexShrink:"0",justifyContent:"flex-end"}}]};return(0,Y.pB)(void 0,g,t)}),Ge=(0,Q.J9)(e=>({root:(0,Y.Zq)("topHeader",e.root),topHeaderLandmark:(0,Y.Zq)("topHeaderLandmark",e.topHeaderLandmark),linkedBadgeDropdown:(0,Y.Zq)("linkedBadgeDropdown",e.linkedBadgeDropdown),linkedBadgeItem:(0,Y.Zq)("linkedBadgeItem",e.linkedBadgeItem),pivotsSection:(0,Y.Zq)("pivotsSection",e.pivotsSection),appMoreOptionsButton:(0,Y.Zq)("appMoreOptionsButton",e.appMoreOptionsButton),appLogo:(0,Y.Zq)("appLogo",e.appLogo),primaryTextSectionContainer:(0,Y.Zq)("primaryTextSectionContainer",e.primaryTextSectionContainer),contextInfoSectionContainer:(0,Y.Zq)("contextInfoSectionContainer",e.contextInfoSectionContainer),nonIcon:(0,Y.Zq)("nonIcon",e.nonIcon),primarySection:(0,Y.Zq)("primarySection",e.primarySection),secondarySection:(0,Y.Zq)("secondarySection",e.secondarySection),rightAlignedSection:(0,Y.Zq)("rightAlignedSection",e.rightAlignedSection)})),We=(0,Q.J9)(e=>({root:{margin:"0px"},listItem:[(0,Ne.Ml)(e),{"&:first-child > .ms-Breadcrumb-item":{paddingLeft:"0px"},"&:last-child > .ms-Breadcrumb-item":[(0,Ne.Ml)(e),{fontWeight:"400",color:"inherit"}]}],item:[(0,Ne.Ml)(e),{fontSize:Y.s.small,lineHeight:"inherit",padding:"0 5px"}],overflowButton:[(0,Ne.Ml)(e),{"&:hover, &:active, &:hover:active, &.is-expanded":[(0,Ne.Mi)(e),(0,Ne.Ml)(e)],":focus-visible":[{outlineColor:"initial",outlineStyle:"auto"}],height:"14px"}]})),_e=(0,Q.J9)(e=>({root:{width:"24px",height:"24px"}}));var ze=o(75472);const Ze="10px",Ke="2px",qe=(0,Q.J9)((e,t)=>{let o=[];o=t?[{marginLeft:"0px","> .icon":{fontSize:Y.s.small,marginRight:Ue.B.TeamsPivotIconRightMargin,paddingBottom:Ke},"*:last-child:not(:only-child)":{marginRight:Ue.B.TeamsPivotLabelRightMargin,marginLeft:"0px"},"&.isSelected,&:hover,&:active":[(0,Ne._D)(e),{"> span":(0,Ne._D)(e),fontWeight:Y.BO.regular}]},e===ce.Sx.TeamsContrast&&{"&.isSelected":{color:Re.z.TeamsContrastSelectedColor,"> span":{color:Re.z.TeamsContrastSelectedColor}},"&:hover,&:active":{color:Re.z.TeamsContrastHyperlinkColor,"> span":{color:Re.z.TeamsContrastHyperlinkColor}}}]:[{":not(.isSelected):not(:hover) > *":{paddingBottom:Ke},"&:hover > *,&.isSelected > *":[(0,Ne.T4)(e),{borderBottomStyle:"solid",borderBottomWidth:Ke}]},e===ce.Sx.TeamsContrast&&{" &.isSelected > *":{borderBottomColor:Re.z.TeamsContrastSelectedColor},"&:hover > *":{color:Re.z.TeamsContrastHyperlinkColor,borderBottomColor:Re.z.TeamsContrastHyperlinkColor}}];const n=[e===ce.Sx.SharePoint&&{margin:"0px ".concat(Ze),"> *:not(.icon)":{color:Re.z.SharepointTitleFontColor()}},{"> .icon":{display:"none"},"> .pivotLinkWithIcon":[(0,Ne.gS)("row","nowrap"),{alignItems:"center","> i svg":{transform:"scale(0.7)",marginLeft:(0,Me.jI)()?"0px":"-4px",marginRight:(0,Me.jI)()?"-4px":"0px"}}]}];return{removable:[(0,Ne.$Z)(),e===ce.Sx.SharePoint&&{margin:"0px -".concat(Ze)},{"> .pivotLink":n}],pivotLink:[o,(0,Ne.gS)(),Ne.cc,(0,Ne.aS)(e),{fontSize:Y.s.medium,cursor:"pointer","> span":(0,Ne.aS)(e),lineHeight:(0,ze.jz)(He)-3,margin:"0px ".concat((0,ze.vb)((0,ze.jz)("24px")/2-(0,ze.jz)("8px"))),"> *":[(0,Ne.$Z)(),{margin:"0px ".concat("8px"),":first-child:not(:only-child)":{marginLeft:"0px"},":last-child:not(:only-child)":{marginRight:"8px"},":only-child":{margin:"0px",paddingBottom:Ke}},e===ce.Sx.SharePoint&&{margin:"0px"}],"&.isSelected":e===ce.Sx.SharePoint&&{color:Re.z.SharepointTitleFontColor()}}],icon:{marginTop:"3px",fontSize:"18px",height:"24px","> button":[Ne.xK,(0,Ne.aS)(e),{".plannerIcon":{cursor:"pointer"}}]}}}),je=(0,Q.J9)(e=>({removable:(0,Y.Zq)("removable",e.removable),pivotLink:(0,Y.Zq)("pivotLink",e.pivotLink),icon:(0,Y.Zq)("icon",e.icon)}));var Qe=o(4648),Ye=o(49560);class Je extends pe.${name(){return"HeaderPivotLinks"}renderComponent(){const{pivotLinks:e,selectedPivotLinkIndex:t,renderTeamsPivotSection:o}=this.props,n=this.getClassNames();return o?this.renderTeamsPivotLinks(n):z.createElement("div",{className:n.removable,role:"tablist"},e.map((e,o)=>{const r=t===o,s=(0,Qe.A)(n.pivotLink,{isSelected:r});return z.createElement("a",{key:e.id,className:s,title:e.name,tabIndex:0,onClick:this.onLinkClick.bind(this,o),onKeyUp:this.handleOnKeyPress.bind(this,o),"aria-label":e.name,role:"tab","aria-selected":r},z.createElement("span",{className:n.icon},z.createElement(xe.I,e.iconProps)),z.createElement("span",{className:e.alwaysShowIcon?"pivotLinkWithIcon":void 0},e.alwaysShowIcon&&z.createElement(xe.I,e.iconProps),e.name))}))}renderTeamsPivotLinks(e){const t={};return this.props.pivotLinks.forEach((e,o)=>{t[e.id]=o}),z.createElement("div",{className:"altViewPivots"},this.props.pivotLinks.map((o,n)=>{const r=(0,Qe.A)(e.pivotLink,{isSelected:this.props.selectedPivotLinkIndex===t[o.id]});return z.createElement("a",{key:o.id,className:r,title:o.name,tabIndex:0,onClick:this.onLinkClick.bind(this,t[o.id]),onKeyUp:this.handleOnKeyPress.bind(this,t[o.id])},z.createElement("span",{className:e.icon},z.createElement(xe.I,o.iconProps)),z.createElement("span",null,o.name))}))}getClassNames(){var e;return je(qe(this.props.theme,null!==(e=this.props.renderTeamsPivotSection)&&void 0!==e&&e))}onLinkClick(e){const{onSelectPivotLink:t,pivotLinks:o}=this.props;t&&o&&t(this.props.pivotLinks[e])}handleOnKeyPress(e,t){const{onSelectPivotLink:o,pivotLinks:n}=this.props,r=Ye.a.getKey(t);r!==Le.D.ENTER&&r!==Le.D.SPACE||!o||!n||o(this.props.pivotLinks[e])}constructor(e,t){super(e,t)}}var Xe=o(6017),$e=o(98571);const et=(0,Q.J9)(e=>({root:[e===ce.Sx.SharePoint&&{display:"none"},(0,Ne.$Z)(),(e===ce.Sx.LoopLight||e===ce.Sx.LoopDark)&&{borderLeft:"solid thin",padding:"0 8px 0 12px"},e===ce.Sx.LoopLight&&{borderLeftColor:Re.z.NeutralLightGrey88},e===ce.Sx.LoopDark&&{borderLeftColor:Re.z.NeutralDarkGrey32}],moreContextMenuButton:[(0,Ne.gS)(),Ne.cc,(0,Ne.aS)(e),{fontSize:Y.s.medium,cursor:"pointer","> span":[(0,Ne.aS)(e)],"&:hover > *":{borderBottom:"none !important"}}]})),tt=(0,Q.J9)(e=>({root:(0,Y.Zq)("more",e.root),moreContextMenuButton:(0,Y.Zq)("moreContextMenuButton",e.moreContextMenuButton)}));var ot=o(59846);class nt extends pe.${name(){return"HeaderMoreOptions"}renderComponent(){const{moreOptionsContextMenuItems:e,moreOptionsTooltip:t}=this.props,o=this.getClassNames(),n=this.getPivotLinkClassNames(),r=z.createElement("button",{onClick:this.toggleLinksContextMenu.bind(this),"aria-haspopup":"true",title:t,"aria-label":Ie.p.Strings.PlannerHeader_MoreAriaLabel,ref:this.props.headerMoreOptionsButtonRef,id:"headerMoreOptionButton"},z.createElement(xe.I,ot.XP)),s=z.createElement($e.l,{shouldFocusOnMount:!0,items:e||[],directionalHint:Xe.A.bottomAutoEdge,target:this.refs.secondaryLinksCommandButton,onDismiss:this.dismissLinksContextMenu.bind(this),appTheme:this.props.theme});return z.createElement("div",{className:o.root,ref:"secondaryLinksCommandButton"},z.createElement("div",{className:(0,Qe.A)(n.pivotLink,o.moreContextMenuButton),"aria-haspopup":!0},z.createElement("span",{className:n.icon},e&&e.length>0?r:null)),this.state.isLinksContextMenuVisible?s:null)}getClassNames(){return tt(et(this.props.theme))}getPivotLinkClassNames(){return je(qe(this.props.theme))}toggleLinksContextMenu(){const{onOpenLinksContextMenu:e}=this.props;!this.state.isLinksContextMenuVisible&&e&&e(),this.setState(e=>({isLinksContextMenuVisible:!e.isLinksContextMenuVisible}))}dismissLinksContextMenu(){this.setState(e=>({isLinksContextMenuVisible:!1}))}constructor(e,t){super(e,t),this.state={isLinksContextMenuVisible:!1}}}function rt(e){switch(e){case p.Yc.Plan:return Ie.p.Strings.PlanHeader_GroupByDropDownPlanOption;case p.Yc.Assignee:return Ie.p.Strings.PlanHeader_GroupByDropDownAssignedToOption;case p.Yc.Bucket:return Ie.p.Strings.PlanHeader_GroupByDropDownBucketOption;case p.Yc.Progress:return Ie.p.Strings.PlanHeader_GroupByDropDownProgressOption;case p.Yc.DueDate:return Ie.p.Strings.Task_DueDateFieldText;case p.Yc.Category:return Ie.p.Strings.PlanHeader_GroupByDropDownCategoryOption;case p.Yc.Priority:return Ie.p.Strings.PlanHeader_GroupByDropDownPriorityOption;default:throw new Error("Unexpected taskGroupingType: ".concat(e))}}class st extends pe.${name(){return"GroupByMenu"}renderComponent(){return z.createElement($e.l,{id:"groupByMenu",shouldFocusOnMount:!0,items:this.getMenuItems(),directionalHint:Xe.A.bottomRightEdge,target:this.props.targetElement,onDismiss:this.props.onDismissGroupByMenu,appTheme:this.props.theme})}getMenuItems(){const{onGroupByChange:e,currentTaskGrouping:t,taskGroupingOptions:o}=this.props,n=[];for(const r of o)isNaN(Number(r))||n.push({key:p.Yc[r],name:rt(r),canCheck:!0,checked:t===r,onClick:e.bind(this,r)});return n}constructor(e,t){super(e,t),this.state={}}}var it=o(31537),at=o(25588);const lt="28px",ct="8px",pt="56px",dt="36px",ut=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.GD)(),{fontSize:Y.s.medium,lineHeight:"20px",alignItems:"center",whiteSpace:"nowrap",maxWidth:"100%"}],itemText:[(0,Ne.GD)(),{margin:"15px 0px",display:"inline-block",verticalAlign:"middle",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"normal"}],headerLink:[(0,Ne.zt)(e),{textDecoration:"none"}],contextRow:[(0,Ne.gS)("row"),(0,Ne.GD)(),(0,Ne.aS)(e),{whiteSpace:"nowrap",alignItems:"center",maxWidth:"100%"}],contextIcon:[(0,Ne.$Z)(),{height:lt,width:lt,marginLeft:(0,ze.vb)((0,ze.jz)(Ue.B.HeaderDropdownItemSpacing)/2),marginRight:Ue.B.HeaderDropdownItemSpacing,"> .ms-Image > .ms-Image-image":[{maxWidth:lt,maxHeight:lt}]}],contextDetailsColumn:[(0,Ne.GD)("auto"),(0,Ne.gS)("column"),{padding:"10px 0px 11px 0px"}],customContextDetailsColumn:[(0,Ne.GD)("auto"),(0,Ne.gS)("column"),{padding:"8px"}],contextDetailsText:[(0,Ne.aS)(e),{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",height:"19px",lineHeight:"16px"}],contextDetailsSecondaryText:[(0,Ne.gS)("row","nowrap"),(0,Ne.Ml)(e),{fontSize:Y.s.small,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",height:"16px",lineHeight:"14px",alignItems:"center","> .plannerLinkDismiss":[(0,Ne.bY)(e),{marginRight:"5px"}]}]};return(0,Y.TW)(o,t)}),ht=(0,Q.J9)(e=>({root:(0,Y.Zq)("ms-ContextualMenu-linkContent",e.root),itemText:(0,Y.Zq)("ms-ContextualMenu-itemText",e.itemText),headerLink:(0,Y.Zq)("headerLink",e.headerLink),contextRow:(0,Y.Zq)("ms-ContextualMenu-linkContent contextRow",e.contextRow),contextIcon:(0,Y.Zq)("contextIcon",e.contextIcon),contextDetailsColumn:(0,Y.Zq)("contextDetailsColumn",e.contextDetailsColumn),customContextDetailsColumn:(0,Y.Zq)("customContextDetailsColumn",e.customContextDetailsColumn),contextDetailsText:(0,Y.Zq)("contextDetailsText",e.contextDetailsText),contextDetailsSecondaryText:(0,Y.Zq)("ms-ContextualMenu-itemSecondaryText contextDetailsSecondaryText",e.contextDetailsSecondaryText)})),gt=(0,Q.J9)(e=>({header:[(0,Ne.aS)(e),{height:"70px",padding:"0px ".concat(Ue.B.HeaderDropdownItemSpacing)}],subComponentStyles:{menuItem:mt(e)}})),mt=(0,Q.J9)(e=>({item:{"&.button, &.link > div":[(0,Ne.$Z)(),{height:pt,alignItems:"center"}],"&.customButton":[(0,Ne.$Z)(),{height:dt,alignItems:"center","> .ms-ContextualMenu-link":{height:dt}}]},root:{height:pt,"&:hover":(0,Ne.Mi)(e)}})),Ct=(0,Q.J9)(e=>{const t=[Ne.xK,(0,Ne.$Z)(),(0,Ne.gS)("row","nowrap"),{alignItems:"center","> *":{marginLeft:ct},"> span:not(:last-child)":{marginRight:"0px"},"> .contextIcon > .ms-Image":[(0,Ne.$Z)(),{height:lt,width:lt,".ms-Image-image":{height:"100%",width:"100%"}}],"> .ms-Label":[(0,Ne.$Z)(),(0,Ne.aS)(e),{fontSize:"13px",fontWeight:Y.BO.regular,cursor:"pointer"}],"&.link, &.button":{"> .ms-Label":{marginRight:ct,marginLeft:ct}},"&.button, &.dropdownMenu":{":hover":(0,Ne.Mi)(e)},"&.link > .ms-Label":{":hover":{textDecoration:"underline"}}}];return(0,Y.Zq)("contextSplitButton",t)}),kt="10px",bt=(0,Q.J9)(e=>{const t=[(0,Ne.$Z)(),(0,Ne.gS)("row","nowrap"),{margin:"0px ".concat((0,ze.vb)(((0,ze.jz)(Ue.B.TopHeaderIconHorizontalOffset)-(0,ze.jz)(Ue.B.HeaderDropdownItemSpacing))/2+(0,ze.jz)("8px")))}],o=[(0,Ne.$Z)(),(0,Ne.aS)(e),{padding:"0px",fontSize:"13px",fontWeight:Y.BO.regular,marginLeft:"8px",cursor:"pointer","> span:first-child":{marginRight:"4px"},"> .value":[(0,Ne.aS)(e),e===ce.Sx.SharePoint&&{color:Re.z.SharepointButtonHoverColor()}]}];return{root:t,dropdownMenu:[Ne.xK,(0,Ne.$Z)(),(0,Ne.gS)("row","nowrap"),{alignItems:"center",cursor:"pointer",margin:"0px ".concat((0,ze.vb)(((0,ze.jz)(Ue.B.HeaderDropdownItemSpacing)-(0,ze.jz)(kt))/2)),height:"38px","&:hover":[(0,Ne.Mi)(e),e===ce.Sx.TeamsLight&&{backgroundColor:Re.z.NeutralLight},{borderRadius:"2px"}],"> *":{margin:"0px ".concat((0,ze.vb)((0,ze.jz)(kt)/2))},"> .ms-Label":o,"> .plannerDiamond":{marginRight:"-8px",marginTop:"3px",svg:{transform:"scale(0.7)"}}},e===ce.Sx.TeamsContrast&&{backgroundColor:Re.z.Black,color:Re.z.White,"&:hover":{"> .ms-Label, > .ms-Label > .value":{color:Re.z.Black}}}],dropdownIcon:[(0,Ne.$Z)(),(0,Ne.gS)("row","nowrap"),Ne.cc,(0,Ne.aS)(e),{marginRight:"8px","> .dropdownChevronIcon":{display:"inline"},"> .dropdownHiddenTextIcon":{display:"none"}}]}}),Tt=(0,Q.J9)(e=>({root:(0,Y.Zq)("dropdowns",e.root),dropdownMenu:(0,Y.Zq)("dropdownMenu",e.dropdownMenu),dropdownIcon:(0,Y.Zq)("dropDownIcon",e.dropdownIcon)}));var St=o(55491),Pt=o.n(St),vt=o(21382),xt=o(6505),yt=o(99535),ft=o(81877);class At extends pe.${name(){return"ContextDropdown"}renderComponent(){return this.renderSplitButton()}getHeaderDropdownClassNames(){return Tt(bt(this.props.theme))}renderSplitButton(){var e;const{onRenderLabel:t,className:o,theme:n,title:r}=this.props,s=this.generateSplitButtonProps();if(null==s)return null;if(t)return z.createElement("button",{className:o,ref:"contextCommandButton",onClick:this.toggleContextCallout,"aria-label":vt.G(Ie.p.Strings.PlannerHeader_TitleContextDropdownAriaLabel,r),"aria-expanded":this.state.isContextCalloutVisible,"aria-haspopup":!0},t(s),this.state.isContextCalloutVisible&&this.renderContextCallout(s.dropdownItems));let i=(0,Qe.A)(Ct(n),o);if(s.dropdownItems.length-1===1){const e=s.dropdownItems[1];return i=(0,Qe.A)(i,e.className),z.createElement("button",{className:i,ref:"link",onClick:t=>this.openLink(e,t),"aria-label":e.ariaLabel},z.createElement(xe.I,(0,c.A)((0,c.A)({},e.iconProps),{},{className:"contextIcon"})),z.createElement(it.J,{className:"context-text"},e.fallbackText))}const a=this.getHeaderDropdownClassNames();i=(0,Qe.A)(i,a.dropdownMenu);const l=this.state.isContextCalloutVisible?Ie.p.Strings.PlannerHeader_RightSectionExpandedAriaLabel:Ie.p.Strings.PlannerHeader_RightSectionCollapsedAriaLabel;return z.createElement("button",{className:i,ref:"contextCommandButton",onClick:this.toggleContextCallout,"aria-label":vt.G(Ie.p.Strings.PlanContextLinking_OpenLinkText,l)},z.createElement(xe.I,(0,c.A)((0,c.A)({},s.currentValueIconProps),{},{className:(0,Qe.A)(null===(e=s.currentValueIconProps)||void 0===e?void 0:e.className,"contextIcon")})),z.createElement(it.J,null,s.currentValue),z.createElement("span",{className:a.dropdownIcon},z.createElement(xe.I,ot.Ju),this.state.isContextCalloutVisible&&this.renderContextCallout(s.dropdownItems)))}renderContextCallout(e){const{theme:t,calloutProps:o,isBeakVisible:n,onRenderCallout:r}=this.props;return r?r(e):z.createElement($e.l,{calloutProps:(0,c.A)((0,c.A)({},o),{},{calloutMaxWidth:257}),className:"contextContextualMenu",shouldFocusOnMount:!0,contextualMenuItemAs:this.contextualMenuItemAs,items:e,directionalHint:Xe.A.bottomRightEdge,target:this.refs.contextCommandButton,onDismiss:this.dismissContextCallout,isBeakVisible:n,appTheme:t,styles:gt(t)})}generateSplitButtonProps(){const{visibleContextKeys:e,contextMenuItemCallbacks:t}=this.props;if(e.length<1&&!t)return null;const o=[];let n,r=Ie.p.Strings.PlanContextLinking_OpenLinkText;if(e.length>0){o.push({key:"header",itemType:ye.G.Header,text:Ie.p.Strings.PlanContextLinking_MultipleLinkedContextsText,ariaLabel:Ie.p.Strings.PlanContextLinking_MultipleLinkedContextsAriaLabel,href:ce.$j.linkedPlans,secondaryText:Ie.p.Strings.SharedComponents_LearnMoreLink,target:"_blank",canCheck:!1}),e.length>1&&o.push({key:"divider_1",itemType:ye.G.Divider});let s=!0;Pt()(e,t=>{const i=this.getContextMenuItemForContextKey(t);null!=i&&(o.push(i),s&&(1===e.length&&(r=i.text),n=i.iconProps,s=!1))}),t&&o.push({key:"divider_2",itemType:ye.G.Divider})}t&&(o.push({key:"planDetails",itemType:ye.G.Normal,className:"customButton",text:Ie.p.Strings.PlanHeader_PlanHeaderPlanSettings,ariaLabel:Ie.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>t.openPlanSettingsPanel(this.refs.contextCommandButton),canCheck:!1}),o.push({key:"copyLinkToPlan",itemType:ye.G.Normal,className:"customButton",text:Ie.p.Strings.PlanHeader_CopyLinkToPlanText,ariaLabel:Ie.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:t.copyLinkToPlan,canCheck:!1}),t.copyPlan&&o.push({key:"copyPlan",itemType:ye.G.Normal,className:"customButton",text:Ie.p.Strings.PlanHeader_CopyPlanText,ariaLabel:Ie.p.Strings.PlanHeader_CopyPlanText,onClick:t.copyPlan,canCheck:!1}),t.iCalendar&&o.push({key:"iCalendar",itemType:ye.G.Normal,className:"customButton",text:Ie.p.Strings.PlanHeader_PublishPlanTasksToCalendar,ariaLabel:Ie.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:t.iCalendar,canCheck:!1}),t.exportPlanToExcel&&o.push({key:"exportPlanToExcel",itemType:ye.G.Normal,className:"customButton",text:Ie.p.Strings.PlanHeader_PlanHeaderExportPlanToExcel,ariaLabel:Ie.p.Strings.PlanHeader_PlanHeaderExportPlanToExcel,onClick:t.exportPlanToExcel,canCheck:!1}));return{currentValueIconProps:n,currentValue:r,dropdownItems:o}}getContextMenuItemForContextKey(e){var t,o;const{contextDetails:n,contexts:r,title:s,planContainer:i}=this.props;if(null==r[e]||null==n||null==n[e])return null;let a=s,l="",c="",p="button";const d=r[e],u=null!==(t=null===i||void 0===i?void 0:i.displayName)&&void 0!==t?t:"",h=(0,ft.C)(d,u),g=n[e];switch(g.displayAs){case at.s.MeetingNotes:a=l=Ie.p.Strings.PlanContextLinking_MeetingNotes,c=vt.G(Ie.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,Ie.p.Strings.PlanContextLinking_MeetingNotes,Ie.p.Strings.PlanContextLinking_MicrosoftLoop),p="link";break;case at.s.LoopPage:c=vt.G(Ie.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,h,Ie.p.Strings.PlanContextLinking_MicrosoftLoop),l=Ie.p.Strings.PlanContextLinking_MicrosoftLoop;break;case at.s.SharePointPage:c=vt.G(Ie.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,h,Ie.p.Strings.PlanContextLinking_SharePoint),l=Ie.p.Strings.PlanContextLinking_OpenInSharePoint;break;case at.s.TeamsTab:c=vt.G(Ie.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,h,Ie.p.Strings.PlanContextLinking_Teams),l=Ie.p.Strings.PlanContextLinking_OpenInMicrosoftTeams;break;case at.s.Other:a=l=null!==(o=g.customLinkText)&&void 0!==o?o:h,c=vt.G(Ie.p.Strings.PlanContextLinking_ExternalContextLinkAriaLabel,a,Ie.p.Strings.PlanContextLinking_Other);break;default:return null}const m=g.status===yt.$.Delinked?Ie.p.Strings.PlanContextLinking_DelinkedContextSecondaryText:(0,ft.C)(d,u);return null!=(null===g||void 0===g?void 0:g.url)&&null!=g.displayAs?{key:e,className:p,itemType:ye.G.Normal,text:a,fallbackText:l,ariaLabel:c,href:null===g||void 0===g?void 0:g.url,onClick:this.logContextClick,data:{displayAs:g.displayAs,status:g.status},secondaryText:m,target:"_blank",iconProps:{imageProps:{src:(0,xt.qz)(g.displayAs,this.context.traceLogger)}}}:null}openLink(e,t){this.logContextClick(t,e),window.open(e.href,e.target)}constructor(e,t){super(e,t),this.contextualMenuItemAs=e=>{const t=ht(ut(this.props.theme));return e.item.itemType===ye.G.Header?z.createElement("div",{className:t.root,"aria-label":e.item.ariaLabel},z.createElement("span",{className:t.itemText},e.item.text," ",z.createElement(K.N,{className:t.headerLink,href:e.item.href,target:e.item.target},e.item.secondaryText))):e.item.itemType===ye.G.Normal?e.item.data?z.createElement("div",{className:t.contextRow,"aria-label":e.item.ariaLabel},z.createElement(xe.I,(0,c.A)((0,c.A)({},e.item.iconProps),{},{className:t.contextIcon})),z.createElement("div",{className:t.contextDetailsColumn},z.createElement("span",{className:t.contextDetailsText},e.item.text),z.createElement("span",{className:t.contextDetailsSecondaryText},e.item.data.status===yt.$.Delinked&&z.createElement(xe.I,ot.aA),e.item.secondaryText))):z.createElement("div",{className:t.contextRow,"aria-label":e.item.ariaLabel},z.createElement("div",{className:t.customContextDetailsColumn},z.createElement("span",{className:t.contextDetailsText},e.item.text))):null},this.toggleContextCallout=()=>{this.setState(e=>({isContextCalloutVisible:!e.isContextCalloutVisible}))},this.dismissContextCallout=()=>{this.setState({isContextCalloutVisible:!1})},this.logContextClick=(e,t)=>{var o;const n={};null!=(null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.displayAs)&&(n.displayAs=t.data.displayAs),this.logUsage("PlanContextClicked",n)},this.state={isContextCalloutVisible:!1}}}var wt=o(58189),Dt=o(94028),Bt=o(39410);const Et=(0,Q.J9)((e,t)=>{const o=(0,Ne.GD)(),n=[(0,Ne.$Z)(),{"> .plannerIcon":[(0,Ne.$Z)(),(0,Ne.aS)(e),{cursor:"pointer",fontSize:"16px",transition:"transform 0.2s ease-in-out",transform:"rotate(180deg)"},t&&{transform:"rotate(0deg)"}]}],r=[Ne.xK,(0,Ne.aS)(e),(0,Ne.D1)(e),(0,Ne.gS)(),{alignItems:"center",cursor:"pointer",height:"35px","> *":{fontSize:Y.s.medium,fontWeight:Y.BO.semibold}},e===ce.Sx.TeamsContrast&&{backgroundColor:Re.z.Black,color:Re.z.White,borderColor:Re.z.White,borderWidth:"1px 0px",borderStyle:"solid",boxSizing:"border-box",":focus, :hover":{borderColor:Re.z.TeamsContrastHyperlinkColor,"> .sectionToggle > .plannerIcon":{color:Re.z.TeamsContrastHyperlinkColor}}}];return{root:[(0,Ne.gS)("column"),{flexShrink:0,paddingTop:"2px","> .sectionRowsContainer":(0,Ne.gS)("column")}],header:r,title:o,sectionToggle:n}}),It=(0,Q.J9)((e,t)=>{const o=Et(e,t);return{root:(0,Y.Zq)("filterSection",o.root),header:(0,Y.Zq)("header",o.header),title:(0,Y.Zq)("title",o.title),sectionToggle:(0,Y.Zq)("sectionToggle",o.sectionToggle)}});class Ft extends pe.${renderComponent(){const e=vt.G(Ie.p.Strings.BaseTaskFilterSection_ToggleFilterSectionAriaLabel,this.getFilterTitleAriaLabel(),this.getAppliedFilterCount()),t=this.getClassNames();return z.createElement("div",{className:t.root},z.createElement("button",{className:t.header,"aria-label":e,"aria-expanded":!this.props.isCollapsed,onClick:this.props.toggleSection.bind(this),tabIndex:0},z.createElement("div",{className:t.title},vt.G(this.props.sectionTitle,this.getAppliedFilterCount())),z.createElement("div",{className:t.sectionToggle},z.createElement(xe.I,ot.Ju))),this.props.isCollapsed?null:this.renderSectionFilterRows())}getAppliedFilterCount(){return this.props.currentTaskFilter.getFieldFilterCount(this.getFilterField()).toString()}getClassNames(){const{theme:e,isCollapsed:t}=this.props;return It(e,t)}constructor(e,t){super(e,t)}}var Lt=o(9011),Mt=o(72721),Nt=o(40787),Rt=o(40729);const Ut="35px",Ot="44px",Ht="40px",Vt="28px",Gt=(0,Q.J9)((e,t)=>{const o=Rt.d.isLoopTheme(e),n={root:[Ne.xK,(0,Ne.gS)(),{height:Ut,cursor:"pointer",padding:"0px ".concat("16px"),"> *":{lineHeight:Ut},":focus, :hover":[(0,Ne.Mi)(e),e===ce.Sx.TeamsContrast&&{color:Re.z.Black},(0,Oe.cP)()],"&.iconFilterRow":_t(e),"&.categoryFilterRow":{alignItems:"center"},"&.assignmentFilterRow":Zt(e)},o&&{width:"100%",height:Ue.B.LoopMenuItemHeight,borderRadius:Ue.B.LoopSubItemBorderRadius,padding:Ue.B.LoopMenuItemPadding,alignItems:"center",".textValue":[(0,Ne.aS)(e),{fontWeight:Y.BO.regular}],".plannerCheckMark":(0,Ne.sC)(e)}],textValue:[(0,Ne.GD)(),(0,Ne.q0)("ellipsis"),{fontSize:Y.s.medium,display:"block"}],indicator:[(0,Ne.gS)(),(0,Ne.$Z)(),{width:Ut,height:Ut,justifyContent:"flex-end","> .ms-Icon":[(0,Ne._D)(e),{fontSize:"16px"}]}]};return(0,Y.TW)(n,t)}),Wt=(0,Q.J9)(e=>({root:(0,Y.Zq)("filterRow",e.root),textValue:(0,Y.Zq)("textValue",e.textValue),indicator:(0,Y.Zq)("indicator",e.indicator)})),_t=(0,Q.J9)(e=>{const t=Rt.d.isLoopTheme(e);return{alignItems:"center","> .icon":{height:Ut,marginRight:t?Ue.B.LoopMenuItemIconMarginRight:"16px","> .plannerIcon":{height:Ut},":not(i[class^='plannerProgress']):not(i[class^='plannerPriority'])":(0,Ne.aS)(e)}}}),zt=(0,Q.J9)(()=>({root:[(0,Ne.$Z)(),{fontSize:Y.s.medium,maxWidth:"205px",height:"20px"}]})),Zt=(0,Q.J9)(e=>{const t=Rt.d.isLoopTheme(e);return[{":hover, :focus":{"> .photo > .plannerIcon":(0,Oe.hS)()},height:t?Ht:Ot,"> .photo":[(0,Ne.$Z)(),{alignSelf:"center",width:t?Ht:Ot,"> .plannerIcon":[(0,Ne.gS)(),(0,Ne.zK)(e),(0,Ne.aS)(e),{alignItems:"center",borderRadius:"50%",height:Vt,width:Vt,justifyContent:"center"}]}]},!t&&{"> *":{lineHeight:"".concat(Ot," !important")},"> .indicator":{width:"".concat(Ot," !important"),height:"".concat(Ot," !important")},":last-child":{marginBottom:"18px"}},t&&{":hover":{"> .photo > .plannerIcon":(0,Ne.NX)(e)}}]});class Kt extends pe.${name(){return"BaseFilterRow"}getStylesClassNames(){return Wt(Gt(this.props.theme,this.props.styles))}renderComponent(){const e=this.getStylesClassNames(),t=(0,Qe.A)(e.root,this.getClassName());return z.createElement("button",{className:t,onClick:this.props.onToggleFilter.bind(this),tabIndex:0,role:"checkbox","aria-checked":this.props.isSet},this.renderFilterRowIcon(),z.createElement("div",{className:e.textValue},this.props.text),z.createElement("div",{className:e.indicator},this.props.isSet?z.createElement(xe.I,ot.r8):null))}constructor(e,t){super(e,t)}}class qt extends Kt{name(){return"AssignmentFilterRow"}renderFilterRowIcon(){const e=this.props.member.id!==p.lf.UnassignedUserId!=null?this.getMemberPersonaProps(this.props.member):null;return z.createElement("div",{className:"photo"},this.props.member.id!==p.lf.UnassignedUserId?z.createElement(Nt.f,{user:this.props.member,onLoad:this.props.onRenderPersona,containerId:"userContainer-filter-".concat(this.props.member.id)},z.createElement(Lt.F,e)):z.createElement(xe.I,ot.T$))}getClassName(){return"assignmentFilterRow"}getMemberPersonaProps(e){return{id:e.id,text:e.formattedDisplayName,secondaryText:e.mail,imageUrl:this.props.memberPhoto,size:Mt.WH.extraSmall}}constructor(e,t){super(e,t)}}var jt=o(50204),Qt=o(141);class Yt extends Ft{name(){return g.M.AssignmentFilterSection}getFilterField(){return"assignments"}getFilterTitleAriaLabel(){return Ie.p.Strings.BaseTaskFilterSection_AssignmentFilterSectionName}renderSectionFilterRows(){const e=this.props.members.slice().sort(Qt.k),t=jt.K.builder.fromUserResource({Id:p.lf.UnassignedUserId,DisplayName:Ie.p.Strings.PlannerApp_UnassignedText,JobTitle:null,ProxyAddresses:[],UserPrincipalName:"",UserType:null,PreferredLanguage:null}).build();return z.createElement("div",{className:"sectionRowsContainer"},this.renderAssignmentFilter(t),e.map(e=>this.renderAssignmentFilter(e)))}renderAssignmentFilter(e){var t;return z.createElement(qt,{key:e.id,text:e.formattedDisplayName,member:e,onToggleFilter:this.onFilterClicked.bind(this,e),memberPhoto:null!==(t=this.props.getUserPhoto(e.id))&&void 0!==t?t:void 0,isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e.id),onRenderPersona:this.props.onRenderPersona,theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterClicked=(e,t)=>{const o=this.getFilterField(),n=null!=e?e.id:null,r=this.props.currentTaskFilter.doesFilterValueExist(o,n),s=this.props.currentTaskFilter.toggleFilterValue(o,n);this.props.setTaskFilter(s,!1,r,[this.getFilterTitleAriaLabel(),e.displayName]),this.logUsage(g.M.FilterClicked,{filterRemoved:String(r)})}}}class Jt extends Kt{name(){return"FilterRow"}renderFilterRowIcon(){return null}getClassName(){return""}constructor(e,t){super(e,t)}}var Xt=o(70776);class $t extends Ft{name(){return g.M.BucketFilterSection}getFilterField(){return"bucketId"}getFilterTitleAriaLabel(){return Ie.p.Strings.BaseTaskFilterSection_BucketFilterSectionName}renderSectionFilterRows(){const e=this.props.buckets||[];e.sort(Xt.k);const t=[];return e.forEach(e=>{t.push(this.renderBucketFilter(e))}),z.createElement("div",{className:"sectionRowsContainer"},t)}renderBucketFilter(e){return z.createElement(Jt,{key:e.id,text:e.title,onToggleFilter:this.onFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e.id),theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterClicked=(e,t)=>{const o=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(o,e.id),r=this.props.currentTaskFilter.toggleFilterValue(o,e.id);this.props.setTaskFilter(r,!1,n,[this.getFilterTitleAriaLabel(),e.title]),this.logUsage(g.M.FilterClicked,{filterRemoved:String(n)})}}}var eo=o(69412);class to extends Kt{name(){return"CategoryFilterRow"}renderFilterRowIcon(){return this.props.renderLabelTag?z.createElement(eo.l,{key:this.props.categoryNumber,index:this.props.categoryNumber,title:this.props.categoryName,isCollapsed:!1,theme:this.props.theme,styles:zt()}):null!==this.props.categoryNumber?z.createElement("span",{className:(0,Qe.A)("category-"+this.props.categoryNumber,"categoryIcon")}):null}getClassName(){return"categoryFilterRow"}constructor(e,t){super(e,t)}}var oo=o(38780);class no extends Ft{name(){return g.M.CategoryFilterSection}getFilterField(){return"appliedCategories"}getFilterTitleAriaLabel(){return Ie.p.Strings.BaseTaskFilterSection_LabelFilterSectionName}renderSectionFilterRows(){const{categories:e}=this.props,t=[this.renderCategoryFilterRow(-1,Ie.p.Strings.Labels_UnlabeledText),...e.map(e=>{let{categoryNumber:t,categoryName:o}=e;return null!=o&&""!==o||(o=oo.U.getLabelPlaceholderByIndex(t)),this.renderCategoryFilterRow(t,o)})];return z.createElement("div",{className:"sectionRowsContainer"},t)}renderCategoryFilterRow(e,t){const o=-1===e,n=o?null:e,r=o?t:"";return z.createElement(to,{key:e,text:r,categoryName:t,categoryNumber:e,onToggleFilter:this.onFilterClicked.bind(this,n,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),n),renderLabelTag:!o,theme:this.props.theme})}onFilterClicked(e,t){const o=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(o,e),r=this.props.currentTaskFilter.toggleFilterValue(o,e);this.props.setTaskFilter(r,!1,n,[this.getFilterTitleAriaLabel(),t]),this.logUsage(g.M.FilterClicked,{filterRemoved:String(n)})}constructor(e,t){super(e,t)}}class ro extends Ft{name(){return g.M.DueDateFilterSection}getFilterField(){return"dueDate"}getFilterTitleAriaLabel(){return Ie.p.Strings.BaseTaskFilterSection_DueDateFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;return!1===e.renderSection?null:z.createElement("div",{className:"sectionRowsContainer"},e.renderLateOption&&this.renderDateFilter(p.Tt.Late),e.renderTodayOption&&this.renderDateFilter(p.Tt.Today),e.renderTomorrowOption&&this.renderDateFilter(p.Tt.Tomorrow),e.renderThisWeekOption&&this.renderDateFilter(p.Tt.ThisWeek),e.renderNextWeekOption&&this.renderDateFilter(p.Tt.NextWeek),e.renderFutureOption&&this.renderDateFilter(p.Tt.Future),e.renderNoDateOption&&this.renderDateFilter(p.Tt.NoDate),e.renderSomeDateOption&&this.renderDateFilter(p.Tt.SomeDate))}renderDateFilter(e){return z.createElement(Jt,{text:this.getDateFilterTitle(e),onToggleFilter:this.onFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),e),theme:this.props.theme})}getDateFilterTitle(e){switch(e){case p.Tt.NoDate:return Ie.p.Strings.PlannerApp_NoDateDueDateText;case p.Tt.Late:return Ie.p.Strings.PlannerApp_LateDueDateText;case p.Tt.Today:return Ie.p.Strings.PlannerApp_TodayDueDateText;case p.Tt.Tomorrow:return Ie.p.Strings.PlannerApp_TomorrowDueDateText;case p.Tt.ThisWeek:return Ie.p.Strings.PlannerApp_ThisWeekDueDateText;case p.Tt.NextWeek:return Ie.p.Strings.PlannerApp_NextWeekDueDateText;case p.Tt.Future:return Ie.p.Strings.PlannerApp_FutureDueDateText;case p.Tt.SomeDate:return Ie.p.Strings.PlannerApp_SomeDueDateText;default:throw new Error("UnsupportedException: filterValue")}}onFilterClicked(e,t){const o=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(o,e),r=this.props.currentTaskFilter.toggleFilterValue(o,e);this.props.setTaskFilter(r,!1,n,[this.getFilterTitleAriaLabel(),this.getDateFilterTitle(e)]),this.logUsage(g.M.FilterClicked,{dueDateCategory:p.Tt[e],filterRemoved:String(n)})}constructor(e,t){super(e,t)}}class so extends Kt{name(){return"IconFilterRow"}renderFilterRowIcon(){return z.createElement("div",{className:"icon"},this.props.iconProps&&z.createElement(xe.I,this.props.iconProps))}getClassName(){return"iconFilterRow"}constructor(e,t){super(e,t)}}var io=o(24723),ao=o(67271);class lo extends Ft{name(){return g.M.PriorityFilterSection}getFilterField(){return"priority"}getFilterTitleAriaLabel(){return Ie.p.Strings.BaseTaskFilterSection_PriorityFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;if(!1===e.renderSection)return null;const t=[];return e.renderUrgentOption&&t.push(this.renderPriorityFilterRow(io.gy.Urgent,Ie.p.Strings.Task_PriorityUrgentText)),e.renderImportantOption&&t.push(this.renderPriorityFilterRow(io.gy.Important,Ie.p.Strings.Task_PriorityImportantText)),e.renderMediumOption&&t.push(this.renderPriorityFilterRow(io.gy.Medium,Ie.p.Strings.Task_PriorityMediumText)),e.renderLowOption&&t.push(this.renderPriorityFilterRow(io.gy.Low,Ie.p.Strings.Task_PriorityLowText)),z.createElement("div",{className:"sectionRowsContainer"},t)}renderPriorityFilterRow(e,t){const o=(0,ao._d)(e);return z.createElement(so,{key:e,text:t,iconProps:(0,xt.m4)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onFilterClicked.bind(this,o,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),o),theme:this.props.theme})}onFilterClicked(e,t){const o=this.getFilterField(),n=this.props.currentTaskFilter.doesFilterValueExist(o,e),r=this.props.currentTaskFilter.toggleFilterValue(o,e);this.props.setTaskFilter(r,!1,n,[this.getFilterTitleAriaLabel(),t]),this.logUsage(g.M.FilterClicked,{priorityName:t,filterRemoved:String(n)})}constructor(e,t){super(e,t)}}var co=o(94772);class po extends Ft{name(){return g.M.ProgressFilterSection}getFilterField(){return"percentComplete"}getFilterTitleAriaLabel(){return Ie.p.Strings.BaseTaskFilterSection_ProgressFilterSectionName}renderSectionFilterRows(){const{options:e}=this.props;if(!1===e.renderSection)return null;const t=[];return e.renderNotStartedOption&&t.push(this.renderProgressFilterRow(co.$.NotStarted,Ie.p.Strings.TaskCard_TaskNotStartedText)),e.renderInProgressOption&&t.push(this.renderProgressFilterRow(co.$.InProgress,Ie.p.Strings.TaskCard_TaskInProgressText)),e.renderCompleteOption&&t.push(this.renderProgressFilterRow(co.$.Complete,Ie.p.Strings.TaskCard_TaskCompletedText)),z.createElement("div",{className:"sectionRowsContainer"},t)}renderProgressFilterRow(e,t){const o=(0,ao.BK)(e);return z.createElement(so,{key:e,text:t,iconProps:(0,xt.Nu)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onFilterClicked.bind(this,o,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(this.getFilterField(),o),theme:this.props.theme})}onFilterClicked(e,t){const o=this.props.currentTaskFilter.doesFilterValueExist("percentComplete",e),n=this.props.currentTaskFilter.toggleFilterValue("percentComplete",e);this.props.setTaskFilter(n,!1,o,[this.getFilterTitleAriaLabel(),t]),this.logUsage(g.M.FilterClicked,{progressName:t,filterRemoved:String(o)})}constructor(e,t){super(e,t)}}var uo=o(72866),ho=o(93950),go=o.n(ho),mo=o(49728);const Co="16px",ko=Co,bo=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.NX)(e),{width:"300px",paddingTop:Co,"> .ms-Callout-main":[(0,Ne.aS)(e),(0,Ne.NX)(e),{"> div":[(0,Ne.gS)("column"),{maxHeight:"".concat("70vh"," !important"),overflowY:"hidden !important","> .ie11Scroll":{maxHeight:"58vh"}}]}]},e===ce.Sx.SharePoint&&{".plannerProgressInProgress, .plannerProgressInProgressSmall":{color:Re.z.SharepointBlueIconColor()},".plannerProgressComplete, .plannerProgressCompleteSmall":{color:Re.z.SharepointCompleteColor()},".plannerPriorityUrgent, .plannerPriorityUrgentSmall":{color:Re.z.SharepointHighPriIconColor()},".plannerPriorityImportant, .plannerPriorityImportantSmall":{color:Re.z.SharepointHighPriIconColor()},".plannerPriorityMedium":{color:Re.z.SharepointCompleteColor()},".plannerPriorityLow":{color:Re.z.SharepointBlueIconColor()},".plannerRecurrence, .plannerRecurrenceSmall ":{color:Re.z.SharepointHighPriIconColor()}}],filterHeader:[(0,Ne.gS)(),{padding:"0px ".concat(Co," ").concat("6px"),minHeight:"20px",justifyContent:"space-between","> .filterTitle":{fontSize:"17px",fontWeight:Y.BO.semibold,cursor:"default"},"> .clearFilters":[Ne.xK,(0,Ne._D)(e),e===ce.Sx.SharePoint&&{color:Re.z.SharepointTitleFontColor()},{cursor:"pointer"},e===ce.Sx.TeamsContrast&&{":focus, :hover":{color:Re.z.TeamsContrastHyperlinkColor}}]}],titleFilterBox:{height:"35px",margin:"0px ".concat(ko," ").concat("6px"),".ms-TextField-fieldGroup":[(0,Ne.Nc)(e),{".ms-TextField-field":[(0,Ne.aS)(e),(0,Ne.Oj)(e),e===ce.Sx.TeamsContrast&&{backgroundColor:Re.z.Black,border:"1px solid ".concat(Re.z.White)},e!==ce.Sx.SharePoint&&{borderRadius:"3px"}],":hover":[e!==ce.Sx.TeamsContrast&&e!==ce.Sx.SharePoint&&{borderColor:"transparent"}]}],"&.is-active":{"> .ms-TextField-wrapper > .ms-TextField-fieldGroup":[(0,Ne.oO)(e),{"::after":{border:"none"}}]}},filterSections:[(0,Ne.gS)("column"),{overflowY:"auto",".title":{paddingLeft:Co},".sectionToggle":{paddingRight:Co}}]};return(0,Y.TW)(o,t)}),To=(0,Q.J9)(e=>({root:(0,Y.Zq)("taskFilterCallout",e.root),filterHeader:(0,Y.Zq)("filterHeader",e.filterHeader),titleFilterBox:(0,Y.Zq)("titleFilterBox",e.titleFilterBox),filterSections:(0,Y.Zq)("filterSections",e.filterSections)}));class So extends pe.${name(){return g.M.TaskFilterCallout}renderComponent(){const{options:e}=this.props,t=this.getClassNames(),o=window.navigator.userAgent.indexOf("Trident/7.0")>0?(0,Qe.A)(t.filterSections,"ie11Scroll"):t.filterSections;return z.createElement(Bt.P,{id:"taskFilterCallout",target:this.props.targetElement,directionalHint:Xe.A.bottomRightEdge,className:t.root,setInitialFocus:!1,isBeakVisible:!1,onDismiss:this.props.callbacks.onDismiss,gapSpace:0,role:"complementary"},z.createElement(wt.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},z.createElement("div",{className:t.filterHeader},z.createElement("div",{className:"filterTitle"},Ie.p.Strings.TaskFilterCallout_FilterTitle),z.createElement("button",{className:"clearFilters",onClick:this.clearFilters.bind(this),"aria-label":Ie.p.Strings.TaskFilterCallout_ClearFiltersAriaLabel},Ie.p.Strings.TaskFilterCallout_ClearFilters)),z.createElement(Dt.A,{ariaLabel:Ie.p.Strings.TaskFilterCallout_FilterTextFieldAriaLabel,autoAdjustHeight:!0,autoFocus:!0,className:t.titleFilterBox,multiline:!1,placeholder:Ie.p.Strings.TaskFilterCallout_TitleFilterInputPlaceholderText,value:this.state.currentlyTypedText,resizable:!1,onChange:(e,t)=>{this.onFilterTextValueChanged(null!==t&&void 0!==t?t:"")}}),z.createElement("div",{className:o},e.dueDateFilterOptions.renderSection&&this.renderDueDateFiltersSection(),e.priorityFilterOptions.renderSection&&this.renderPriorityFiltersSection(),e.progressFilterOptions.renderSection&&this.renderProgressFiltersSection(),e.labelFilterOptions.renderSection&&this.renderCategoryFiltersSection(),e.bucketFilterOptions.renderSection&&this.renderBucketFiltersSection(),e.assignmentFilterOptions.renderSection&&this.renderAssignmentFiltersSection())))}renderAssignmentFiltersSection(){const{users:e,currentTaskFilter:t,taskData:o,callbacks:n,theme:r}=this.props;if(!e)return null;const s=o?(0,mo.rA)(e,o,t):e;return z.createElement(Yt,{members:s,currentTaskFilter:t,sectionTitle:Ie.p.Strings.TaskFilterCallout_AssignmentSectionTitle,isCollapsed:this.state.isAssignmentSectionCollapsed,setTaskFilter:n.setTaskFilter,toggleSection:this.onAssignmentSectionToggle.bind(this),getUserPhoto:n.getUserPhoto,onRenderPersona:n.onRenderPersona,theme:r})}renderBucketFiltersSection(){return this.props.buckets?z.createElement($t,{buckets:this.props.buckets,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ie.p.Strings.TaskFilterCallout_BucketSectionTitle,isCollapsed:this.state.isBucketSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onBucketSectionToggle.bind(this),theme:this.props.theme}):null}renderCategoryFiltersSection(){const{categories:e,currentTaskFilter:t,taskData:o,callbacks:n,theme:r}=this.props;if(!e)return null;const s=(0,mo.$p)(e,o,t);return z.createElement(no,{categories:s,currentTaskFilter:t,sectionTitle:Ie.p.Strings.TaskFilterCallout_CategoryLabelSectionTitle,isCollapsed:this.state.isCategorySectionCollapsed,setTaskFilter:n.setTaskFilter,toggleSection:this.onCategorySectionToggle.bind(this),theme:r})}renderDueDateFiltersSection(){return z.createElement(ro,{options:this.props.options.dueDateFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ie.p.Strings.TaskFilterCallout_DueDateSectionTitle,isCollapsed:this.state.isDueDateSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onDueDateSectionToggle.bind(this),theme:this.props.theme})}renderPriorityFiltersSection(){return z.createElement(lo,{options:this.props.options.priorityFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ie.p.Strings.TaskFilterCallout_PrioritySectionTitle,isCollapsed:this.state.isPrioritySectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onPrioritySectionToggle.bind(this),theme:this.props.theme})}renderProgressFiltersSection(){return z.createElement(po,{options:this.props.options.progressFilterOptions,currentTaskFilter:this.props.currentTaskFilter,sectionTitle:Ie.p.Strings.TaskFilterCallout_ProgressSectionTitle,isCollapsed:this.state.isProgressSectionCollapsed,setTaskFilter:this.props.callbacks.setTaskFilter,toggleSection:this.onProgressSectionToggle.bind(this),theme:this.props.theme})}onFilterTextValueChanged(e){let t;this.logUsage(g.M.FilterByKeyword,{filterRemoved:String(""===e)}),t=""===e?this.props.currentTaskFilter.removeFilter("title"):this.props.currentTaskFilter.replaceFilter("title",new uo.d("title",[e])),this.setState(t=>({currentlyTypedText:e})),this.debouncedTextFilterCallback(t)}onAssignmentSectionToggle(){this.setState(e=>({isAssignmentSectionCollapsed:!e.isAssignmentSectionCollapsed}))}onBucketSectionToggle(){this.setState(e=>({isBucketSectionCollapsed:!e.isBucketSectionCollapsed}))}onDueDateSectionToggle(){this.setState(e=>({isDueDateSectionCollapsed:!e.isDueDateSectionCollapsed}))}onCategorySectionToggle(){this.setState(e=>({isCategorySectionCollapsed:!e.isCategorySectionCollapsed}))}onPrioritySectionToggle(){this.setState(e=>({isPrioritySectionCollapsed:!e.isPrioritySectionCollapsed}))}onProgressSectionToggle(){this.setState(e=>({isProgressSectionCollapsed:!e.isProgressSectionCollapsed}))}clearFilters(){this.logUsage(g.M.ClearFilters),this.props.callbacks.setTaskFilter(new uo.S,!0),this.setState(e=>({currentlyTypedText:""}))}getClassNames(){return To(bo(this.props.theme,this.props.styles))}constructor(e,t){super(e,t);const o=this.props.currentTaskFilter.filters.filter(e=>"title"===e.field)[0];this.state={currentlyTypedText:null!=(null===o||void 0===o?void 0:o.values[0])?o.values[0].toString():"",isAssignmentSectionCollapsed:!1,isBucketSectionCollapsed:!0,isDueDateSectionCollapsed:!1,isCategorySectionCollapsed:!0,isPrioritySectionCollapsed:!0,isProgressSectionCollapsed:!0},this.debouncedTextFilterCallback=go()(e.callbacks.setTaskFilter,200)}}var Po=o(54555),vo=o(16701);const xo="16px",yo=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.gS)("column"),(0,Ne.NX)(e),{alignItems:"flex-start",maxHeight:"400px",maxWidth:"260px","> ul":[(0,Ne.gS)("column"),{alignSelf:"center",width:"100%"}],".ms-ContextualMenu-item:hover":{".assignmentFilterNoResults":(0,Ne.NX)(e)},".assignmentFilterNoResults":[(0,Ne.aS)(e),{textAlign:"center",width:Ue.B.MenuItemWidth,padding:"30px 0px"}]}],header:[(0,Ne.gS)(),{width:Ue.B.MenuItemWidth,height:"32px",alignItems:"center",padding:"".concat(Ue.B.LoopMenuItemPadding," 0px"),justifyContent:"space-between",fontSize:Y.s.small,fontWeight:Y.BO.semibold,"> .filterTitle":[(0,Ne.aS)(e),{paddingLeft:xo}],"> .clearFilters":[Ne.xK,(0,Ne._D)(e),(0,Oe.c3)(),{cursor:"pointer",paddingRight:xo}]}],menuItems:[(0,Ne.gS)(),{width:Ue.B.MenuItemWidth,height:Ue.B.LoopMenuItemHeight,alignItems:"center",alignSelf:"center",button:[(0,Ne.gS)(),{borderRadius:Ue.B.LoopSubItemBorderRadius,padding:Ue.B.LoopMenuItemPadding,alignItems:"center",".ms-ContextualMenu-linkContent":{width:"100%"},".ms-ContextualMenu-submenuIcon":[(0,Ne.$Z)(),{justifyContent:"flex-end"}]}]}]};return(0,Y.TW)(o,t)}),fo=(0,Q.J9)(e=>({root:(0,Y.Zq)("taskFilterMenu",e.root),header:(0,Y.Zq)("header",e.header),menuItems:(0,Y.Zq)("menuItems",e.menuItems)})),Ao=(0,Q.J9)(e=>({root:[(0,Ne.zK)(e),(0,Oe.kE)(),{width:Ue.B.MenuItemWidth,height:Ue.B.LoopMenuItemHeight,borderRadius:"8px",alignSelf:"center",border:"none",padding:Ue.B.LoopMenuItemPadding,"&.is-active":[{"::after":[(0,Oe.lX)({border:"none !important"}),(0,Ne.T4)(e),{borderRadius:Ue.B.LoopSubItemBorderRadius}]}],"&.assignmentFilterSearchBox":{paddingLeft:"14px",margin:"12px 12px 0px 12px","> input":{marginLeft:"2px"},i:{marginLeft:"0px"}}}],icon:[(0,Ne.A9)(e),{marginLeft:"2px",paddingLeft:"0px",span:{justifyContent:"flex-start"}}],field:[(0,Ne.MJ)(e),(0,Ne.aS)(e),{marginLeft:"4px"}],clearButton:{marginRight:"-6px"}}));var wo=o(86634),Do=o(26727),Bo=o.n(Do);function Eo(e){switch(e){case p.Tt.NoDate:return Ie.p.Strings.PlannerApp_NoDateDueDateText;case p.Tt.Late:return Ie.p.Strings.PlannerApp_LateDueDateText;case p.Tt.Today:return Ie.p.Strings.PlannerApp_TodayDueDateText;case p.Tt.Tomorrow:return Ie.p.Strings.PlannerApp_TomorrowDueDateText;case p.Tt.ThisWeek:return Ie.p.Strings.PlannerApp_ThisWeekDueDateText;case p.Tt.NextWeek:return Ie.p.Strings.PlannerApp_NextWeekDueDateText;case p.Tt.Future:return Ie.p.Strings.PlannerApp_FutureDueDateText;case p.Tt.SomeDate:return Ie.p.Strings.PlannerApp_SomeDueDateText;default:throw new Error("Unexpected DueDateCategory value: ".concat(e))}}function Io(e){switch(e){case vo.mW.DueDate:return Ie.p.Strings.BaseTaskFilterSection_DueDateFilterSectionName;case vo.mW.Priority:return Ie.p.Strings.BaseTaskFilterSection_PriorityFilterSectionName;case vo.mW.Progress:return Ie.p.Strings.BaseTaskFilterSection_ProgressFilterSectionName;case vo.mW.Label:return Ie.p.Strings.BaseTaskFilterSection_LabelFilterSectionName;case vo.mW.Bucket:return Ie.p.Strings.BaseTaskFilterSection_BucketFilterSectionName;case vo.mW.Assignment:return Ie.p.Strings.BaseTaskFilterSection_AssignmentFilterSectionName;default:throw new Error("Unexpected FilterTypes value: ".concat(e))}}function Fo(e,t,o){return vt.G(Ie.p.Strings.BaseTaskFilterSection_ToggleFilterSectionAriaLabel,Io(e),Lo(t,o))}function Lo(e,t){return t.getFieldFilterCount(e)}function Mo(e,t,o){let n=e;const r=Lo(t,o);return r>0&&(n=n.concat(" (",r.toString(),")")),n}class No extends pe.${name(){return"TaskFilterMenu"}getClassNames(){return fo(yo(this.props.theme,this.props.styles))}renderComponent(){const e=this.getClassNames();return z.createElement($e.l,{className:e.root,items:this.getFilterMenuItems(e),directionalHint:Xe.A.bottomRightEdge,target:this.props.targetElement,onDismiss:this.props.callbacks.onDismiss,onRestoreFocus:this.onRestoreFocus,onRenderMenuList:(t,o)=>this.renderMenuList(e,t,o),appTheme:this.props.theme,styles:this.props.contextualMenuStyles})}renderMenuList(e,t,o){return z.createElement(wt.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},z.createElement("div",{className:e.header},z.createElement("div",{className:"filterTitle"},Ie.p.Strings.TaskFiltering_FiltersMenuHeaderText),z.createElement("button",{className:"clearFilters",onClick:this.clearFilters.bind(this),"aria-label":Ie.p.Strings.TaskFiltering_ClearFiltersAriaLabel},Ie.p.Strings.TaskFiltering_ClearFilters)),!this.props.hideSearchBox&&z.createElement(Po.G,{placeholder:Ie.p.Strings.TaskFiltering_TitleFilterInputPlaceholderText,ariaLabel:Ie.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,iconProps:ot._x,clearButtonProps:{iconProps:ot.s5},value:this.state.currentlyTypedText,onChange:this.onFilterSearchBoxChange,styles:Ao(this.props.theme)}),o?o(t):null)}clearFilters(){this.context.usageLogger.logData(g.M.TaskFilterMenu,g.M.ClearFilters),this.props.callbacks.setTaskFilter(new uo.S,!0),this.setState(e=>({currentlyTypedText:""}))}clearAssignmentFilter(){this.setState({currentlyTypedTextAssignment:""})}getFilterMenuItems(e){return[this.getDueDateMenuItem(e),this.getPriorityMenuItem(e),this.getProgressMenuItem(e),this.getLabelMenuItem(e),this.getBucketMenuItem(e),this.getAssignmentMenuItem(e)]}getBucketMenuItem(e){const{currentTaskFilter:t}=this.props,o=[],n=this.props.buckets||[];n.sort(Xt.k);for(const r of n)o.push({key:r.title,onRender:()=>this.renderBucketFilterRow(r)});return{key:vo.mW.Bucket,name:Mo(Ie.p.Strings.Task_BucketIdFieldText,vo.Gx.Bucket,t),ariaLabel:Fo(vo.mW.Bucket,vo.Gx.Bucket,t),className:e.menuItems,iconProps:ot.fD,subMenuProps:{items:o,calloutProps:{className:"plannerAppCallout"},styles:(0,wo.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:ot.rK}}getLabelMenuItem(e){const{currentTaskFilter:t,taskData:o}=this.props,n=[],r=this.props.categories||[];n.push({key:"Unlabeled",onRender:()=>this.renderCategoryFilterRow(-1,Ie.p.Strings.Labels_UnlabeledText)});return(0,mo.$p)(r,o,t).forEach(e=>{let{categoryNumber:t,categoryName:o}=e;const r=null!==o&&void 0!==o?o:oo.U.getLabelPlaceholderByIndex(t);n.push({key:r,onRender:()=>this.renderCategoryFilterRow(t,r)})}),{key:vo.mW.Label,name:Mo(Ie.p.Strings.Task_LabelsFieldText,vo.Gx.Label,t),ariaLabel:Fo(vo.mW.Label,vo.Gx.Label,t),className:e.menuItems,iconProps:ot.Oi,subMenuProps:{items:n,calloutProps:{className:"plannerAppCallout"},styles:(0,wo.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:ot.rK}}onCategoryFilterClicked(e,t){this.context.usageLogger.logData(g.M.CategoryFilterSection,g.M.FilterClicked);const o=this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Label,e),n=this.props.currentTaskFilter.toggleFilterValue(vo.Gx.Label,e);this.props.callbacks.setTaskFilter(n,!1,o,[Io(vo.mW.Label),t])}getAssignmentMenuItems(){const{members:e,currentTaskFilter:t,taskData:o}=this.props,n=[];let r=o?(0,mo.rA)(e,o,t):e;const{currentlyTypedTextAssignment:s}=this.state;if(s){if(r=r.filter(e=>-1!==e.formattedDisplayName.toLowerCase().indexOf(s.toLowerCase())).sort(Qt.k),!r||me()(r)){const e=z.createElement("div",{className:"assignmentFilterNoResults"},Ie.p.Strings.TaskFiltering_FilterNoResultsFound);return n.push({key:"noResults",onRender:()=>e}),n}}else{r=[jt.K.builder.fromUserResource({Id:p.lf.UnassignedUserId,DisplayName:Ie.p.Strings.PlannerApp_UnassignedText,JobTitle:null,ProxyAddresses:[],UserPrincipalName:"",UserType:null,PreferredLanguage:null}).build(),...r.slice().sort(Qt.k)]}for(const i of r)n.push({key:i.id,text:i.formattedDisplayName,onRender:this.renderAssignmentFilterRow.bind(this,i)});return n}getAssignmentMenuItem(e){const{currentTaskFilter:t}=this.props;return{key:vo.mW.Assignment,name:Mo(Ie.p.Strings.Task_AssignmentFieldText,vo.Gx.Assignment,t),ariaLabel:Fo(vo.mW.Assignment,vo.Gx.Assignment,t),className:e.menuItems,iconProps:ot.Nz,subMenuProps:{items:this.getAssignmentMenuItems(),onRenderMenuList:(t,o)=>this.renderAssignmentMenuList(e,t,o),calloutProps:{className:"plannerAppCallout"},styles:(0,wo.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:ot.rK}}renderAssignmentMenuList(e,t,o){return z.createElement(z.Fragment,null,z.createElement(Po.G,{placeholder:Ie.p.Strings.TaskFiltering_AssignmentFilterInputPlaceholderText,ariaLabel:Ie.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,className:"assignmentFilterSearchBox",iconProps:ot._x,clearButtonProps:{iconProps:ot.s5},value:this.state.currentlyTypedTextAssignment,onAbort:this.clearAssignmentFilter,onChange:this.onAssignmentFilterSearchBoxChange,styles:Ao(this.props.theme)}),o?o(t):null)}getDueDateMenuItem(e){const{currentTaskFilter:t}=this.props,o=[],n=Bo()(p.Tt).filter(e=>e!==p.Tt.SomeDate);for(const r of Bo()(n))isNaN(Number(r))||o.push({key:r.toString(),onRender:this.renderDueDateFilterRow.bind(this,r)});return{key:vo.mW.DueDate,name:Mo(Ie.p.Strings.Task_DueDateFieldText,vo.Gx.DueDate,t),ariaLabel:Fo(vo.mW.DueDate,vo.Gx.DueDate,t),className:e.menuItems,iconProps:ot.cx,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:o,styles:(0,wo.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:ot.rK}}getPriorityMenuItem(e){const{currentTaskFilter:t}=this.props,o=[{key:io.gy.Urgent,text:Ie.p.Strings.Task_PriorityUrgentText},{key:io.gy.Important,text:Ie.p.Strings.Task_PriorityImportantText},{key:io.gy.Medium,text:Ie.p.Strings.Task_PriorityMediumText},{key:io.gy.Low,text:Ie.p.Strings.Task_PriorityLowText}].map(e=>({key:e.key,onRender:this.renderPriorityFilterRow.bind(this,e.key,e.text)}));return{key:vo.mW.Priority,name:Mo(Ie.p.Strings.Task_PriorityFieldText,vo.Gx.Priority,t),ariaLabel:Fo(vo.mW.Priority,vo.Gx.Priority,t),className:e.menuItems,iconProps:ot.iW,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:o,styles:(0,wo.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:ot.rK}}getProgressMenuItem(e){const{currentTaskFilter:t}=this.props,o=[{key:co.$.NotStarted,text:Ie.p.Strings.TaskCard_TaskNotStartedText},{key:co.$.InProgress,text:Ie.p.Strings.TaskCard_TaskInProgressText},{key:co.$.Complete,text:Ie.p.Strings.TaskCard_TaskCompletedText}].map(e=>({key:e.key,onRender:this.renderProgressFilterRow.bind(this,e.key,e.text)}));return{key:vo.mW.Progress,name:Mo(Ie.p.Strings.Task_ProgressFieldText,vo.Gx.Progress,t),ariaLabel:Fo(vo.mW.Progress,vo.Gx.Progress,t),className:e.menuItems,iconProps:ot.vE,subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:o,styles:(0,wo.Zo)(this.props.theme,this.props.contextualMenuStyles),onRestoreFocus:this.onRestoreFocus},submenuIconProps:ot.rK}}renderPriorityFilterRow(e,t){const{theme:o,currentTaskFilter:n}=this.props,r=(0,ao._d)(e);return z.createElement(so,{key:e,text:t,iconProps:(0,xt.m4)(this.context.traceLogger,o,e),onToggleFilter:this.onPriorityFilterClicked.bind(this,r,t),isSet:n.doesFilterValueExist(vo.Gx.Priority,r),theme:o})}onPriorityFilterClicked(e,t){this.context.usageLogger.logData(g.M.PriorityFilterSection,g.M.FilterClicked,{priorityName:e});const o=this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Priority,e),n=this.props.currentTaskFilter.toggleFilterValue(vo.Gx.Priority,e);this.props.callbacks.setTaskFilter(n,!1,o,[Io(vo.mW.Priority),t])}renderProgressFilterRow(e,t){const o=(0,ao.BK)(e);return z.createElement(so,{key:e,text:t,iconProps:(0,xt.Nu)(this.context.traceLogger,this.props.theme,e),onToggleFilter:this.onProgressFilterClicked.bind(this,o,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Progress,o),theme:this.props.theme})}onProgressFilterClicked(e,t){this.context.usageLogger.logData(g.M.ProgressFilterSection,g.M.FilterClicked,{progressName:e});const o=this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Progress,e),n=this.props.currentTaskFilter.toggleFilterValue(vo.Gx.Progress,e);this.props.callbacks.setTaskFilter(n,!1,o,[Io(vo.mW.Progress),t])}renderDueDateFilterRow(e){return z.createElement(so,{key:e,iconProps:(0,xt.OY)(e,this.context.traceLogger),text:Eo(e),onToggleFilter:this.onDueDateFilterClicked.bind(this,e),isSet:this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.DueDate,e),theme:this.props.theme})}onDueDateFilterClicked(e){this.context.usageLogger.logData(g.M.DueDateFilterSection,g.M.FilterClicked,{dueDateCategory:p.Tt[e]});const t=this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.DueDate,e),o=this.props.currentTaskFilter.toggleFilterValue(vo.Gx.DueDate,e);this.props.callbacks.setTaskFilter(o,!1,t,[Io(vo.mW.DueDate),Eo(e)])}renderAssignmentFilterRow(e){var t;return z.createElement(qt,{key:e.id,text:e.formattedDisplayName,member:e,onToggleFilter:this.onAssignmentFilterClicked.bind(this,e),memberPhoto:null!==(t=this.props.callbacks.getUserPhoto(e.id))&&void 0!==t?t:void 0,isSet:this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Assignment,e.id),onRenderPersona:this.props.callbacks.onRenderPersona,theme:this.props.theme})}constructor(e,t){super(e,t),this.onFilterSearchBoxChange=(e,t)=>{this.context.usageLogger.logData(g.M.TaskFilterMenu,g.M.FilterByKeyword);const o=null!==t&&void 0!==t?t:"";let n;n=""===o?this.props.currentTaskFilter.removeFilter("title"):this.props.currentTaskFilter.replaceFilter("title",new uo.d("title",[o])),this.props.callbacks.setTaskFilter(n),this.setState({currentlyTypedText:o})},this.onAssignmentFilterSearchBoxChange=(e,t)=>{this.setState({currentlyTypedTextAssignment:null!==t&&void 0!==t?t:""})},this.renderBucketFilterRow=e=>z.createElement(Jt,{key:e.id,text:e.title,onToggleFilter:()=>this.onBucketFilterClicked(e),isSet:this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Bucket,e.id),theme:this.props.theme}),this.onBucketFilterClicked=e=>{this.context.usageLogger.logData(g.M.BucketFilterSection,g.M.FilterClicked);const t=this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Bucket,e.id),o=this.props.currentTaskFilter.toggleFilterValue(vo.Gx.Bucket,e.id);this.props.callbacks.setTaskFilter(o,!1,t,[Io(vo.mW.Bucket),e.title])},this.renderCategoryFilterRow=(e,t)=>{const o=-1===e,n=o?null:e,r=o?t:"";return z.createElement(to,{key:e,text:r,categoryName:t,categoryNumber:e,onToggleFilter:()=>this.onCategoryFilterClicked(n,t),isSet:this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Label,n),renderLabelTag:!o,theme:this.props.theme})},this.onAssignmentFilterClicked=e=>{const t=null!=e?e.id:null,o=this.props.currentTaskFilter.doesFilterValueExist(vo.Gx.Assignment,t),n=this.props.currentTaskFilter.toggleFilterValue(vo.Gx.Assignment,t);this.props.callbacks.setTaskFilter(n,!1,o,[Io(vo.mW.Assignment),e.displayName])},this.onRestoreFocus=e=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()};const o=this.props.currentTaskFilter.filters.filter(e=>"title"===e.field)[0];this.state={currentlyTypedText:null!=(null===o||void 0===o?void 0:o.values[0])?o.values[0].toString():"",currentlyTypedTextAssignment:""}}}var Ro=o(65337),Uo=o(94850),Oo=o(17323);const Ho=(0,Q.J9)((e,t,o)=>{const n={root:[{"&:focus, &:hover":[{".moreButton":{opacity:"1"}},(0,Ne.Mi)(e),e===ce.Sx.TeamsContrast&&{"> .memberCardContainer > .ms-Persona .ms-Persona-primaryText":{color:Re.z.Black}}]},t&&{opacity:"0.5"}],memberCardContainer:[(0,Ne.gS)(),{backgroundColor:"transparent",padding:"".concat("6px"," ").concat("24px"),"&:focus, &:hover":{"> .moreButton":{opacity:"1"}}}],moreButton:[Ne.xK,(0,Ne.$Z)(),{opacity:"0",cursor:"pointer","&.isMenuOpen":{display:"inline-block"},"&:focus":{opacity:"1"}}]};return(0,Y.TW)(n,o)}),Vo=(0,Q.J9)(e=>({root:(0,Y.Zq)("memberCard",e.root),memberCardContainer:(0,Y.Zq)("memberCardContainer",e.memberCardContainer),moreButton:(0,Y.Zq)("moreButton",e.moreButton)})),Go=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.GD)(),{overflow:"hidden",cursor:"pointer"}],primaryText:[(0,Ne.aS)(e),{"&:hover":(0,Ne.aS)(e)}]};return(0,Y.TW)(o,t)});var Wo=o(62948);class _o extends pe.${name(){return"Member"}renderComponent(){const e=this.props.isEditable?this.renderEditableMemberItem():this.renderReadOnlyMemberItem(),t=this.getClassNames(),o=(0,Qe.A)("plannerAppCallout",t.root),n=this.getPersonaProps(),r=z.createElement("div",{className:o,onKeyUp:this.handleKeyUpEvent.bind(this,n.id),"aria-label":n.text+" "+n.secondaryText,tabIndex:0,"data-is-focusable":!0,ref:this.memberFocusElement,role:"button"},e);var s;return this.props.connectDragSource&&null!==(s=this.props.connectDragSource(r))&&void 0!==s?s:r}cardSource(){return{beginDrag:e=>({user:e.user,userPhoto:e.userPhoto})}}cardCollect(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}}getPersonaProps(){let e=this.props.personaProps;e||(e=this.getMemberPersonaProps());const t=(0,c.A)({},e);return t.onClick=this.highlightCardsAssignedToUser.bind(this,e.id),t}renderReadOnlyMemberItem(){var e;const t=this.getPersonaProps();return z.createElement("div",{className:this.getClassNames().memberCardContainer},z.createElement(Nt.f,{user:this.props.user,onLoad:this.props.onRenderPersona,containerId:"userContainer-memberCard-".concat(null===(e=this.props.user)||void 0===e?void 0:e.id)},z.createElement(Lt.F,(0,c.A)((0,c.A)({},t),{},{styles:Go(this.props.theme)}))))}renderEditableMemberItem(){var e;const t=this.getPersonaProps(),o=[{key:"remove",name:Ie.p.Strings.MembersList_RemoveMember,onClick:this.props.onRemoveUser}],n=z.createElement($e.l,{items:o,target:this.contextMenuLauncher,onDismiss:this.hideContextMenu.bind(this),directionalHint:Xe.A.bottomAutoEdge,appTheme:this.props.theme}),r=this.getClassNames(),s=(0,Qe.A)(r.moreButton,{isMenuOpen:this.state.isContextMenuOpen});return z.createElement("div",{className:r.memberCardContainer},z.createElement(Nt.f,{user:this.props.user,onLoad:this.props.onRenderPersona,containerId:"userContainer-memberCard-".concat(null===(e=this.props.user)||void 0===e?void 0:e.id)},z.createElement(Lt.F,(0,c.A)((0,c.A)({},t),{},{styles:Go(this.props.theme)}))),z.createElement("button",{className:s,onClick:this.toggleContextMenu.bind(this),ref:this.resolveRef(this,"contextMenuLauncher"),title:Ie.p.Strings.MembersList_MoreButtonTooltipText,"aria-label":Ie.p.Strings.MembersList_MoreButtonTooltipText},z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.XP),{},{"data-is-focusable":!1}))),this.state.isContextMenuOpen?n:null)}getMemberPersonaProps(){return{id:this.props.user.id,text:this.props.user.formattedDisplayName,secondaryText:this.props.user.mail,imageUrl:this.props.userPhoto,size:Mt.WH.extraSmall,onClick:this.highlightCardsAssignedToUser.bind(this,this.props.user.id)}}handleKeyUpEvent(e,t){Ye.a.getKey(t)===Le.D.ENTER&&this.highlightCardsAssignedToUser(e)}highlightCardsAssignedToUser(e){this.props.highlightTasks&&this.props.highlightTasks(p.JS.Assignee,e)}toggleContextMenu(){this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isContextMenuOpen:!e.isContextMenuOpen}))}hideContextMenu(){this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isContextMenuOpen:!1}))}getClassNames(){const{theme:e,styles:t,isDragging:o}=this.props;return Vo(Ho(e,!!o,t))}constructor(e,t){super(e,t),this.memberFocusElement=z.createRef(),this.state={isContextMenuOpen:!1}}}const zo=(0,Wo.I)("memberCard",_o.prototype.cardSource(),_o.prototype.cardCollect)(_o);var Zo=o(9737),Ko=o(89379),qo=o(65804),jo=o(19664);const Qo="24px",Yo={fontSize:Y.s.xLarge,fontWeight:Y.BO.semibold},Jo="280px",Xo="17px",$o=(0,ze.vb)((0,ze.jz)(Jo)-2*(0,ze.jz)(Xo)),en=(0,Q.J9)((e,t,o)=>{const n={root:{},sectionsContainer:[(0,Ne.gS)("column"),{maxHeight:"80vh",overflowY:"auto","> .membersSection":[(0,Ne.GD)("auto"),(0,Ne.gS)("column"),{flexShrink:2,minHeight:t?"120px":"100px"}],"> .sharedContainersSection":[(0,Ne.GD)("auto"),(0,Ne.gS)("column"),{minHeight:"80px"}]}],membersTitle:[(0,Ne.$Z)(),Yo,{margin:"0px ".concat(Qo," ").concat((0,ze.vb)((0,ze.jz)(Qo)/2)," ").concat(Qo),cursor:"default"}],membersListContainer:[(0,Ne.GD)("auto"),{paddingTop:"1px",minHeight:t?"100px":"60px",maxHeight:"481px",overflowY:"auto","> .noViewMembersPermissionMessage":[(0,Ne.Ml)(e),{margin:"0px ".concat(Qo)}]}],noSuggestions:[(0,Ne.aS)(e),{textAlign:"center",fontSize:Y.s.small,lineHeight:30,padding:"5px"}],addGuest:{marginBottom:"10px","> .addGuestBtn":[Ne.xK,(0,Ne.jU)(e),{color:Re.z.White,cursor:"pointer",padding:"".concat("12px"," ").concat(Xo),width:$o}],"> .addGuestMicrocopy":{fontSize:Y.s.small,padding:"10px ".concat(Xo)},"> .addGuestHelpLink":[(0,Ne.BP)(e),{display:"block",fontSize:Y.s.small,textDecoration:"none",padding:"10px ".concat(Xo)}]},suggestions:[(0,Ne.aS)(e),(0,Ne.NX)(e),{width:Jo,".ms-Suggestions-title":[(0,Ne.aS)(e),(0,Ne.NX)(e),{borderBottom:"none","> .addGuestHelpFooter":{fontSize:Y.s.medium,padding:"0 ".concat((0,ze.vb)((0,ze.jz)(Xo)-(0,ze.jz)("5px")))}}]}],suggestionsItem:[(0,Ne.aS)(e),{padding:"5px",":hover":[(0,Ne.Mi)(e),{".ms-Suggestions-itemButton.is-suggested":(0,Ne.Mi)(e)}],".ms-Persona":{width:"100%"},".ms-Persona-primaryText":(0,Ne.aS)(e),".ms-Persona-secondaryText":(0,Ne.Ml)(e),".ms-Suggestions-itemButton.is-suggested":(0,Ne.NX)(e)}]};return(0,Y.TW)(n,o)}),tn=(0,Q.J9)(e=>({root:(0,Y.Zq)("membersList",e.root),sectionsContainer:(0,Y.Zq)("sectionsContainer",e.sectionsContainer),membersTitle:(0,Y.Zq)("membersTitle",e.membersTitle),membersListContainer:(0,Y.Zq)("membersListContainer",e.membersListContainer),noSuggestions:(0,Y.Zq)("noSuggestions",e.noSuggestions),addGuest:(0,Y.Zq)("addGuest",e.addGuest),suggestions:(0,Y.Zq)("suggestions",e.suggestions),suggestionsItem:(0,Y.Zq)("suggestionsItem",e.suggestionsItem)})),on=(0,Q.J9)((e,t)=>{const o=Rt.d.isLoopTheme(e),n={root:[(0,Ne.NX)(e),{width:"320px",padding:"".concat("16px"," 0px")},o&&{borderRadius:Ue.B.LoopBorderRadius}],calloutMain:[(0,Ne.aS)(e),(0,Ne.NX)(e),{overflowY:"hidden"}]};return(0,Y.TW)(n,t)}),nn=(0,Q.J9)((e,t)=>{const o=Rt.d.isLoopTheme(e),n={root:{margin:"0px ".concat(Qo," ").concat((0,ze.vb)((0,ze.jz)(Qo)/2)," ").concat(Qo)},text:{border:"none","::after":[o&&{borderRadius:Ue.B.LoopSubItemBorderRadius},(0,Ne.T4)(e)]},input:[(0,Ne.aS)(e),(0,Ne.zK)(e),(0,Ne.Oj)(e),{minHeight:"34px"}]};return(0,Y.TW)(n,t)}),rn=(0,Q.J9)(()=>({root:[(0,Ne.GD)("auto")]}));var sn=o(63633);const an=(0,Ko.Z)(),ln=(0,qo.I)(e=>{let{sharedContainerItems:t,inaccessibleSharedContainerCount:o,theme:n,styles:r}=e;const s=t.length>0,i=o>0,a=t.length+o,l=an(r,{theme:n,hasMultipleListItems:s&&a>1});let p=null;s?p=Ie.p.Strings.SharedContainersList_PlanSharedWithFilesMessage:1===o?p=Ie.p.Strings.SharedContainersList_UnsharedFileFullMessageSingular:o>1&&(p=vt.G(Ie.p.Strings.SharedContainersList_UnsharedFileFullMessagePlural,o)),p&&(p+=" ");const d=s?z.createElement("ul",null,t.map((e,t)=>z.createElement("li",{key:t},z.createElement(jo.S,(0,c.A)({styles:l.subComponentStyles.item},e))))):null,u=s&&i?z.createElement("div",{className:l.inaccessibleFilesInfo},z.createElement("span",{className:"countBubble"},vt.G(Ie.p.Strings.SharedContainersList_PlusNumberOfUnsharedFiles,o)),z.createElement("span",{className:"inaccessibleFilesText"},1===o?Ie.p.Strings.SharedContainersList_UnsharedFileMessageSingular:Ie.p.Strings.SharedContainersList_UnsharedFileMessagePlural)):null;return z.createElement("div",{className:l.root},z.createElement("div",{className:l.header},Ie.p.Strings.SharedContainersList_SharedWithHeader),z.createElement("div",{className:l.description},p,p&&z.createElement(K.N,{href:ce.$j.sharedPlans,target:"_blank",rel:"noopener noreferrer"},Ie.p.Strings.SharedComponents_LearnMoreLink)),(d||u)&&z.createElement("div",{className:l.itemsList},d,u))},e=>{let{theme:t,hasMultipleListItems:o}=e;const n=o?"64px":"40px";return{root:["sharedContainersList",(0,Ne.gS)("column"),{marginTop:"12px"}],header:["header",(0,Ne.$Z)(),{margin:"0 ".concat(Qo," 8px"),fontSize:Y.s.xLarge,fontWeight:Y.BO.semibold}],description:["description",(0,Ne.$Z)(),(0,Ne.Ml)(t),{margin:"0 ".concat(Qo)}],itemsList:[(0,Ne.GD)("auto"),{marginTop:"12px",minHeight:n,overflowY:"auto"}],inaccessibleFilesInfo:["inaccessibleFilesInfo",(0,Ne.$Z)(),(0,Ne.gS)(),Ne.cc,{margin:"4px ".concat(Qo," 0"),height:sn.n,".countBubble":[(0,Ne.$Z)(sn.s),(0,Ne.wA)(t),{marginRight:"10px",lineHeight:sn.s,borderRadius:"50%",textAlign:"center",fontSizes:Y.s.small,fontWeight:Y.BO.semibold}],".inaccessibleFilesText":[(0,Ne.GD)("auto"),(0,Ne.Ml)(t)]}],subComponentStyles:{item:{root:{margin:"0 ".concat(Qo)}}}}});var cn=o(50723),pn=o.n(cn),dn=o(32520),un=o.n(dn),hn=o(19853),gn=o.n(hn),mn=o(33411),Cn=o.n(mn),kn=o(27559),bn=o(28730);class Tn extends pe.${name(){return g.M.MembersList}renderComponent(){let e;this.memberCardFocusElements={},e=this.props.canViewMembers?this.props.canAddMembers?this.renderMembersPeoplePicker():this.renderReadOnlyMembersList():this.renderNoViewMembersPermissionMessage();const t=this.getClassNames(),o=(0,Qe.A)("plannerAppCallout",t.root);return z.createElement(Bt.P,{id:"membersList",directionalHint:Xe.A.bottomRightEdge,target:this.props.calloutTarget,onDismiss:this.props.callbacks.dismissMembersCallout,className:o,isBeakVisible:!1,gapSpace:0,ariaLabel:Ie.p.Strings.MembersList_MembersTitle,role:"complementary",layerProps:{eventBubblingEnabled:!0},onClick:this.stopPropagation,onKeyDown:this.stopPropagation,styles:on(this.props.theme,this.props.calloutStyles)},z.createElement(wt.Y,{className:t.sectionsContainer,isClickableOutsideFocusTrap:!0},z.createElement("div",{className:"membersSection"},z.createElement("div",{className:t.membersTitle},Ie.p.Strings.MembersList_MembersTitle),z.createElement("div",{className:t.membersListContainer},e)),this.renderSharedContainersList()))}renderMembersPeoplePicker(){const e=Cn()(this.getMembersToRender(),e=>this.getMemberPersonaProps(e)),t=this.getClassNames(),o={loadingText:Ie.p.Strings.MembersList_LoadingText,noResultsFoundText:Ie.p.Strings.MembersList_NoResultsFound,onRenderNoResultFound:this.renderNoResultsFound.bind(this),className:t.suggestions,suggestionsItemClassName:t.suggestionsItem};return z.createElement("div",{className:"membersPeoplePicker"},z.createElement(Oo.iG,{onResolveSuggestions:this.onSearchTextChanged.bind(this),onGetMoreResults:this.onSearchTextChanged.bind(this),getTextFromItem:e=>{var t;return null!==(t=e.text)&&void 0!==t?t:""},className:"addMembersPeoplePicker",pickerSuggestionsProps:o,onRenderItem:this.renderMemberItem.bind(this),onChange:this.onUsersChange.bind(this),selectedItems:e,inputProps:{placeholder:Ie.p.Strings.MembersList_AddMemberPlaceholder,role:"textbox",tabIndex:0},ref:this._peoplePickerRef,resolveDelay:200,onDismiss:e=>{e.defaultPrevented=!0},styles:nn(this.props.theme,this.props.peoplePickerStyles)}))}renderNoResultsFound(e,t){const o=this.getClassNames();return z.createElement("div",{className:o.noSuggestions},Ie.p.Strings.MembersList_NoResultsFound)}renderReadOnlyMembersList(){let e=!1;this.state.numMembersToRender<this.props.members.length&&(e=!0);const t=z.createElement(z.Fragment,null,Cn()(this.getMembersToRender(),e=>{var t;return z.createElement("div",{key:e.id,role:"listitem"},z.createElement(zo,{isEditable:!1,user:e,userPhoto:null!==(t=this.props.callbacks.getUserPhoto(e.id))&&void 0!==t?t:void 0,highlightTasks:this.props.callbacks.highlightTasks,onRenderPersona:this.props.callbacks.onRenderPersona,theme:this.props.theme}))}));return z.createElement(Ro.R,{className:"readOnlyMembersList",direction:Uo.E.vertical,isCircularNavigation:!1,role:"list"},z.createElement(Zo.H,{id:"readOnlyMemberList",hasMoreItemsToRender:e,orientation:Zo.Q.Vertical,onLastElementIsVisible:()=>this.onLastMemberVisible()},t))}onLastMemberVisible(){const e=this.state.numMembersToRender+this.membersPageSize;this.setState({numMembersToRender:e})}getMembersToRender(){return this.memoizeGetMembersToRender(this.props.members,this.state.numMembersToRender)}memoizeGetMembersToRender(e,t){const o=this.prevMembers!==e&&!gn()(this.prevMembers,e);return o&&(this.sortedMembers=e.slice().sort((e,t)=>bn.l.compareStringForDisplay(e.displayName,t.displayName)),this.prevMembers=e),(o||this.prevNumMembersToRender!==t)&&(this.renderedMembers=this.sortedMembers.slice(0,t),this.prevNumMembersToRender=t),this.renderedMembers}renderMemberItem(e){const t=!!this.props.canRemoveMembers&&(!!this.props.callbacks.canUserBeRemovedFromGroup&&this.props.callbacks.canUserBeRemovedFromGroup(e.item.id));let o=!1;e.index===this.state.numMembersToRender-1&&(o=!0);const n=z.createElement("div",{key:e.item.id,role:"listitem"},z.createElement(zo,{isEditable:t,personaProps:e.item,user:this.getMembersToRender()[e.index],highlightTasks:this.props.callbacks.highlightTasks,onRemoveUser:()=>{var t;this.updateFocusOnRemoval(e.item.id),null===(t=e.onRemoveItem)||void 0===t||t.call(e)},onRenderPersona:this.props.callbacks.onRenderPersona,ref:t=>{var o;const n=null===t||void 0===t?void 0:t.getDecoratedComponentInstance();null!==n&&void 0!==n&&null!==(o=n.memberFocusElement)&&void 0!==o&&o.current&&(this.memberCardFocusElements[e.item.id]={element:n.memberFocusElement.current,id:e.item.id})},theme:this.props.theme}));return z.createElement(Zo.H,{id:"memberList",key:"memberListKey".concat(e.item.id),hasMoreItemsToRender:o,orientation:Zo.Q.Vertical,onLastElementIsVisible:()=>this.onLastMemberVisible()},n)}updateFocusOnRemoval(e){kn.n.ChangeFocusBeforeRemovalAlt(this.getMembersToRender(),()=>{var e,t;return null===(e=this._peoplePickerRef)||void 0===e||null===(e=e.current)||void 0===e||null===(t=e.focusInput)||void 0===t?void 0:t.call(e)},e,e=>e.id,e=>{var t;return null===(t=this.memberCardFocusElements[e.id])||void 0===t?void 0:t.element})}getMemberPersonaProps(e){var t;return{id:e.id,text:e.formattedDisplayName,secondaryText:e.mail,imageUrl:null!==(t=this.props.callbacks.getUserPhoto(e.id))&&void 0!==t?t:void 0,size:Mt.WH.extraSmall}}onSearchTextChanged(e,t){const{getUserWithKeyword:o}=this.props.callbacks;return this.setState({inputText:e}),me()(e)||e.length<ce.c9.MinCharsNeededToSearch?[]:o?new Promise((t,n)=>{o(e).then(e=>{if(me()(e))t([]);else{const o=pn()(e,e=>!(un()(this.props.members,t=>t.id===e.id)>-1)&&!(!this.props.canAddGuests&&e.isGuest())),n=Cn()(o,e=>this.getMemberPersonaProps(e));t(n)}})}):[]}onUsersChange(e){if(this.props.callbacks.addUserCallback){const t=this.props.members;for(let o=0;o<e.length;o++){if(-1===un()(t,t=>t.id===e[o].id))return this.logUsage(g.M.AddMember),void this.props.callbacks.addUserCallback(e[o].id)}}if(this.props.callbacks.removeUserCallback){const t=this.getMembersToRender();for(let o=0;o<t.length;o++){if(-1===un()(e,e=>e.id===t[o].id))return this.logUsage(g.M.RemoveMember),void this.props.callbacks.removeUserCallback(t[o].id)}}}renderNoViewMembersPermissionMessage(){return z.createElement("div",{className:"noViewMembersPermissionMessage"},Ie.p.Strings.MembersList_NonPlanMemberMessage)}renderSharedContainersList(){return null==this.props.sharedContainersListProps?null:z.createElement("div",{className:"sharedContainersSection"},z.createElement(ln,(0,c.A)((0,c.A)({},this.props.sharedContainersListProps),{},{styles:rn()})))}getClassNames(){const{members:e,theme:t,styles:o}=this.props,n=e.length>1;return tn(en(t,n,o))}constructor(e,t){super(e,t),this._peoplePickerRef=z.createRef(),this.membersPageSize=10,this.prevMembers=[],this.prevNumMembersToRender=0,this.sortedMembers=[],this.renderedMembers=[],this.stopPropagation=e=>{e.stopPropagation()},this.state={inputText:"",numMembersToRender:this.membersPageSize}}}class Sn extends pe.${name(){return"HeaderDropdowns"}renderComponent(){const{renderNewFilterMenu:e}=this.props.filtersDropdownProps,t=this.getClassNames();return z.createElement("div",{className:t.root},this.renderContextDropdown(),e?this.renderFiltersDropdown(t):this.renderMembersDropdown(t),e?this.renderGroupByDropdown(t):this.renderFiltersDropdown(t),e?this.renderMembersDropdown(t):this.renderGroupByDropdown(t))}getClassNames(){return Tt(bt(this.props.theme))}renderContextDropdown(){const{contextMenuProps:e,renderContextDropdown:t}=this.props;return t&&null!=e&&null!=e.contextDetails?z.createElement(At,e):null}renderMembersDropdown(e){const{renderMembersDropdown:t,membersDropdownProps:o}=this.props;return t&&null!=o?z.createElement("button",{className:(0,Qe.A)("members passive_2 active_3",e.dropdownMenu),ref:"membersCommandButton",onClick:o.toggleMembersCallout,title:Ie.p.Strings.PlannerHeader_MembersTooltipText,"aria-expanded":o.isMembersCalloutVisible,"aria-controls":"membersList",id:"plannerHeaderMemberButton"},z.createElement(it.J,null,Ie.p.Strings.PlannerHeader_MembersDropDownHeaderText),z.createElement("span",{className:e.dropdownIcon},z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.Ju),{},{className:(0,Qe.A)(ot.Ju.className,"dropdownChevronIcon")})),z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.BW),{},{className:(0,Qe.A)(ot.BW.className,"dropdownHiddenTextIcon")})),o.isMembersCalloutVisible&&this.renderMembersCallout())):null}renderFiltersDropdown(e){const{filtersDropdownProps:t}=this.props;if(!t.currentTaskFilter)return null;const o=vt.G(Ie.p.Strings.PlannerHeader_FiltersTooltipText,t.currentTaskFilter.filterCount.toString());return z.createElement("button",{className:(0,Qe.A)("filters",e.dropdownMenu),ref:"filterCalloutCommandButton",onClick:this.toggleFilterCallout.bind(this),title:o,"aria-expanded":t.isFilterCalloutVisible,"aria-controls":"taskFilterCallout"},z.createElement(it.J,null,z.createElement("span",null,Ie.p.Strings.TaskFiltering_FiltersMenuHeaderText),z.createElement("span",null,Ie.p.Strings.PlannerHeader_FiltersMenuHeaderOpeningParentheses),z.createElement("span",{className:"value"},t.currentTaskFilter.filterCount.toString()),z.createElement("span",null,Ie.p.Strings.PlannerHeader_FiltersMenuHeaderClosingParentheses)),z.createElement("span",{className:e.dropdownIcon},z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.Ju),{},{className:(0,Qe.A)(ot.Ju.className,"dropdownChevronIcon")})),z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.ao),{},{className:(0,Qe.A)(ot.ao.className,"dropdownHiddenTextIcon")})),t.isFilterCalloutVisible?this.renderTaskFilterMenu():null))}renderMembersCallout(){var e,t,o,n,r;const{membersDropdownProps:s,callbacks:i}=this.props;if(null==s)return null;const a=i,l={addUserCallback:a.onAddMember,dismissMembersCallout:s.dismissMembersCallout,getUserWithKeyword:a.getUserWithKeyword,getUserPhoto:a.getUserPhoto,canUserBeRemovedFromGroup:a.canUserBeRemovedFromContainer?a.canUserBeRemovedFromContainer:()=>!1,highlightTasks:a.highlightTasks,onRenderPersona:a.onRenderPersona,removeUserCallback:a.onRemoveMember};return z.createElement(Tn,{callbacks:l,calloutTarget:this.refs.membersCommandButton,members:null!==(e=this.props.members)&&void 0!==e?e:[],canAddGuests:null!==(t=s.canUserAddGuests)&&void 0!==t&&t,canViewMembers:null===(o=s.canUserViewMembers)||void 0===o||o,canAddMembers:null!==(n=s.canUserAddMembers)&&void 0!==n&&n,canRemoveMembers:null!==(r=s.canUserRemoveMembers)&&void 0!==r&&r,sharedContainersListProps:s.sharedContainersListProps,theme:this.props.theme})}renderTaskFilterMenu(){const{filtersDropdownProps:e,members:t,callbacks:o,theme:n}=this.props,{currentTaskFilter:r,taskData:s,buckets:i,planCategories:a,filterOptions:l,renderNewFilterMenu:c}=e;if(!r)return null;const p={getUserPhoto:o.getUserPhoto,setTaskFilter:o.setTaskFilter,onDismiss:this.dismissFilterCallout,onRenderPersona:o.onRenderPersona};return c?z.createElement(No,{targetElement:this.refs.filterCalloutCommandButton,callbacks:p,currentTaskFilter:r,taskData:s,members:null!==t&&void 0!==t?t:[],categories:a,buckets:i,theme:n}):z.createElement(So,{targetElement:this.refs.filterCalloutCommandButton,callbacks:p,currentTaskFilter:r,taskData:s,buckets:i,users:t,categories:a,options:null!==l&&void 0!==l?l:{assignmentFilterOptions:{renderSection:!1},bucketFilterOptions:{renderSection:!1},dueDateFilterOptions:{renderSection:!1,renderSomeDateOption:!1,renderFutureOption:!1,renderLateOption:!1,renderNoDateOption:!1,renderNextWeekOption:!1,renderThisWeekOption:!1,renderTodayOption:!1,renderTomorrowOption:!1},labelFilterOptions:{renderSection:!1},priorityFilterOptions:{renderSection:!0,renderUrgentOption:!0,renderImportantOption:!0,renderMediumOption:!0,renderLowOption:!0},progressFilterOptions:{renderSection:!0,renderCompleteOption:!0,renderInProgressOption:!0,renderNotStartedOption:!0}},theme:n})}toggleFilterCallout(){this.context.usageLogger.logData(this.name(),"Filter menu selected"),this.props.callbacks.onFilterCalloutVisibleChange(!this.props.filtersDropdownProps.isFilterCalloutVisible)}renderGroupByDropdown(e){const{groupByDropdownProps:t}=this.props;if(!t.taskGroupingOptions||me()(t.taskGroupingOptions)||!t.currentTaskGrouping)return null;const o=rt(t.currentTaskGrouping);return z.createElement("button",{className:(0,Qe.A)("groupByMenu",e.dropdownMenu),ref:"groupByMenuCommandButton",onClick:this.toggleGroupByMenu,title:Ie.p.Strings.HeaderDropdowns_GroupByTooltipText,"aria-expanded":this.state.isGroupByMenuVisible,"aria-controls":"groupByMenu"},z.createElement(it.J,null,z.createElement("span",null,Ie.p.Strings.HeaderDropdowns_GroupByDropDownHeaderText),t.showGroupByMenuTitleValue?z.createElement("span",{className:"value"},o):null),z.createElement("span",{className:e.dropdownIcon},z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.Ju),{},{className:(0,Qe.A)(ot.Ju.className,"dropdownChevronIcon")})),z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.DZ),{},{className:(0,Qe.A)(ot.DZ.className,"dropdownHiddenTextIcon")})),this.state.isGroupByMenuVisible?z.createElement(st,{currentTaskGrouping:t.currentTaskGrouping,taskGroupingOptions:t.taskGroupingOptions,targetElement:this.refs.groupByMenuCommandButton,onDismissGroupByMenu:this.dismissGroupByMenu,onGroupByChange:this.props.callbacks.onGroupByChange,theme:this.props.theme}):null))}constructor(e,t){super(e,t),this.dismissFilterCallout=()=>{this.props.callbacks.onFilterCalloutVisibleChange(!1),this.refs.filterCalloutCommandButton.focus()},this.toggleGroupByMenu=()=>{this.setState(e=>({isGroupByMenuVisible:!e.isGroupByMenuVisible}))},this.dismissGroupByMenu=()=>{this.setState(e=>({isGroupByMenuVisible:!1}))},this.state={isGroupByMenuVisible:!1}}}var Pn=o(56205),vn=o(3902);const xn=e=>({root:[(0,Ne.$Z)("auto"),(0,Ne.gS)("row","nowrap"),{margin:"0px ".concat((0,ze.vb)((0,ze.jz)("20px")-((0,ze.jz)(Ue.B.TopHeaderIconHorizontalOffset)+(0,ze.jz)(Ue.B.HeaderDropdownItemSpacing))/2))}],descriptiveOverflowButton:{lineHeight:"normal",backgroundColor:"transparent",".ms-Persona-initials > span":[(0,Ne.aS)(e),(0,Oe.M8)()]}});class yn extends pe.${name(){return"HeaderFacepile"}renderComponent(){const{members:e,toggleMembersCallout:t,onRenderPersona:o,theme:n}=this.props,r=e.length,s=e.map(e=>this.getFacepileProps(e));let i="";return Pt()(e.slice(0,4),(e,t)=>{i+=e.displayName,t!==r-1&&3!==t&&(i+=Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator)}),z.createElement(vn.g,{className:"facePileArray",personas:s,maxDisplayablePersonas:4,overflowButtonType:Pn.Z.descriptive,overflowButtonProps:{onClick:t,ariaLabel:vt.G(Ie.p.Strings.PlannerHeader_OverflowButtonAriaLabel,s.length-4)},onRenderUserPersona:o,ariaLabel:i,customStyles:xn(n)})}getFacepileProps(e){var t;return{personaName:e.formattedDisplayName,imageUrl:null!==(t=this.props.getUserPhoto(e.id))&&void 0!==t?t:void 0,onClick:this.highlightCardsAssignedToUser.bind(this,e.id),data:{user:e}}}highlightCardsAssignedToUser(e){var t,o;null===(t=(o=this.props).highlightTasks)||void 0===t||t.call(o,p.JS.Assignee,e)}constructor(e,t){super(e,t),this.state={}}}var fn=o(79889),An=o.n(fn),wn=o(44388);class Dn extends pe.${name(){return"Responsive"}componentDidMount(){this.resizeEventGroup.on(window,"resize",An()(this.calculateClassName.bind(this))),this.calculateClassName()}componentWillUnmount(){this.resizeEventGroup.off()}renderComponent(){return z.createElement(this.props.elementTagName||"div",{ref:"responsiveContainer"},this.props.children)}calculateClassName(){let e=0,t="";if(null!=this.refs.responsiveContainer){this.isAdditive()&&(t=this.defaultClassName);do{t=this.isAdditive()?(0,Qe.A)(t,this.props.sizeClasses[e]):(0,Qe.A)(this.defaultClassName,this.props.sizeClasses[e]),this.refs.responsiveContainer.className=t,e++}while(e<this.props.sizeClasses.length&&this.refs.responsiveContainer.offsetWidth<this.refs.responsiveContainer.scrollWidth);this.refs.responsiveContainer.offsetWidth<this.refs.responsiveContainer.scrollWidth&&this.logUsage("ResponsiveTooSmall",{parentSize:this.refs.responsiveContainer.offsetWidth.toString(10),contentSize:this.refs.responsiveContainer.scrollWidth.toString(10)})}}isAdditive(){return this.props.isAdditive||!0}constructor(e,t){if(super(e,t),0===this.props.sizeClasses.length)throw new Error("InvalidArgumentException: sizeClasses must be of length 1 or greater");this.defaultClassName=(0,Qe.A)("responsive",this.props.className),this.state={className:this.defaultClassName},this.resizeEventGroup=new wn.g(this)}}var Bn=o(44433),En=o(67239),In=o(96980);const Fn="12px",Ln="16px",Mn=(0,Q.J9)((e,t)=>{const o=Rt.d.isLoopTheme(e),n={root:[e===ce.Sx.Dark&&{".ms-Button-icon":{color:Re.z.White}},{".ms-Callout-main":{borderRadius:o?Ue.B.LoopBorderRadius:"initial"}}],content:[(0,Ne.gS)("column"),{boxSizing:"border-box",width:"288px",padding:"".concat(Fn," ").concat(Fn," 0 ").concat("28px")}],infoSectionContainer:[(0,Ne.gS)("column"),{width:"232px",".infoSection":{"> .title":{fontWeight:Y.BO.bold,paddingBottom:"12px"},"> .description":{fontSize:Y.s.small,fontWeight:Y.BO.semilight,paddingBottom:"24px"}}}],closeButtonContainer:{alignSelf:"flex-end",".closeButton":{width:Ln,height:Ln,padding:"0px",".ms-Button-icon":{padding:"0px",margin:"0px"}}}};return(0,Y.TW)(n,t)}),Nn=(0,Q.J9)(e=>({root:(0,Y.Zq)("planInfoCallout",e.root),content:(0,Y.Zq)("planInfoCallout-content",e.content),infoSectionContainer:(0,Y.Zq)("infoSectionContainer",e.infoSectionContainer),closeButtonContainer:(0,Y.Zq)("closeButtonContainer",e.closeButtonContainer)}));class Rn extends pe.${name(){return"PlanInfoCallout"}renderComponent(){const e=this.getClassNames();return z.createElement(Bt.P,{ariaLabel:Ie.p.Strings.PlanInfoCallout_CalloutAriaLabel,target:this.props.targetElement,directionalHint:Xe.A.bottomLeftEdge,className:e.root,setInitialFocus:!0,isBeakVisible:!0,beakWidth:10,onDismiss:this.props.callbacks.onDismiss,gapSpace:5,styles:(0,wo.df)(this.props.theme)},z.createElement(wt.Y,{elementToFocusOnDismiss:this.props.targetElement,isClickableOutsideFocusTrap:!0,className:e.content},z.createElement("div",{className:e.closeButtonContainer},z.createElement(En.K,{className:(0,Qe.A)("ms-TeachingBubble-closebutton","closeButton"),iconProps:ot.s5,title:Ie.p.Strings.PlanInfoCallout_CloseButtonText,ariaLabel:Ie.p.Strings.PlanInfoCallout_CloseButtonAriaLabel,onClick:this.props.callbacks.onDismiss,plannerTheme:this.props.theme})),z.createElement("div",{className:e.infoSectionContainer},this.renderPrivacySection(),this.renderClassificationSection(),this.renderSensitivitySection(),this.renderHasGuestsSection())))}renderPrivacySection(){const e=this.props.visibility===he.X.Public?Ie.p.Strings.PlanCreateEditor_VisibilityMode_Public:this.props.hasSharedContainers?Ie.p.Strings.Plan_Group_PrivacyText_WithSharedContainers:Ie.p.Strings.PlanCreateEditor_VisibilityMode_Private;return z.createElement(In.K,{title:Ie.p.Strings.PlanInfoCallout_PrivacyTitle,description:e})}renderClassificationSection(){return!this.props.classification||this.props.sensitivity?null:z.createElement(In.K,{title:Ie.p.Strings.PlanInfoCallout_ClassificationTitle,description:this.props.classification})}renderSensitivitySection(){return this.props.sensitivity?z.createElement(In.K,{title:Ie.p.Strings.PlanInfoCallout_SensitivityTitle,description:this.props.sensitivity}):null}renderHasGuestsSection(){return this.props.hasGuests?z.createElement(In.K,{title:Ie.p.Strings.PlanInfoCallout_GuestsTitle,description:Ie.p.Strings.PlanInfoCallout_HasGuestsText}):null}getClassNames(){return Nn(Mn(this.props.theme,this.props.styles))}constructor(e,t){super(e,t)}}var Un=o(94283);const On="48px",Hn="19px",Vn=(0,Q.J9)(e=>{const t=Rt.d.isLoopTheme(e);return{root:[(0,Ne.$Z)(On),{position:"relative",margin:"".concat("5px"," ").concat(Ue.B.TopHeaderHorizontalPadding," 0px"),"> .icon":[(0,Ne.gS)(),Ne.cc,(0,Ne.$Z)(On),(0,Oe.kE)(),{height:On,width:On,borderRadius:t&&"4px","&.circular":{borderRadius:"50%"}}],".icontext":{fontSize:"17px",fontWeight:"300",color:Re.z.White,textAlign:"center"}}],badge:[(0,Ne.gS)(),Ne.cc,{backgroundColor:Re.z.White,position:"absolute",top:(0,ze.vb)((0,ze.jz)(On)-(0,ze.jz)(Hn)/2),right:(0,ze.vb)(0-(0,ze.jz)(Hn)/2),borderRadius:"50%",height:Hn,width:Hn,".badgeContainer":[Ne.xK,(0,Ne.gS)(),Ne.cc,{cursor:"pointer"}]}]}}),Gn=(0,Q.J9)(e=>({root:(0,Y.Zq)("primaryIconSection",e.root),badge:(0,Y.Zq)("primaryIconBadge",e.badge)}));var Wn=o(36060),_n=o(27678),zn=o(44535);class Zn extends pe.${name(){return"HeaderIcon"}renderComponent(){const{badgeIconAriaLabel:e,imageSource:t,isIconCircular:o,titleText:n}=this.props,r=this.getClassNames();let s;const i=null!==e&&void 0!==e?e:"";if(t){const e=(0,Qe.A)("icon",{circular:null!==o&&void 0!==o&&o});s=z.createElement("img",{src:t,className:e,tabIndex:i?0:-1,alt:i,title:i})}else{const e=(0,Wn.K)((0,_n.wV)(n)),t=(0,Qe.A)("icon",e,{circular:null!==o&&void 0!==o&&o});s=z.createElement("div",{className:t,tabIndex:i?0:-1,"aria-label":i,title:i},z.createElement("div",{className:"icontext"},zn.$.parseInitialsFromName(n)))}return z.createElement("div",{className:r.root},s,this.renderBadge(r))}getClassNames(){return Gn(Vn(this.props.theme))}renderPlanInfoCallout(){const{hasSharedContainers:e,sensitivityLabels:t,planMembers:o,planContainer:n,theme:r}=this.props,s={onDismiss:this.dismissPlanInfoCallout};let i=!1;if(o)for(let l=0;l<o.length;l++)if(o[l].isGuest()){i=!0;break}const a=null===n||void 0===n?void 0:n.unifiedGroup;return z.createElement(Rn,{callbacks:s,visibility:null===a||void 0===a?void 0:a.visibility,classification:null===a||void 0===a?void 0:a.classification,sensitivity:a?Un.k.getFullSensitivityTitle(a.assignedSensitivityLabelId,null!==t&&void 0!==t?t:null):"",targetElement:this.infoCalloutCommandButton,hasGuests:i,hasSharedContainers:e,theme:r})}constructor(e,t){super(e,t),this.renderBadge=e=>this.props.hideBadgeIcon?null:z.createElement("div",{className:e.badge},z.createElement("button",{className:"badgeContainer",tabIndex:0,onClick:this.togglePlanInfoCallout,ref:e=>this.infoCalloutCommandButton=e,"aria-label":Ie.p.Strings.PlanHeader_PlanInfoBadgeIconAriaLabel,"aria-haspopup":!0},z.createElement(xe.I,ot.DA),this.state.isPlanInfoCalloutVisible?this.renderPlanInfoCallout():null)),this.togglePlanInfoCallout=()=>{this.state.isPlanInfoCalloutVisible||this.logUsage("ViewPlanInfoCallout"),this.setState(e=>({isPlanInfoCalloutVisible:!e.isPlanInfoCalloutVisible}))},this.dismissPlanInfoCallout=()=>{this.setState(e=>({isPlanInfoCalloutVisible:!1}))},this.state={isPlanInfoCalloutVisible:!1}}}var Kn=o(62264);const qn=o.p+"static/media/planner.ada07f52318c532dc0d7d68dc36a9b7c.svg",jn=(0,Q.J9)(()=>({hidePersonas:{".facePileArray, .joinUnifiedGroup":{display:"none"},".rightAlignedSection":[(0,Ne.$Z)(),{flexGrow:1,justifyContent:"flex-end"}],".secondarySection":[(0,Ne.GD)("auto"),{flexShrink:0}],".dropdowns":{margin:"0px"}},hidePivotText:{".pivotsSection > .removable > .pivotLink":{"> *:not(.icon)":{display:"none"},"> .icon":{display:"inline"}}},hideTitle:{".nonIcon > * > .primarySection":{display:"none"}},hideDropdownText:{".dropdownMenu":{margin:"0px ".concat((0,ze.vb)((0,ze.jz)(Ue.B.HeaderDropdownItemSpacing)/2)),"> *":{margin:"0px"},"> label":{display:"none"},".dropDownIcon":{"> .dropdownChevronIcon":{display:"none"},"> .dropdownHiddenTextIcon":{display:"inline"}},".plannerDiamond svg":{transform:"scale(1)"}}}})),Qn=(0,Q.J9)(e=>({hidePersonas:(0,Y.Zq)("hidePersonas",e.hidePersonas),hidePivotText:(0,Y.Zq)("hidePivotText",e.hidePivotText),hideTitle:(0,Y.Zq)("hideTitle",e.hideTitle),hideDropdownText:(0,Y.Zq)("hideDropdownText",e.hideDropdownText)}));var Yn=o(98990),Jn=o.n(Yn),Xn=o(80493),$n=o(33268);class er extends Pe{name(){return"PlanHeader"}getClassNames(){return Ge(Ve(this.props.theme,this.props.styles))}getResponsiveHeaderClassNames(){return Qn(jn())}renderComponent(){const{callbacks:e,disableMode:t,flights:o,plan:n,planContainer:r,hideFavoriteButton:s}=this.props,i=this.getClassNames(),a=this.renderPrimaryIconSection(),l=this.renderPrimaryTextSection(),c=o.EnableDocumentTasks&&(null===r||void 0===r?void 0:r.containerType)===de.K.DriveItem&&null!==e.getBreadcrumbUrl(null===r||void 0===r?void 0:r.externalId)?this.renderSecondaryIconSection():null,p=s||t===Te.DisableAll?null:this.renderToggleFavoriteButton(),d=this.renderPivotsSection(i),u=this.renderRightSection(i),h=this.renderBreadcrumbSection(),g=this.renderLinkedSection(i);let m="";const C=this.getBreadcrumbItemsInfo();m=me()(C)?this.fallbackContextInfoProvider():C.map(e=>e.text).join();const k=this.getResponsiveHeaderClassNames(),b=["",k.hidePersonas,k.hideTitle,k.hidePivotText,k.hideDropdownText];this.props.isSlimView&&b.push("slimView");const T=this.props.hideTitleSection?null:z.createElement("div",{className:i.primarySection,tabIndex:0,"aria-label":vt.G(Ie.p.Strings.PlannerHeader_PrimarySectionAriaLabel,this.props.plan.title,m)},z.createElement("div",{className:i.primaryTextSectionContainer},l,p,c),z.createElement("div",{className:i.contextInfoSectionContainer},z.createElement("div",{className:"contextInfoSection"},h),g));return z.createElement(fe.$,{planContainerId:n.id,onRender:e.onRenderPlanPhoto},z.createElement(Dn,{sizeClasses:b,isAdditive:!0,className:i.root},z.createElement(Bn.H,{className:i.topHeaderLandmark,role:"banner","aria-label":Ie.p.Strings.PlannerHeader_TopHeaderLandmarkAriaLabel},a,z.createElement("div",{className:i.nonIcon},z.createElement("div",null,this.renderAppLogo(),T,z.createElement("div",{className:i.secondarySection},d),u)),this.props.children)),this.state.workloadNameToShowInMissingWorkloadErrorDialog&&z.createElement(Fe,{dialogClassName:"workloadErrorDialog",dialogContainerClassName:ce.bI,dialogContentClassName:ce.vt,workloadName:this.state.workloadNameToShowInMissingWorkloadErrorDialog,onDismiss:this.closeWorkloadErrorDialog.bind(this),theme:this.props.theme}))}renderPrimaryIconSection(){var e,t,o,n,r;return this.props.hideTitleSection?null:z.createElement(Zn,{hideBadgeIcon:this.props.hideBadgeIcon,badgeIconAriaLabel:null===(e=(t=this.props.callbacks).getBadgeIconAriaLabel)||void 0===e?void 0:e.call(t),imageSource:this.props.imageSource,isIconCircular:this.props.isIconCircular,titleText:this.props.plan.title,planMembers:null!==(o=this.props.planMembers)&&void 0!==o?o:[],planContainer:null!==(n=this.props.planContainer)&&void 0!==n?n:null,sensitivityLabels:null!==(r=this.props.sensitivityLabels)&&void 0!==r?r:null,hasSharedContainers:this.props.plan.sharedWithContainers.length>0,theme:this.props.theme})}renderAppLogo(){return this.props.showAppLogo?z.createElement("div",{className:this.getClassNames().appLogo},z.createElement("img",{src:qn,alt:"",role:"presentation"})):null}renderToggleFavoriteButton(){const{isCurrentPlanFavorite:e,theme:t}=this.props,o=e?ot.z$:ot.XR,n=e?Ie.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ie.p.Strings.PlanHeader_PlanHeaderAddPinned;return z.createElement(En.K,{onClick:this.toggleFavoriteButtonClick,className:"toggleFavoriteIcon",iconProps:o,title:n,ariaLabel:n,plannerTheme:t,styles:_e(t)})}renderPrimaryTextSection(){const{hideTitleSection:e,plan:t}=this.props;if(e)return null;const o=t.title;return z.createElement(Kn.g,{onClickTitleButton:this.props.callbacks.onClickTitleButton,titleButtonAriaLabel:vt.G(Ie.p.Strings.PlanHeader_PlanTitleButtonAriaLabel,o),titleText:o,theme:this.props.theme})}renderBreadcrumbSection(){const{contextDropdownProps:e,hideBreadcrumbMenu:t}=this.props;if(t||e&&e.visibleContextKeys.length>0)return null;const o=this.getBreadcrumbItemsInfo();if(me()(o))return z.createElement("div",{className:"fallbackContextInfoText"},this.fallbackContextInfoProvider());const n=null!==e&&void 0!==e&&e.visibleContextKeys&&e.visibleContextKeys.length>0?1:void 0;return z.createElement(ve.Q,{items:null!==o&&void 0!==o?o:[],className:"headerBreadCrumb",maxDisplayedItems:n,overflowAriaLabel:Ie.p.Strings.PlanHeader_BreadcrumbButtonOverflowAriaLabel,role:void 0,styles:We(this.props.theme)})}renderLinkedSection(e){const{contextDropdownProps:t,theme:o}=this.props;if(t&&t.visibleContextKeys.length>0){const n=z.createElement("span",{title:Ie.p.Strings.PlanContextLinking_MultipleLinkedContextsAriaLabel},Ie.p.Strings.PlanContextLinking_LinkedPlanBreadCrumbText),r=this.renderDelinkSection();return z.createElement(At,(0,c.A)((0,c.A)({},t),{},{className:e.linkedBadgeDropdown,isBeakVisible:!0,onRenderLabel:t=>z.createElement("div",{className:e.linkedBadgeItem},n,r),theme:o}))}return null}renderDelinkSection(){const{contextDropdownProps:e}=this.props;if(e&&e.visibleContextKeys.length>0){const t=e.contextDetails;if(!t)return null;if(null!=Jn()(t,e=>e.status===yt.$.Delinked))return z.createElement("div",{className:"delinkIcon"},z.createElement(xe.I,ot.Zl),z.createElement(xe.I,ot.aA))}return null}renderSecondaryIconSection(){const e=Ie.p.Strings.PlanHeader_OpenDocumentInNewWindow;return z.createElement("button",{className:"secondaryIconSection",onClick:()=>{this.openOriginalDocument(this.props.plan)},"aria-label":e,title:e},z.createElement(xe.I,ot.XL))}renderPivotsSection(e){const{hidePlanNavLinks:t}=this.props;return t?null:z.createElement("div",{className:e.pivotsSection},z.createElement(Je,{pivotLinks:this.getPrimaryPagePivotLinksInfo(),selectedPivotLinkIndex:this.findSelectedIndex(),onSelectPivotLink:this.onClickHeaderPivotLink,renderTeamsPivotSection:this.props.renderTeamsPivotSection,theme:this.props.theme}),!this.props.renderTeamsPivotSection&&z.createElement(nt,{moreOptionsContextMenuItems:this.getSecondaryLinksContextMenuInfo(),onOpenLinksContextMenu:this.props.callbacks.onOpenLinksContextMenu,moreOptionsTooltip:Ie.p.Strings.PlanHeader_MoreText,theme:this.props.theme,headerMoreOptionsButtonRef:this.headerMoreOptionsButtonRef}))}renderRightSection(e){const{planContainer:t,containerPermissions:o,userPermissions:n}=this.props;let r=!1;if((null===t||void 0===t?void 0:t.containerType)===de.K.Group){const e=t;r=null!=e.unifiedGroupDetails&&e.unifiedGroup.visibility===he.X.Public}const s=!this.isUserCurrentGroupMembership()&&r&&z.createElement("div",{className:"joinUnifiedGroup"},z.createElement(q.j,{className:"joinUnifiedGroupButton",onClick:this.props.callbacks.joinGroup.bind(this)},Ie.p.Strings.PlannerHeader_JoinUnifiedGroupButtonLabel)),i=null!=this.props.planMembers&&!this.props.hideMembers,a={assignmentFilterOptions:{renderSection:!0},bucketFilterOptions:{renderSection:!me()(this.props.planBuckets)},dueDateFilterOptions:{renderSection:!0,renderFutureOption:!0,renderLateOption:!0,renderNextWeekOption:!0,renderThisWeekOption:!0,renderTodayOption:!0,renderTomorrowOption:!0,renderNoDateOption:!0,renderSomeDateOption:!1},labelFilterOptions:{renderSection:!0},priorityFilterOptions:{renderSection:!0,renderUrgentOption:!0,renderImportantOption:!0,renderMediumOption:!0,renderLowOption:!0},progressFilterOptions:{renderSection:!0,renderCompleteOption:!0,renderInProgressOption:!0,renderNotStartedOption:!0}};return z.createElement("div",{className:e.rightAlignedSection},s,i&&this.renderFacepile(),z.createElement(Sn,{renderContextDropdown:!0,renderMembersDropdown:i,contextMenuProps:this.props.contextDropdownProps,membersDropdownProps:{canUserAddGuests:null===n||void 0===n?void 0:n.canAddGuests,canUserViewMembers:null===o||void 0===o?void 0:o.canViewMembers,canUserAddMembers:null===o||void 0===o?void 0:o.canAddMembers,canUserRemoveMembers:null===o||void 0===o?void 0:o.canRemoveMembers,sharedContainersListProps:this.props.sharedContainersListProps,isMembersCalloutVisible:this.state.isMembersCalloutVisible,toggleMembersCallout:this.toggleMembersCallout,dismissMembersCallout:this.dismissMembersCallout},filtersDropdownProps:{currentTaskFilter:this.props.currentTaskFilter,filterOptions:a,isFilterCalloutVisible:this.props.isFilterCalloutVisible,taskData:this.props.taskData,buckets:this.props.planBuckets,planCategories:this.props.planCategories},groupByDropdownProps:{showGroupByMenuTitleValue:this.props.showGroupByMenuTitleValue,currentTaskGrouping:this.props.currentTaskGrouping,taskGroupingOptions:this.props.taskGroupingOptions},members:this.props.planMembers,callbacks:this.props.callbacks,theme:this.props.theme}),this.renderAppMoreOptionsButton())}renderFacepile(){const{callbacks:e,planMembers:t}=this.props;return null==t||me()(t)?null:z.createElement(yn,{members:t,getUserPhoto:e.getUserPhoto,toggleMembersCallout:this.toggleMembersCallout,onRenderPersona:e.onRenderPersona,highlightTasks:e.highlightTasks,theme:this.props.theme})}renderAppMoreOptionsButton(){if(null==this.props.callbacks.openAppAboutDialog)return null;const e=z.createElement($e.l,{appTheme:this.props.theme,items:[{key:"about",name:Ie.p.Strings.SharedComponents_TeamsHeader_About,onClick:this.props.callbacks.openAppAboutDialog}],target:this.moreButtonRef,onDismiss:this.closeAppMoreOptionsContextMenu});return z.createElement("div",{className:this.getClassNames().appMoreOptionsButton},z.createElement(En.K,{plannerTheme:this.props.theme,elementRef:this.moreButtonRef,iconProps:ot.XP,onClick:this.toggleAppMoreOptionsContextMenu,title:Ie.p.Strings.SharedComponents_MoreButtonTooltipText,ariaLabel:Ie.p.Strings.SharedComponents_MoreButtonTooltipText}),this.state.isAppMoreOptionsContextMenuVisible&&e)}getPrimaryPagePivotLinksInfo(){const{isTimelineVisible:e,showGoToProject:t}=this.props,o=[];return o.push({id:d.EC.PlanGrid,name:Ie.p.Strings.SharedComponents_PlanGridPageName,iconProps:ot.Dz}),o.push({id:d.EC.PlanTaskboard,name:Ie.p.Strings.SharedComponents_PlanTaskboardPageName,iconProps:ot.fD}),o.push({id:d.EC.PlanCharts,name:Ie.p.Strings.SharedComponents_PlanChartsPageName,iconProps:ot.V1}),o.push({id:d.EC.PlanSchedule,name:Ie.p.Strings.SharedComponents_PlanSchedulePageName,iconProps:ot.cx}),e&&o.push({id:d.EC.PlanTimeline,name:t?Ie.p.Strings.SharedComponents_PlanProjectPageName:Ie.p.Strings.SharedComponents_PlanTimelinePageName,iconProps:ot.aM,alwaysShowIcon:!0}),o}getSpoWorkloadUrl(e,t){const{sharepointDomainUrl:o}=this.props;return vt.G(p.Lf.SharepointWorkloadUrlFormat,o,e,t)}getSecondaryLinksContextMenuInfo(){const{callbacks:e,disableMode:t,flights:o,isCurrentPlanFavorite:n,plan:r,planContainer:s,planMembers:i,sharepointDomainUrl:a,hasAccessViaSharedContainer:l,showCopyPlanToProjectLink:c}=this.props;if(this.props.hideSecondaryLinksContextMenu||null==s||le.B.clientType===h.s.SharepointApp)return[];const d=[];if(t!==Te.DisableAll&&null!=r&&s.containerType===de.K.User){const e=ae.getLinksCapabilitiesForPlan(s,i.length,r.container.containerType,l);if(be(e,ie.EnableFavorite)){const e=n?Ie.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ie.p.Strings.PlanHeader_PlanHeaderAddPinned;d.push({key:"ToggleFavorite",name:e,onClick:this.togglePlanFavorite.bind(this)})}return be(e,ie.EnableCopyLink)&&d.push({key:"copyLinkToPlan",name:Ie.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:this.onClickCopyLinkToPlan.bind(this)}),be(e,ie.EnableSettings)&&t===Te.DisableNothing&&d.push({key:"PlanSettings",name:Ie.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>{var e;return this.openPlanSettingsPanel(r.id,null!==(e=this.headerMoreOptionsButtonRef.current)&&void 0!==e?e:void 0)}}),d}const u=ae.getLinksCapabilitiesForContainer(s);if(ke(u,se.EnableYammer)&&d.push({key:"Yammer",name:Ie.p.Strings.PlanHeader_PlanHeaderWorkloadYammer,onClick:this.handleWorkloadNavigation.bind(this,Be.P[Be.P.Yammer])}),ke(u,se.EnableConversations)&&d.push({key:"Conversations",name:Ie.p.Strings.PlanHeader_PlanHeaderWorkloadConversation,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,Be.P[Be.P.Conversations]),"navigateToWorkloadConversations"):(this.context.traceLogger.logTrace(508036125,E.k.Warning,"SharepointDomainUrl is not available"),this.handleWorkloadNavigation(Be.P[Be.P.Conversations]))}}),ke(u,se.EnableMembers)&&d.push({key:"Members",name:Ie.p.Strings.PlanHeader_PlanHeaderWorkloadMembers,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,"Members"),"navigateToWorkloadPeople"):(this.context.traceLogger.logTrace(508036124,E.k.Warning,"SharepointDomainUrl is not available"),this.handleWorkloadNavigation(Be.P[Be.P.People]))}}),ke(u,se.EnableFiles)&&d.push({key:"Files",name:Ie.p.Strings.PlanHeader_PlanHeaderWorkloadFiles,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,Be.P[Be.P.Documents]),"navigateToWorkloadDocuments"):this.handleWorkloadNavigation(Be.P[Be.P.Documents])}}),ke(u,se.EnableNotebook)&&d.push({key:"Notebook",name:Ie.p.Strings.PlanHeader_PlanHeaderWorkloadNotebook,onClick:()=>{a?this.openLink(this.getSpoWorkloadUrl(s.externalId,Be.P[Be.P.Notebook]),"navigateToWorkloadNotebook"):this.handleWorkloadNavigation(Be.P[Be.P.Notebook])}}),ke(u,se.EnableSites)&&d.push({key:"Sites",name:Ie.p.Strings.PlanHeader_PlanHeaderWorkloadSites,onClick:()=>{this.openLink(vt.G(p.Lf.SharepointSiteUrlFormat,a,null===s||void 0===s?void 0:s.externalId),"navigateToWorkloadSites")}}),me()(d)||d.push({key:"divider_1",name:"-",itemType:ye.G.Divider}),t!==Te.DisableAll&&null!=r){const a=ae.getLinksCapabilitiesForPlan(s,i.length,r.container.containerType,l);if(be(a,ie.EnableFavorite)){const e=n?Ie.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ie.p.Strings.PlanHeader_PlanHeaderAddPinned;d.push({key:"ToggleFavorite",name:e,onClick:this.togglePlanFavorite.bind(this)})}if(be(a,ie.EnableCopy)&&null!=e.onClickCopyPlan&&t===Te.DisableNothing&&d.push({key:"CopyPlan",name:Ie.p.Strings.PlanHeader_CopyPlanText,onClick:()=>e.onClickCopyPlan(r.id)}),c&&d.push({key:"CopyPlanToProject",name:Ie.p.Strings.PlanHeader_CopyPlanToProjectText,onClick:()=>this.openLink((0,$n.lo)(r.id),"navigateToImportPlanInProject")}),be(a,ie.EnableExport)&&this.showExportPlanToExcel()&&d.push({key:"ExportPlanToExcel",name:Ie.p.Strings.PlanHeader_PlanHeaderExportPlanToExcel,onClick:()=>e.onClickExportPlanToExcel(r.id)}),be(a,ie.EnableCopyLink)&&d.push({key:"copyLinkToPlan",name:Ie.p.Strings.PlanHeader_CopyLinkToPlanText,onClick:this.onClickCopyLinkToPlan.bind(this)}),be(a,ie.EnableSettings)&&t===Te.DisableNothing&&d.push({key:"PlanSettings",name:Ie.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>{var e;return this.openPlanSettingsPanel(r.id,null!==(e=this.headerMoreOptionsButtonRef.current)&&void 0!==e?e:void 0)}}),be(a,ie.EnableCalendar)&&null!=o&&o.ICalendar){const e=this.getCalendarLink();null!=e&&d.push(e)}be(a,ie.EnableLeave)&&d.push({key:"LeavePlan",name:Ie.p.Strings.PlanHeader_PlanHeaderLeavePlan,onClick:()=>this.openLeavePlanDialog(r.id)}),be(a,ie.EnableJoin)&&d.push({key:"Join",name:Ie.p.Strings.PlanHeader_PlanHeaderJoin,onClick:e.joinGroup.bind(this)})}return d}getCalendarLink(){const{callbacks:e,plan:t,planContainer:o,planDetails:n,userOutlookCalendarUrlToPublishTasks:r}=this.props;let s=null;return(null===o||void 0===o?void 0:o.containerType)===de.K.Group&&(s=o.unifiedGroupDetails)?(null===(i=s)||void 0===i?void 0:i.currentUserRelationToGroup)===ue.N.Owner?{key:"AddPlanToCalendar",name:Ie.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:e.openTasksICalendarDialog.bind(this,t.id)}:n&&(null===(a=s)||void 0===a?void 0:a.currentUserRelationToGroup)===ue.N.Member&&n.iCalendarPublishEnabled&&r?{key:"AddPlanToCalendar",name:Ie.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:()=>{this.context.usageLogger.logData("PlanHeader","publishPlanTasksToOutlookCalendar ",{planID:t.id}),Xn.b.safelyOpenExternalUrl(r,"_blank")}}:null:{key:"AddPlanToCalendar",name:Ie.p.Strings.PlanHeader_PublishPlanTasksToCalendar,onClick:e.openTasksICalendarDialog.bind(this,t.id)};var i,a}togglePlanFavorite(){const{callbacks:e,isCurrentPlanFavorite:t}=this.props;this.logUsage(t?g.M.RemoveFromFavorite:g.M.AddToFavorite),e.updatePlanFavoriteStatus(!t)}getBreadcrumbItemsInfo(){var e;const{callbacks:t,flights:o,plan:n,planContainer:r}=this.props,s=(0,Ce.g)(n.contexts);if((null===r||void 0===r?void 0:r.containerType)!==de.K.DriveItem&&me()(s))return;const i=null!==(e=null===r||void 0===r?void 0:r.displayName)&&void 0!==e?e:"",a=[];if(o.EnableDocumentTasks&&(null===r||void 0===r?void 0:r.containerType)===de.K.DriveItem&&null!==t.getBreadcrumbUrl(null===r||void 0===r?void 0:r.externalId))a.push({key:"DocPlanBreadcrumb",text:n.title,onClick:()=>this.openOriginalDocument(n)});else if(null!=s){const e=n.contexts[s],t=(0,ft.e)(e,i);Pt()(t,(e,t)=>{a.push({key:e+t,text:e})})}return a}findSelectedIndex(){const e=this;return un()(this.getPrimaryPagePivotLinksInfo(),t=>t.id===e.props.currentPage)}isUserCurrentGroupMembership(){const{planContainer:e}=this.props;if((null===e||void 0===e?void 0:e.containerType)!==de.K.Group)return!1;const t=e;return!(!t.unifiedGroup||!t.unifiedGroupDetails)&&t.unifiedGroupDetails.currentUserRelationToGroup!==ue.N.NonMember}handleWorkloadNavigation(e){var t,o;if((null===(t=this.props.planContainer)||void 0===t?void 0:t.containerType)!==de.K.Group)return;const n=null===(o=this.props.planContainer.unifiedGroupDetails)||void 0===o?void 0:o.getWorkloadUrl(e);this.context.traceLogger.logTrace(508036123,E.k.Info,"Workload navigation [Name=".concat(e,"][HasUrl=").concat(!!n,"]")),n?this.openLink(n,"navigateToWorkload"+e):this.showWorkloadErrorDialog(e)}openLink(e,t){this.logUsage(t),Xn.b.safelyOpenExternalUrl(e,"_blank")}openOriginalDocument(e){const t=this.props.callbacks.getBreadcrumbUrl(e.container.externalId);return t&&this.openLink(t,"openOriginalDocument")}showWorkloadErrorDialog(e){this.setState(t=>({workloadNameToShowInMissingWorkloadErrorDialog:e}))}closeWorkloadErrorDialog(){this.setState(e=>({workloadNameToShowInMissingWorkloadErrorDialog:null}))}onClickCopyLinkToPlan(){const{callbacks:e,plan:t}=this.props,o={planId:t.id};this.logUsage("copyPlanLinkPlanHeader",o),e.copyLinkToPlan(t.id)}showExportPlanToExcel(){const{callbacks:e,disableMode:t}=this.props,o=t===Te.DisableNothing,n=null!=e.onClickExportPlanToExcel;return o&&n}constructor(e,t){super(e,t),this.moreButtonRef=z.createRef(),this.fallbackContextInfoProvider=()=>{const{planContainer:e,sensitivityLabels:t}=this.props;let o="";if((null===e||void 0===e?void 0:e.containerType)===de.K.Group){const n=e;n.unifiedGroup&&(o=n.unifiedGroup.getDetailedInfo(t))}return o},this.toggleFavoriteButtonClick=()=>{this.logUsage(this.props.isCurrentPlanFavorite?g.M.RemoveFromFavorite:g.M.AddToFavorite),this.togglePlanFavorite()},this.dismissMembersCallout=()=>{this.setState(e=>({isMembersCalloutVisible:!1}))},this.toggleMembersCallout=()=>{this.setState(e=>{const t=!e.isMembersCalloutVisible;return t&&this.onOpenMembersCallout(),{isMembersCalloutVisible:t}})},this.toggleAppMoreOptionsContextMenu=()=>{this.setState(e=>({isAppMoreOptionsContextMenuVisible:!e.isAppMoreOptionsContextMenuVisible}))},this.closeAppMoreOptionsContextMenu=()=>{this.setState({isAppMoreOptionsContextMenuVisible:!1})},this.onClickHeaderPivotLink=e=>{const{callbacks:t}=this.props;switch(this.logUsage(e.id+"Clicked"),e.id){case d.EC.PlanTaskboard:t.navigateToPage(d.EC.PlanTaskboard);break;case d.EC.PlanCharts:t.navigateToPage(d.EC.PlanCharts);break;case d.EC.PlanSchedule:t.navigateToPage(d.EC.PlanSchedule);break;case d.EC.PlanGrid:t.navigateToPage(d.EC.PlanGrid);break;case d.EC.PlanTimeline:this.logUsage(g.M.PlanTimelineViewClicked),t.navigateToPage(d.EC.PlanTimeline)}},this.state={workloadNameToShowInMissingWorkloadErrorDialog:null,isMembersCalloutVisible:!1,isAppMoreOptionsContextMenuVisible:!1}}}var tr=o(96426),or=o(93589),nr=o(42463),rr=o(40488),sr=o(57433),ir=o(11660),ar=o(48709);const lr=(0,Q.J9)(e=>{let t="";switch(e){case ce.Sx.Dark:t=Re.z.NeutralPrimaryAlt;break;case ce.Sx.Light:t=Re.z.NeutralLighter;break;case ce.Sx.TeamsLight:t=Re.z.White;break;case ce.Sx.TeamsDark:t=Re.z.Black;break;case ce.Sx.TeamsContrast:t=ar.kd.gray150}return{backgroundColor:t}}),cr=(0,Q.J9)(e=>{let t="";switch(e){case ce.Sx.Dark:t=Re.z.FontColorThemeLight;break;case ce.Sx.Light:case ce.Sx.TeamsLight:t=Re.z.FontColorThemeDark;break;case ce.Sx.SharePoint:t=Re.z.SharepointButtonHoverColor();break;case ce.Sx.TeamsDark:case ce.Sx.TeamsContrast:t=Re.z.White}return{color:t}}),pr=(0,Q.J9)((e,t)=>({root:[(0,Ne.gS)("row","nowrap"),{position:"relative"},e===ce.Sx.TeamsLight&&{background:t?Ue.B.HeaderlessTeamsBackgroundColor:Re.z.TeamsLightBackgroundColor},e===ce.Sx.TeamsDark&&{background:Re.z.TeamsDarkBackgroundColor},e===ce.Sx.TeamsContrast&&{backgroundColor:Re.z.Black},e===ce.Sx.SharePoint&&{background:Re.z.SharepointBackgroundColor()}],background:[(0,Ne.GD)(),(0,Ne.gS)("row","nowrap"),Ne.cc],columns:[(0,Ne.gS)("row","nowrap"),(0,Ne.$Z)(),{alignItems:"flex-start"}],column:[(0,Ne.GD)("276px"),(0,Ne.gS)("column","nowrap"),{alignItems:"stretch",width:"276px",margin:"0px 15px"}],addTaskButtonShadow:[lr(e),e===ce.Sx.SharePoint&&{border:"1px solid "+Re.z.SharepointTextFontColor()},{marginBottom:"15px",height:"40px"}],taskCardShadow:[lr(e),e===ce.Sx.SharePoint&&{border:"1px solid "+Re.z.SharepointTextFontColor()},{marginTop:"7px",height:"98px"}],foreground:[(0,Ne.gS)("column","nowrap"),Ne.cc,{position:"absolute",top:0,left:0,right:0,bottom:0}],mainText:[cr(e),{fontSize:Y.s.xxLarge,fontWeight:Y.BO.semibold,marginBottom:"7px"}],subText:[cr(e),{fontSize:Y.s.mediumPlus,fontWeight:Y.BO.semibold,marginBottom:"10px"}]})),dr=(0,Q.J9)((e,t)=>{const o=pr(e,t);return{root:(0,Y.Zq)("planCreationInProgressView",o.root),background:(0,Y.Zq)("background",o.background),columns:(0,Y.Zq)("columns",o.columns),column:(0,Y.Zq)("column",o.column),addTaskButtonShadow:(0,Y.Zq)("addTaskButtonShadow",o.addTaskButtonShadow),taskCardShadow:(0,Y.Zq)("taskCardShadow",o.taskCardShadow),foreground:(0,Y.Zq)("foreground",o.foreground),mainText:(0,Y.Zq)("mainText",o.mainText),subText:(0,Y.Zq)("subText",o.subText)}});class ur extends pe.${name(){return"PlanCreationInProgressView"}renderComponent(){const e=this.getClassNames();return z.createElement("div",{className:e.root},z.createElement("div",{className:e.background},z.createElement("div",{className:e.columns},z.createElement("div",{className:e.column},z.createElement("div",{className:e.addTaskButtonShadow}),z.createElement("div",{className:e.taskCardShadow})),z.createElement("div",{className:e.column},z.createElement("div",{className:e.addTaskButtonShadow}),z.createElement("div",{className:e.taskCardShadow}),z.createElement("div",{className:e.taskCardShadow}),z.createElement("div",{className:e.taskCardShadow})),z.createElement("div",{className:e.column},z.createElement("div",{className:e.addTaskButtonShadow}),z.createElement("div",{className:e.taskCardShadow}),z.createElement("div",{className:e.taskCardShadow})))),z.createElement("div",{className:e.foreground},z.createElement("div",{className:e.mainText},Ie.p.Strings.PlanCreationInProgressView_MainText),z.createElement("div",{className:e.subText},Ie.p.Strings.PlanCreationInProgressView_SubText),z.createElement(q.j,{className:"redirectButton",onClick:()=>this.props.onClickNavigateToHub()},Ie.p.Strings.PlanCreationInProgressView_ReturnToHubButtonText)))}getClassNames(){const{theme:e}=this.props;return dr(e,le.B.headerlessMode)}constructor(e,t){super(e,t)}}class hr extends pe.${name(){return"PlaceholderHeader"}renderComponent(){const e=this.getResponsiveHeaderClassNames(),t=["",e.hidePersonas,e.hideTitle,e.hidePivotText,e.hideDropdownText];return z.createElement(Dn,{sizeClasses:t,isAdditive:!0,className:this.getClassNames().root})}getClassNames(){return Ge(Ve(this.props.theme,this.props.topHeaderStyles))}getResponsiveHeaderClassNames(){return Qn(jn())}constructor(e,t){super(e,t)}}var gr=o(80708),mr=o(56128),Cr=o(42870),kr=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),br=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.perfActionCreator=n.props.perfActionCreator,n.pageReadyActionDispatched=!1,n.dataFetchStartTime=(new Date).getTime(),n}return kr(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.trySendPageReadyAction()},t.prototype.componentDidUpdate=function(t,o){e.prototype.componentDidUpdate.call(this,t,o),this.setTitle()},t.prototype.storeDidUpdate=function(){e.prototype.storeDidUpdate.call(this),this.trySendPageReadyAction()},t.prototype.getPageReadyExportName=function(){},t.prototype.getPageTitle=function(){return""},t.prototype.getPageReadyMetaTag=function(){},t.prototype.getPageReadyLoggingData=function(){},t.prototype.setTitle=function(){var e=this.getPageTitle();e&&(document.title=e)},t.prototype.trySendPageReadyAction=function(){!1===this.pageReadyActionDispatched&&this.checkForCriticalDataReady()&&(this.pageReadyActionDispatched=!0,this.perfActionCreator.pageReady(this.dataFetchStartTime,(new Date).getTime(),this.getPageReadyExportName(),this.getPageReadyMetaTag(),this.getPageReadyLoggingData()))},t}(Cr.M),Tr=o(56953);class Sr extends br{logUsage(e,t,o){this.props.loggers.usageLogger.logData(this.name(),e,t,o)}logError(e,t,o){Tr.v.logError(e,t,o,this.props.loggers.logHandler)}storeDidUpdate(){An()(super.storeDidUpdate,ce.c9.StoreUpdateThrottleThreshold).bind(this)()}async fetchCriticalData(e,t){(await e.viewActionCreatorProvider()).fetchViewData(e.viewPartitionKey)}fetchNonCriticalData(e,t){this.onViewCriticalDataFetchCompletion()}checkForCriticalDataReady(){const e=this.checkForCriticalViewDataReady();return e&&this.onViewCriticalDataFetchCompletion(),e}fetchCriticalDataWhenComponentDidUpdate(e,t){return super.fetchCriticalDataWhenComponentDidUpdate(e,t),this.props.viewPartitionKey!==e.viewPartitionKey}fetchNonCriticalDataWhenComponentDidUpdate(e,t){return super.fetchNonCriticalDataWhenComponentDidUpdate(e,t),this.props.viewPartitionKey!==e.viewPartitionKey}notifyInteractive(e){var t,o;null===(t=(o=this.props).onPageInteractive)||void 0===t||t.call(o,e)}getViewContext(){const{viewStore:e,viewPartitionKey:t}=this.props;return e.getViewContext(this.taskAccessContext,t)}async onSetLabelsCollapsedStateForView(e){const{viewPartitionKey:t,actionCreatorProviders:o}=this.props;(await o.viewTransformsActionCreator()).setCategoryLabelMode(this.taskAccessContext,e,t)}constructor(){super(...arguments),this.onCriticalDataReadyDispatched={},this.onViewCriticalDataFetchCompletion=async()=>{const{viewPartitionKey:e,viewActionCreatorProvider:t}=this.props;if(!this.onCriticalDataReadyDispatched[e]){this.onCriticalDataReadyDispatched[e]=!0;(await t()).onCriticalDataFetchCompletion(e),this.notifyInteractive()}},this.getTaskPermissions=e=>{const t=this.props.planStore.getPlan(e.planId);return this.props.permissionsStore.getTaskPermissions(e,t)},this.completedTaskClassifier=e=>e.isComplete(),this.onFilterMenuVisibleChange=e=>{this.setState({isFilterMenuVisible:e})},this.onUpdateTask=async(e,t)=>{var o;this.props.loggers.usageLogger.logData(this.name(),g.M.TaskUpdated,{taskCreationSourceType:null!==(o=e.taskCreationSourceType)&&void 0!==o?o:""});(await this.props.actionCreatorProviders.taskActionCreator()).updateTask(gr.F.builder.withTask(e).build(),gr.F.builder.withTask(t).build())},this.onUpdateTaskDetails=async(e,t)=>{(await this.props.actionCreatorProviders.taskActionCreator()).updateTaskDetails(e,t)},this.onUpdatePlanDetails=async(e,t)=>{(await this.props.actionCreatorProviders.planActionCreator()).updatePlanDetails(e,t)},this.onDeleteTask=async e=>{const t=this.props.taskStore.getTask(e),o=await this.props.actionCreatorProviders.taskActionCreator();t&&o.deleteTask(e,t.itemVersion)},this.onDeleteRecurringTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openDeleteRecurringTaskDialog(e,t)},this.onOpenTaskDetailsEditor=async(e,t)=>{const{appContextStore:o,actionCreatorProviders:n,userStore:r,flights:s,taskStore:i}=this.props;(await n.dialogActionCreator()).openTaskDetails(e,this.taskAccessContext,t);const a=r.getUserDetailsById(o.getCurrentUserId());if(null==a)return;let l=!1;if(s.EnablePalauCoachmark){var c;const t=i.getTask(e);l=null!==(c=null===t||void 0===t?void 0:t.isProjectTask())&&void 0!==c&&c}if(!l&&!a.getHasSeenTaskDetails()&&le.B.clientType!==h.s.Loop){(await n.walkthroughActionCreator()).setTeachingCallout(a,ce.Ox.TaskDetails,null,null)}},this.onRenderPersona=async e=>{const t=this.props.userStore.getUserPhotoById(e.id);if(!t||t===ce.S1.Photo){(await this.props.actionCreatorProviders.userActionCreator()).fetchUserPhoto(e)}},this.onShowAssigneeLimitError=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openAssigneeLimitErrorDialog(e)},this.onGroupByChange=async e=>{(await this.props.actionCreatorProviders.viewTransformsActionCreator()).setTaskGroupingState(this.taskAccessContext,e)},this.onFilterChange=async(e,t,o,n)=>{(await this.props.actionCreatorProviders.viewTransformsActionCreator()).setTaskFilter(this.getViewKey(),e,t,o,n)},this.getViewKey=()=>"".concat(this.taskAccessContext,"_").concat(this.props.viewPartitionKey),this.onCopyTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openCopyTaskDialog(e,t)},this.onMoveTaskClick=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openMoveTaskDialog(e,t)},this.onAssignTask=async(e,t,o,n)=>{const{taskStore:r,appContextStore:s,actionCreatorProviders:i,viewPartitionKey:a}=this.props;if(null==e||""===e)return;let l=r.getTask(t);null==l&&(l=(0,mo.YO)(t,a));const c=l.getClone();c&&(c.assignments[e]=new mr.I(s.getCurrentUserId(),new Date));(await i.taskActionCreator()).assignTask({userId:e,originalTask:l,updatedTask:c,elementToFocusOnDismiss:o,onAssignSuccess:n})},this.onOpenAssignCallout=async e=>{const{planStore:t,userStore:o,actionCreatorProviders:n,groupDocumentsStore:r}=this.props,s=t.getPlan(e);if(null!=s){if(null==o.getContainerUsers(s.container.externalId)){(await n.userActionCreator()).fetchUsersForContainer(s.container)}if(null!=s.sharedWithContainers)for(const e of s.sharedWithContainers)if(e.containerType===de.K.DriveItem&&null==r.getDriveItem(e.externalId)){(await n.groupDocumentsActionCreator()).fetchDriveItem(e.externalId)}}},this.getAssigneePool=e=>{var t;const{taskStore:o,planStore:n,userStore:r}=this.props,s=o.getTask(e),i=s?n.getPlan(s.planId):null,a=null===i||void 0===i?void 0:i.container;return a&&null!==(t=r.getContainerUsers(a.externalId))&&void 0!==t?t:[]},this.canUserAccessPlanViaSharedContainerOnly=e=>{const{permissionsStore:t,planStore:o}=this.props,n=o.getPlan(e);return null!=n&&(t.canAccessPlanViaSharedContainers(n.sharedWithContainers)&&!t.canAccessPlanViaHostContainer(n))},this.onDeleteBucket=async e=>{const{actionCreatorProviders:t,bucketStore:o,viewPartitionKey:n}=this.props,r=await t.bucketActionCreator();if("null"===e)r.deleteBucket(p.iR+n,"");else{const t=o.getBucket(e);r.deleteBucket(e,t?t.itemVersion:"")}},this.fetchReferencePreviewForTask=async e=>{(await this.props.actionCreatorProviders.taskActionCreator()).fetchReferencePreviewForTask(e)},this.onCopyLinkToTask=async e=>{(await this.props.actionCreatorProviders.taskActionCreator()).copyLinkToTask(e)},this.showInfoBanner=async e=>{(await this.props.actionCreatorProviders.notificationActionCreator()).showInfo(e)},this.alertUser=async(e,t,o)=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast(e,t,o)},this.getUsersWithKeyword=async e=>(await this.props.actionCreatorProviders.userActionCreator()).fetchUsersWithKeyword(e),this.navigateToPage=async(e,t,o,n)=>{(await this.props.actionCreatorProviders.navigationActionCreator()).navigate(e,t,o,n)},this.fetchPermissionsWithTaskContext=async e=>{(await this.props.actionCreatorProviders.containerActionCreator()).fetchPermissionsWithTaskContext(e)}}}const Pr=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.gS)("column","nowrap"),(0,Ne.$Z)(Ue.B.TopHeaderHeight),{padding:"".concat(Ue.B.TopHeaderPaddingTop," ").concat(Ue.B.TopHeaderHorizontalPadding," ").concat(Ue.B.TopHeaderPaddingBottom),overflowX:"auto","&.responsive":{overflowY:"hidden"}}],landmark:[(0,Ne.gS)("row","nowrap"),{height:"100%"}],leftAlignedSection:[(0,Ne.gS)("row","nowrap"),{alignItems:"center","> .primaryTextSection":{marginLeft:"12px",maxWidth:"220px"}}],rightAlignedSection:[(0,Ne.GD)("auto"),(0,Ne.gS)("row","nowrap"),{alignItems:"center","> div:first-child":{flexGrow:"1",flexShrink:"0",justifyContent:"flex-end"}}]};return(0,Y.TW)(o,t)}),vr=(0,Q.J9)(e=>({root:(0,Y.Zq)("LoopPlanHeader",e.root),landmark:(0,Y.Zq)("LoopPlanHeaderLandmark",e.landmark),leftAlignedSection:(0,Y.Zq)("leftAlignedSection",e.leftAlignedSection),rightAlignedSection:(0,Y.Zq)("rightAlignedSection",e.rightAlignedSection)}));class xr extends Pe{name(){return"LoopPlanHeader"}getClassNames(){return vr(Pr(this.props.theme,this.props.styles))}getResponsiveHeaderClassNames(){return Qn(jn())}renderComponent(){var e;const{contextDropdownProps:t,imageSource:o,isIconCircular:n,hideBadgeIcon:r,showGroupByMenuTitleValue:s,currentTaskGrouping:i,taskGroupingOptions:a,currentTaskFilter:l,plan:c,planBuckets:p,planCategories:d,isFilterCalloutVisible:u,sharedContainersListProps:h,renderContextDropdown:g,renderMembersDropdown:m,callbacks:C,planMembers:k,planContainer:b,sensitivityLabels:T,userPermissions:S,containerPermissions:P,theme:v}=this.props,x=this.getClassNames(),y=this.getResponsiveHeaderClassNames(),f=["",y.hidePivotText,y.hideDropdownText,y.hideTitle],A=c.title;return z.createElement(fe.$,{planContainerId:c.id,onRender:C.onRenderPlanPhoto},z.createElement(Dn,{sizeClasses:f,isAdditive:!0,className:x.root},z.createElement(Bn.H,{className:x.landmark,role:"banner"},z.createElement("div",{className:x.leftAlignedSection},z.createElement(Zn,{badgeIconAriaLabel:null===(e=C.getBadgeIconAriaLabel)||void 0===e?void 0:e.call(C),hideBadgeIcon:r,imageSource:o,isIconCircular:n,titleText:c.title,planMembers:k,planContainer:null!==b&&void 0!==b?b:null,sensitivityLabels:null!==T&&void 0!==T?T:null,hasSharedContainers:c.sharedWithContainers.length>0,theme:v}),z.createElement(Kn.g,{onClickTitleButton:C.onClickTitleButton,titleButtonAriaLabel:vt.G(Ie.p.Strings.PlanHeader_PlanTitleButtonAriaLabel,A),titleText:A,theme:v})),z.createElement("div",{className:x.rightAlignedSection},z.createElement(Sn,{renderContextDropdown:null===g||void 0===g||g,renderMembersDropdown:null===m||void 0===m||m,contextMenuProps:t,membersDropdownProps:{canUserAddGuests:null===S||void 0===S?void 0:S.canAddGuests,canUserViewMembers:null===P||void 0===P?void 0:P.canViewMembers,canUserAddMembers:null===P||void 0===P?void 0:P.canAddMembers,canUserRemoveMembers:null===P||void 0===P?void 0:P.canRemoveMembers,sharedContainersListProps:h,isMembersCalloutVisible:this.state.isMembersCalloutVisible,toggleMembersCallout:this.toggleMembersCallout,dismissMembersCallout:this.dismissMembersCallout},filtersDropdownProps:{renderNewFilterMenu:!0,currentTaskFilter:l,buckets:p,planCategories:d,isFilterCalloutVisible:u,taskData:this.props.taskData},groupByDropdownProps:{showGroupByMenuTitleValue:s,currentTaskGrouping:i,taskGroupingOptions:a},members:k,callbacks:C,theme:v}),z.createElement(nt,{moreOptionsContextMenuItems:this.getMoreOptionsMenuItems(),moreOptionsTooltip:Ie.p.Strings.PlanHeader_MoreText,headerMoreOptionsButtonRef:this.headerMoreOptionsButtonRef,theme:v})))))}getMoreOptionsMenuItems(){const{disableMode:e,plan:t,planContainer:o,planMembers:n,hasAccessViaSharedContainer:r}=this.props;if(e===Te.DisableAll||null==t)return[];const s=[],i=ae.getLinksCapabilitiesForPlan(null!==o&&void 0!==o?o:null,n.length,t.container.containerType,null!==r&&void 0!==r&&r);return be(i,ie.EnableSettings)&&s.push({key:"PlanSettings",name:Ie.p.Strings.PlanHeader_PlanHeaderPlanSettings,onClick:()=>{var e,o;return null===(e=this.openPlanSettingsPanel)||void 0===e?void 0:e.call(this,t.id,null!==(o=this.headerMoreOptionsButtonRef.current)&&void 0!==o?o:void 0)}}),be(i,ie.EnableLeave)&&s.push({key:"LeavePlan",name:Ie.p.Strings.PlanHeader_PlanHeaderLeavePlan,onClick:()=>{var e;return null===(e=this.openLeavePlanDialog)||void 0===e?void 0:e.call(this,t.id)}}),s.push({key:"Help",name:Ie.p.Strings.PlanHeader_PlanHeaderHelp,onClick:()=>this.openHelpLink()}),s}constructor(e,t){super(e,t),this.dismissMembersCallout=()=>{this.setState(e=>({isMembersCalloutVisible:!1}))},this.toggleMembersCallout=()=>{this.setState(e=>{const t=!e.isMembersCalloutVisible;return t&&this.onOpenMembersCallout(),{isMembersCalloutVisible:t}})},this.openHelpLink=()=>{Xn.b.safelyOpenExternalUrl(ce.$j.usePlannerComponent,"_blank")},this.state={isMembersCalloutVisible:!1}}}var yr=o(24369),fr=o(13706),Ar=o(56851),wr=o(67215),Dr={root:"ms-TagItem",text:"ms-TagItem-text",close:"ms-TagItem-close",isSelected:"is-selected"};var Br,Er=o(15199),Ir=(0,Ko.Z)(),Fr=(0,qo.I)(function(e){var t=e.theme,o=e.styles,n=e.selected,r=e.disabled,s=e.enableTagFocusInDisabledPicker,i=e.children,a=e.className,l=e.index,c=e.onRemoveItem,p=e.removeButtonAriaLabel,d=e.title,u=void 0===d?"string"===typeof e.children?e.children:e.item.name:d,h=e.removeButtonIconProps,g=e.removeButtonProps,m=z.createRef(),C=Ir(o,{theme:t,className:a,selected:n,disabled:r}),k=(0,Er.B)(),b=s?{"aria-disabled":r,tabindex:0}:{disabled:r};return z.createElement("div",{"data-selection-index":l,className:C.root,role:"listitem",key:l,onClick:function(){var e;null===(e=m.current)||void 0===e||e.focus()}},z.createElement("span",{className:C.text,title:u,id:"".concat(k,"-text")},i),z.createElement(fr.K,(0,Ar.__assign)({componentRef:m,id:k,onClick:c},b,{iconProps:null!==h&&void 0!==h?h:{iconName:"Cancel"},styles:{icon:{fontSize:"12px"}},className:C.close,"aria-labelledby":"".concat(k,"-removeLabel ").concat(k,"-text")},g)),z.createElement("span",{id:"".concat(k,"-removeLabel"),hidden:!0},p))},function(e){var t,o,n,r,s,i,a=e.className,l=e.theme,c=e.selected,p=e.disabled,d=l.palette,u=l.effects,h=l.fonts,g=l.semanticColors,m=(0,Y.Km)(Dr,l);return{root:[m.root,h.medium,(0,Y.gm)(l),{boxSizing:"content-box",flexShrink:"1",margin:2,height:26,lineHeight:26,cursor:"default",userSelect:"none",display:"flex",flexWrap:"nowrap",maxWidth:300,minWidth:0,borderRadius:u.roundedCorner2,color:g.inputText,background:d.neutralLighter,selectors:(t={":hover":[!p&&!c&&{color:d.neutralDark,background:d.neutralLight,selectors:{".ms-TagItem-close":{color:d.neutralPrimary}}},p&&{background:d.neutralLighter}]},t[Y.up]={border:"1px solid ".concat(c?"WindowFrame":"WindowText")},t)},p&&{selectors:(o={},o[Y.up]={borderColor:"GrayText"},o)},c&&!p&&[m.isSelected,{":focus-within":(n={background:d.themePrimary,color:d.white},n[Y.up]={color:"HighLightText",background:"Highlight"},n)}],a],text:[m.text,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:30,margin:"0 8px"},p&&{selectors:(r={},r[Y.up]={color:"GrayText"},r)}],close:[m.close,(0,Y.gm)(l,{borderColor:"transparent",inset:1,outlineColor:d.white}),{color:d.neutralSecondary,width:30,height:"100%",flex:"0 0 auto",borderRadius:(0,Me.jI)(l)?"".concat(u.roundedCorner2," 0 0 ").concat(u.roundedCorner2):"0 ".concat(u.roundedCorner2," ").concat(u.roundedCorner2," 0"),selectors:(s={":hover":{background:d.neutralQuaternaryAlt,color:d.neutralPrimary}},s[".".concat(m.isSelected," &:focus")]={color:d.white,background:d.themePrimary},s[":focus:hover"]={color:d.white,background:d.themeDark},s[":active"]={color:d.white,backgroundColor:d.themeDark},s)},p&&{selectors:(i={},i[".".concat(wr._.msButtonIcon)]={color:d.neutralSecondary},i)}]}},void 0,{scope:"TagItem"}),Lr=o(27663),Mr=o(50861);!function(e){e.color0="rgb(104, 123, 33)",e.color1="rgb(76, 119, 168)",e.color2="rgb(177, 87, 144)",e.color3="rgb(0, 163, 0)",e.color4="rgb(30, 113, 69)",e.color5="rgb(217, 0, 128)",e.color6="rgb(126, 56, 120)",e.color7="rgb(96, 60, 186)",e.color8="rgb(0, 130, 129)",e.color9="rgb(0, 120, 212)",e.color10="rgb(43, 87, 151)",e.color11="rgb(196, 74, 38)",e.color12="rgb(185, 29, 71)",e.color13="rgb(226, 16, 16)"}(Br||(Br={}));const Nr=(0,Q.J9)(e=>{if(null==Br[e])return"";const t={backgroundColor:Br[e]};return(0,Y.Zq)(t)});var Rr=o(66987),Ur=o(9117);const Or=(0,Q.J9)((e,t,o,n)=>{const r={borderRadius:"4px",width:"".concat(t,"px"),height:"".concat(t,"px")},s={root:[(0,J.gS)(),(0,J.GD)(),{justifyContent:"space-between",padding:"0 ".concat("12px")}],initialsWrapper:[(0,J.gS)(),J.cc,(0,Ur.kE)(e),r],initialsText:{fontSize:Y.s.size10,fontWeight:Y.BO.semibold,color:Rr.J.White},subComponentStyles:{icon:{root:[(0,Ur.kE)(e),r,{"> svg":{width:"".concat(o,"px"),height:"".concat(o,"px")}}]},image:{root:r}}};return(0,Y.TW)(s,n)}),Hr=(0,Q.J9)(e=>({root:(0,Y.Zq)("dynamic-icon",e.root),initialsWrapper:(0,Y.Zq)("initials-wrapper",e.initialsWrapper),initialsText:(0,Y.Zq)("initials-text",e.initialsText)}));var Vr=o(11597);const Gr=e=>{const{stateBasedIcons:t,focused:o,name:n,styles:r,size:s=24,iconSvgSize:i=20}=e,a=(0,Z.D)(),l=Or(a,s,i,r),{initialsWrapper:p,initialsText:d}=Hr(l),{image:u,icon:h}=l.subComponentStyles;if(null==t){if(null!=n){const e=(0,Vr.cc)(n),t=Nr(function(e){const t=(0,Vr.fV)(e,Rr.C);return t<0?"":"color"+t}(n));return z.createElement("div",{className:(0,Qe.A)(p,t)},z.createElement("span",{className:d},e))}return null}if("string"===typeof t)return z.createElement(Lr._,{styles:u,imageFit:Mr.N_.cover,src:t,alt:""});{const e=t;return o&&null!=e.focusedIcon?z.createElement(xe.I,(0,c.A)({styles:h},e.focusedIcon)):z.createElement(xe.I,(0,c.A)({styles:h},e.normalIcon))}};var Wr;!function(e){e.Invalid="invalid",e.PlannerUser="plannerUser",e.Group="group",e.TeamsConversation="teamsConversation",e.DriveItem="driveItem",e.Roster="roster",e.Project="project",e.User="user",e.ToDo="todo"}(Wr||(Wr={}));var _r=o(90203);const zr={subComponentStyles:{icon:{root:{background:"linear-gradient(224deg, ".concat("#B377E0"," 1.02%, ").concat("#5166D7"," 123.98%)"),color:Rr.J.White,":hover":{color:Rr.J.White}}},image:{}}},Zr=e=>{const{containerType:t,containerPhoto:o,focused:n=!1,showIconOnly:r,name:s,size:i=20,iconSvgSize:a=16}=e,l=(0,z.useMemo)(()=>r||t!==Wr.Group?{normalIcon:_r.mU,focusedIcon:_r._P}:o,[t,o,r]);return z.createElement(Gr,{name:s,focused:n,stateBasedIcons:l,size:i,iconSvgSize:a,styles:zr})};var Kr=o(91900);const qr=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.$Z)(),(0,Ne.gS)("row","nowrap"),{alignItems:"center","> div":(0,Ne.gS)(),paddingRight:"24px"}],linkedBadgeDropdown:[Ne.xK,{color:e.palette.neutralSecondary,fontSize:Y.s.small,textDecoration:"none",cursor:"pointer"}],linkedBadgeItem:[Ne.$Z,(0,Ne.gS)("row","nowrap"),{alignItems:"center","> .delinkIcon":[(0,Ne.gS)("row","nowrap"),{"> .plannerDivider":[{color:e.palette.neutralQuaternaryAlt}],"> .plannerLinkDismiss":{color:e.semanticColors.errorIcon}}],"> .plannerChevronDownSmall":{color:e.palette.neutralPrimary,marginLeft:"8px",":hover, :active":{color:e.palette.themePrimary}}}],dividerContainer:[(0,Ne.gS)(),Ne.cc,{".plannerChevronRightSmall":{color:e.palette.neutralSecondary,padding:"1px 4px 0px 4px"}}],planAvatar:[(0,Ne.gS)(),{marginRight:"8px"}],planTitle:[(0,Ne.gS)(),{fontWeight:Y.BO.bold,fontSize:Y.s.size16,paddingBottom:"4px"}],titleSideTag:[(0,Ne.gS)(),{marginLeft:"8px",marginRight:"8px",fontSize:Y.s.size12,backgroundColor:e.palette.neutralLighter,"> .ms-TagItem-close":{display:"none"}}]};return(0,Y.pB)(void 0,o,t)}),jr=(0,Q.J9)(e=>({root:(0,Y.Zq)("planTitleSection",e.root),linkedBadgeDropdown:(0,Y.Zq)("linkedBadgeDropdown",e.linkedBadgeDropdown),linkedBadgeItem:(0,Y.Zq)("linkedBadgeItem",e.linkedBadgeItem),dividerContainer:(0,Y.Zq)("dividerContainer",e.dividerContainer),planAvatar:(0,Y.Zq)("planAvatar",e.planAvatar),planTitle:(0,Y.Zq)("planTitle",e.planTitle),titleSideTag:(0,Y.Zq)("titleSideTag",e.titleSideTag)})),Qr=e=>{const{theme:{palette:t}}=e;return{root:{margin:"0px"},listItem:[{"&:first-child > .ms-Breadcrumb-itemLink":{fontSize:Y.s.size14},"&:last-child > .ms-Breadcrumb-itemLink":{fontWeight:Y.BO.bold,fontSize:Y.s.size16,maxWidth:"30ch"}}],itemLink:{padding:"0px",":active, :active:hover, :hover":{background:"transparent",textDecoration:"underline"}},overflowButton:[{color:t.neutralSecondary,":focus-visible":[{outlineColor:"initial",outlineStyle:"auto"}],height:"14px"}]}},Yr=(0,Q.J9)(e=>({root:{marginLeft:"8px",height:"24px",width:"24px",color:e.palette.neutralPrimary},rootPressed:{color:e.palette.themePrimary,backgroundColor:"inherit"}})),Jr=e=>{let{isCurrentPlanPinned:t,styles:o,theme:n,plan:r,imageSource:s,breadcrumbItems:i,contextDropdownProps:a,togglePlanPinUnpinStatus:l,isTeamsTabView:p,onRenderPlanPhoto:d,isReadOnly:u}=e;const h=(0,Z.D)(),g=jr(qr(h,o)),m=()=>a&&(a.visibleContextKeys.length>0||a.contextMenuItemCallbacks)?z.createElement(At,(0,c.A)((0,c.A)({},a),{},{className:g.linkedBadgeDropdown,isBeakVisible:!1,onRenderLabel:e=>z.createElement("div",{className:g.linkedBadgeItem},z.createElement(xe.I,ot.u2),(()=>{if(a&&a.visibleContextKeys.length>0){const e=a.contextDetails;if(!e)return null;if(null!=Jn()(e,e=>e.status===yt.$.Delinked))return z.createElement("div",{className:"delinkIcon"},z.createElement(xe.I,ot.Zl),z.createElement(xe.I,ot.aA))}return null})()),theme:n})):null,C=z.useCallback(()=>{const e=z.createElement("div",{className:g.planAvatar},z.createElement(Zr,{containerType:r.container.containerType,containerPhoto:s,name:r.title}));return z.createElement(Kr.n,{containerId:r.id,onLoad:d},e)},[g.planAvatar,s,r,d]),k=z.useCallback(e=>z.createElement("div",{className:g.dividerContainer},z.createElement(xe.I,ot.gO),C()),[C,g.dividerContainer]),b=()=>{const e=Ie.p.Strings.UnoPlanHeader_ReadOnlyTag;return z.createElement(Fr,{item:{key:e,name:e},index:0,tabIndex:0,id:"sideInfoTagItem",className:g.titleSideTag},e)};return p?z.createElement("div",{className:g.root},C(),z.createElement("div",{className:g.planTitle}," ",r.title," "),m(),u&&b()):z.createElement("div",{className:g.root},z.createElement(ve.Q,{items:i,className:"planHeader-breadcrumb",maxDisplayedItems:2,overflowAriaLabel:"",dividerAs:k,styles:Qr,onReduceData:()=>{}}),m(),(()=>{const e=t?Ie.p.Strings.PlanHeader_PlanHeaderRemovePinned:Ie.p.Strings.PlanHeader_PlanHeaderAddPinned,o=t?ot.s1:ot.ol;return z.createElement(ir.S,{hostClassName:"pin-button-tooltiphost",content:e,delay:yr.H.medium,directionalHint:Xe.A.bottomRightEdge},z.createElement(fr.K,{onClick:l,className:"toggleFavoriteIcon",ariaLabel:e,styles:Yr(h),onRenderIcon:()=>z.createElement(z.Fragment,null,z.createElement(xe.I,(0,c.A)((0,c.A)({},o),{},{className:(0,Qe.A)(o.className,"regularPin")})))}))})(),u&&b())};var Xr=o(29344),$r=o(62672);const es=(0,Q.J9)(e=>({root:[(0,J.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto",marginTop:"-4px"}]})),ts=(0,Q.J9)(e=>({root:(0,Y.Zq)("overflowMenu",e.root)})),os=(0,Q.J9)(e=>({header:{color:e.palette.neutralPrimary,marginLeft:"-20px",".ms-ContextualMenu-icon":{color:e.palette.themeSecondary,marginTop:"8px",order:"2",paddingRight:"10px"}},container:{overflowY:"auto"}})),ns="upsellOverflowMenuButtonClassName",rs=e=>{let{menuItems:t,dropdownMenuTitle:o,iconButtonTitle:n}=e;const r=(0,Z.D)(),[s,i]=z.useState(!1),a=ts(es(r)),l=(0,z.useCallback)(()=>{if(!s)return null;const e=[{key:"AddPremiumViews",itemType:ye.G.Section,sectionProps:{title:{key:"AddPremiumViews",text:o,iconProps:_r.aM},items:t}}];return z.createElement($r.l,{shouldFocusOnMount:!0,items:e,directionalHint:Xe.A.bottomAutoEdge,target:".".concat(ns),onDismiss:()=>i(!1),styles:os(r)})},[o,t,s,r]);return z.createElement("div",{className:a.root},z.createElement(fr.K,{title:n,className:ns,id:Xr.hN.HeaderMoreOptionsButton,iconProps:_r.XP,onClick:()=>i(!s)}),l())};var ss=o(40440),is=o(37178),as=o(17066),ls=o(27480),cs=o(87633);function ps(e,t){void 0===t&&(t=null);var o=z.useRef({ref:function(){var e=function(e){o.ref.current!==e&&(o.cleanup&&(o.cleanup(),o.cleanup=void 0),o.ref.current=e,null!==e&&(o.cleanup=o.callback(e)))};return e.current=t,e}(),callback:e}).current;return o.callback=e,o.ref}var ds=o(76682),us=o(44828),hs=function(e){var t=e.onOverflowItemsChanged,o=e.rtl,n=e.pinnedIndex,r=z.useRef(),s=z.useRef(),i=ps(function(e){var t=function(e,t){if("undefined"!==typeof ResizeObserver){var o=new ResizeObserver(t);return Array.isArray(e)?e.forEach(function(e){return o.observe(e)}):o.observe(e),function(){return o.disconnect()}}var n=function(){return t(void 0)},r=(0,us.z)(Array.isArray(e)?e[0]:e);if(!r)return function(){};var s=r.requestAnimationFrame(n);return r.addEventListener("resize",n,!1),function(){r.cancelAnimationFrame(s),r.removeEventListener("resize",n,!1)}}(e,function(t){s.current=t?t[0].contentRect.width:e.clientWidth,r.current&&r.current()});return function(){t(),s.current=void 0}}),a=ps(function(e){return i(e.parentElement),function(){return i(null)}});return(0,ds.E)(function(){var e=i.current,l=a.current;if(e&&l){for(var c=[],p=0;p<e.children.length;p++){var d=e.children[p];d instanceof HTMLElement&&d!==l&&c.push(d)}var u=[],h=0;r.current=function(){var e=s.current;if(void 0!==e){for(var t=c.length-1;t>=0;t--){if(void 0===u[t]){var r=o?e-c[t].offsetLeft:c[t].offsetLeft+c[t].offsetWidth;t+1<c.length&&t+1===n&&(h=u[t+1]-r),t===c.length-2&&(h+=l.offsetWidth),u[t]=r+h}if(e>u[t])return void m(t+1)}m(0)}};var g=c.length,m=function(e){g!==e&&(g=e,t(e,c.map(function(t,o){return{ele:t,isOverflowing:o>=e&&o!==n}})))},C=void 0;if(void 0!==s.current){var k=(0,us.z)(e);if(k){var b=k.requestAnimationFrame(r.current);C=function(){return k.cancelAnimationFrame(b)}}}return function(){C&&C(),m(c.length),r.current=void 0}}}),{menuButtonRef:a}},gs=o(78233),ms=o(9833),Cs=function(e){function t(t){var o=e.call(this,t)||this;return(0,gs.f)(o),(0,ms.A)("PivotItem",t,{linkText:"headerText"}),o}return(0,Ar.__extends)(t,e),t.prototype.render=function(){return z.createElement("div",(0,Ar.__assign)({},(0,as.G1)(this.props,as.JM)),this.props.children)},t}(z.Component),ks=(0,Ko.Z)(),bs=function(e,t){var o={links:[],keyToIndexMapping:{},keyToTabIdMapping:{}};return z.Children.forEach(z.Children.toArray(e.children),function(n,r){if(Ts(n)){var s=n.props,i=s.linkText,a=(0,Ar.__rest)(s,["linkText"]),l=n.props.itemKey||r.toString();o.links.push((0,Ar.__assign)((0,Ar.__assign)({headerText:i},a),{itemKey:l})),o.keyToIndexMapping[l]=r,o.keyToTabIdMapping[l]=function(e,t,o,n){return e.getTabId?e.getTabId(o,n):t+"-Tab".concat(n)}(e,t,l,r)}else n&&(0,is.R)("The children of a Pivot component must be of type PivotItem to be rendered.")}),o},Ts=function(e){var t;return z.isValidElement(e)&&(null===(t=e.type)||void 0===t?void 0:t.name)===Cs.name},Ss=z.forwardRef(function(e,t){var o,n=z.useRef(null),r=z.useRef(null),s=(0,Er.B)("Pivot"),i=(0,ss.k)(e.selectedKey,e.defaultSelectedKey),a=i[0],l=i[1],c=e.componentRef,p=e.theme,d=e.linkSize,u=e.linkFormat,h=e.overflowBehavior,g=e.overflowAriaLabel,m=e.focusZoneProps,C=e.overflowButtonAs,k={"aria-label":e["aria-label"],"aria-labelledby":e["aria-labelledby"]},b=(0,as.G1)(e,as.JM,["aria-label","aria-labelledby"]),T=bs(e,s);z.useImperativeHandle(c,function(){return{focus:function(){var e;null===(e=n.current)||void 0===e||e.focus()}}});var S=function(e){if(!e)return null;var t=e.itemCount,n=e.itemIcon,r=e.headerText;return z.createElement("span",{className:o.linkContent},void 0!==n&&z.createElement("span",{className:o.icon},z.createElement(xe.I,{iconName:n})),void 0!==r&&z.createElement("span",{className:o.text}," ",e.headerText),void 0!==t&&z.createElement("span",{className:o.count}," (",t,")"))},P=function(e,t,n,r){var s,i=t.itemKey,a=t.headerButtonProps,l=t.onRenderItemLink,c=e.keyToTabIdMapping[i],p=n===i;s=l?l(t,S):S(t);var d=t.headerText||"";d+=t.itemCount?" ("+t.itemCount+")":"",d+=t.itemIcon?" xx":"";var u=t.role&&"tab"!==t.role?{role:t.role}:{role:"tab","aria-selected":p};return z.createElement(cs.c,(0,Ar.__assign)({},a,u,{id:c,key:i,className:(0,Qe.A)(r,p&&o.linkIsSelected),onClick:function(e){return v(i,e)},onKeyDown:function(e){return x(i,e)},"aria-label":t.ariaLabel,name:t.headerText,keytipProps:t.keytipProps,"data-content":d}),s)},v=function(e,t){t.preventDefault(),y(e,t)},x=function(e,t){t.which===ls.c.enter&&(t.preventDefault(),y(e,t))},y=function(t,o){var n;if(l(t),T=bs(e,s),e.onLinkClick&&T.keyToIndexMapping[t]>=0){var i=T.keyToIndexMapping[t],a=z.Children.toArray(e.children)[i];Ts(a)&&e.onLinkClick(a,o)}null===(n=r.current)||void 0===n||n.dismissMenu()};o=ks(e.styles,{theme:p,linkSize:d,linkFormat:u});var f=function(){return null===(e=a)||void 0!==e&&void 0!==T.keyToIndexMapping[e]?a:T.links.length?T.links[0].itemKey:void 0;var e}(),A=f?T.keyToIndexMapping[f]:0,w=T.links.map(function(e){return P(T,e,f,o.link)}),D=z.useMemo(function(){return{items:[],alignTargetEdge:!0,directionalHint:Xe.A.bottomRightEdge}},[]),B=hs({onOverflowItemsChanged:function(e,t){t.forEach(function(e){var t=e.ele,o=e.isOverflowing;return t.dataset.isOverflowing="".concat(o)}),D.items=T.links.slice(e).filter(function(e){return e.itemKey!==f}).map(function(t,n){return t.role="menuitem",{key:t.itemKey||"".concat(e+n),onRender:function(){return P(T,t,f,o.linkInMenu)}}})},rtl:(0,Me.jI)(p),pinnedIndex:A}).menuButtonRef,E=C||cs.c;return z.createElement("div",(0,Ar.__assign)({ref:t},b),z.createElement(Ro.R,(0,Ar.__assign)({componentRef:n,role:"tablist"},k,{direction:Uo.E.horizontal},m,{className:(0,Qe.A)(o.root,null===m||void 0===m?void 0:m.className)}),w,"menu"===h&&z.createElement(E,{className:(0,Qe.A)(o.link,o.overflowMenuButton),elementRef:B,componentRef:r,menuProps:D,menuIconProps:{iconName:"More",style:{color:"inherit"}},ariaLabel:g,role:"tab"})),f&&T.links.map(function(t){return(!0===t.alwaysRender||f===t.itemKey)&&function(t,n){if(e.headersOnly||!t)return null;var r=T.keyToIndexMapping[t],s=T.keyToTabIdMapping[t];return z.createElement("div",{role:"tabpanel",hidden:!n,key:t,"aria-hidden":!n,"aria-labelledby":s,className:o.itemContainer},z.Children.toArray(e.children)[r])}(t.itemKey,f===t.itemKey)}))});Ss.displayName="Pivot";var Ps=o(42815),vs={count:"ms-Pivot-count",icon:"ms-Pivot-icon",linkIsSelected:"is-selected",link:"ms-Pivot-link",linkContent:"ms-Pivot-linkContent",root:"ms-Pivot",rootIsLarge:"ms-Pivot--large",rootIsTabs:"ms-Pivot--tabs",text:"ms-Pivot-text",linkInMenu:"ms-Pivot-linkInMenu",overflowMenuButton:"ms-Pivot-overflowMenuButton"},xs=function(e,t,o){var n,r,s;void 0===o&&(o=!1);var i=e.linkSize,a=e.linkFormat,l=e.theme,c=l.semanticColors,p=l.fonts,d="large"===i,u="tabs"===a;return[p.medium,{color:c.actionLink,padding:"0 8px",position:"relative",backgroundColor:"transparent",border:0,borderRadius:0,selectors:{":hover":{backgroundColor:c.buttonBackgroundHovered,color:c.buttonTextHovered,cursor:"pointer"},":active":{backgroundColor:c.buttonBackgroundPressed,color:c.buttonTextHovered},":focus":{outline:"none"}}},!o&&[{display:"inline-block",lineHeight:44,height:44,marginRight:8,textAlign:"center",selectors:(n={},n[".".concat(Ps.Y2," &:focus, :host(.").concat(Ps.Y2,") &:focus")]={outline:"1px solid ".concat(c.focusBorder)},n[".".concat(Ps.Y2," &:focus:after, :host(.").concat(Ps.Y2,") &:focus:after")]={content:"attr(data-content)",position:"relative",border:0},n[":before"]={backgroundColor:"transparent",bottom:0,content:'""',height:2,left:8,position:"absolute",right:8,transition:"left ".concat(Y.cs.durationValue2," ").concat(Y.cs.easeFunction2,",\n                        right ").concat(Y.cs.durationValue2," ").concat(Y.cs.easeFunction2)},n[":after"]={color:"transparent",content:"attr(data-content)",display:"block",fontWeight:Y.BO.bold,height:1,overflow:"hidden",visibility:"hidden"},n)},d&&{fontSize:p.large.fontSize},u&&[{marginRight:0,height:44,lineHeight:44,backgroundColor:c.buttonBackground,padding:"0 10px",verticalAlign:"top",selectors:(r={":focus":{outlineOffset:"-2px"}},r[".".concat(Ps.Y2," &:focus::before, :host(.").concat(Ps.Y2,") &:focus::before")]={height:"auto",background:"transparent",transition:"none"},r["&:hover, &:focus"]={color:c.buttonTextCheckedHovered},r["&:active, &:hover"]={color:c.primaryButtonText,backgroundColor:c.primaryButtonBackground},r["&.".concat(t.linkIsSelected)]={backgroundColor:c.primaryButtonBackground,color:c.primaryButtonText,fontWeight:Y.BO.regular,selectors:(s={":before":{backgroundColor:"transparent",transition:"none",position:"absolute",top:0,left:0,right:0,bottom:0,content:'""',height:0},":hover":{backgroundColor:c.primaryButtonBackgroundHovered,color:c.primaryButtonText},":active":{backgroundColor:c.primaryButtonBackgroundPressed,color:c.primaryButtonText}},s[Y.up]=(0,Ar.__assign)({fontWeight:Y.BO.semibold,color:"HighlightText",background:"Highlight"},(0,Y.Qg)()),s)},r[".".concat(Ps.Y2," &.").concat(t.linkIsSelected,":focus, :host(.").concat(Ps.Y2,") &.").concat(t.linkIsSelected,":focus")]={outlineColor:c.primaryButtonText},r)}]]]},ys=(0,qo.I)(Ss,function(e){var t,o,n,r,s=e.className,i=e.linkSize,a=e.linkFormat,l=e.theme,c=l.semanticColors,p=l.fonts,d=(0,Y.Km)(vs,l),u="large"===i,h="tabs"===a;return{root:[d.root,p.medium,Y.S8,{position:"relative",color:c.link,whiteSpace:"nowrap"},u&&d.rootIsLarge,h&&d.rootIsTabs,s],itemContainer:{selectors:{"&[hidden]":{display:"none"}}},link:(0,Ar.__spreadArray)((0,Ar.__spreadArray)([d.link],xs(e,d),!0),[(t={},t["&[data-is-overflowing='true']"]={display:"none"},t)],!1),overflowMenuButton:[d.overflowMenuButton,(o={visibility:"hidden",position:"absolute",right:0},o[".".concat(d.link,"[data-is-overflowing='true'] ~ &")]={visibility:"visible",position:"relative"},o)],linkInMenu:(0,Ar.__spreadArray)((0,Ar.__spreadArray)([d.linkInMenu],xs(e,d,!0),!0),[{justifyContent:"start",height:36,lineHeight:36,width:"100%"}],!1),linkIsSelected:[d.link,d.linkIsSelected,{fontWeight:Y.BO.semibold,selectors:(n={":before":{backgroundColor:c.inputBackgroundChecked,selectors:(r={},r[Y.up]={backgroundColor:"Highlight"},r)},":hover::before":{left:0,right:0}},n[Y.up]={color:"Highlight"},n)}],linkContent:[d.linkContent,{flex:"0 1 100%",selectors:{"& > * ":{marginLeft:4},"& > *:first-child":{marginLeft:0}}}],text:[d.text,{display:"inline-block",verticalAlign:"top"}],count:[d.count,{display:"inline-block",verticalAlign:"top"}],icon:d.icon}},void 0,{scope:"Pivot"});const fs=e=>{const{theme:{palette:t,semanticColors:o}}=e;return{root:[(0,Ne.gS)("row","wrap")],link:{marginRight:"8px",color:t.neutralSecondary,":last-of-type":{marginRight:"4px"},["@media (max-width: ".concat(Ue.B.UnoSmallScreenWidth,")")]:{margin:"0xp",width:"36px",":hover":{backgroundColor:"transparent","::before":{backgroundColor:t.neutralTertiaryAlt},color:o.menuItemTextHovered}}},linkIsSelected:{"> span > .ms-TooltipHost > .ms-Pivot-linkContent > .ms-Pivot-icon":{color:t.themePrimary},"> span > .ms-TooltipHost > .ms-Pivot-linkContent > .ms-Pivot-text":{fontWeight:Y.BO.semibold,color:t.neutralPrimary},":hover":{"::before":{backgroundColor:t.themePrimary}}},icon:{"> i":{marginTop:"5px"}},text:{marginRight:"2px",["@media (max-width: ".concat(Ue.B.UnoSmallScreenWidth,")")]:{display:"none"}}}},As={root:{display:"block",height:"100%"}},ws=e=>{const{pivotItemProps:t,onSelectPivotItem:o,selectedPivotKey:n,showTooltip:r}=e,s=(e,t)=>{if(!e||!t)return null;const o=r?e.tooltipText:void 0;return z.createElement("div",{id:e.pivotElementId},z.createElement(ir.S,{styles:As,content:o,componentRef:e.tooltipRef},t(e)))},i=z.useCallback((e,t)=>{var n;if(null===t||void 0===t||t.stopPropagation(),null!=(null===e||void 0===e||null===(n=e.props)||void 0===n?void 0:n.itemKey)){const t=e.props.itemKey;o(t)}},[o]);return z.createElement(ys,{headersOnly:!0,onLinkClick:i,styles:fs,selectedKey:n},t.map(e=>{return z.createElement(Cs,(0,c.A)((0,c.A)({},e),{},{key:e.itemKey,onRenderItemLink:s,headerButtonProps:{onFocus:(t=e.tooltipRef,()=>{null!==t&&void 0!==t&&t.current&&t.current.show()})},ariaLabel:r?e.tooltipText:void 0}));var t}))},Ds=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.$Z)(),(0,Ne.gS)("row","nowrap"),{alignItems:"center","> div":(0,Ne.gS)()}]};return(0,Y.pB)(void 0,o,t)}),Bs=(0,Q.J9)(e=>({root:(0,Y.Zq)("planViewsPivots",e.root)}));var Es=o(66298);const Is=e=>{const t=(0,Z.D)(),o=Bs(Ds(t,e.styles)),{usageLogger:n}=(0,Es.t)(),r=z.useRef(null),s=z.useRef(null),i=z.useRef(null),a=z.useRef(null),l=e.plan.container.containerType,c=le.B.clientSettings.Flights.EnablePersonalPlanConversionUX?l!==de.K.Group&&l!==de.K.User:l!==de.K.Group,p=le.B.clientSettings.Flights.EnableUpsellOverflowMenuUpdate,u=()=>{const{onUpsellHookClick:t,showUpsellHooks:o}=e,n=[];return o&&(p||n.push({key:"AddMoreViews",name:Ie.p.Strings.SharedComponents_AddMoreViewsText,itemType:ye.G.Header,iconProps:ot.aM}),(p&&c||!p)&&n.push({key:d.EC.PlanTimeline,name:Ie.p.Strings.SharedComponents_PlanTimelinePageName,onClick:()=>t(d.EC.PlanTimeline),iconProps:ot.mF,disabled:c,canCheck:!0,checked:!1}),n.push({key:d.EC.PlanPeople,name:Ie.p.Strings.SharedComponents_PlanPeoplePageName,onClick:()=>t(d.EC.PlanPeople),iconProps:ot.CR,disabled:c,canCheck:!0,checked:!1}),n.push({key:d.EC.PlanGoals,name:Ie.p.Strings.SharedComponents_PlanGoalsPageName,onClick:()=>t(d.EC.PlanGoals),iconProps:ot.C,disabled:c,canCheck:!0,checked:!1}),n.push({key:d.EC.PlanAssignments,name:Ie.p.Strings.SharedComponents_PlanAssignmentsPageName,onClick:()=>t(d.EC.PlanAssignments),iconProps:ot.T6,disabled:c,canCheck:!0,checked:!1})),n},h=t=>{const{currentPage:o}=e;return t===o},g=u();return z.createElement("div",{className:o.root},z.createElement(ws,{pivotItemProps:(()=>{const t=[];return t.push({headerText:Ie.p.Strings.SharedComponents_PlanGridPageName,itemIcon:h(d.EC.PlanGrid)?ot.SG.iconName:ot.CY.iconName,itemKey:d.EC.PlanGrid,tooltipText:Ie.p.Strings.SharedComponents_PlanGridPageName,tooltipRef:r,pivotElementId:Xr.hN.GridViewPivot}),t.push({headerText:Ie.p.Strings.SharedComponents_PlanTaskboardPageName,itemIcon:h(d.EC.PlanTaskboard)?ot.fN.iconName:ot.fD.iconName,itemKey:d.EC.PlanTaskboard,tooltipText:Ie.p.Strings.SharedComponents_PlanTaskboardPageName,tooltipRef:s,pivotElementId:Xr.hN.BoardViewPivot}),t.push({headerText:Ie.p.Strings.SharedComponents_PlanSchedulePageName,itemIcon:h(d.EC.PlanSchedule)?ot._o.iconName:ot.cx.iconName,itemKey:d.EC.PlanSchedule,tooltipText:Ie.p.Strings.SharedComponents_PlanSchedulePageName,tooltipRef:i,pivotElementId:Xr.hN.ScheduleViewPivot}),t.push({headerText:Ie.p.Strings.SharedComponents_PlanChartsPageName,itemIcon:h(d.EC.PlanCharts)?ot.OH.iconName:ot.iH.iconName,itemKey:d.EC.PlanCharts,tooltipText:Ie.p.Strings.SharedComponents_PlanChartsPageName,tooltipRef:a,pivotElementId:Xr.hN.ChartsViewPivot}),e.showUpsellHooks&&!c&&p&&t.push({headerText:Ie.p.Strings.SharedComponents_PlanTimelinePageName,itemIcon:ot.aM.iconName,itemKey:d.EC.PlanTimeline,tooltipText:Ie.p.Strings.SharedComponents_PlanTimelineTooltip,pivotElementId:Xr.hN.TimelineViewPivot}),t})(),onSelectPivotItem:t=>{const{navigateToPage:o}=e;n.logData(t,"Clicked"),t===d.EC.PlanTimeline&&p?e.onUpsellHookClick(d.EC.PlanTimeline):o(t)},selectedPivotKey:(()=>{const{currentPage:t,plan:o}=e;if(o.container.containerType===de.K.User){return u().find(e=>e.key===t)?null:t}return t})(),showTooltip:e.showTooltip}),g.length>0&&!p&&z.createElement(nt,{moreOptionsContextMenuItems:g,moreOptionsTooltip:Ie.p.Strings.UnoPlanHeader_MoreViews,theme:e.theme}),g.length>0&&p&&z.createElement(rs,{menuItems:g,dropdownMenuTitle:Ie.p.Strings.UpsellOverflowMenu_DropdownTitle,iconButtonTitle:Ie.p.Strings.UnoPlanHeader_MoreViews}))},Fs=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto"}]};return(0,Y.pB)(void 0,o,t)}),Ls=(0,Q.J9)(e=>({root:(0,Y.Zq)("overflowMenu",e.root)})),Ms="bpShowMoreHeaderButton",Ns=e=>{let{styles:t,theme:o,showFeedbackButton:n,onClickFeedback:r}=e;const s=(0,Z.D)(),[i,a]=z.useState(!1),l=Ls(Fs(s,t)),c=(0,z.useCallback)(()=>{if(!i)return null;const e=[{key:"help",text:Ie.p.Strings.PlanHeader_PlanHeaderHelp,iconProps:ot.uh,onClick:()=>{a(!1),Xn.b.safelyOpenExternalUrl(ce.$j.plannerHelp,"_blank")}}];return n&&e.push({key:"feedback",text:Ie.p.Strings.UnoPlanHeader_FeedbackText,iconProps:ot.is,onClick:()=>{a(!1),r()}}),z.createElement($e.l,{shouldFocusOnMount:!0,items:e,directionalHint:Xe.A.bottomAutoEdge,target:".".concat(Ms),appTheme:o,onDismiss:()=>a(!1)})},[r,o,n,i]);return z.createElement("div",{className:l.root},z.createElement(En.K,{title:Ie.p.Strings.PlannerHeader_MoreAriaLabel,className:Ms,iconProps:ot.uh,onClick:()=>a(!i),plannerTheme:o}),c())};var Rs=o(8784);const Us=(0,Q.J9)((e,t)=>{const o={root:[{border:"none",borderColor:null===e||void 0===e?void 0:e.semanticColors.buttonBorder,height:"32px",padding:"0px",".ms-Icon":{margin:"0px"},".ms-Button-textContainer":{["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{display:"none"}}}]};return(0,Y.pB)(void 0,o,t)}),Os=(0,Q.J9)(e=>({root:(0,Y.Zq)("diamondButton",e.root)})),Hs=e=>{let{showTooltip:t,styles:o,showTrialStatusButton:n,showTrialStatusButtonText:r,isTrialActive:s,isSelfServiceEnabled:i,onClickTrialButton:a}=e;const l=(0,Z.D)(),c=Os(Us(l,o));if(!1===n)return null;const p=t?Ie.p.Strings.UnoPlanHeader_TrialTooltip:"";return z.createElement(ir.S,{content:p},z.createElement(Rs.r,{text:r?s?Ie.p.Strings.UnoPlanHeader_TrialButtonTextTrialActive:i?Ie.p.Strings.UnoPlanHeader_TrialButtonText:Ie.p.Strings.UnoPlanHeader_RequestSubscriptionButtonText:void 0,onClick:a,className:c.root,iconProps:ot.aM,id:k.Au}))},Vs=(0,Q.J9)(e=>({root:{border:"none",background:"transparent",minWidth:"auto",padding:"0px",borderRadius:"4px",["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{padding:"0px 5px 0px 5px",minWidth:"32px"}},icon:{color:e.palette.neutralPrimary,display:"inline-block",margin:"0px",["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{marginRight:"0px"}},label:{color:e.palette.neutralPrimary,fontWeight:Y.BO.regular},textContainer:{["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{display:"none"}},menuIcon:{margin:"2px 0px 0px 0px",["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{display:"none !important"}}})),Gs=e=>{let{showCopilotButton:t,showTooltip:o,onClickCopilotButton:n}=e;const r=(0,Z.D)();if(!1===t)return null;const s=o?Ie.p.Strings.UnoPlanHeader_CopilotText:"";return z.createElement(ir.S,{content:s},z.createElement(j.Y,{id:Xr.hN.CopilotButton,text:Ie.p.Strings.UnoPlanHeader_CopilotText,iconProps:_r.H3,styles:Vs(r),onClick:n}))},Ws=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.gS)("row","nowrap"),{minWidth:"0",alignItems:"center",color:e.palette.neutralSecondary,marginLeft:"auto",paddingLeft:"32px",columnGap:"12px"}],statusIcon:{marginRight:"12px"}};return(0,Y.pB)(void 0,o,t)}),_s=(0,Q.J9)(e=>({root:(0,Y.Zq)("planStatusSection",e.root),statusIcon:(0,Y.Zq)("statusIcon",e.statusIcon)})),zs=(0,Q.J9)(e=>({root:{border:"1px solid ".concat(e.palette.neutralTertiaryAlt),background:"transparent",minWidth:"auto",padding:"5px 8px 5px 10px",borderRadius:"4px",["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{padding:"0px 5px 0px 5px",minWidth:"32px"}},icon:{color:e.palette.neutralPrimary,display:"inline-block",margin:"0px 2px 4px 0px",["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{marginRight:"0px"}},label:{color:e.palette.neutralPrimary,fontWeight:Y.BO.regular},textContainer:{["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{display:"none"}},menuIcon:{margin:"2px 0px 0px 0px",["@media (max-width: ".concat(Ue.B.UnoLargeScreenWidth,")")]:{display:"none !important"}}}));var Zs=o(50840);const Ks=(0,Q.J9)(e=>({root:{maxWidth:"343px",padding:"20px 24px",borderRadius:"2px",background:e.palette.white},calloutMain:{background:"transparent"}})),qs=e=>{const t=(0,Z.D)();return z.createElement(Zs.P,(0,c.A)({styles:Ks(t)},e),z.createElement("div",null,Ie.p.Strings.UnoPlanHeader_ViewMembersDisabledInfo))};var js=o(25290);const Qs="shareButtonRef",Ys=e=>{let{showTooltip:t,showOverflowMenu:o,styles:n,plan:r,openSharePlanDialog:s,canViewMembers:i,copilotButtonProps:a,premiumPlanTrialButtonProps:l,headerOverflowMenuProps:p}=e;const d=(0,Z.D)(),[u,h]=z.useState(!1),g=_s(Ws(d,n)),m=r.id,C=r.container.containerType,k=z.useMemo(()=>(0,js.DA)(),[]),b=(0,z.useCallback)(()=>{i?s(m):h(!u)},[i,u,s,m]);return z.createElement("div",{className:g.root},z.createElement(Gs,a),(()=>{if(C===de.K.User)return z.createElement(ir.S,{id:k,content:Ie.p.Strings.UnoPlanHeader_PrivatePlanStatus},z.createElement(xe.I,(0,c.A)((0,c.A)({className:g.statusIcon},ot.VW),{},{"aria-labelledby":k,"aria-hidden":"false"})))})(),(()=>{const e=t?Ie.p.Strings.UnoPlanHeader_ShareTooltip:"";return z.createElement("div",null,z.createElement(ir.S,{content:e,id:"shareButtonTooltip"},z.createElement(j.Y,{text:Ie.p.Strings.UnoPlanHeader_ShareText,ariaLabel:Ie.p.Strings.UnoPlanHeader_ShareText,"aria-describedby":"shareButtonTooltip",iconProps:ot.lO,menuIconProps:ot.u2,styles:zs(d),onClick:b,className:Qs,id:Xr.hN.HeaderShareButton})),u&&z.createElement(qs,{directionalHint:Xe.A.bottomRightEdge,isBeakVisible:!1,gapSpace:0,onDismiss:()=>h(!u),target:".".concat(Qs)}))})(),z.createElement(Hs,l),o&&z.createElement(Ns,p))};var Js=o(46851);const Xs="32px",$s="58px",ei=(0,Q.J9)((e,t,o)=>{const n={root:[(0,Ne.gS)("row","nowrap"),{backgroundColor:"inherit",marginBottom:Xs}],unoPlanHeaderLandmark:t?[(0,Ne.gS)("row","nowrap"),{width:"100%",boxShadow:Js.f.depth4,borderBottom:"1px solid ".concat(e.palette.neutralLight)}]:[(0,Ne.gS)("column","nowrap"),{width:"100%"}],pinButton:{width:"24px",height:"24px"}};return(0,Y.pB)(void 0,n,o)}),ti=(0,Q.J9)(e=>({root:(0,Y.Zq)("unoPlanHeader",e.root),unoPlanHeaderLandmark:(0,Y.Zq)("unoPlanHeaderLandmark",e.unoPlanHeaderLandmark),pinButton:(0,Y.Zq)("unoPlanHeaderPinButton",e.pinButton)})),oi=(0,Q.J9)((e,t,o)=>{const n={height:$s,padding:"0 ".concat(Xs," 0 ").concat(Xs),overflowX:"auto"},r={root:t?[(0,Ne.gS)("row","nowrap"),n]:[(0,Ne.gS)("row","nowrap"),n,{boxShadow:Js.f.depth4,borderBottom:"1px solid ".concat(e.palette.neutralLight)}]};return(0,Y.pB)(void 0,r,o)}),ni=(0,Q.J9)(e=>({root:(0,Y.Zq)("planHeader",e.root)})),ri=e=>{const t=(0,Z.D)(),o=ni(oi(t,e.isTeamsTabView,e.styles));return z.createElement("div",{className:o.root},z.createElement(Jr,e.planTitleSectionProps),z.createElement(Is,e.planViewPivotsProps),e.isTeamsTabView?null:z.createElement(Ys,e.planStatusSectionProps))};var si=o(55563);const ii=(0,Q.J9)(e=>{const{theme:{semanticColors:t,palette:o}}=e;return{root:{background:t.menuBackground},subComponentStyles:{callout:{root:{backgroundColor:t.menuBackground,color:o.neutralPrimary,borderRadius:"2px",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"},beak:{background:t.menuBackground},beakCurtain:{borderRadius:"2px",background:t.menuBackground},calloutMain:{borderRadius:"2px",backgroundColor:t.menuBackground}},menuItem:ai}}}),ai=e=>{const{theme:{semanticColors:t,palette:o},expanded:n}=e;return{root:[n&&{backgroundColor:t.menuItemBackgroundPressed},{color:o.neutralPrimary,".ms-ContextualMenu-icon, .ms-ContextualMenu-checkmarkIcon, .ms-ContextualMenu-submenuIcon":{color:o.neutralPrimary},":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered,color:o.neutralPrimary,".ms-ContextualMenu-icon, .ms-ContextualMenu-checkmarkIcon, .ms-ContextualMenu-submenuIcon":{color:o.neutralPrimary}}}],item:{":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered},backgroundColor:t.menuBackground,marginLeft:"4px",marginRight:"4px",":first-of-type":{marginTop:"4px"},":last-of-type":{marginBottom:"6px"},"*":{boxSizing:"border-box"},button:[{borderRadius:"0px",height:"36px",width:"100%",marginBottom:"0px !important",":focus, :hover":{backgroundColor:t.menuItemBackgroundHovered,color:t.menuItemTextHovered}},n&&{backgroundColor:t.menuItemBackgroundPressed,color:t.menuItemTextHovered}]},checkmarkIcon:{color:o.neutralPrimary},icon:{marginRight:"12px",color:o.neutralPrimary}}},li=(0,Q.J9)(e=>({root:{backgroundColor:e.semanticColors.menuBackground},header:[{"> .clearFilters":{color:e.palette.themePrimary},"> .filterTitle":{color:e.palette.neutralPrimary}}]})),ci=e=>{const t=z.useRef(),o=(0,Z.D)(),[n,r]=z.useState(!1),s=z.useCallback(()=>{r(!n)},[n]),i=z.useCallback(()=>{r(!1),t.current.focus()},[]);return(()=>{const{currentTaskFilter:r,styles:a}=e;if(!r)return null;const l=r.filterCount>0?"".concat(Ie.p.Strings.UnoPlanHeader_Filters,"\n                    ").concat(Ie.p.Strings.PlannerHeader_FiltersMenuHeaderOpeningParentheses).concat(r.filterCount.toString()).concat(Ie.p.Strings.PlannerHeader_FiltersMenuHeaderClosingParentheses):Ie.p.Strings.UnoPlanHeader_Filters,c=e.showTooltip?Ie.p.Strings.UnoPlanHeader_Filters:"";return z.createElement("span",{ref:t,id:Xr.hN.TaskFiltersButton},z.createElement(ir.S,{content:c},z.createElement(si.z,{onClick:s,text:l,iconProps:ot.ao,styles:a,menuIconProps:ot.Ju,"aria-expanded":n}),n&&(()=>{const{members:n,theme:r,currentTaskFilter:s,taskData:a,buckets:l,planCategories:c,getUserPhoto:p,setTaskFilter:d,onRenderPersona:u,hideSearchBox:h}=e;if(!s)return null;const g={getUserPhoto:p,setTaskFilter:d,onRenderPersona:u,onDismiss:i};return z.createElement(No,{targetElement:t.current,callbacks:g,currentTaskFilter:s,taskData:a,members:null!==n&&void 0!==n?n:[],categories:c,buckets:l,theme:r,hideSearchBox:h,contextualMenuStyles:ii,styles:li(o)})})()))})()},pi=e=>{const t=()=>{const{currentTaskGrouping:t,onGroupByChange:o}=e,n={items:[],shouldFocusOnMount:!1,directionalHint:Xe.A.bottomRightEdge,styles:(0,wo.SH)(e.theme)};for(const r of e.taskGroupingOptions)isNaN(Number(r))||n.items.push({key:p.Yc[r],text:rt(r),canCheck:!0,checked:t===r,onClick:o.bind(void 0,r)});return n};return(()=>{const{taskGroupingOptions:o,currentTaskGrouping:n,onGroupByChange:r,styles:s}=e;if(!o||me()(o)||!n)return null;const i={items:[],shouldFocusOnMount:!1,directionalHint:Xe.A.bottomRightEdge};for(const e of o)isNaN(Number(e))||i.items.push({key:p.Yc[e],text:rt(e),canCheck:!0,checked:n===e,onClick:r.bind(void 0,e)});const a=rt(n),l=e.showTooltip?vt.G(Ie.p.Strings.UnoPlanHeader_GroupByText,a):"";return z.createElement(ir.S,{content:l},z.createElement(si.z,{iconProps:ot.JW,text:vt.G(Ie.p.Strings.UnoPlanHeader_GroupByText,a),menuProps:t(),menuIconProps:ot.Ju,styles:s}))})()},di=(0,Q.J9)((e,t)=>{const o={root:[(0,Ne.gS)("row","nowrap"),{alignItems:"center",columnGap:"12px",overflowX:"auto"}]};return(0,Y.pB)(void 0,o,t)}),ui=(0,Q.J9)(e=>({root:(0,Y.Zq)("planActionBar",e.root)})),hi=(0,Q.J9)((e,t)=>{const o={padding:"0px",minHeight:"32px",["@media (max-width: ".concat(Ue.B.UnoSmallScreenWidth,")")]:t&&{minWidth:"36px"},backgroundColor:"inherit"},n={["@media (max-width: ".concat(Ue.B.UnoSmallScreenWidth,")")]:t&&{display:"none"}},r={marginLeft:"0px",marginRight:"0px",["@media (max-width: ".concat(Ue.B.UnoSmallScreenWidth,")")]:t&&{display:"none !important"}},s={["@media (min-width: ".concat(Ue.B.UnoSmallScreenWidth,")")]:{background:"transparent"},color:e.palette.themePrimary},i={background:"transparent",color:e.palette.themePrimary};return{root:o,rootExpanded:t?[s]:[i],rootHovered:t?[s]:[i],rootExpandedHovered:t?[s]:[i],rootPressed:t?[s]:[i],rootFocused:t?{["@media (min-width: ".concat(Ue.B.UnoSmallScreenWidth,")")]:{background:"transparent"}}:{background:"transparent"},textContainer:n,menuIcon:r,icon:{color:"inherit",display:"inline-block",marginBottom:"2px"},iconPressed:{color:e.palette.themePrimary}}}),gi=e=>{const t=(0,Z.D)(),o=ui(di(t,e.styles));return z.createElement("div",{className:o.root},z.createElement(ci,{taskData:e.taskData,buckets:e.buckets,planCategories:e.planCategories,currentTaskFilter:e.currentTaskFilter,setTaskFilter:e.setTaskFilter,getUserPhoto:e.getUserPhoto,onRenderPersona:e.onRenderPersona,members:e.members,theme:e.theme,styles:hi(t,!0),hideSearchBox:!e.isTeamsTabView,showTooltip:e.showTooltip}),z.createElement(pi,{taskGroupingOptions:e.taskGroupingOptions,currentTaskGrouping:e.currentTaskGrouping,onGroupByChange:e.onGroupByChange,theme:e.theme,styles:hi(t,!0),showTooltip:e.showTooltip}))},mi=e=>{const{theme:{palette:t}}=e;return{root:{minWidth:"200px",width:"280px",alignSelf:"center",border:"none",borderRadius:0,background:"transparent",borderBottom:"1px solid ".concat(t.neutralSecondaryAlt),"&.is-active":[{"::after":{border:"none",borderBottom:"2px solid ".concat(t.themePrimary),borderBottomRightRadius:"0px",borderBottomLeftRadius:"0px"}}]},icon:{color:t.neutralSecondary,marginTop:"6px"},clearButton:{},field:{color:t.neutralPrimary}}},Ci=e=>{const{currentTaskFilter:t,setTaskFilter:o}=e,[n,r]=z.useState("");if(!t)return null;return z.createElement(Po.G,{placeholder:Ie.p.Strings.TaskFiltering_TitleFilterInputPlaceholderText,ariaLabel:Ie.p.Strings.TaskFiltering_FilterTextFieldAriaLabel,iconProps:ot._x,value:n,onChange:(e,n)=>{const s=null!==n&&void 0!==n?n:"";let i;i=""===s?t.removeFilter("title"):t.replaceFilter("title",new uo.d("title",[s])),o(i),r(s)},styles:mi})},ki=(0,Q.J9)((e,t,o)=>{const n={root:t?[(0,Ne.gS)("row","nowrap"),{alignItems:"center",justifyContent:"space-between",height:$s,padding:"0 ".concat(Xs," 0 ").concat(Xs),marginLeft:"auto",columnGap:"12px"}]:[(0,Ne.gS)("row","nowrap"),{alignItems:"center",justifyContent:"space-between",height:$s,padding:"0 ".concat(Xs," 0 ").concat(Xs)}]};return(0,Y.pB)(void 0,n,o)}),bi=(0,Q.J9)(e=>({root:(0,Y.Zq)("planViewHeader",e.root)})),Ti=e=>{const t=(0,Z.D)(),o=bi(ki(t,e.isTeamsTabView,e.styles));return e.isTeamsTabView?z.createElement("div",{className:o.root},z.createElement(Gs,e.copilotButtonProps),z.createElement(gi,e.planActionBarProps),z.createElement(Hs,e.premiumPlanTrialButtonProps),z.createElement(Ns,e.headerOverflowMenuProps)):z.createElement("div",{className:o.root},z.createElement(Ci,e.filterSearchBoxProps),z.createElement(gi,e.planActionBarProps))},Si=e=>{const t=(0,Z.D)(),{root:o,unoPlanHeaderLandmark:n}=ti(ei(t,e.isTeamsTabView));return z.createElement(Dn,{sizeClasses:[""],isAdditive:!0,className:o},z.createElement(Bn.H,{className:n,role:"banner","aria-label":""},z.createElement(ri,e.planHeaderProps),z.createElement(Ti,e.planViewHeaderProps)))};var Pi=o(70149);const vi=()=>(0,Pi.L)(()=>o.e(21724).then(o.bind(o,31002))).then(e=>({default:e.PlanArchivedStateView})),xi=(0,z.lazy)(vi),yi=(0,Q.J9)((e,t,o)=>{const n=[(0,Ne.Ph)(e,t),{"::before":[{content:"''",display:"block",width:"100%",height:"100%",position:"absolute",zIndex:"-1",top:"0",left:"0"},e===ce.Sx.Light&&{background:"linear-gradient(to bottom, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.2) 50%)"},e===ce.Sx.Dark&&{background:"linear-gradient(to bottom, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0.2) 50%)"}]}],r=[(0,Ne.Ph)(e,t),(0,Ne.GD)()],s={root:n,planErrorView:[(0,Ne.Ph)(e,t),(0,Ne.gS)("column"),Ne.cc,(0,Ne.aS)(e),{padding:"10px","> *":{textAlign:"center"},"> .errorText":{fontSize:Y.s.xxLarge,paddingTop:"48px",paddingBottom:"28px"},"> .errorSubText":[{fontSize:Y.s.medium,paddingBottom:"88px"}],".buttonContainers":[(0,Ne.gS)("row"),Ne.cc,{"> .buttonContainer":{margin:"0px 10px"}}],".buttonContainer":[(0,Ne.gS)("row"),Ne.cc,{"> .redirectButton":[(0,Ne.jU)(e),{width:"200px",height:"38px"}]}],"> .shrug":[(0,Ne._D)(e),{fontSize:Y.s.superLarge,lineHeight:"1"}]}],unoPlanErrorView:r,pendingView:{"> .spinner":{display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"}},subComponentStyles:{topHeader:fi()}};return(0,Y.pB)(void 0,s,o)}),fi=(0,Q.J9)(()=>({root:(0,Ne.$Z)(Ue.B.TopHeaderHeight)})),Ai=(0,Q.J9)(e=>({root:(0,Y.Zq)("planView",e.root),planErrorView:(0,Y.Zq)("planErrorView",e.planErrorView),unoPlanErrorView:(0,Y.Zq)("unoPlanErrorView",e.unoPlanErrorView),pendingView:(0,Y.Zq)("pendingView",e.pendingView)}));var wi,Di,Bi=o(62687),Ei=o(97139),Ii=o(39589),Fi=o(64696),Li=o(17776),Mi=o(40468);!function(e){e[e.Invalid=0]="Invalid",e[e.Plan=1]="Plan"}(wi||(wi={})),function(e){e[e.Invalid=0]="Invalid",e[e.Excel=1]="Excel"}(Di||(Di={}));var Ni,Ri=o(70252),Ui=o(31408),Oi=o(10871),Hi=o.n(Oi),Vi=o(28673),Gi=o.n(Vi),Wi=o(91733),_i=o.n(Wi),zi=o(86178),Zi=o.n(zi);function Ki(e){return Zi().utc().year(e.year()).month(e.month()).date(e.date()).hour(10).minute(0).second(0).millisecond(0)}function qi(e){switch(e){case Ni.Late:return Ki(Zi()().subtract(1,"day"));case Ni.Today:return Ki(Zi()());case Ni.Tomorrow:return Ki(Zi()().add(1,"day"));case Ni.ThisWeek:return Ki(Zi()().endOf("week"));case Ni.NextWeek:return Ki(Zi()().add(7,"days").endOf("week"));case Ni.Future:return Ki(Zi()().add(7,"days").endOf("week").add(1,"day"));case Ni.NoDate:default:return null}}!function(e){e[e.Late=0]="Late",e[e.Today=1]="Today",e[e.Tomorrow=2]="Tomorrow",e[e.ThisWeek=3]="ThisWeek",e[e.NextWeek=4]="NextWeek",e[e.Future=5]="Future",e[e.NoDate=6]="NoDate"}(Ni||(Ni={}));var ji=o(98424),Qi=o(79537),Yi=o(74719),Ji=o(99611),Xi=o(65528);class $i extends Sr{getPageReadyMetaTag(){return le.B.headerlessMode?"headerless":"fullpage"}componentDidUpdate(e,t){super.componentDidUpdate(e,t);const{viewPartitionKey:o,onPlanLoaded:n}=this.props;e.viewPartitionKey!==o&&(null==this.props.planStore.getPlan(o)&&(this.isPlanViewLoaded=!1),this.planViewLoadNotified=!1,this.shouldDispatchPlanViewOpenTriggerAction=!0),this.isPlanViewLoaded&&!this.planViewLoadNotified&&(n(o),this.planViewLoadNotified=!0),this.currentPageName!==this.name()&&(this.shouldDispatchPlanViewOpenTriggerAction=!0,this.currentPageName=this.name()),this.dispatchCampaignTriggerActionsOnUpdate()}componentDidMount(){super.componentDidMount();const{viewPartitionKey:e,onPlanLoaded:t}=this.props;this.isPlanViewLoaded&&!this.planViewLoadNotified&&(t(e),this.planViewLoadNotified=!0),this.currentPageName=this.name()}checkForCriticalViewDataReady(){const{viewPartitionKey:e,bucketStore:t,planStore:o,viewStore:n,taskStore:r}=this.props,s=null!=this.getTaskboardTaskFormatData(),i=null!=r.getTasksForPlan(e),a=n.getCurrentTaskGroupingState(this.taskAccessContext)!==p.Yc.Bucket||!me()(t.getBucketsForPlan(e)),l=n.getCurrentTaskGroupingState(this.taskAccessContext)!==p.Yc.Category||null!=o.getPlanDetails(e);return!!(i&&a&&s&&l)&&(this.onViewCriticalDataFetchCompletion(),!0)}getTaskData(){var e;const{taskStore:t,viewPartitionKey:o}=this.props;return null!==(e=t.getTasksForPlan(o))&&void 0!==e?e:[]}getTaskboardTaskFormatData(){var e;const{viewPartitionKey:t,taskStore:o,viewStore:n}=this.props,r=n.getCurrentTaskGroupingState(this.taskAccessContext);return r!==p.Yc.Assignee&&r!==p.Yc.Bucket&&r!==p.Yc.Progress?[]:null!==(e=o.getTaskboardTaskFormattingForPlan(t,this.getCurrentTaskboardType()))&&void 0!==e?e:[]}getCurrentTaskboardType(){switch(this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext)){case p.Yc.Assignee:return Ri.s.AssignedTo;case p.Yc.Bucket:return Ri.s.Bucket;case p.Yc.Progress:return Ri.s.Progress;default:throw new Error("NotSupportedException: invalid type")}}progressBoardValueSetter(e,t,o,n,r,s){const i=t.setProperty("percentComplete",(0,ao.BK)(o)),a=this.getOrderHintForProgressBoard(n,e),l=this.getOrderHintForProgressBoard(r,e),c=ji.O.generateOrderHintBetween(a,l);let p=e[t.id];p||(p=Ei.j.builder.withPropertyBag({id:t.id,orderHint:void 0}).build());const d=p.setProperty("orderHint",c),u=Ii._.builder.withPropertyBag({progressBoardFormat:p}).build(),h=Ii._.builder.withPropertyBag({progressBoardFormat:d}).build();this.updateOnTaskDragAndDrop(t,i,u,h)}bucketBoardValueSetter(e,t,o,n,r,s){const i=t.setProperty("bucketId",o),a=this.getOrderHintForBucketBoard(n,e),l=this.getOrderHintForBucketBoard(r,e),c=ji.O.generateOrderHintBetween(a,l);let p=e[t.id];p||(p=Li.g.builder.withPropertyBag({id:t.id,orderHint:void 0}).build());const d=p.setProperty("orderHint",c),u=Ii._.builder.withPropertyBag({bucketBoardFormat:p}).build(),h=Ii._.builder.withPropertyBag({bucketBoardFormat:d}).build();this.updateOnTaskDragAndDrop(t,i,u,h)}assignedToBoardValueSetter(e,t,o,n,r,s){const i=t.getClone();let a,l=!1,c=null,p=null,d=e[t.id];if(d)a=d.getClone();else{d=Fi.x.builder.withPropertyBag({id:t.id,unassignedOrderHint:void 0,orderHintsByAssignee:{}}).build();const s={};let i=null;Pt()(Gi()(t.assignments),e=>{i=ji.O.generateOrderHintBetween(i,null),s[e]=i}),a=Fi.x.builder.withPropertyBag({id:t.id,unassignedOrderHint:ji.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(n,o,e),this.getOrderHintForAssigneeColumn(r,o,e)),orderHintsByAssignee:s}).build()}if(null!=s&&""!==s&&"null"!==s&&(-1!==i.getAssigneeIds().indexOf(s)&&(l=!0,c=s,delete i.assignments[s]),a.orderHintsByAssignee[s]&&delete a.orderHintsByAssignee[s]),null==o||""===o||"null"===o){if(i.getAssigneeIds().length>0){l=!0;i.getAssigneeIds().forEach(e=>{delete i.assignments[e],delete a.orderHintsByAssignee[e]})}a=a.setProperty("orderHintsByAssignee",{}),a=a.setProperty("unassignedOrderHint",ji.O.generateOrderHintBetween(this.getOrderHintForUnassignedColumn(n,e),this.getOrderHintForUnassignedColumn(r,e)))}else-1===i.getAssigneeIds().indexOf(o)&&(l=!0,p=o,i.assignments[o]=new mr.I(this.props.appContextStore.getCurrentUserId(),new Date)),a.orderHintsByAssignee[o]=ji.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(n,o,e),this.getOrderHintForAssigneeColumn(r,o,e));const u=Ii._.builder.withPropertyBag({assignedBoardFormat:d}).build(),h=Ii._.builder.withPropertyBag({assignedBoardFormat:a}).build();l?this.updateOnTaskDragAndDrop(t,i,u,h):this.updateOnTaskDragAndDrop(t,t,u,h),this.onAssignedToCardValueSetterUpdated(t,i,c,p,o,s)}async updateOnTaskDragAndDrop(e,t,o,n){this.state.isCardChangingCompletedSection&&(t=t.toggleCompletionState());(await this.props.actionCreatorProviders.taskActionCreator()).updateTask(gr.F.builder.withTask(e).withFormatData(o).build(),gr.F.builder.withTask(t).withFormatData(n).build()),this.state.isCardChangingCompletedSection&&this.setState({isCardChangingCompletedSection:!1})}getOrderHintForProgressBoard(e,t){return e&&t[e.id]?t[e.id].orderHint:null}getOrderHintForBucketBoard(e,t){return e&&t[e.id]?t[e.id].orderHint:null}getOrderHintForUnassignedColumn(e,t){return e&&t[e.id]?t[e.id].unassignedOrderHint:null}getOrderHintForAssigneeColumn(e,t,o){let n=null;if(e&&o[e.id]){var r;n=(null!==(r=o[e.id].orderHintsByAssignee)&&void 0!==r?r:{})[t]}return n||this.getOrderHintForUnassignedColumn(e,o)||""}setupCallbacks(){const{bucketStore:e,userStore:t}=this.props;this.taskCardCallbacks={onAssignTask:this.onAssignTask,getUser:t.getUserById.bind(t),getUserPhoto:t.getUserPhotoById.bind(t),getUsersWithKeyword:this.getUsersWithKeyword,getBuckets:e.getBucketsForPlan.bind(e),getAssigneePool:this.getAssigneePool,getFlights:()=>this.props.flights,getCanUserModifyAssigneePool:e=>{const t=this.props.taskStore.getTask(e);if(!t)return!1;const o=this.props.planStore.getPlan(t.planId);return null!=o&&(this.canUserAddMembers(o)||this.canUserAccessPlanViaSharedContainerOnly(t.planId))},getCanUserAccessPlanViaSharedContainerOnly:this.canUserAccessPlanViaSharedContainerOnly,onUpdateTask:this.onUpdateTask,onUpdateTaskDetails:this.onUpdateTaskDetails,getDocumentPreviewThumbnail:this.props.groupDocumentsStore.getDriveItemThumbnail.bind(this.props.groupDocumentsStore),showAssigneeLimitError:this.onShowAssigneeLimitError,openCopyTaskDialog:this.onCopyTaskClick,openMoveTaskDialog:this.onMoveTaskClick,openDeleteRecurringTaskDialog:this.onDeleteRecurringTaskClick,onCopyLinkToTask:this.onCopyLinkToTask,onRenderPersona:this.onRenderPersona,showInfoBanner:this.showInfoBanner,fetchTaskContainerPermissions:this.fetchPermissionsWithTaskContext,onOpenLink:this.context.openLinkCallback,setLabelsCollapsedState:e=>{this.onSetLabelsCollapsedStateForView(e)},alertUser:this.alertUser,onOpenAssignCallout:this.onOpenAssignCallout,addUserToContainer:()=>{},getAssigneeSuggestions:()=>[],isTaskOnMyDay:this.props.isTaskOnMyDay,toggleMyDayForTask:this.props.toggleMyDayForTask}}getViewClassNames(){return Ai(this.getViewStyles())}getViewStyles(){return yi(this.props.appContextStore.getCurrentTheme(),le.B.isUnoContext,this.props.styles)}getThemedPageStyles(e){if(le.B.clientType!==h.s.Plex||le.B.isUnoContext||!this.props.flights.EnableImageRecommendations)return{};let t={};if(null!=e){const o=this.props.planStore.getPlanDetails(e);null!=(null===o||void 0===o?void 0:o.background.overlayImage)&&(t={backgroundImage:"url(".concat(o.background.overlayImage,")"),backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover",zIndex:0,position:"relative"})}return t}renderMessageBar(){var e;const{viewPartitionKey:t,planStore:o,loggers:n,appContextStore:r}=this.props,s=o.getPlan(t);if(!(null===s||void 0===s?void 0:s.isArchived))return null;const i=(null===s||void 0===s||null===(e=s.archivalInfo)||void 0===e?void 0:e.justification)===O.D,a=r.getClientFlavor(),l=a===u.g.SharepointPage||a===u.g.SharepointWebpart;let c=null,p=Ie.p.Strings.NotificationBar_PlanReadOnlyInfo;return i?(l?(p=Ie.p.Strings.NotificationBar_PlanConvertedInfoForSharePoint,c=z.createElement(tr.p,{onClick:()=>{const e=o.getPlanDetails(t);e&&function(e){const{plan:t,planDetails:o,projectAppId:n,currentRouteHash:r,loggers:s,target:i}=e;if(!t.isArchived)return!1;for(const l in null===o||void 0===o?void 0:o.contextDetails){var a;const e=o.contextDetails[l],c=null===t||void 0===t||null===(a=t.contexts[l])||void 0===a?void 0:a.ownerAppId;if(l.startsWith("ConvertPlanToProject")&&c===n){if(null==e.url)return s.traceLogger.logTrace(507357128,Xi.TraceLevel.Error,"checkForArchivedOrConvertedPlan: URL undefined error for converted plan context"),!1;const t=new URLSearchParams(r.split("?")[1]);if("true"===t.get("admin"))return!1;const o=t.get("taskId");let n=e.url;return o&&(n="".concat(n,"&taskId=").concat(o)),Xn.b.safelyOpenExternalUrl(n,null!==i&&void 0!==i?i:"_self"),!1}}new URLSearchParams(r.split("?")[1]).get("admin")}({plan:s,planDetails:e,projectAppId:r.getECSSettings().ApplicationIds.Project,currentRouteHash:"",loggers:n,target:"_blank"})}},Ie.p.Strings.SharedComponents_OpenPlanButton)):(p=Ie.p.Strings.NotificationBar_PlanConvertingInfo,c=z.createElement(tr.p,{onClick:()=>Xn.b.safelyOpenExternalUrl(N.importPlanLearnMoreUrl)},Ie.p.Strings.SharedComponents_LearnMoreLink)),z.createElement(or.n,{messageBarType:nr.H.info,"aria-label":Ie.p.Strings.NotificationBar_NotificationBarAriaLabel,actions:null!==c&&void 0!==c?c:void 0,isMultiline:!1},z.createElement("span",null,p))):(null!==s&&void 0!==s&&s.isArchived&&l&&(p=Ie.p.Strings.NotificationBar_PlanArchivedInfoForSharePoint),z.createElement(or.n,{messageBarType:nr.H.info,"aria-label":Ie.p.Strings.NotificationBar_NotificationBarAriaLabel},z.createElement("span",null,p)))}renderViewCommandBar(){var e,t;const{appContextStore:o,bucketStore:n,containerStore:r,getSharepointDomainUrl:s,groupDocumentsStore:i,permissionsStore:a,planStore:l,showHeader:C,tenantStore:T,userOutlookCalendarUrlToPublishTasks:S,userStore:P,viewStore:v,taskStore:x,flights:y,isSlimView:f,viewPartitionKey:A,copyLinkToPlanUno:w,exportPlanToExcelUno:D}=this.props;if(!C)return null;const B=o.getCurrentTheme(),E=null===(e=this.getViewStyles().subComponentStyles)||void 0===e?void 0:e.topHeader,I=l.getPlan(A);if(null==I){const e=l.getPlanStatus(A);return le.B.isUnoContext&&null!==e?null:z.createElement(hr,{theme:B,topHeaderStyles:E})}const F=a.getPlanPermissions(I);let L=Te.DisableNothing;const M=o.getClientFlavor();F.canEdit||F.canFavorite?(!F.canEdit&&F.canFavorite||M===u.g.TeamsPersonalApp)&&(L=Te.DisablePlanChanges):L=Te.DisableAll;const N=r.getContainer(I.container.externalId),R=N?a.getContainerPermissions(N):a.getDefaultContainerPermissions(I.container),U=R.canViewMembers?this.getContainerMembers(I.container.externalId):[],O=l.getPlanDetails(A),H={title:I.title,visibleContextKeys:this.getVisibleContextKeys(),contexts:I.contexts,contextDetails:null===O||void 0===O?void 0:O.contextDetails,theme:B,planContainer:N},V=oo.U.getILabelArray((null===O||void 0===O?void 0:O.categories)||[],this.props.aggregatesStore.getLabelUsageCountsForPlan(A)).map(e=>e.name),G=null!==(t=x.getTasksForPlan(A))&&void 0!==t?t:[];if(M===u.g.LoopSinglePlanApp){var W;const e={onAddMember:this.onAddMember,onRemoveMember:this.onRemoveUserFromPlan,canUserBeRemovedFromContainer:this.canUserBeRemovedFromContainer,getUserWithKeyword:this.getUsersWithKeyword,getUserPhoto:P.getUserPhotoById.bind(P),highlightTasks:this.onHighlightTasks,onRenderPersona:this.onRenderPersona,setTaskFilter:this.onFilterChange,onFilterCalloutVisibleChange:this.onFilterMenuVisibleChange,onGroupByChange:this.onGroupByChange,getBadgeIconAriaLabel:this.getBadgeIconAriaLabel,openPlanSettingsPanel:this.openPlanSettingsPanel,openLeavePlanDialog:this.openLeavePlanDialog,onClickTitleButton:this.onPlanTitleClick,openTasksICalendarDialog:this.openPlanTasksICalendarDialog.bind(I.id),onRenderPlanPhoto:this.onRenderPlanPhoto};return z.createElement(xr,{callbacks:e,renderContextDropdown:!0,renderMembersDropdown:null!=U,contextDropdownProps:H,imageSource:this.getPlanImage(),currentTaskFilter:v.getCurrentTaskFilter(this.getViewKey()),isFilterCalloutVisible:this.state.isFilterMenuVisible,currentTaskGrouping:v.getCurrentTaskGroupingState(this.taskAccessContext),taskGroupingOptions:this.taskGroupingOptions,showGroupByMenuTitleValue:!0,planMembers:U,planContainer:N,planBuckets:null!==(W=n.getBucketsForPlan(A))&&void 0!==W?W:[],planCategories:V,planDetails:O,plan:I,taskData:G,disableMode:L,sharedContainersListProps:this.getSharedContainersListProps(I),hasAccessViaSharedContainer:this.getHasAccessViaSharedContainer(I),sensitivityLabels:T.getCurrentSensitivityLabels(),userPermissions:a.getUserPermissions(),containerPermissions:R,flights:y,theme:B})}if(le.B.isUnoContext){var _,Z,K,q,j,Q,Y,J,X,$,ee,te;const e={};e[d.yx.GroupId]=I.container.externalId,e[d.yx.PlanId]=A;const t=M===u.g.TeamsTab,r=P.getCurrentUserProjectUpsellExperienceMode(null!==(_=this.props.showUpsellConversion)&&void 0!==_&&_),s=null===(Z=(K=this.props).isPlannerPremiumEnabled)||void 0===Z?void 0:Z.call(K),i={navigateToPage:t=>this.navigateToPage(t,e,void 0,d.jf.Other),onUpsellHookClick:e=>{this.logUsage(g.M.UpsellDialogOpenedFromViewPivots,{pageName:e}),this.openConvertPlan()},currentPage:this.name(),plan:I,showUpsellHooks:!!s&&(r!==k.M$.Disabled&&r!==k.M$.RequestAdmin||null!==(q=this.props.showUpsellConversion)&&void 0!==q&&q&&a.hasWriteAccessToPremiumPlan()),showTooltip:o.getUnoCurrentPageFormFactorState()!==p.qk.Desktop,theme:B},l=[];t||l.push({key:"MyPlansBreadcrumb",text:Ie.p.Strings.UnoPlanHeader_MyPlans,onClick:()=>this.navigateToMyPlans()},{key:"PlanTitleBreadcrumb",text:I.title,onClick:()=>this.openPlanSettingsPanel(I.id)});const C=P.getFavoritePlansMRU();let b=!1;null!=(null===C||void 0===C?void 0:C.references)&&(b=null!=C.references[A]);const S=async()=>{this.props.loggers.usageLogger.logData(b?g.M.RemoveFromFavorite:g.M.AddToFavorite,"Clicked");(await this.props.actionCreatorProviders.planActionCreator()).setPlanFavoriteStatus(I.id,!b);(await this.props.actionCreatorProviders.userActionCreator()).toggleUserFavoritePlanStatus(I)},x=!!N&&(null===a||void 0===a?void 0:a.canAccessICalendar(N));let y={openPlanSettingsPanel:e=>this.openPlanSettingsPanel(I.id,e),copyLinkToPlan:()=>null===w||void 0===w?void 0:w(this.getPlanRoutingDetails()),iCalendar:le.B.clientSettings.Flights.Uno_EnableICalendar&&x&&!t?()=>this.openICalendarDialog(I.id):void 0};le.B.clientSettings.Flights.Uno_EnableCopyPlan&&be(ae.getLinksCapabilitiesForPlan(N,U.length,I.container.containerType,this.getHasAccessViaSharedContainer(I)),ie.EnableCopy)&&(y=(0,c.A)((0,c.A)({},y),{},{copyPlan:this.copyPlan})),le.B.clientSettings.Flights.Uno_EnableExportPlanToExcel&&D&&(y=(0,c.A)((0,c.A)({},y),{},{exportPlanToExcel:()=>D(I.id)}));const f={breadcrumbItems:l,theme:B,contextDropdownProps:(0,c.A)((0,c.A)({},H),{},{contextMenuItemCallbacks:y}),isCurrentPlanPinned:b,plan:I,imageSource:this.getPlanImage(),togglePlanPinUnpinStatus:()=>S(),isTeamsTabView:t,onRenderPlanPhoto:this.onRenderPlanPhoto,isReadOnly:I.isArchived},E=P.getCurrentUserProjectSubscriptionStatus(),F=P.getCurrentUserProjectUpsellExperienceMode(o.getFlights().EnableTryProjectFeature),L={onClickFeedback:this.onClickFeedback,showFeedbackButton:null!==(j=null===(Q=T.getCurrentTenantFeedbackSettings())||void 0===Q?void 0:Q.allowFeedback)&&void 0!==j&&j,theme:B},O=le.B.isUnoContext&&le.B.clientType===h.s.Plex,W=null!=E&&((0,Ji.yJ)(E)||F===k.M$.GoToProject)&&(null===(Y=E.highestTrialSubscription)||void 0===Y?void 0:Y.eligibilityStatus)!==m.RG.Ineligible,oe=null!==(J=this.props.showUpsellConversion)&&void 0!==J&&J&&F===k.M$.OfferTrial&&(null===I||void 0===I?void 0:I.container.containerType)===de.K.Group,ne=!oe&&F===k.M$.OfferTrial,re=!oe&&F===k.M$.RequestAdmin,se=null===E||void 0===E||null===(X=E.highestTrialSubscription)||void 0===X?void 0:X.subscriptionStatus,ce=se===m.gr.InGracePeriod||se===m.gr.Disabled||se===m.gr.Deprovisioned,pe={showTrialStatusButton:!O&&(W||oe||ne||re),showTrialStatusButtonText:!ce,isTrialActive:null!=E&&(null===($=E.highestTrialSubscription)||void 0===$?void 0:$.subscriptionStatus)===m.gr.Active,isSelfServiceEnabled:F===k.M$.OfferTrial,onClickTrialButton:()=>this.onClickTrialButton(W,oe,ne,re),showTooltip:o.getUnoCurrentPageFormFactorState()!==p.qk.Desktop},ue={showCopilotButton:null!==(ee=this.props.showCopilotUpsellExperience)&&void 0!==ee&&ee,onClickCopilotButton:this.onClickCopilotButton,showTooltip:o.getUnoCurrentPageFormFactorState()!==p.qk.Desktop},he={planTitleSectionProps:f,planViewPivotsProps:i,planStatusSectionProps:{plan:I,planContainer:N,planMembersCount:U.length,showTooltip:o.getUnoCurrentPageFormFactorState()!==p.qk.Desktop,showOverflowMenu:!O,openSharePlanDialog:this.openSharePlanDialog,headerOverflowMenuProps:L,premiumPlanTrialButtonProps:pe,copilotButtonProps:ue,canViewMembers:R.canViewMembers},isTeamsTabView:t},ge={planActionBarProps:{theme:B,taskGroupingOptions:this.taskGroupingOptions,currentTaskGrouping:v.getCurrentTaskGroupingState(this.taskAccessContext),onGroupByChange:this.onGroupByChange,currentTaskFilter:v.getCurrentTaskFilter(this.getViewKey()),taskData:G,buckets:null!==(te=n.getBucketsForPlan(A))&&void 0!==te?te:[],planCategories:V,members:U,getUserPhoto:P.getUserPhotoById.bind(P),setTaskFilter:this.onFilterChange,onRenderPersona:this.onRenderPersona,isTeamsTabView:t,showTooltip:t&&o.getUnoCurrentPageFormFactorState()!==p.qk.Desktop},filterSearchBoxProps:{currentTaskFilter:v.getCurrentTaskFilter(this.getViewKey()),setTaskFilter:this.onFilterChange},headerOverflowMenuProps:L,premiumPlanTrialButtonProps:pe,isTeamsTabView:t,copilotButtonProps:ue};return z.createElement(Si,{planHeaderProps:he,planViewHeaderProps:ge,isTeamsTabView:t})}{var oe,ne,re;const e=M===u.g.TeamsPersonalApp||y.EnableTeamsSplitUI&&M===u.g.TeamsTab,t=le.B.clientType===h.s.Teams&&!e,r=(null===N||void 0===N?void 0:N.containerType)===de.K.Group?N:null,l=null!==(oe=null===r||void 0===r?void 0:r.unifiedGroupDetails)&&void 0!==oe?oe:null,c=s?s(l):"",p={};p[d.yx.GroupId]=I.container.externalId,p[d.yx.PlanId]=A;const g=null===(ne=P.getUserDetailsById(o.getCurrentUserId()))||void 0===ne?void 0:ne.favoritePlans;let m=!1;null!=(null===g||void 0===g?void 0:g.references)&&(m=null!=g.references[A]);const C=async e=>{(await this.props.actionCreatorProviders.planActionCreator()).setPlanFavoriteStatus(I.id,e)},x={navigateToPage:e=>this.navigateToPage(e,p,void 0,d.jf.Other),onGroupByChange:this.onGroupByChange,onAddMember:this.onAddMember,onRemoveMember:this.onRemoveUserFromPlan,canUserBeRemovedFromContainer:this.canUserBeRemovedFromContainer,highlightTasks:this.onHighlightTasks,getBreadcrumbUrl:e=>{var t,o;return null!==(t=null===(o=i.getDriveItem(e))||void 0===o?void 0:o.url)&&void 0!==t?t:null},getUserWithKeyword:this.getUsersWithKeyword,getUserPhoto:P.getUserPhotoById.bind(P),updatePlanFavoriteStatus:C,openPlanSettingsPanel:this.openPlanSettingsPanel,openLeavePlanDialog:this.openLeavePlanDialog,setTaskFilter:this.onFilterChange,joinGroup:async()=>{(await this.props.actionCreatorProviders.unifiedGroupActionCreator()).joinGroup(I.container.externalId)},copyLinkToPlan:async()=>{(await this.props.actionCreatorProviders.planActionCreator()).copyLinkToPlan(A)},onClickCopyPlan:e=>this.onOpenCopyPlanDialog(e),onClickExportPlanToExcel:e=>this.onExportPlanToExcel(e),onRenderPersona:this.onRenderPersona,onFilterCalloutVisibleChange:this.onFilterMenuVisibleChange,onRenderPlanPhoto:this.onRenderPlanPhoto,openAppAboutDialog:e?this.openTeamsAboutDialog:void 0,getBadgeIconAriaLabel:this.getBadgeIconAriaLabel,onClickTitleButton:this.onPlanTitleClick,openTasksICalendarDialog:this.openPlanTasksICalendarDialog.bind(I.id)},w=P.getCurrentUserProjectUpsellExperienceMode(y.EnableTryProjectFeature),D=w!==k.M$.Disabled,F=P.getCanCurrentUserCopyPlanToProject(y.EnableTryProjectFeature,o.getExperiment(b.b.UpsellImportPlan)===b.b.UpsellImportPlan_treatment,y.EnableImportPlanForTrialUsers,y.EnableImportPlanForProjectUsers);return z.createElement(er,{callbacks:x,currentPage:this.name(),currentTaskFilter:v.getCurrentTaskFilter(this.getViewKey()),isFilterCalloutVisible:this.state.isFilterMenuVisible,currentTaskGrouping:v.getCurrentTaskGroupingState(this.taskAccessContext),taskGroupingOptions:this.taskGroupingOptions,showGroupByMenuTitleValue:!0,sensitivityLabels:T.getCurrentSensitivityLabels(),plan:I,planBuckets:null!==(re=n.getBucketsForPlan(A))&&void 0!==re?re:[],planDetails:O,isCurrentPlanFavorite:m,flights:y,planMembers:U,planContainer:N,imageSource:this.getPlanImage(),taskData:G,userOutlookCalendarUrlToPublishTasks:null!==S&&void 0!==S?S:"",sharepointDomainUrl:null!==c&&void 0!==c?c:void 0,hideMembers:le.B.clientType===h.s.Webpart||le.B.clientType===h.s.SharepointApp||le.B.clientType===h.s.Teams||I.container.containerType===de.K.DriveItem,hideBadgeIcon:y.EnableDocumentTasks&&(null===N||void 0===N?void 0:N.containerType)===de.K.DriveItem,userPermissions:a.getUserPermissions(),containerPermissions:R,hidePlanNavLinks:!this.props.showPlanViewNavLinks,hideBreadcrumbMenu:!this.props.showPlanContext,hideTitleSection:!this.props.showPlanTitleSection,hideSecondaryLinksContextMenu:e,renderTeamsPivotSection:t,disableMode:L,planCategories:V,isSlimView:f,theme:B,styles:E,isTimelineVisible:D,showGoToProject:w===k.M$.GoToProject,showAppLogo:y.EnableTeamsSplitUI&&M===u.g.TeamsTab,sharedContainersListProps:this.getSharedContainersListProps(I),hasAccessViaSharedContainer:this.getHasAccessViaSharedContainer(I),contextDropdownProps:H,showCopyPlanToProjectLink:F})}}renderPartitionedView(e){const{viewPartitionKey:t,appContextStore:o,planStore:n}=this.props,r=n.getPlan(t),s=n.getPlanStatus(t);if(null==r)return null==s?le.B.clientType===h.s.Teams?null:this.renderSpinner():le.B.isUnoContext?this.renderUnoPlanErrorView(t,s):s===T.ZB.Inaccessible?this.renderRequestAccessPermissionView(r):this.renderPlanNotFoundErrorView();if(r.isBeingCreated())return this.renderCreationInProgressView(e);const i=o.getClientFlavor();if(r.isArchived&&(i===u.g.SharepointPage||i===u.g.SharepointWebpart))return this.renderArchivedPlanView(r,e);const a=n.getPlanDetails(t);if(a&&s===T.ZB.Stable){if(!$i.openedPlans){var l;const e=Mi.T.getSortedDisplayableContexts(r,a);let t;var c;if(e.length>0)t=null!==(c=a.contextDetails[e[0].contextKey].displayAs)&&void 0!==c?c:"";const o={planId:r.id};t&&(o.displayAs=t),this.logUsage(g.M.OpenPlan,o),this.props.loggers.traceLogger.logTrace(508065228,E.k.Info,"Open Plan Info,\n                        [containerType=".concat(null===r||void 0===r?void 0:r.container.containerType,"]\n                        [creationProcessType=").concat(null===r||void 0===r||null===(l=r.creationProcessInfo)||void 0===l?void 0:l.processType,"]")),$i.openedPlans=!0}}else $i.openedPlans=!1;return this.isPlanViewLoaded=!0,this.renderPlanView()}renderRequestAccessPermissionView(e){var t,o;if(null==this.props.getSharepointDomainUrl)return null;const n=e?null===(t=this.props.containerStore.getContainer(e))||void 0===t?void 0:t.unifiedGroupDetails:null,r=this.props.getSharepointDomainUrl(n),s=!!e&&(null===(o=this.props.containerStore.getContainer(null!==e&&void 0!==e?e:""))||void 0===o?void 0:o.containerType)===de.K.Group&&!!n&&!!r,i=le.B.clientType===h.s.Plex&&!le.B.isUnoContext,a=Ie.p.Strings.Errors_AskForAccessText,l=Ie.p.Strings.Errors_UnauthorizedAccessErrorSubTitle;return z.createElement(Bn.H,{className:this.getViewClassNames().planErrorView,role:"main"},z.createElement("div",{className:"shrug","aria-label":Ie.p.Strings.SharedComponents_ShrugEmoticonLabel},"\xaf\\_(\u30c4)_/\xaf"),z.createElement("div",{className:"errorText",tabIndex:0,"aria-label":a},a),s&&z.createElement("div",{className:"errorSubText",tabIndex:0,"aria-label":l},l),z.createElement("div",{className:"buttonContainers"},s&&z.createElement("div",{className:"buttonContainer"},z.createElement(q.j,{className:"redirectButton",onClick:()=>{this.logUsage("requestGroupAccess",{groupId:e||""}),Xn.b.safelyOpenExternalUrl(vt.G(p.Lf.SharepointSiteUrlFormat,r,e),"_blank")}},Ie.p.Strings.Errors_UnauthorizedAccessErrorButtonText)),i&&z.createElement("div",{className:"buttonContainer"},z.createElement(q.j,{className:"redirectButton",onClick:this.redirectToPlanList},Ie.p.Strings.Errors_PlanNotFoundButtonText))))}renderPlanNotFoundErrorView(){return this.renderPlanErrorView(Ie.p.Strings.Errors_PlanNotFoundErrorText,Ie.p.Strings.Errors_PlanNotFoundErrorBody)}renderCreationInProgressView(e){return z.createElement(ur,{theme:e,onClickNavigateToHub:()=>this.navigateToPage(d.EC.PlanHub,{},!1,d.jf.Other)})}renderUnoPlanErrorView(e,t){const{appContextStore:o,userStore:n,removePlanFromMyPlans:r,isPlanInMyPlans:s}=this.props,i=o.getClientFlavor()===u.g.TeamsTab,a=null!=n.getCurrentUserDetails().recentPlans.references[e],l={planNotFoundText:Ie.p.Strings.Errors_UnoPlanNotFoundErrorText,planNotFoundBody:Ie.p.Strings.Errors_UnoPlanNotFoundErrorBody,planNotFoundBodyTab:Ie.p.Strings.Errors_UnoTabPlanNotFoundErrorBody,planInaccessibleText:Ie.p.Strings.Errors_UnoPlanInaccessibleErrorText,planInaccessibleBody:Ie.p.Strings.Errors_UnoPlanInaccessibleErrorBody,planGenericErrorText:Ie.p.Strings.Errors_UnoPlanGenericErrorText,planGenericErrorBody:Ie.p.Strings.Errors_UnoPlanGenericErrorBody,navigateToMyPlansButtonText:Ie.p.Strings.Errors_UnoPlanGoBackToPlansButtonText,removeFromMyPlansButtonText:Ie.p.Strings.Errors_UnoPlanRemoveFromRecentsButtonText};return z.createElement(Bn.H,{className:this.getViewClassNames().unoPlanErrorView,role:"main"},z.createElement(re,{strings:l,planStatus:(0,ao.gW)(t),isTeamsTabView:i,isMyPlansPlan:(null===s||void 0===s?void 0:s(e))||a,removeFromMyPlansButtonCallback:async()=>{if(null!=r)r(e);else{(await this.props.actionCreatorProviders.planActionCreator()).removePlanFromRecents(e)}this.redirectToPlanList()},navigateToMyPlansButtonCallback:this.redirectToPlanList}))}renderPlanErrorView(e,t){const o=le.B.clientType===h.s.Plex&&!le.B.isUnoContext;return z.createElement(Bn.H,{className:this.getViewClassNames().planErrorView,role:"main"},z.createElement("div",{className:"shrug","aria-label":Ie.p.Strings.SharedComponents_ShrugEmoticonLabel},"\xaf\\_(\u30c4)_/\xaf"),z.createElement("div",{className:"errorText",tabIndex:0,"aria-label":e},e),z.createElement("div",{className:"errorSubText",tabIndex:0,"aria-label":t},t),o&&z.createElement("div",{className:"buttonContainer"},z.createElement(q.j,{className:"redirectButton",onClick:this.redirectToPlanList},Ie.p.Strings.Errors_PlanNotFoundButtonText)))}renderArchivedPlanView(e,t){return z.createElement(xi,{plan:e,theme:t})}renderSpinner(){return z.createElement("div",{className:this.getViewClassNames().pendingView},z.createElement("div",{className:"spinner"},z.createElement(rr.y,{size:sr.H.large})))}getSharedContainersListProps(e){const{appContextStore:t,groupDocumentsStore:o}=this.props;return(0,Yi.qg)({sharedWithContainers:e.sharedWithContainers,getDriveItemStatus:e=>o.getDriveItemStatus(e),getDriveItem:e=>o.getDriveItem(e)},t.getCurrentTheme(),this.props.loggers.traceLogger)}getHasAccessViaSharedContainer(e){const{groupDocumentsStore:t}=this.props;return(0,Yi.NL)({sharedWithContainers:e.sharedWithContainers,getDriveItemStatus:e=>t.getDriveItemStatus(e)})}onAssignedToCardValueSetterUpdated(e,t,o,n,r,s){}dispatchCampaignTriggerActionsOnUpdate(){const{dispatchCampaignTriggerActions:e}=this.props;if(!e||!this.shouldDispatchPlanViewOpenTriggerAction||!this.checkForCriticalDataReady())return;this.shouldDispatchPlanViewOpenTriggerAction=!1;const t=[s.PlanViewOpen,s.BasicPlanViewOpen];switch(this.name()){case d.EC.PlanTaskboard:t.push(s.BasicBoardViewOpen);break;case d.EC.PlanGrid:t.push(s.BasicGridViewOpen);break;case d.EC.PlanSchedule:t.push(s.BasicScheduleViewOpen);break;case d.EC.PlanCharts:t.push(s.BasicChartsViewOpen)}e(t)}constructor(){super(...arguments),this.isPlanViewLoaded=!1,this.planViewLoadNotified=!1,this.shouldDispatchPlanViewOpenTriggerAction=!0,this.taskAccessContext=Bi.t.Plan,this.taskGroupingOptions=S,this.usageloggingConstant=g.M.PlanViewComponent,this.isGroupMember=null,this.loggedUnbucketedTasks=!1,this.categoryBoardValueSetter=(e,t,o,n,r)=>{let s=e.getClone(),i=!1;if(null!=r&&"null"!==r){const e=parseInt(r,10),t=s.appliedCategories.indexOf(e);-1!==t&&(i=!0,s.appliedCategories.splice(t,1),this.props.loggers.usageLogger.logData(this.usageloggingConstant,g.M.RemoveLabelFromTask))}if(null==t||"null"===t)s.appliedCategories.length>0&&(i=!0,s=s.setProperty("appliedCategories",[]),this.props.loggers.usageLogger.logData(this.usageloggingConstant,g.M.RemoveLabelFromTask));else{const e=parseInt(t,10);-1===s.appliedCategories.indexOf(e)&&(i=!0,s.appliedCategories.push(e),this.props.loggers.usageLogger.logData(this.usageloggingConstant,g.M.AddLabelToTask,{isNewLabel:String(e>5)}))}i&&this.updateOnTaskDragAndDrop(e,s)},this.dueDateBoardValueSetter=(e,t,o,n,r)=>{if((null===t||void 0===t?void 0:t.toString())!==(null===r||void 0===r?void 0:r.toString())){var s;const o=qi(t);null==o&&null!==(s=e.recurrence)&&void 0!==s&&s.isActive()&&this.logUsage(g.M.RecurrenceCanceledDueDate);const n=e.setDueDate(o);this.updateOnTaskDragAndDrop(e,n)}},this.priorityBoardValueSetter=(e,t,o,n,r)=>{if((null===t||void 0===t?void 0:t.toString())!==(null===r||void 0===r?void 0:r.toString())){const o=e.setProperty("priority",(0,ao._d)(t));this.updateOnTaskDragAndDrop(e,o)}},this.completedSectionValueSetter=(e,t)=>{t!==this.completedTaskClassifier(e)&&this.setState({isCardChangingCompletedSection:!0})},this.canUserAddMembers=e=>{const{containerStore:t,permissionsStore:o}=this.props,n=t.getContainer(e.container.externalId);return(n?o.getContainerPermissions(n):o.getDefaultContainerPermissions(e.container)).canAddMembers},this.getTaskHighlightedType=e=>{const t={assigneeHighlighted:!1,wywaBorderHighlighted:this.props.wywaStore.isModifiedTask(e.id),wywaAnimated:this.props.wywaStore.isModifiedTask(e.id)&&this.props.wywaStore.getAnimatedModifiedTasks()};if(this.state.highlightField===p.JS.Assignee){const o=this.state.highlightValue;null!=e.assignments[o]&&(t.assigneeHighlighted=!0)}else t.assigneeHighlighted=!1;return t},this.onOpenCopyPlanDialog=async e=>{this.props.loggers.usageLogger.logData(this.usageloggingConstant,g.M.CopyPlanDialogOpened);(await this.props.actionCreatorProviders.dialogActionCreator()).openCopyPlan(e)},this.onCreateTask=async(e,t,o,n)=>{let r,s,i;const a=this.getTaskboardTaskFormatData(),l=Hi()(a,"id"),c=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext);switch(c){case p.Yc.Bucket:e=e.setProperty("bucketId",t),s=Li.g.builder.withPropertyBag({id:e.id,orderHint:ji.O.generateOrderHintBetween(this.getOrderHintForBucketBoard(o,l),this.getOrderHintForBucketBoard(n,l))}).build();break;case p.Yc.Assignee:null!=t&&(e.assignments[t]=new mr.I(this.props.appContextStore.getCurrentUserId(),new Date)),r=Fi.x.builder.withPropertyBag({id:e.id,unassignedOrderHint:ji.O.generateOrderHintBetween(this.getOrderHintForUnassignedColumn(o,l),this.getOrderHintForUnassignedColumn(n,l)),orderHintsByAssignee:_i()(e.assignments,(e,t)=>ji.O.generateOrderHintBetween(this.getOrderHintForAssigneeColumn(o,t,l),this.getOrderHintForAssigneeColumn(n,t,l)))}).build();break;case p.Yc.Progress:e=e.setProperty("percentComplete",(0,ao.BK)(t)),i=Ei.j.builder.withPropertyBag({id:e.id,orderHint:ji.O.generateOrderHintBetween(this.getOrderHintForProgressBoard(o,l),this.getOrderHintForProgressBoard(n,l))}).build();break;case p.Yc.Category:null!=t&&(e=e.setProperty("appliedCategories",[t]));break;case p.Yc.DueDate:e=e.setDueDate(qi(t));break;case p.Yc.Priority:e=e.setProperty("priority",(0,ao._d)(t));break;case p.Yc.Plan:case p.Yc.None:break;default:return void Qi.f.unreachableCase(c,e=>{this.props.loggers.traceLogger.logTrace(508065227,E.k.Error,e)})}const d=Ii._.builder.withPropertyBag({assignedBoardFormat:r,bucketBoardFormat:s,progressBoardFormat:i}).build();(await this.props.actionCreatorProviders.taskActionCreator()).createTask(gr.F.builder.withTask(e).withFormatData(d).build())},this.onAddUserToContainer=async e=>{const t=this.props.planStore.getPlan(this.props.viewPartitionKey);if(null!=(null===t||void 0===t?void 0:t.container)){(await this.props.actionCreatorProviders.userActionCreator()).addUsersToContainer([e],t.container)}},this.onRemoveUserFromPlan=async e=>{const{actionCreatorProviders:t,planStore:o,containerStore:n,viewPartitionKey:r}=this.props;if(null==e)return;const s=o.getPlan(r);if(null==s)return;const i=n.getContainer(s.container.externalId),a=i?this.getContainerMembers(i.externalId):[];let l=!1;for(let c=0;c<a.length;c++)if(a[c].id===e){l=!0;break}if(l)if(e===this.props.appContextStore.getCurrentUserId()){(await t.dialogActionCreator()).openLeavePlanDialog(s.id)}else{(await t.userActionCreator()).removeUserFromContainer(e,s.container)}},this.onHighlightTasks=async(e,t)=>{if(le.B.clientType!==h.s.Loop){(await this.props.actionCreatorProviders.wywaActionCreator()).setAnimateModifiedTasks(!1)}this.setState(o=>o.highlightField!==e||o.highlightValue!==t?{highlightField:e,highlightValue:t}:{highlightField:null,highlightValue:null})},this.onExportPlanToExcel=async e=>{(await this.props.actionCreatorProviders.exportActionCreator()).requestExportOperation(e,Di.Excel,wi.Plan)},this.onGetAssigneeSuggestion=(e,t)=>{var o;const n=null===(o=this.props.assigneeSuggestionStore)||void 0===o?void 0:o.getAssigneeSuggestions(e,null!=t?this.props.taskStore.getSimilarTasks(t):[]);if(null!=n){const e=[];for(const t of n){const o=this.props.userStore.getUserById(t.userId);null!=o&&e.push(new Ui.D(o,t.context,t.weight))}return e}return[]},this.getContainerMembers=e=>{var t;return null!==(t=this.props.userStore.getContainerUsers(e))&&void 0!==t?t:[]},this.onAddMember=async e=>{const t=this.getPlanContainer();if(null==t)return;(await this.props.actionCreatorProviders.userActionCreator()).addUsersToContainer([e],t.id)},this.getPlanContainer=()=>{const{viewPartitionKey:e,planStore:t,containerStore:o}=this.props,n=t.getPlan(e);return n&&o.getContainer(n.container.externalId)},this.canUserBeRemovedFromContainer=e=>{const t=this.getPlanContainer(),o=t?this.getContainerMembers(t.externalId):[];if((null===t||void 0===t?void 0:t.containerType)===de.K.Roster)return o.length>1;if((null===t||void 0===t?void 0:t.containerType)!==de.K.Group)return!1;const n=t;if(!n.unifiedGroup||!n.unifiedGroupDetails||!n.unifiedGroupDetails.owners)return!1;const r=n.unifiedGroupDetails.owners.length>1;return!(-1!==un()(n.unifiedGroupDetails.owners,t=>t.id===e)&&!r)},this.onPlanTitleClick=e=>{const{viewPartitionKey:t,planStore:o,containerStore:n}=this.props,r=o.getPlan(t);if(null==r)return;const s=n.getContainer(r.container.externalId),i=s?this.getContainerMembers(s.externalId):[],a=be(ae.getLinksCapabilitiesForPlan(s,i.length,r.container.containerType,this.getHasAccessViaSharedContainer(r)),ie.EnableSettings);this.getPlanHeaderDisableMode(r)===Te.DisableNothing&&a&&this.openPlanSettingsPanel(t,e)},this.openPlanSettingsPanel=async(e,t)=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openPlanSettingsPanel(e,t)},this.copyPlan=()=>{this.onOpenCopyPlanDialog(this.props.viewPartitionKey)},this.navigateToMyPlans=async()=>{(await this.props.actionCreatorProviders.navigationActionCreator()).navigate(d.EC.PlanHub,{})},this.openConvertPlan=()=>{var e,t;null===(e=(t=this.props).openConvertPlanModal)||void 0===e||e.call(t)},this.openLeavePlanDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openLeavePlanDialog(e)},this.getPlanHeaderDisableMode=e=>{const{permissionsStore:t,appContextStore:o}=this.props,n=t.getPlanPermissions(e);let r=Te.DisableNothing;return n.canEdit||n.canFavorite?(!n.canEdit&&n.canFavorite||o.getClientFlavor()===u.g.TeamsPersonalApp)&&(r=Te.DisablePlanChanges):r=Te.DisableAll,r},this.openPlanTasksICalendarDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openPublishTasksToCalenderDialog(e)},this.openTeamsAboutDialog=async()=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openTeamsAboutDialog()},this.openSharePlanDialog=async e=>{(await this.props.actionCreatorProviders.dialogActionCreator()).openSharePlanDialog(e,[])},this.onClickTrialButton=async(e,t,o,n)=>{var r,s;if(e)null===(r=(s=this.props).openUpsellStatusModal)||void 0===r||r.call(s);else if(t){var i,a;null===(i=(a=this.props).openConvertPlanModal)||void 0===i||i.call(a)}else if(o){var l,c;null===(l=(c=this.props).openTryPremiumModal)||void 0===l||l.call(c,k.vR.Header)}else if(n){var p,d;null===(p=(d=this.props).openRequestPremiumLicenseModal)||void 0===p||p.call(d)}},this.onClickCopilotButton=async()=>{var e,t,o,n;const{userStore:r,permissionsStore:s}=this.props;switch(r.p3TrialEligibilityStatus()){case m.RG.EligibleForSelfService:return void(null===(e=(t=this.props).openCopilotUpsellModal)||void 0===e||e.call(t));case m.RG.EligibleToRequestOnly:return void(null===(o=(n=this.props).openRequestPremiumLicenseModal)||void 0===o||o.call(n))}const i=r.getCurrentUserProjectSubscriptionStatus(),a=i&&(0,Ji.yJ)(i),l=s.canAccessCopilot();var c,p,d,u;a||!a&&l?null===(c=(p=this.props).openCopilotUpsellModal)||void 0===c||c.call(p):null===(d=(u=this.props).openGetSubscriptionCallout)||void 0===d||d.call(u)},this.onClickFeedback=async()=>{var e,t;null===(e=(t=this.props).openInAppFeedback)||void 0===e||e.call(t)},this.getPlanImage=()=>{const{planStore:e,containerStore:t,viewPartitionKey:o}=this.props,n=e.getPlan(o);if(null==n)return null;const r=e.getPlanDetails(o);return(0,xt.R6)(n,r,t.getContainerPhotoById.bind(t))},this.getBadgeIconAriaLabel=()=>{const{flights:e}=this.props,t=this.getPlanContainer();let o;if(e.EnableDocumentTasks&&(null===t||void 0===t?void 0:t.containerType)===de.K.DriveItem)o=Ie.p.Strings.PlanHeader_BadgeIconTextDocumentPlan;else if((null===t||void 0===t?void 0:t.containerType)===de.K.Group){const e=t;o=e.unifiedGroup?e.unifiedGroup.visibility===he.X.Public?Ie.p.Strings.PlanHeader_BadgeIconTextPublicPlan:Ie.p.Strings.PlanHeader_BadgeIconTextPrivatePlan:void 0}else(null===t||void 0===t?void 0:t.containerType)===de.K.Roster&&this.getVisibleContextKeys().length>0&&(o=Ie.p.Strings.PlanHeader_BadgeIconTextRosterPlan);return o},this.getVisibleContextKeys=()=>{const{viewPartitionKey:e,planStore:t}=this.props,o=t.getPlan(e),n=t.getPlanDetails(e),r=[];for(const s in null===n||void 0===n?void 0:n.contextDetails)null!==n&&void 0!==n&&n.contextDetails[s].isVisible()&&null!=(null===o||void 0===o?void 0:o.contexts[s])&&r.push(s);return r},this.getPlanRoutingDetails=()=>{const{viewPartitionKey:e,planStore:t}=this.props,o=t.getPlan(e);return{planId:e,planType:L.Basic,planName:null===o||void 0===o?void 0:o.title}},this.renderUncategorizedBucketHeaderImage=()=>z.createElement(ir.S,{content:Ie.p.Strings.Bucket_NullBucketInfoIconText},z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.an),{},{"aria-label":Ie.p.Strings.Bucket_NullBucketInfoIconText,"aria-hidden":"false"}))),this.redirectToPlanList=()=>{this.navigateToPage(d.EC.PlanHub,{},void 0,d.jf.Other)},this.openICalendarDialog=async e=>{this.props.loggers.usageLogger.logData(this.usageloggingConstant,g.M.ICalendarDialogOpened);(await this.props.actionCreatorProviders.dialogActionCreator()).openPublishTasksToCalenderDialog(e)},this.onRenderPlanPhoto=async()=>{const{viewPartitionKey:e,actionCreatorProviders:t}=this.props;(await t.unifiedGroupActionCreator()).ensureGroupPhotoForPlan(e)}}}$i.contextType=C.Do,$i.openedPlans=!1;var ea,ta=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),oa=function(){return oa=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},oa.apply(this,arguments)};!function(e){e[e.Board=0]="Board",e[e.List=1]="List"}(ea||(ea={}));var na=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n.boardViewUlElementRef=z.createRef(),n.dragToScrollData={isDragging:!1,initialScrollValue:0},n.onPointerDown=function(e){n.props.enableDragToScroll&&n.boardViewUlElementRef.current&&e.target instanceof HTMLElement&&e.target.dataset.canDragToScroll&&"mouse"===e.pointerType&&0===e.button&&(n.boardViewUlElementRef.current.setPointerCapture(e.pointerId),n.dragToScrollData={isDragging:!0,initialScrollValue:n.boardViewUlElementRef.current.scrollLeft+e.clientX})},n.onPointerMove=function(e){n.dragToScrollData.isDragging&&n.boardViewUlElementRef.current&&e.clientX&&(e.preventDefault(),n.boardViewUlElementRef.current.scrollLeft=n.dragToScrollData.initialScrollValue-e.clientX)},n.onPointerUp=function(e){var t;null===(t=n.boardViewUlElementRef.current)||void 0===t||t.releasePointerCapture(e.pointerId),n.dragToScrollData.isDragging=!1},n.state={placeholderIndex:null,draggedColumnIndex:null},n._previousPointerPosition=null,n}return ta(t,e),t.prototype.name=function(){return"BoardView"},t.prototype.renderComponent=function(){var e=this,t=this.props.columnDefinitions.map(function(t,o){return e.renderBoardViewColumn(t,o)});if(this.props.isOver&&null!=this.state.placeholderIndex&&t.splice(this.state.placeholderIndex,0,z.createElement("li",{key:"placeholderColumn","data-dnd-role":"placeholder",className:this.props.placeholderColumnClassName})),null==this.props.connectDropTarget)throw new Error("connectDropTarget not defined");var o=this.props.enableDragToScroll?{onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp}:null;return this.props.connectDropTarget(z.createElement("div",{className:this.props.boardViewClassName},this.renderDragPreviews(),z.createElement("ul",oa({ref:this.boardViewUlElementRef},o),t,this.props.columnCreationEnabled?this.renderAddColumnControl():null)))},t.prototype.boardCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.boardTarget=function(){return{drop:function(e,t,o){var n=o,r=n.props.callbacks.onColumnDrop;if(r){var s=n.state.placeholderIndex;if(null==t)throw new Error("monitor not defined");var i=t.getItem(),a=s===i.props.index+1?s-2:s-1,l=s===i.props.index&&i.props.index===n.props.columnDefinitions.length-1,c=n.props.columnDefinitions[s]&&!l?n.props.columnDefinitions[s].pivotValue:null,p=n.props.columnDefinitions[a]?n.props.columnDefinitions[a].pivotValue:null;r(i.props.pivotValue,p,c)}},hover:An()(function(e,t,o){if(null==t)throw new Error("monitor not defined");var n=o,r=t.getClientOffset(),s=n.state.placeholderIndex;if(null!=r){var i=n.getDisplayMode()===ea.List?r.y:r.x,a=null===n._previousPointerPosition?0:i-n._previousPointerPosition;n._previousPointerPosition=i;var l=document.elementFromPoint(r.x,r.y);if(null!==(l=n.findTarget(l))){var c=parseInt(l.getAttribute("data-index")||"",10),p=l.getBoundingClientRect().top+l.getBoundingClientRect().bottom,d=l.getBoundingClientRect().left+l.getBoundingClientRect().right,u=i-(n.getDisplayMode()===ea.List?p:d)/2>=0;if((null===s||Math.abs(c-s)>1)&&u&&(c+=1),s===c&&(c+=1),!(a<0&&c===s+1||a>0&&c===s-1||0===a&&null!==s)&&null!==c&&c!==s){var h=t.getItem();n.setPlaceholder(c,h.props.index)}}}},50)}},t.prototype.findTarget=function(e){return null==e||"placeholder"===e.getAttribute("data-dnd-role")?null:("column"===e.getAttribute("data-dnd-role")||(e=e.parentElement,e=this.findTarget(e)),e)},t.prototype.setPlaceholder=function(e,t){this.setState({placeholderIndex:e,draggedColumnIndex:t})},t.prototype.renderDragPreviews=function(){return null},t.prototype.renderAddColumnControl=function(){return null},t.prototype.getDisplayMode=function(){return this.props.displayMode||ea.Board},t}(pe.$),ra=o(46646),sa=o(11034),ia=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),aa=function(e){function t(t,o){return e.call(this,t,o)||this}return ia(t,e),t.prototype.renderComponent=function(){return this.props.connectDragSource?this.props.connectDragSource(z.createElement("li",{className:this.props.className,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":!0===this.props.disableDrag?void 0:"column"},this.renderColumnHeader(),this.renderColumnBody())):null},t.prototype.columnSource=function(){return{beginDrag:function(e){return{props:e}},canDrag:function(e){return!0!==e.disableDrag}}},t.prototype.columnCollect=function(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource()}},t.prototype.name=function(){return"BoardColumn"},t}(pe.$),la=o(75886),ca=o(11079),pa=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),da=function(e){function t(t,o){var n=e.call(this,t,o)||this;return n._previousPointerYPosition=null,n}return pa(t,e),t.prototype.renderComponent=function(){var e=this,t=this.renderSectionToggle(),o=this.renderAddButton(),n=this.props.data.map(function(t,o){return e.renderEntityCard(t,o)}),r=this.props.isOver?this.state.placeholderIndex:null;if(null!=r&&n.splice(r,0,z.createElement("div",{style:{position:"relative"},key:"placeholder",className:this.props.placeholderCardClassName,"data-dnd-role":"placeholder"},z.createElement("div",{style:{opacity:0,visibility:"hidden"}},this.renderEntityCard(this.props.isOver?this.state.draggedEntity:null,null)))),null==this.props.connectDropTarget)throw new Error("connectDropTarget not defined");return this.props.connectDropTarget(z.createElement("div",{className:this.props.columnGroupClassName,"data-dnd-role":"columnGroup"},this.props.isCollapsable?t:null,z.createElement("div",{"data-dnd-role":"topDropZone",className:this.props.topDropZoneClassName},null!=this.props.callbacks.addCardControlProvider?o:null),z.createElement("ul",{className:this.state.showSection?void 0:"hidden"},null!=this.props.callbacks.addCardControlProvider&&this.state.showAddEntityCard?this.renderAddCardControl():null,n),this.state.showSection?z.createElement("div",{"data-dnd-role":"bottomDropZone",className:this.props.bottomDropZoneClassName}):null))},t.prototype.groupTarget=function(){return{drop:function(e,t,o){var n=o,r=n.props.callbacks.valueSetter,s=n.state.placeholderIndex;if(n.onDrop(n.props,t,o),null==t)throw new Error("monitor not defined");if("card"===t.getItemType()){var i=t.getItem(),a=i.sourceColumnValue===n.props.columnValue&&i.secondaryGrouping===n.props.secondaryGrouping,l=void 0;l=a&&s===i.index+1?s-2:s-1;var c=!1;a&&(c=s===i.index&&i.index===n.props.data.length-1);var p=n.props.data[s]&&!c?n.props.data[s]:null,d=n.props.data[l]?n.props.data[l]:null,u=n.props.callbacks.secondaryValueSetter;u&&u(i.entity,n.props.secondaryGrouping,i.secondaryGrouping),r(i.entity,d,p,i.sourceColumnValue)}},hover:An()(function(e,t,o){var n=o;if(n.onHover(e,t,o),null==t)throw new Error("monitor not defined");if("card"===t.getItemType()){var r=t.getItem(),s=t.getClientOffset();if(null==s)return;var i=null===n._previousPointerYPosition?0:s.y-n._previousPointerYPosition;n._previousPointerYPosition=s.y;var a=document.elementFromPoint(s.x,s.y);if((a=n.findTarget(a))&&"topDropZone"===a.getAttribute("data-dnd-role")&&n.setPlaceholder(0,r),a&&"bottomDropZone"===a.getAttribute("data-dnd-role")&&n.setPlaceholder(n.props.data.length,r),a&&"card"===a.getAttribute("data-dnd-role")){var l=s.y-(a.getBoundingClientRect().top+a.getBoundingClientRect().bottom)/2<=0,c=parseInt(a.getAttribute("data-index")||"",10),p=n.state.placeholderIndex;if((null===p||Math.abs(c-p)>1)&&!l&&(c+=1),p===c&&(c+=1),i<0&&c===p+1||i>0&&c===p-1||0===i&&null!==n.state.placeholderIndex)return;n.setPlaceholder(c,r)}a&&"sectionToggle"===a.getAttribute("data-dnd-role")&&(!1===n.state.showSection&&n.setState({showSection:!0}),n.setPlaceholder(0,r))}},50)}},t.prototype.groupCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.name=function(){return"BoardColumnGroup"},t.prototype.findTarget=function(e){if(null==e)return null;var t=e.getAttribute("data-dnd-role");return"placeholder"===t?null:("card"===t||"columnGroup"===t||"sectionToggle"===t||null===t&&(e=e.parentElement,e=this.findTarget(e)),e)},t.prototype.setPlaceholder=function(e,t){this.setState({draggedEntity:t.entity,placeholderIndex:e})},t.prototype.renderSectionToggle=function(){return z.createElement("div",{className:"sectionToggle","data-dnd-role":"sectionToggle",onClick:this.toggleShowSection.bind(this)},z.createElement("div",{className:"icon"},z.createElement(xe.I,{iconName:"ChevronDown",className:this.state.showSection?"rotated":"straight"})),z.createElement("div",{className:"toggleText"},this.props.callbacks.sectionTitleProvider?this.props.callbacks.sectionTitleProvider(this.state.showSection):""),z.createElement("div",{className:"sectionItemCount"},this.props.data.length),z.createElement("div",{className:"labelSpacer"}))},t.prototype.renderAddButton=function(){return z.createElement("div",{className:"addButtonContainer"},z.createElement("button",{className:"addButton",onClick:this.toggleAddCardControl.bind(this)},z.createElement(xe.I,{iconName:"Add"})),z.createElement("div",{className:"labelSpacer"}))},t.prototype.toggleAddCardControl=function(){this.props.callbacks.addCardControlProvider&&this.setState({showAddEntityCard:!this.state.showAddEntityCard})},t.prototype.toggleShowSection=function(){!0===this.props.isCollapsable&&this.setState({showSection:!this.state.showSection})},t.prototype.onDrop=function(e,t,o){},t.prototype.onHover=function(e,t,o){},t}(pe.$),ua=o(79966);const ha="44px",ga="15px",ma="12px",Ca="30px",ka="32px",ba=Ue.B.ShadowMargin,Ta="4px",Sa="5px",Pa="288px",va="260px",xa=(0,Q.J9)(e=>{let t;switch(e){case ce.Sx.LoopLight:t={boxShadow:Ue.B.LoopLightRestShadow,backgroundColor:Re.z.White,":hover":{backgroundColor:Re.z.NeutralLightGrey96,boxShadow:Ue.B.LoopLightHoverShadow},":active":{backgroundColor:Re.z.NeutralLightGrey96,boxShadow:Ue.B.LoopLightRestShadow}};break;case ce.Sx.LoopDark:t={boxShadow:Ue.B.LoopDarkRestShadow,backgroundColor:Re.z.NeutralDarkGrey20,":hover":{backgroundColor:Re.z.NeutralDarkGrey24,boxShadow:Ue.B.LoopDarkHoverShadow},":active":{backgroundColor:Re.z.NeutralDarkGrey24,boxShadow:Ue.B.LoopDarkRestShadow}}}return t}),ya=(0,ze.vb)((0,ze.jz)(Pa)+(0,ze.jz)(Ue.B.ScrollbarSpaceAround)),fa=(0,Q.J9)((e,t,o,n,r)=>{let s="0 ".concat(ga);switch(e){case ce.Sx.TeamsLight:case ce.Sx.TeamsDark:case ce.Sx.TeamsContrast:r||n||(s="0 ".concat(Ca," 0 0"));break;case ce.Sx.LoopLight:case ce.Sx.LoopDark:s="0 ".concat(ma);case ce.Sx.Light:case ce.Sx.Dark:case ce.Sx.SharePoint:}return[(0,Ne.gS)("column"),e===ce.Sx.SharePoint&&{outline:"none"},t===ea.Board&&[{padding:s},e===ce.Sx.SharePoint&&{"&:nth-child(1)":{paddingLeft:"0px"},"&:nth-last-child(1)":{paddingRight:"0px"}}],t===ea.List&&{display:"table"},{boxSizing:"contentBox","> .columnContent":[(0,Ne.gS)("column"),(0,Ne.GD)("100%"),{marginLeft:"-".concat(ba),marginRight:"-".concat(ba)}]},o&&{".columnContent":[{overflowX:"hidden",overflowY:"auto"}]}]}),Aa=(0,Q.J9)(e=>{let t=Pa;switch(e){case ce.Sx.LoopLight:case ce.Sx.LoopDark:t=va;case ce.Sx.Light:case ce.Sx.Dark:case ce.Sx.TeamsLight:case ce.Sx.TeamsDark:case ce.Sx.TeamsContrast:case ce.Sx.SharePoint:}return{paddingLeft:ba,paddingRight:ba,"> .columnHeaderTitle":[(0,Ne.$Z)(),(0,Ne.gS)(),{width:t}]}}),wa=(0,Q.J9)((e,t)=>[(0,Ne.GD)(),(0,Ne.gS)(),(0,Ne.q0)(),(0,Ne.aS)(e),{height:ka,lineHeight:ka,margin:"0px -".concat(Sa),fontSize:Y.s.medium,fontWeight:Y.BO.semibold,"> *":{margin:"0px ".concat(Sa)},"> .columnTitle":[(0,Ne.GD)(),(0,Ne.gS)(),{cursor:t?"default":"pointer",".plannerIcon":{display:"none"},"> h3":[Ne.xK,(0,Ne.GD)(),(0,Ne.q0)()]}],"> .editColumnTextField":[(0,Ne.GD)(),{".ms-TextField-field":{paddingLeft:"10px"}}]},(e===ce.Sx.LoopLight||e===ce.Sx.LoopDark)&&{paddingTop:Ue.B.ShadowMargin}]),Da=e=>{switch(e){case ce.Sx.Light:return Re.z.NeutralLighter;case ce.Sx.TeamsLight:return Re.z.NeutralLight;case ce.Sx.Dark:case ce.Sx.TeamsDark:return Re.z.DarkThemeAppBackgroundColor;case ce.Sx.TeamsContrast:return Re.z.Black;case ce.Sx.SharePoint:return Re.z.SharepointAddTaskButtonBackgroundColor();case ce.Sx.LoopLight:return Re.z.NeutralLighter;case ce.Sx.LoopDark:return Re.z.DarkThemeAppBackgroundColor;default:return""}},Ba=(0,Q.J9)(e=>{const t={root:{margin:"".concat(Ta," 0px"),position:"relative",width:"100%","&.ui-draggable-dragging":{opacity:"0.75"}},preview:{width:Pa}};return(0,Y.TW)(t,e)}),Ea=(0,Q.J9)(e=>{const t=Ba(e);return{root:(0,Y.Zq)("taskBoardCard",t.root),preview:(0,Y.Zq)("taskBoardCardPreview",t.preview)}});var Ia=o(17961),Fa=o.n(Ia),La=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ma=function(e){function t(t,o){return e.call(this,t,o)||this}return La(t,e),t.prototype.renderComponent=function(){return this.props.connectDragSource&&this.props.connectDropTarget?this.props.connectDragSource(this.props.connectDropTarget(z.createElement("div",{className:this.props.className,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":"card","aria-posinset":this.props.taskBoardCardPositionInColumnGroup,"aria-setsize":this.props.totalTasksInColumnGroup},this.cardRenderer()))):null},t.prototype.cardSource=function(){return{beginDrag:function(e){return{entity:e.entity,index:e.index,sourceColumnValue:e.columnValue,secondaryGrouping:e.secondaryGrouping}}}},t.prototype.cardTarget=function(){return{drop:this.onDrop.bind(this)}},t.prototype.cardCollect=function(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}},t.prototype.cardTargetCollect=function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}},t.prototype.name=function(){return"BoardCard"},t}(pe.$),Na=o(64226);const Ra=z.createContext({isLabelCollapsed:!1});var Ua=o(10859),Oa=o(9100),Ha=o(15987),Va=function(){return Va=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Va.apply(this,arguments)},Ga=function(e){return z.createElement(Rs.r,Va({"aria-label":e.ariaLabel,tabIndex:e.isKeyboardFocusable?0:-1,"data-is-focusable":e.isKeyboardFocusable,title:e.ariaLabel},e),e.label)},Wa=o(51129);const _a="6px",za="12px",Za="16px",Ka="16px",qa="18px",ja="10px",Qa="236px",Ya=(0,ze.vb)((0,ze.jz)(Qa)-(0,ze.jz)(qa)),Ja="20px",Xa="2px",$a="8px",el="2px",tl="85px",ol="32px",nl="4px",rl="1px solid ".concat(Re.z.WywaLightColor),sl="1px solid ".concat(Re.z.WywaDarkColor),il="1px solid ".concat(Re.z.WywaTeamsLightColor),al="1px solid ".concat(Re.z.TeamsAppBrand00),ll="1px solid ".concat(Re.z.WywaTeamsDarkColor),cl="1px solid ".concat(Re.z.HighContrastCyan),pl=(0,Q.J9)((e,t,o,n,r,s,i,a)=>{const l=(0,Y.i7)({from:xl(e),to:yl(e)}),c=Rt.d.isLoopTheme(e),p={root:[(0,Ne.gS)("row","nowrap"),{cursor:"pointer",":hover":[{".bottomBar .ms-Facepile-addButton":{opacity:"1"}},c&&[xa(e),{borderRadius:Ue.B.LoopBorderRadius}]],"> .container":[Ue.B.CardShadow,(0,Ne.NX)(e),(0,Ne.$Z)(),xa(e),(0,Ne.gS)("row","nowrap"),{minHeight:"10px",borderRadius:Ue.B.PlannerBorderRadius,width:"100%","> .textContent":(0,Ne.GD)()},e===ce.Sx.TeamsContrast&&!n&&{border:"1px solid ".concat(Re.z.White),":hover":{borderColor:Re.z.TeamsContrastHyperlinkColor}},n&&yl(e),r&&[xl(e),{animation:"".concat(l," 1s 3s forwards")}],c&&[xa(e),{borderRadius:Ue.B.LoopBorderRadius}]]}],textContent:[(0,Ne.gS)("column"),(0,Oe.kE)(),{cursor:"pointer",position:"relative",borderRadius:c?Ue.B.LoopBorderRadius:"".concat(Ue.B.PlannerBorderRadius," ").concat(Ue.B.PlannerBorderRadius," 0 0"),":hover":[{"> .taskMenuSection > .indicator":[{opacity:"1"},c&&[(0,Ne.zK)(e),{".plannerMore > span":(0,Oe.c3)()}]]}],"> .labels":[(0,Ne.GD)("auto"),(0,Ne.gS)("row"),{flexWrap:"wrap",justifyContent:"flex-start",padding:za,paddingBottom:"0px",marginBottom:"-".concat(_a),"> :last-child":{marginRight:"0px"},"> li":{marginRight:_a,marginBottom:_a}}],"> .topBar":[(0,Ne.GD)("auto"),(0,Ne.gS)("column"),{justifyContent:"space-between",padding:za,"> .titleRow":hl(e,o,r),"> .planName":dl(e),"> .bucketName":ul(e)}]},o&&[e===ce.Sx.SharePoint&&{backgroundColor:Re.z.SharepointAddTaskButtonBackgroundColor()},e===ce.Sx.TeamsContrast&&{backgroundColor:Re.z.Black}],s&&fl(e)],taskMenuSection:[(0,Ne.gS)(),(0,Ne.$Z)("auto"),(0,Ne.Ml)(e),{fontSize:Y.s.small,right:"2px",top:"12px",lineHeight:Ja,letterSpacing:"0.75px",alignItems:"flex-start",margin:"0px ".concat(Xa),position:"absolute","> .indicator":[(0,Ne.gS)(),(0,Ne.$Z)(),(0,Ne.NX)(e),{fontSize:Y.s.xSmall,margin:"0px ".concat((0,ze.vb)((0,ze.jz)($a)/2-(0,ze.jz)(Xa))),padding:"0px ".concat(el),opacity:"0"}],"> .indicator.clickable":Sl(e),"> .indicator.menuOpen":[{opacity:"1"},c&&{":hover":[(0,Ne.wA)(e),(0,Oe.cP)()]}],"> .indicator:focus":{opacity:"1"}}],thumbnail:[(0,Ne.$Z)("162px"),(0,Ne.gS)(),Ne.cc,{textAlign:"center",wordWrap:"break-word",overflow:"hidden",borderRadius:"".concat(Ue.B.PlannerBorderRadius," ").concat(Ue.B.PlannerBorderRadius," 0 0"),"> .fallbackPreviewIcon":[{fontSize:ol,animation:"".concat(Pl," 1s"),"> svg":{height:ol,width:ol}},e===ce.Sx.TeamsContrast&&{color:Re.z.White}],"> .previewImage > img.is-loaded":{maxWidth:"100%",minWidth:tl,minHeight:tl,pointerEvents:"none"},"&.real":[{borderBottom:"1px solid"},(0,Ne.au)(e),vl(e,o)],"&.placeholder":[{borderBottom:"1px solid"},vl(e,o),(0,Ne.au)(e),n&&(e===ce.Sx.Dark||e===ce.Sx.TeamsDark)&&{borderColor:ar.kd.gray140},r&&e===ce.Sx.TeamsContrast&&{borderColor:Re.z.Black}]},o&&e===ce.Sx.SharePoint&&{"& .real":{backgroundColor:Re.z.SharepointAddTaskButtonBackgroundColor()}},o&&e===ce.Sx.TeamsContrast&&{"& .real":{backgroundColor:Re.z.Black}}],preview:[(0,Ne.gS)(),{marginTop:"10px",fontSize:Y.s.size16,"> *":{flex:"0 1 auto",maxWidth:"100%"},"> .notesPreview":[(0,Ne.Ml)(e),(0,Ne.Gn)(),{fontSize:Y.s.small,wordWrap:"normal",maxHeight:"80px",marginLeft:"28px"},e===ce.Sx.SharePoint&&{color:Re.z.SharepointTitleFontColor()},e===ce.Sx.TeamsContrast&&{color:Re.z.White}],"> .referencePreviewDescription":[(0,Ne.gS)(),{alignItems:"center","> .previewIcon":[(0,Ne.$Z)(),{marginRight:"11px",marginLeft:"1px",padding:"0",height:Za,width:Za,"> .ms-Image > img":{height:Za,width:Za}},e===ce.Sx.SharePoint&&{color:Re.z.SharepointTitleFontColor()},e===ce.Sx.TeamsContrast&&{color:Re.z.White}],"> .previewCaption":[(0,Ne.q0)(),{fontSize:Y.s.small,flex:"0 1 auto",minHeight:"16px"}],":hover > .previewCaption":[{textDecoration:"underline"},e===ce.Sx.TeamsContrast&&{color:Re.z.TeamsContrastHyperlinkColor}]}],"> .checklistPreview":gl(e,i)}],topBar:[(0,Ne.gS)(),{"> .bucketName.disableUpdateBucket":{cursor:"default","> a:hover":{backgroundColor:"transparent"}}}],indicatorRow:[(0,Ne.gS)(),(0,Ne.$Z)("auto"),(0,Ne.Ml)(e),{fontSize:Y.s.size12,lineHeight:Ja,marginTop:"16px",marginBottom:"-4px",letterSpacing:"0.75px","> *":[(0,Ne.gS)(),{alignItems:"center",margin:"0px -".concat((0,ze.vb)((0,ze.jz)($a)/2+(0,ze.jz)(el))),"> .indicator":[(0,Ne.gS)(),(0,Ne.$Z)(),{margin:"0px ".concat((0,ze.vb)((0,ze.jz)($a)/2-(0,ze.jz)(Xa))),padding:"0px ".concat(el)}]}],"> .leftSection":[(0,Ne.GD)()]},r&&e===ce.Sx.TeamsContrast&&{".indicator > .ms-Button > .ms-Button-flexContainer > .ms-Button-icon":{color:Re.z.Black},".indicator > .ms-Button > .ms-Button-flexContainer > .ms-Button-textContainer > .ms-Button-label":{color:Re.z.Black}}],requiredCompleteIcon:[(0,Ne.$Z)(qa),{marginRight:ja,marginBottom:"auto"}],bottomBar:[(0,Ne.gS)("row"),{"&.noDisplayBottomBar":[{display:"none"}],transition:"color 0.167s ease-in-out, background 0.167s ease-in-out",borderTop:"1px solid",borderRadius:"0 0 ".concat(Ue.B.PlannerBorderRadius," ").concat(Ue.B.PlannerBorderRadius),"> .completedAssignment":[(0,Ne.GD)(),{padding:"".concat("8px"," ").concat("14px"),width:"100%",".ms-Persona-primaryText":[(0,Ne.aS)(e)]}],"> .bottomBarLeftSection":[(0,Ne.gS)(),{paddingLeft:"12px"," > .dueDateIndicator":{margin:"".concat("6px"," 0px")}}],"> .bottomBarRightSection":[(0,Ne.gS)(),{right:"12px",position:"absolute",marginTop:"6px"}]},(0,Ne.au)(e),o&&e===ce.Sx.TeamsContrast&&[{backgroundColor:Re.z.Black,color:Re.z.White,borderTop:"1px solid ".concat(Re.z.NeutralLighter),":hover":{backgroundColor:Re.z.Black,color:Re.z.White}}],o&&e===ce.Sx.SharePoint&&[{borderTop:"1px solid ".concat(Re.z.SharepointBackgroundColor()),backgroundColor:Re.z.SharepointAddTaskButtonBackgroundColor()}],n&&(e===ce.Sx.Dark||e===ce.Sx.TeamsDark)&&{borderColor:ar.kd.gray140},s&&fl(e)]};return(0,Y.TW)(p,t)}),dl=e=>[(0,Ne.$Z)(),(0,Ne.q0)(),(0,Ne._D)(e),{fontSize:Y.s.small,fontWeight:Y.BO.semibold,marginBottom:"15px",marginTop:"-5px",textOverflow:"ellipsis",wordWrap:"break-word",minHeight:"16px"}],ul=e=>{const t=Rt.d.isLoopTheme(e);return[(0,Ne.$Z)(),(0,Ne.q0)(),{fontSize:Y.s.small,fontWeight:Y.BO.semibold,marginTop:"10px",textOverflow:"ellipsis",wordWrap:"break-word","> a":[(0,Ne._D)(e),{padding:"4px",":hover":[(0,Ne.zK)(e),e===ce.Sx.TeamsContrast&&{backgroundColor:"transparent",color:Re.z.TeamsContrastHyperlinkColor},t&&(0,Ne.NX)(e)]},Sl(e)]}]},hl=(e,t,o)=>{const n=Rt.d.isLoopTheme(e);return[(0,Ne.$Z)(),(0,Ne.gS)("row"),{"> .completeButtonWithAnimation":[(0,Ne.$Z)(qa),{marginRight:ja}],"> .title":[(0,Ne.aS)(e),(0,Ne.$Z)(n?Ya:Qa),{marginTop:"-1px",fontSize:Y.s.medium,fontWeight:Y.BO.regular,overflow:"hidden"},t&&[(0,Ne.Ml)(e),{textDecoration:"line-through"}],o&&e===ce.Sx.TeamsContrast&&{color:Re.z.Black}],".toggleCheckLabel":[o&&e===ce.Sx.TeamsContrast&&{color:Re.z.Black}]}]},gl=(e,t)=>[(0,Ne.GD)(),{marginLeft:"1px","*":{marginTop:"0px !important",marginLeft:"0px !important"},"> .checklistItem":[(0,Ne.gS)(),(0,Ne.q0)(),{height:Ka,padding:"3px 0px 3px 3px","> .clickWrapper":{"> .checklistItemText":[(0,Ne.Ml)(e),{maxWidth:"100%",".ms-Checkbox-text":[(0,Ne.q0)("ellipsis"),(0,Ne.Ml)(e),(0,Oe.M8)(),{":hover":[(0,Oe.M8)(),{textDecoration:"underline"}],fontSize:Y.s.small,lineHeight:Ka,marginTop:"0px"},e===ce.Sx.SharePoint&&{color:Re.z.SharepointTitleFontColor()},e===ce.Sx.TeamsContrast&&{color:Re.z.White}]},e===ce.Sx.TeamsContrast&&{color:Re.z.White,"> .ms-Checkbox-label > .ms-Checkbox-checkbox":{borderColor:Re.z.White,"> .ms-Checkbox-checkmark":{color:Re.z.TeamsContrastHyperlinkColor},"&:hover":{borderColor:Re.z.TeamsContrastHyperlinkColor}}},t&&{".ms-Checkbox-label span:hover":{textDecoration:"none"}}]}}],".ms-Checkbox-checkbox":[(0,Ne.jI)(e),{margin:"0px",marginRight:"".concat("11px"," !important"),borderRadius:"50%",flex:"0 0 ".concat(Ka),height:Ka,width:Ka,"> .ms-Checkbox-checkmark":{width:Wa.kT}}]}],ml=(0,Q.J9)(e=>({root:(0,Y.Zq)("taskCard",e.root),textContent:(0,Y.Zq)("textContent",e.textContent),taskMenuSection:(0,Y.Zq)("taskMenuSection",e.taskMenuSection),thumbnail:(0,Y.Zq)("thumbnail",e.thumbnail),preview:(0,Y.Zq)("preview",e.preview),indicatorRow:(0,Y.Zq)("indicatorRow",e.indicatorRow),bottomBar:(0,Y.Zq)("bottomBar",e.bottomBar),topBar:(0,Y.Zq)("topBar",e.topBar),requiredCompleteIcon:(0,Y.Zq)("requiredCompleteIcon",e.requiredCompleteIcon)})),Cl=(0,Q.J9)(()=>{const e={maxHeight:"280px",maxWidth:Pa,".labelTagMenuButton":[Ne.xK,(0,Ne.gS)(),{paddingLeft:nl,paddingRight:(0,ze.vb)(2*(0,ze.jz)(nl)),alignItems:"center",cursor:"pointer",width:"100%",height:"32px","> .ms-ContextualMenu-checkmarkIcon":[(0,Ne.$Z)(),(0,Ne.gS)(),Ne.cc,{margin:"0px ".concat(nl)}],"> .labelTag":[(0,Ne.$Z)(),{marginLeft:nl,maxWidth:"234px"}]}]};return(0,Y.Zq)("taskCardContextMenu",e)}),kl="24px",bl="6px",Tl=(0,Q.J9)((e,t)=>{const o=Rt.d.isLoopTheme(t);return{root:[(0,Ne.GD)(),{width:"100%"}],assigneeRow:[e&&{":hover .addFriendIcon":{opacity:"1"}},{".ms-Facepile-member":{margin:"0px 4px",marginBottom:bl,".ms-Persona-primaryText":{maxWidth:"92px"}},".ms-Facepile-addButton":{marginBottom:bl,opacity:"0",borderRadius:"50%"},".ms-Facepile-addButton:focus":{opacity:"1"},".ms-Facepile-addButton:hover":[(0,Ne.wA)(t)],".ms-Facepile-addButton i":{margin:"1px 2px 0px"},".ms-Facepile-descriptiveOverflowButton":{marginBottom:bl},".assignDiv .addFriendIcon":{marginLeft:"4px",marginRight:"0px"}}],addFriendIcon:[o?(0,Ne.aS)(t):(0,Ne._D)(t),{marginBottom:"3px",backgroundColor:"transparent",position:"absolute",bottom:"0px",opacity:"1",transition:"opacity 0.167s ease-in-out"}],assignDiv:{height:kl,width:kl," &:hover":[(0,Ne.wA)(t),{borderRadius:"50%"}]}}}),Sl=(0,Q.J9)(e=>{const t=Rt.d.isLoopTheme(e);return{borderRadius:t?"4px":"2px",":hover":[(0,Ne.Mi)(e),t&&[(0,Ne.wA)(e),(0,Oe.cP)(),{"> .plannerMore":[(0,Ne._D)(e),{"> span":(0,Oe.cP)()}],".plannerIcon > span":(0,Oe.cP)()}]]}}),Pl=(0,Y.i7)({from:{opacity:0},to:{opacity:1}}),vl=(0,Q.J9)((e,t)=>{let o=ar.kd.gray10;switch(e){case ce.Sx.Dark:case ce.Sx.TeamsDark:o=ar.kd.gray170;break;case ce.Sx.TeamsContrast:o=Re.z.Black;break;case ce.Sx.SharePoint:o=t?Re.z.SharepointAddTaskButtonBackgroundColor():Re.z.SharepointBackgroundColor();case ce.Sx.Light:case ce.Sx.TeamsLight:}return{backgroundColor:o}}),xl=(0,Q.J9)(e=>{let t=Re.z.WywaLightHighlightBackgroundColor,o=rl;switch(e){case ce.Sx.Dark:t=Re.z.WywaDarkHighlightBackgroundColor,o=sl;break;case ce.Sx.TeamsLight:t=Re.z.WywaTeamsLightHighlightBackgroundColor,o=il;break;case ce.Sx.TeamsDark:t=Re.z.WywaTeamsDarkHighlightBackgroundColor,o=ll;break;case ce.Sx.TeamsContrast:t=Re.z.TeamsContrastHyperlinkColor,o=cl;case ce.Sx.Light:}return{backgroundColor:t,border:o}}),yl=(0,Q.J9)(e=>{let t=Re.z.White,o=rl;switch(e){case ce.Sx.Dark:t=ar.kd.gray160,o=sl;break;case ce.Sx.TeamsLight:t=Re.z.White,o=al;break;case ce.Sx.TeamsDark:t=ar.kd.gray160,o=ll;break;case ce.Sx.TeamsContrast:t=Re.z.Black,o=cl;case ce.Sx.Light:}return{backgroundColor:t,border:o}}),fl=(0,Q.J9)(e=>{let t=Re.z.NeutralTertiary;switch(e){case ce.Sx.TeamsContrast:t=Re.z.Black;case ce.Sx.Light:case ce.Sx.Dark:case ce.Sx.TeamsLight:case ce.Sx.TeamsDark:case ce.Sx.SharePoint:}return{backgroundColor:t}}),Al=(0,Q.J9)(e=>{const t=[(0,Ne.GD)("auto"),Ne.xK,(0,Ne.Ml)(e),{fontSize:Y.s.xSmall,height:"100%"}],o=[(0,Ne.Ml)(e),(0,Oe.M8)()],n=[(0,Oe.M8)(),(0,Ne.Ml)(e),{padding:"0",margin:"2px",height:"100%"}];return{root:t,rootHovered:o,flexContainer:{padding:"0",margin:"0"},icon:n,iconHovered:n,iconPressed:n,textContainer:{letterSpacing:"0.75px",padding:"0 0 1px 0",margin:"0"},label:[(0,Ne.Ml)(e),{fontSize:Y.s.xSmall,padding:"0",margin:"2px"}]}}),wl=(0,Q.J9)((e,t,o)=>{const n=o&&Sl(e),r=e===ce.Sx.TeamsContrast&&{color:Re.z.White},s={color:e===ce.Sx.TeamsContrast?Re.z.Black:(0,_n.eX)(e,t)},i={root:n,rootExpanded:r,iconHovered:s,iconPressed:s,iconExpandedHovered:s};return(0,Y.TW)(Al(e),i)}),Dl=(0,Q.J9)((e,t,o)=>{const n=[o&&Sl(e)],r=e===ce.Sx.TeamsContrast&&{color:Re.z.White},s={color:e===ce.Sx.TeamsContrast?Re.z.Black:(0,_n.Bt)(e,t)},i={root:n,rootExpanded:r,iconHovered:s,iconPressed:s,iconExpandedHovered:s};return(0,Y.TW)(Al(e),i)}),Bl=e=>{const t=Math.max(e.numberOfAttachments,0),o=1===t?Ie.p.Strings.AttachmentIndicator_AttachmentsIndicatorAriaLabelSingular:Ie.p.Strings.AttachmentIndicator_AttachmentsIndicatorAriaLabelPlural,n=vt.G(o,t),r=Al(e.appTheme);return z.createElement("div",{className:"attachment indicator",title:n},z.createElement(Ga,(0,c.A)((0,c.A)({},e),{},{ariaLabel:n,label:t.toString(),iconProps:ot.M$,styles:r})))},El=e=>{const t=Math.max(e.numChecklistItems,0),o=Math.max(e.numCompletedChecklistItems,0),n=vt.G(Ie.p.Strings.ChecklistIndicator_ChecklistIndicatorAriaLabel,o,t),r=vt.G(Ie.p.Strings.TaskEditor_ChecklistFraction,o,t),s=Al(e.appTheme);return z.createElement("div",{className:"checkList indicator",title:n},z.createElement(Ga,(0,c.A)((0,c.A)({},e),{},{ariaLabel:n,label:r,iconProps:ot.tF,styles:s})))},Il=e=>{const t=Al(e.appTheme);return z.createElement("div",{className:"conversation indicator",title:e.ariaLabel},z.createElement(Ga,(0,c.A)((0,c.A)({},e),{},{ariaLabel:e.ariaLabel,iconProps:ot.CJ,styles:t})))};var Fl=o(3176),Ll=o(55228),Ml=o(60601);const Nl=z.memo(e=>{const{attachment:t,theme:o,isFocusable:n,onAttachmentClick:r,onKeyDown:s}=e,i=Fl.m.builder.fromTaskAttachment(t,"").build(),a=i.taskAttachmentRowItemType.taskAttachmentType,l=(0,Ll.$)(o,a);return z.createElement("a",{className:"referencePreviewDescription",title:i.url,"data-is-focusable":n,tabIndex:n?0:-1,onKeyDown:e=>{const t=Ml.$.getKey(e);t!==Le.D.ENTER&&t!==Le.D.SPACE||r(i.url,e),s(e)},onClick:e=>r(i.url,e)},z.createElement(Ua.$,{key:i.url,styles:l,taskAttachmentRowItem:i,className:"previewIcon",icons:Ll.b}),z.createElement("span",{className:"previewCaption"},i.alias))});var Rl=o(22344),Ul=o(5958);const Ol=(0,Q.J9)((e,t)=>{const o=Rt.d.isLoopTheme(e),n={root:[(0,Ne.gS)(),{display:"inline-flex",alignItems:"center",height:"24px",cursor:"default","&.clickable":{borderRadius:"2px",cursor:"pointer"},"&.clickable:hover":(0,Ne.wA)(e),"&.isLate":[(0,Ne.wM)(e),{borderRadius:o?"4px":"2px",transition:"background 0.167s ease-in-out","> .plannerIcon,.label":(0,Ne.sS)(e)}]}],calendarIcon:[o?(0,Ne.aS)(e):(0,Ne._D)(e),{paddingLeft:"2px",paddingRight:"2px"}],calendarLabel:[(0,Ne.aS)(e),{fontSize:Y.s.small,fontWeight:Y.BO.regular,paddingLeft:"2px",paddingRight:"8px"}],callout:(0,Ul.j)(e).callout};return(0,Y.TW)(n,t)}),Hl=(0,Q.J9)(e=>({root:(0,Y.Zq)("dueDateIndicator",e.root),calendarIcon:(0,Y.Zq)("calendarIcon",e.calendarIcon),calendarLabel:(0,Y.Zq)("calendarLabel",e.calendarLabel),callout:(0,Y.Zq)("dueDateIndicatorCallout",e.callout)})),Vl=e=>{var t;const{isItemVisible:o,toggleOnEvent:n,hideItem:r}=(()=>{const[e,t]=z.useState(!1);return{isItemVisible:e,toggleOnEvent:e=>{null===e||void 0===e||e.preventDefault(),null===e||void 0===e||e.stopPropagation(),t(e=>!e)},showItem:z.useCallback(()=>t(!0),[t]),hideItem:z.useCallback(()=>t(!1),[t])}})(),s=z.useRef(null),{ariaLabel:i,isKeyboardFocusable:a,task:l,taskPermissions:p,onKeyDown:d,onUpdateTask:u,appTheme:h,styles:g}=e,m=z.useCallback(e=>{const t=l.setDueDate(null==e?null:Zi()(e));u(l,t),r()},[l,u,r]),C=z.useCallback(e=>{Ye.a.getKey(e)===Le.D.ESCAPE&&r()},[r]),k=Hl(Ol(h,g)),b=z.useMemo(()=>(0,Qe.A)(null===k||void 0===k?void 0:k.root,p.canEdit&&p.canUpdateDueDate?"clickable":null,{isLate:l.isLate()}),[l,p,k]),T=l.dueDate?l.getFormattedDueDate():Ie.p.Strings.TaskCard_DueDatePlaceholder;let S;return S=null!==(t=l.recurrence)&&void 0!==t&&t.isActive()?ot.SO:ot.cx,z.createElement("div",{ref:s,className:b,"aria-label":i,title:i,"data-is-focusable":a,onClick:n,onKeyUp:C,onKeyDown:d,role:"button"},z.createElement(xe.I,(0,c.A)((0,c.A)({},S),{},{className:(0,Qe.A)(null===k||void 0===k?void 0:k.calendarIcon,S.className)})),z.createElement("span",{className:(0,Qe.A)(null===k||void 0===k?void 0:k.calendarLabel,"label"),tabIndex:-1},T),p.canUpdateDueDate&&o&&z.createElement(Bt.P,{isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:s,directionalHint:Xe.A.bottomLeftEdge,onDismiss:r,setInitialFocus:!0,className:Hl(Ol(h,g)).callout},z.createElement(wt.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},z.createElement(Rl.V,{onSelectDate:m,onDismiss:r,isMonthPickerVisible:!0,value:null!=l.dueDate?l.dueDate.toDate():void 0,today:new Date,theme:h}))))},Gl=e=>{const{priorityStrings:t,task:o,taskPermissions:n,appTheme:r,onUpdateTask:s}=e,{traceLogger:i}=(0,Es.t)(),a=z.useCallback((e,t)=>{let n;switch(t.key){case io.gy[io.gy.Urgent]:n=o.setProperty("priority",(0,ao._d)(io.gy.Urgent));break;case io.gy[io.gy.Important]:n=o.setProperty("priority",(0,ao._d)(io.gy.Important));break;case io.gy[io.gy.Medium]:n=o.setProperty("priority",(0,ao._d)(io.gy.Medium));break;case io.gy[io.gy.Low]:n=o.setProperty("priority",(0,ao._d)(io.gy.Low));break;default:return}s(o,n)},[o,s]),l=z.useMemo(()=>[{key:io.gy[io.gy.Urgent],disabled:!n.canUpdatePriorityToUrgent,name:t.priorityUrgentText,onClick:a,iconProps:(0,xt.m4)(i,r,io.gy.Urgent)},{key:io.gy[io.gy.Important],name:t.priorityImportantText,onClick:a,iconProps:(0,xt.m4)(i,r,io.gy.Important)},{key:io.gy[io.gy.Medium],name:t.priorityMediumText,onClick:a,iconProps:(0,xt.m4)(i,r,io.gy.Medium)},{key:io.gy[io.gy.Low],name:t.priorityLowText,onClick:a,iconProps:(0,xt.m4)(i,r,io.gy.Low)}],[t,a,n,r,i]),[p,d]=z.useMemo(()=>{let e=(0,xt.m4)(i,r,io.gy.Urgent,xt.lK.Small),n=t.priorityUrgentText;return(0,ao.aV)(o.priority)===io.gy.Important&&(e=(0,xt.m4)(i,r,io.gy.Important,xt.lK.Small),n=t.priorityImportantText),[e,n]},[o.priority,t,r,i]),u=wl(r,(0,ao.aV)(o.priority),n.canUpdatePriority);return z.createElement("div",{className:"priority indicator",title:d},z.createElement(Ga,(0,c.A)((0,c.A)({},e),{},{ariaLabel:d,iconProps:p,disabled:!n.canUpdatePriority,menuProps:{calloutProps:{className:"plannerAppCallout"},className:"contextualMenu",directionalHint:Xe.A.bottomAutoEdge,items:l,styles:(0,wo.Zo)(r)},menuIconProps:{iconName:"",style:{display:"none"}},styles:u})))},Wl=e=>{const{usageLogger:t,traceLogger:o}=(0,Es.t)(),{ariaLabel:n,progressState:r,progressStrings:s,task:i,appTheme:a,onUpdateTask:l,canUpdateProgress:p}=e,d=z.useCallback((e,o)=>{var n;let r;switch(t.logData("ProgressIndicatorOnTaskCard",g.M.TaskProgressChanged,{taskCreationSourceType:null!==(n=i.taskCreationSourceType)&&void 0!==n?n:""}),o.key){case co.$.NotStarted:r=i.setProperty("percentComplete",(0,ao.BK)(co.$.NotStarted));break;case co.$.InProgress:r=i.setProperty("percentComplete",(0,ao.BK)(co.$.InProgress));break;case co.$.Complete:r=i.setProperty("percentComplete",(0,ao.BK)(co.$.Complete));break;default:return}l(i,r)},[i,l,t]),u=z.useMemo(()=>(0,xt.Nu)(o,a,null!==r&&void 0!==r?r:co.$.InProgress,xt.lK.Small),[a,r,o]),h=z.useMemo(()=>[{key:co.$.NotStarted,name:s.notStartedText,onClick:d,iconProps:(0,xt.Nu)(o,a,co.$.NotStarted)},{key:co.$.InProgress,name:s.inProgressText,onClick:d,iconProps:(0,xt.Nu)(o,a,co.$.InProgress)},{key:co.$.Complete,name:s.completedText,onClick:d,iconProps:(0,xt.Nu)(o,a,co.$.Complete)}],[s,d,a,o]),m=Dl(a,null!==r&&void 0!==r?r:co.$.InProgress,p);return z.createElement("div",{className:"progress indicator",title:n},z.createElement(Ga,(0,c.A)((0,c.A)({},e),{},{ariaLabel:n,disabled:!p,iconProps:u,menuProps:{calloutProps:{className:"plannerAppCallout"},className:"contextualMenu",directionalHint:Xe.A.bottomAutoEdge,items:h,styles:(0,wo.Zo)(a)},menuIconProps:{iconName:"",style:{display:"none"}},styles:m})))};var _l,zl=o(62530),Zl=o(67058),Kl=o(54052),ql=o.n(Kl);!function(e){function t(e,t){return e.index===t.index?0:e.index<t.index?-1:1}e.getLabelPlaceholder=function(e){return null==e.name||""===e.name?e.placeholderText:e.name},e.sortLabelsByUsageAndIndex=function(e){var o=e.filter(function(e){return e.usageCount&&e.usageCount>0}).sort(t),n=e.filter(function(e){return null==e.usageCount||e.usageCount<=0}).sort(t),r=[];return r.push.apply(r,o),r.push.apply(r,n),r},e.compareLabelsByIndex=t}(_l||(_l={}));var jl=o(35525);class Ql extends pe.${name(){return"TaskContextMenu"}renderComponent(){const e=(0,Qe.A)("otherCommands indicator clickable",{menuOpen:this.state.isTaskContextMenuVisible});return z.createElement("div",{className:e,onClick:this.toggleOtherCommandsMenu.bind(this),title:Ie.p.Strings.TaskContextMenu_MoreButtonTooltipText,"aria-label":Ie.p.Strings.TaskContextMenu_MoreButtonTooltipText,"aria-expanded":this.state.isTaskContextMenuVisible,"aria-haspopup":!0,onKeyUp:this.handleOtherCommandsMenu.bind(this),onKeyDown:this.handleOnKeyDown.bind(this),"data-is-focusable":this.props.isFocusZoneEnabled,ref:null!=this.props.otherCommandsMenuCommandButton?this.props.otherCommandsMenuCommandButton:"TaskContextMenuButton",role:"button"},z.createElement(xe.I,ot.XP),this.state.isTaskContextMenuVisible?this.renderContextMenu():null)}renderContextMenu(){const e=[],{isTaskOnMyDay:t,toggleMyDayForTask:o}=this.props,n=this.props.task.getAssigneeIds().indexOf(le.B.currentUserId)>-1;if(le.B.isUnoContext&&n&&t&&o){const n=t(this.props.task.id),r=()=>{o(this.props.task.id)};e.push(((e,t)=>e?{key:jl.uU.RemoveFromMyDay,name:Ie.p.Strings.TaskContextMenu_RemoveFromMyDay,iconProps:ot.c6,title:Ie.p.Strings.TaskContextMenu_RemoveFromMyDayTooltip,onClick:t}:{key:jl.uU.AddToMyDay,name:Ie.p.Strings.TaskContextMenu_AddToMyDay,iconProps:ot.c6,title:Ie.p.Strings.TaskContextMenu_AddToMyDayTooltip,onClick:t})(n,r))}return this.renderLabelMenuItems(e),this.props.showAssign&&this.props.onClickAssign&&(0,ao.Fk)(this.props.task.percentComplete)!==co.$.Complete&&e.push({key:"Assign",name:Ie.p.Strings.TaskContextMenu_AssignOption,iconProps:this.iconPropsWithDefaultColor(ot.lO),onClick:this.props.onClickAssign.bind(this)}),e.push({key:"CopyTask",name:Ie.p.Strings.TaskContextMenu_CopyTaskOption,iconProps:this.iconPropsWithDefaultColor(ot.RC),onClick:this.onClickCopyTask.bind(this),disabled:!this.props.showCopyTask}),this.props.showCopyLinkToTask&&e.push({key:"CopyLinkToTask",name:Ie.p.Strings.TaskContextMenu_CopyLinkToTaskOption,iconProps:this.iconPropsWithDefaultColor(ot.M8),onClick:this.onClickCopyLinkToTask.bind(this)}),e.push({key:"MoveTask",name:Ie.p.Strings.TaskContextMenu_MoveTaskOption,iconProps:this.iconPropsWithDefaultColor(ot.Nk),onClick:this.onClickMoveTask.bind(this),disabled:!this.props.config.enableMoveTaskOperation}),this.props.showTaskDetails&&this.props.openTaskDetails&&e.push({key:"TaskDetails",name:Ie.p.Strings.TaskContextMenu_TaskDetailsOption,onClick:this.props.openTaskDetails.bind(this,this.props.task.id,()=>{})}),this.props.showDelete&&e.push({key:"Delete",name:Ie.p.Strings.TaskContextMenu_DeleteOption,iconProps:this.iconPropsWithDefaultColor(ot.pJ),onClick:this.handleDelete}),z.createElement($e.l,{className:Cl(),shouldFocusOnMount:!0,items:e,directionalHint:Xe.A.bottomAutoEdge,target:null!=this.props.otherCommandsMenuCommandButton?this.props.otherCommandsMenuCommandButton.current:this.refs.TaskContextMenuButton,onDismiss:this.dismissOtherCommandsMenu.bind(this),appTheme:this.props.theme})}renderLabelMenuItems(e){if(!this.props.showLabel)return;let t=[];null!=this.props.labels&&(t=this.state.taskPlanLabels.map(e=>({key:e.index.toString(),data:e,onRender:this.onRenderLabelMenuItem}))),t.length>0&&e.push({key:"Labels",name:Ie.p.Strings.TaskContextMenu_LabelOption,iconProps:this.iconPropsWithDefaultColor(ot.Oi),subMenuProps:{calloutProps:{className:"plannerAppCallout"},items:t,styles:(0,wo.Zo)(this.props.theme)},submenuIconProps:this.iconPropsWithDefaultColor(ot.rK)})}handleOtherCommandsMenu(e){const t=Ye.a.getKey(e);t===this.lastKeyDown&&t===Le.D.ENTER&&(e.stopPropagation(),this.toggleOtherCommandsMenu(e)),this.lastKeyDown=null}handleOnKeyDown(e){const t=Ye.a.getKey(e);t===Le.D.ENTER&&e.stopPropagation(),this.lastKeyDown=t,this.props.disableFocusZone(e)}toggleCategory(e){const t=this.props.task.getClone(),o=t.appliedCategories.indexOf(e);o>-1?(t.appliedCategories.splice(o,1),this.logUsage(g.M.RemoveLabelFromTask)):(t.appliedCategories.push(e),this.logUsage(g.M.AddLabelToTask,{isNewLabel:String(e>5)})),this.props.onFocusContainer&&this.props.onFocusContainer(),this.props.onUpdateTask&&this.props.onUpdateTask(this.props.task,t)}toggleOtherCommandsMenu(e){var t;e.stopPropagation();const{task:o,fetchTaskContainerPermissions:n,onOtherCommandsMenuOpened:r}=this.props;null!=(null===(t=o.creationSource)||void 0===t?void 0:t.publication)&&n(o);const s=this.getSortedLabels();this.setState(e=>{var t;e.isTaskContextMenuVisible||this.context.usageLogger.logData(this.name(),g.M.TaskCardContextMenuClicked,{taskCreationSourceType:null!==(t=o.taskCreationSourceType)&&void 0!==t?t:""});return{isTaskContextMenuVisible:!e.isTaskContextMenuVisible,taskPlanLabels:s}},()=>{r&&r()})}getSortedLabels(){var e;let t=null!==(e=this.props.labels)&&void 0!==e?e:[];return t=_l.sortLabelsByUsageAndIndex(t),t}onDeleteTask(){var e,t;null===(e=(t=this.props).deleteTask)||void 0===e||e.call(t,this.props.task.id)}onDeleteTaskSeries(){var e,t;this.logUsage("DeleteRecurringTaskDialogOpened"),null===(e=(t=this.props).openDeleteRecurringTaskDialog)||void 0===e||e.call(t,this.props.task.id)}dismissOtherCommandsMenu(){this.setState({isTaskContextMenuVisible:!1})}onClickCopyTask(){this.logUsage("CopyTaskDialogOpened"),this.props.openCopyTaskDialog&&this.props.openCopyTaskDialog(this.props.task.id)}onClickMoveTask(){this.logUsage("MoveTaskDialogOpened"),this.props.openMoveTaskDialog&&this.props.openMoveTaskDialog(this.props.task.id)}onClickCopyLinkToTask(){const e={taskId:this.props.task.id};this.logUsage("copyTaskLinkTaskCard",e),this.props.onCopyLinkToTask&&this.props.onCopyLinkToTask(this.props.task.id),this.props.onFocusContainer&&this.props.onFocusContainer()}constructor(e,t){super(e,t),this.onRenderLabelMenuItem=e=>{const t=e.data,{index:o}=t,n=(ql()(this.props.task.appliedCategories)?this.props.task.appliedCategories:[]).indexOf(o)>-1,r=t.name||oo.U.getLabelPlaceholderByIndex(o),s={className:"ms-ContextualMenu-link labelTagMenuButton",name:r,"aria-posinset":e["aria-posinset"],"aria-setsize":e["aria-setsize"],"aria-checked":n};return z.createElement("button",(0,c.A)((0,c.A)({},s),{},{onClick:e=>this.toggleCategory(o),role:"menuitemcheckbox"}),n?z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.r8),{},{className:(0,Qe.A)("ms-ContextualMenu-checkmarkIcon",ot.r8.className)})):z.createElement(xe.I,{iconName:"",className:"ms-ContextualMenu-checkmarkIcon"}),z.createElement(eo.l,{key:o,index:o,title:r,isCollapsed:!1,theme:this.props.theme}))},this.handleDelete=e=>{var t;return null!==(t=this.props.task.recurrence)&&void 0!==t&&t.isActive()?this.onDeleteTaskSeries():this.onDeleteTask()},this.iconPropsWithDefaultColor=e=>(0,c.A)((0,c.A)({},e),{},{className:(0,Qe.A)("defaultIconColor",e.className)});const o=this.getSortedLabels();this.state={isTaskContextMenuVisible:!1,taskPlanLabels:o}}}const Yl=e=>{const t=Al(e.appTheme),o=Ie.p.Strings.TaskEditor_AppPoweredTasksOpenTaskButtonAriaLabel;return z.createElement("div",{className:"appPoweredTask indicator",title:o},z.createElement(Ga,(0,c.A)((0,c.A)({},e),{},{ariaLabel:o,iconProps:ot.Mt,styles:t})))};var Jl=o(46530),Xl=o(34648),$l=o(13378),ec=o(8480),tc=o(70995),oc=o(69108),nc=o.n(oc),rc=o(47649),sc=o(79962),ic=o(80347),ac=o(71683),lc=o(78005);function cc(e){if(!e)return"";const t=(0,lc.fv)(e);return dc((new DOMParser).parseFromString(t,"text/html").body).trim().replace(/\n{2,}/g,"\n")}const pc=["BR","LI","P","DIV"];function dc(e){if(null==e)return"";var t;if(e.nodeType===Node.TEXT_NODE)return null!==(t=e.textContent)&&void 0!==t?t:"";if(e.nodeType===Node.ELEMENT_NODE){const t=e;let o="";pc.includes(t.tagName)&&(o+="\n");for(const e of t.childNodes)o+=dc(e);return o}return""}const uc={};var hc=o(75314),gc=o(36723);class mc extends pe.${name(){return"TaskCard"}logUsage(e,t,o){this.props.loggers.usageLogger.logData(this.name(),e,t,o)}logError(e,t,o){Tr.v.logError(e,t,o,this.props.loggers.logHandler)}renderComponent(){const{task:e,highlightType:t,showPreview:o,isFocusZoneEnabled:n}=this.props;if(null==e)return null;const r=this.getClassNames(),s=(0,ao.Fk)(e.percentComplete),i=this.renderTaskMenu(r),a=this.renderTopBar(r),l=this.renderBottomBar(s,r),c=this.renderCategoryLabels(),p=(0,Qe.A)(r.root,"passive_0","active_2",{complete:s===co.$.Complete},{wywaBorderHighlighted:t.wywaBorderHighlighted},{assigneeHighlighted:t.assigneeHighlighted},{wywaAnimated:!t.assigneeHighlighted&&t.wywaAnimated}),d=t.wywaBorderHighlighted||!t.assigneeHighlighted&&t.wywaAnimated?Ie.p.Strings.TaskCard_TaskChangedSinceLastVisit:"",u=e.title+d,h=z.createElement("div",{className:r.textContent,tabIndex:-1},o&&this.renderReferencePreviewThumbnail(r),i,c,a,l);return z.createElement(Ro.R,{direction:Uo.E.horizontal,isCircularNavigation:!0,disabled:!n},z.createElement("div",{className:p,"aria-label":u},z.createElement("div",{className:"container",ref:e=>this._containerRef=e},h)))}getAssignees(){return Cn()(this.props.task.getAssigneeIds(),e=>{let t=this.props.callbacks.getUser(e);return t||(t=Jl._.getUnknownUser(e)),t})}renderCompleteButton(e,t){const{completeBtnRef:o,task:n,taskPermissions:r,isFocusZoneEnabled:s,theme:i,callbacks:a,taskDetails:l}=this.props,c=a.getFlights().TeamsTasksECS_enableMandatoryChecklist&&(0,hc.cl)(n,l),p=a.getFlights().TeamsTasksECS_enableMandatoryForms&&(0,hc.lj)(n,l),d=a.getFlights().TeamsTasksECS_enableMandatoryApprovals&&(0,hc.Zw)(n,l),u=a.getFlights().EnableAppPoweredTasks&&n.isAppPoweredTask()&&!n.isComplete();return c||p||d||u?z.createElement(ec.S,{plannerTheme:i,directionalHint:Xe.A.rightCenter,content:Ie.p.Strings.TaskEditor_ShowShouldCompleteRequirementsInfoLabel},z.createElement("img",{className:t.requiredCompleteIcon,tabIndex:-1,onClick:this.stopMouseClickEventPropagation,src:tc.A,"data-is-focusable":this.props.isFocusZoneEnabled,"aria-label":Ie.p.Strings.TaskEditor_ShowShouldCompleteRequirementsInfoLabel,role:"checkbox","aria-checked":e})):z.createElement(Zl.N,{id:"completeButton"+n.id,isTaskCompleted:e,isFocusZoneEnabled:s,completeButtonRef:o,isDisabled:!r.canUpdateProgress,completeTaskButtonTabIndex:-1,onButtonClick:this.onTaskCardCompleteClick,disableTaskCardFocusZone:this.disableFocusZone,theme:i})}renderAssignmentBar(){const{callbacks:e,currentUserId:t,maxAssignees:o,task:n,taskPermissions:r,theme:s}=this.props,i=this.getAssignees(),a=e.getCanUserModifyAssigneePool(n.id)&&r.canEdit&&r.canAssign,l=(0,ao.Fk)(n.percentComplete);return z.createElement(Ha.UI,{layout:Ha.Yn.Compact,assignees:i,currentUserId:t,canEditAssignments:r.canAssign,canEditAccessPermissions:a,canGiveAccessToGuests:this.props.canAddGuests,canAssignToResourcesWithoutAccess:a,canAccessPlanViaSharedContainerOnly:e.getCanUserAccessPlanViaSharedContainerOnly(n.planId),minQueryTermLength:ce.c9.MinCharsNeededToSearch,maxAssignees:o,maxDisplayablePersonas:ce.eg.MaxDisplayablePersonasTaskCard,addIconPlacement:Ha.aq.BeforeAssignees,strings:{assignControlLauncherText:"",assignControlIconTitle:Ie.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlAssignToMeButtonText:Ie.p.Strings.TaskAssignmentControl_AssignToMeLabel,readonlyFieldPermissionsTooltip:Ie.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,assignControlAriaLabelSuffix:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelSuffix,assignControlAriaLabelPrefix:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefix,assignControlAriaLabelPrefixNoAssignees:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefixNoAssignees,assignControlListSeparator:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator,assignControlAriaLabelConstruction:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelConstruction,assignmentFilterPlaceholderText:Ie.p.Strings.AssignmentPicker_AssignFilterPlaceholder,assignmentFilterAriaLabel:Ie.p.Strings.AssignmentPicker_AssignFilterPlaceholder,noResultsFoundText:Ie.p.Strings.AssignmentPicker_NoResultsFoundText,giveAccessTooltipText:Ie.p.Strings.AssignmentPicker_GiveAccessButtonAriaLabel,unassignUserButtonText:Ie.p.Strings.AssignmentPicker_UnassignUserButtonAriaLabel,assignedSectionHeader:Ie.p.Strings.AssignmentPicker_AssignedSectionHeader,queryLoadingText:Ie.p.Strings.AssignmentPicker_LoadingText,suggestedSectionHeader:Ie.p.Strings.AssignmentPicker_SuggestedSectionHeader,personaRoleGuest:Ie.p.Strings.AssignmentPicker_PersonaRoleGuest,personaRoleNonMember:Ie.p.Strings.AssignmentPicker_PersonaRoleNonMember,personaCompoundRole:Ie.p.Strings.AssignmentPicker_PersonaCompoundSubText,suggestedAssigneeMostAvailableUser:Ie.p.Strings.AssignmentPicker_SuggestedAssigneeMostAvailableUser,suggestedAssigneePlanTopAssignee:Ie.p.Strings.AssignmentPicker_SuggestedAssigneePlanTopAssignee,suggestedAssigneeSimilarTitle:Ie.p.Strings.AssignmentPicker_SuggestedAssigneeSimilarTitle,suggestedAssigneeUserTopAssignee:Ie.p.Strings.AssignmentPicker_SuggestedAssigneeUserTopAssignee},onRenderPersona:e.onRenderPersona,getUsersWithPlanAccess:this.getAssigneePool,getZeroTermQueryResults:this.getZeroTermQueryAssignmentResults,onAssignUser:this.onAssignUser,onUnassignUser:this.onUnassignUser,onGivePlanAccess:this.giveUserAccessToPlan,onOpenAssignCallout:this.onOpenAssignCallout,onCloseAssignCallout:this.onCloseAssignCallout,getSearchQueryResults:a?e.getUsersWithKeyword:void 0,getUserPhoto:e.getUserPhoto,showAssigneeLimitError:this.showAssigneeLimitError,alertUser:this.tenantSearchAlertUser,overflowButtonType:Pn.Z.descriptive,showPeoplePicker:this.state.isPeoplePickerVisible,targetElement:l!==co.$.Complete&&null!==n.getAssigneeIds()&&n.getAssigneeIds().length>0?this._bottomBar||void 0:this._containerRef||void 0,theme:s,styles:Tl(r.canAssign,s),allowMultiline:!1,hideSingleAssigneeDetails:!0})}renderCompletedTaskBottomBar(){const{task:e,callbacks:t}=this.props;if(null==e.completedBy||null==e.completedDate)return null;const o=ic.lz.FormatDate(e.completedDate);let n=this.props.callbacks.getUser(e.completedBy);null==n&&(n=Jl._.getUnknownUser(e.completedBy));const r={text:vt.G(Ie.p.Strings.TaskCard_CompletedByOnDate,n.formattedDisplayName,o),imageUrl:t.getUserPhoto(n.id)||void 0,imageInitials:(0,sc.I)(n.displayName,(0,Me.jI)()),initialsColor:(0,Oa.X)({text:n.displayName}),size:Mt.WH.extraSmall,className:"completedBy"};return z.createElement("div",{className:"completedAssignment"},z.createElement(Nt.f,{user:n,onLoad:t.onRenderPersona,containerId:"userContainer-taskCard-".concat(e.id,"-").concat(n.id)},z.createElement(Lt.F,r)))}renderActiveTaskBottomBar(){const e=this.renderDueDateIndicator();return z.createElement(z.Fragment,null,z.createElement("div",{className:"bottomBarLeftSection"},e),z.createElement("div",{className:"bottomBarRightSection",onClick:this.preventDefault},this.renderAssignmentBar()))}renderTaskMenu(e){const t={enableMoveTaskOperation:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canMove};return z.createElement("div",{className:e.taskMenuSection},z.createElement(Ql,{config:t,task:this.props.task,labels:this.props.taskPlanLabels,showAssign:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canAssign,showDelete:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canDelete,showLabel:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canUpdateAppliedLabels,showCopyTask:this.props.taskPermissions.canEdit&&this.props.taskPermissions.canCopy,showCopyLinkToTask:this.props.showCopyLinkToTask,openCopyTaskDialog:e=>{this.props.callbacks.openCopyTaskDialog(e,this.props.onFocusContainer)},openMoveTaskDialog:e=>{this.props.callbacks.openMoveTaskDialog(e,this.props.onFocusContainer)},openDeleteRecurringTaskDialog:e=>{this.props.callbacks.openDeleteRecurringTaskDialog(e,this.props.onFocusContainer)},onCopyLinkToTask:e=>{this.props.callbacks.onCopyLinkToTask(e)},deleteTask:e=>{this.props.onDelete(e)},onFocusContainer:()=>{this.props.onFocusContainer()},onUpdateTask:(e,t)=>{this.props.callbacks.onUpdateTask(e,t)},onClickAssign:()=>{this.onClickAssign()},onOtherCommandsMenuOpened:()=>{this.onOtherCommandsMenuOpened()},isTaskOnMyDay:this.props.callbacks.isTaskOnMyDay,toggleMyDayForTask:this.props.callbacks.toggleMyDayForTask,isFocusZoneEnabled:this.props.isFocusZoneEnabled,disableFocusZone:this.disableFocusZone,otherCommandsMenuCommandButton:this.props.moreBtnRef,fetchTaskContainerPermissions:this.props.callbacks.fetchTaskContainerPermissions,theme:this.props.theme}))}renderTopBar(e){const t=this.props.taskPlan,o=vt.G(Ie.p.Strings.TaskCard_TaskTitleAriaLabel,this.props.task.title),n=z.createElement("div",{className:"titleRow"},this.renderCompleteButton(this.props.task.isComplete(),e),z.createElement("div",{className:"title","aria-label":o,role:"textbox"},this.props.task.title));let r=null;if(this.props.showPlanTitle){const e=null!=t?vt.G(Ie.p.Strings.TaskCard_PlanTitleAriaLabel,t.title):void 0;r=z.createElement("div",{className:"planName","aria-label":e,role:null!=t?"textbox":void 0},null===t||void 0===t?void 0:t.title)}const s=this.renderIndicatorRow(e);return z.createElement("div",{className:e.topBar,onClick:this.onCardClick},r,n,this.renderBucketTitle(),this.props.showPreview&&this.renderPreview(e),s)}renderBottomBar(e,t){const{task:o}=this.props,n=null!=o.dueDate,r=(0,Qe.A)(t.bottomBar,e===co.$.Complete||n||null!==o.getAssigneeIds()&&o.getAssigneeIds().length>0?"":"noDisplayBottomBar");return z.createElement("div",{className:r,ref:this.resolveRef(this,"_bottomBar"),tabIndex:-1},e===co.$.Complete&&o.completedBy&&o.completedDate?this.renderCompletedTaskBottomBar():this.renderActiveTaskBottomBar())}renderBucketTitle(){if(null==this.props.taskBucket||!this.props.showBucketTitle)return null;const e=this.props.taskPermissions.canUpdateBucket?"bucketName":"bucketName disableUpdateBucket";if(null!=this.props.callbacks.getBuckets){const t=[],o=null!=this.props.task.planId?this.props.callbacks.getBuckets(this.props.task.planId):[];null!=o&&o.sort((e,t)=>ji.O.compareOrderHints(t.orderHint,e.orderHint)),Pt()(o,e=>{t.push({key:e.id,name:e.title,onClick:this.setBucket})});const n=z.createElement($e.l,{shouldFocusOnMount:!0,items:t,className:"bucketContextualMenu",directionalHint:Xe.A.bottomAutoEdge,target:this.refs.bucketMenuCommandButton,onDismiss:this.dismissBucketMenu,appTheme:this.props.theme});return z.createElement("div",{className:e,ref:"bucketMenuCommandButton",tabIndex:-1},z.createElement("a",{onClick:this.toggleBucketMenu,"data-is-focusable":"false"},this.props.taskBucket.title),this.state.isBucketMenuVisible?n:null)}return z.createElement("div",{className:e},this.props.taskBucket.title)}renderPreview(e){let t=null;switch(this.props.task.previewType){case Xl.X.CheckList:t=this.renderChecklistPreview();break;case Xl.X.Description:t=this.renderNotesPreview();break;case Xl.X.Reference:case Xl.X.Automatic:t=this.renderTaskReferencePreviewDescription();break;case Xl.X.NoPreview:break;default:Qi.f.unreachableCase(this.props.task.previewType,e=>{this.props.loggers.traceLogger.logTrace(508077509,E.k.Error,e)})}return t?t&&z.createElement("div",{className:e.preview},t):null}renderChecklistPreview(){if(!this.props.taskDetails)return null;this._checklistItems=[];const e=!this.props.taskPermissions.canEdit||(0,la.c)(this.props.taskPermissions.checklistPermissions,la.j.DisableCheckedStateToggling),t=$l.e.getSortedChecklistItems(this.props.taskDetails.checklist).filter(e=>!e.isChecked).slice(0,10).map(t=>z.createElement("div",{className:"checklistItem",key:t.id},z.createElement("div",{className:"clickWrapper",title:e?Ie.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip:t.title,onClick:this.onIgnoreClick,onKeyUp:this.stopKeyUpPropagation},z.createElement(zl.S,{inputProps:{"data-is-focusable":!0},label:t.title,className:"checklistItemText",onChange:e=>this.onPreviewCheckboxChanged(t,e),componentRef:e=>{null!=e&&this._checklistItems.push({element:e,id:t.id})},disabled:e,appTheme:this.props.theme}))));return z.createElement("div",{className:"checklistPreview"},t)}renderNotesPreview(){var e;const{taskDetails:t,callbacks:o}=this.props,n=o.getFlights().TeamsTasksECS_richTextEditorEnabled,r=t&&(n?null===(e=t.notes)||void 0===e?void 0:e.content:t.description);return z.createElement("div",{className:"notesPreview"},r?n?function(e,t){var o;return e?((null===(o=uc[t])||void 0===o?void 0:o.htmlString)!==e&&(uc[t]={htmlString:e,plainText:cc(e)}),uc[t].plainText):""}(r,t.id):(0,ac.o)(r):"")}renderTaskReferencePreviewDescription(){const e=this.props.task.getNumberOfVisibleReferences();if(!this.props.taskDetails)return e>0?z.createElement("div",{className:"referencePreviewDescription","data-is-focusable":"false"},z.createElement("span",{className:"previewCaption"})):null;const t=this.props.taskDetails.getReferenceWithLowestPriority();return this.isPreviewTypeReferenceOrAutomatic()&&t&&t.taskAttachmentType&&(null===t||void 0===t?void 0:t.taskAttachmentType.taskAttachmentType)!==gc.Er.TeamsHostedApp?z.createElement(Nl,{theme:this.props.theme,isFocusable:this.props.isFocusZoneEnabled,attachment:t,onAttachmentClick:this.onAttachmentClick,onKeyDown:this.disableFocusZone}):null}renderReferencePreviewThumbnail(e){if(!this.isPreviewTypeReferenceOrAutomatic()||this.props.task.numberOfReferences<=0)return null;if(null==this.props.taskDetails)return z.createElement("div",{className:(0,Qe.A)(e.thumbnail,"placeholder")});const t=this.props.taskDetails.getReferenceWithLowestPriority();if(null===t||void 0===t||!t.taskAttachmentType||(null===t||void 0===t?void 0:t.taskAttachmentType.taskAttachmentType)===gc.Er.TeamsHostedApp)return null;const o=this.props.callbacks.getFlights().VideoLinkPreviews;if(o&&t.isGifAttachment())return z.createElement("img",{src:t.url,className:(0,Qe.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick});if(o&&!t.hasKnownExtension())if(this.state.reactPlayerInstance){const o=this.state.reactPlayerInstance;if(t.taskAttachmentType.videoUrlParseResult.canPlay)return z.createElement("div",{className:(0,Qe.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick},z.createElement("iframe",{sandbox:void 0,src:t.taskAttachmentType.videoUrlParseResult.embedUrl,allowFullScreen:!0,frameBorder:0}));if(o.canPlay(t.url))return z.createElement("div",{className:(0,Qe.A)(e.thumbnail,"real"),onClick:this.onAnimatedPreviewContentClick},z.createElement(o,{url:t.url,controls:!0}))}else this.loadReactPlayer();if(!this.props.taskPlan)return this.renderFallbackThumbnail(t,e);const n=this.props.callbacks.getDocumentPreviewThumbnail(this.props.taskPlan.container.externalId,t.url);return null==n||this.state.taskPreviewImageLoadState===Mr.P6.error?this.renderFallbackThumbnail(t,e):z.createElement("div",{className:(0,Qe.A)(e.thumbnail,"real")},z.createElement(Lr._,{className:"previewImage",shouldFadeIn:!0,imageFit:Mr.N_.none,src:n,alt:"",onLoadingStateChange:this.onImageLoadingStateChange}))}renderFallbackThumbnail(e,t){const o=Fl.m.builder.fromTaskAttachment(e,"").build(),n=o.taskAttachmentRowItemType.taskAttachmentType,r=(0,Ll.$)(this.props.theme,n);return z.createElement("div",{className:(0,Qe.A)(t.thumbnail,"placeholder")},z.createElement(Ua.$,{key:o.url,styles:r,taskAttachmentRowItem:o,className:"fallbackPreviewIcon",icons:Ll.b}))}renderIndicatorRow(e){const{task:t,isFocusZoneEnabled:o,callbacks:n}=this.props,r=z.createElement(Il,{ariaLabel:Ie.p.Strings.TaskCard_HasCommentsAriaLabel,isKeyboardFocusable:o,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),s=t.getNumberOfVisibleReferences(),i=z.createElement(Bl,{isKeyboardFocusable:o,numberOfAttachments:s,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),a=z.createElement(El,{isKeyboardFocusable:o,numChecklistItems:t.numberOfChecklistItems,numCompletedChecklistItems:t.numberOfChecklistItems-t.numberOfActiveChecklistItems,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}),l=(0,ao.Fk)(t.percentComplete),c=(0,ao.aV)(t.priority);return z.createElement("div",{className:e.indicatorRow},z.createElement("div",{className:"leftSection"},c!==io.gy.Low&&c!==io.gy.Medium?this.renderPriorityIndicator():null,l!==co.$.NotStarted&&l!==co.$.Complete?this.renderInProgressIndicator():null,t.conversationThreadId&&null!==t.conversationThreadId?r:null,s>0?i:null,t.numberOfChecklistItems>0?a:null,n.getFlights().EnableAppPoweredTasks&&this.renderAppPoweredTaskIndicator()))}renderAppPoweredTaskIndicator(){return this.props.task.isAppPoweredTask()?z.createElement(Yl,{isKeyboardFocusable:this.props.isFocusZoneEnabled,onKeyDown:this.disableFocusZone,appTheme:this.props.theme}):null}renderPriorityIndicator(){const e={priorityUrgentText:Ie.p.Strings.Task_PriorityUrgentText,priorityImportantText:Ie.p.Strings.Task_PriorityImportantText,priorityMediumText:Ie.p.Strings.Task_PriorityMediumText,priorityLowText:Ie.p.Strings.Task_PriorityLowText};return z.createElement(Gl,{isKeyboardFocusable:this.props.isFocusZoneEnabled,priorityStrings:e,task:this.props.task,taskPermissions:this.props.taskPermissions,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,onMenuClick:this.onClickIndicator,appTheme:this.props.theme})}renderInProgressIndicator(){const e=Ie.p.Strings.TaskCard_TaskInProgressText,t={completedText:Ie.p.Strings.PlannerApp_CompletedText,inProgressText:Ie.p.Strings.PlannerApp_InProgressText,notStartedText:Ie.p.Strings.PlannerApp_NotStartedText};return z.createElement(Wl,{ariaLabel:e,canUpdateProgress:this.props.taskPermissions.canUpdateProgress,isKeyboardFocusable:this.props.isFocusZoneEnabled,progressStrings:t,task:this.props.task,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,onMenuClick:this.onClickIndicator,appTheme:this.props.theme})}renderDueDateIndicator(){let e;var t;this.props.task.dueDate?e=null!==(t=this.props.task.recurrence)&&void 0!==t&&t.isActive()?vt.G(Ie.p.Strings.TaskCard_RecurringDueDateAriaLabel,this.props.task.dueDate.format("LL")):vt.G(Ie.p.Strings.TaskCard_DueDateAriaLabel,this.props.task.dueDate.format("LL")):e=Ie.p.Strings.AddTaskCard_DueDateText;return this.props.taskPermissions.canUpdateDueDate||(e=Ie.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip),z.createElement(Vl,{ariaLabel:e,isKeyboardFocusable:this.props.isFocusZoneEnabled,task:this.props.task,taskPermissions:this.props.taskPermissions,onKeyDown:this.disableFocusZone,onUpdateTask:this.props.callbacks.onUpdateTask,appTheme:this.props.theme})}renderCategoryLabels(){const{callbacks:e,isFocusZoneEnabled:t,task:o,taskPlanLabels:n}=this.props,r=o.appliedCategories.sort(bn.l.compareNumbers);if(me()(r)||0===n.length)return null;const s=[];Pt()(r,e=>{const t=n[e];null!=t&&s.push(_l.getLabelPlaceholder(t))});const i=s.join(", ");return z.createElement("ul",{className:"labels","aria-label":i,"data-is-focusable":t,tabIndex:t?0:-1,onClick:e=>{e.screenX||e.screenY||e.stopPropagation()},onKeyUp:t=>{Ye.a.isButtonPress(t)&&(t.stopPropagation(),e.setLabelsCollapsedState(!this.context.isLabelCollapsed,o.planId))},onKeyDown:this.disableFocusZone},r.map(e=>this.renderLabel(e,this.context.isLabelCollapsed)))}renderLabel(e,t){const o=this.props.taskPlanLabels[e];return null==o?null:z.createElement("li",{key:e},z.createElement(eo.l,{key:e,index:e,isHovered:this.state.labelsHovered,title:_l.getLabelPlaceholder(o),isCollapsed:t,showBorder:this.state.labelsHovered&&!t,theme:this.props.theme,onClick:e=>{e.stopPropagation(),this.props.callbacks.setLabelsCollapsedState(!t,this.props.task.planId)},onMouseEnterCallback:()=>{this.setState({labelsHovered:!0})},onMouseLeaveCallback:()=>{this.setState({labelsHovered:!1})}}))}isPreviewTypeReferenceOrAutomatic(){return nc()([Xl.X.Reference,Xl.X.Automatic],this.props.task.previewType)>=0}onOtherCommandsMenuOpened(){this.onCloseAssignCallout()}onClickAssign(){this.state.isPeoplePickerVisible||this.setState({isPeoplePickerVisible:!0})}loadReactPlayer(){(0,Pi.L)(()=>o.e(82707).then(o.bind(o,90961))).then(e=>{if(null===e||void 0===e||!e.default)throw new Error("Invalid react-player import");this.setState({reactPlayerInstance:e.default})}).catch(e=>{this.props.loggers.traceLogger.logTrace(508077508,E.k.Error,"Failed to dynamically import react-player [Error=".concat(Qi.f.getMessage(e),"]"))})}getClassNames(){const{highlightType:e,task:t}=this.props,o=(0,ao.Fk)(t.percentComplete)===co.$.Complete,n=e.wywaBorderHighlighted,r=!e.assigneeHighlighted&&e.wywaAnimated,s=e.assigneeHighlighted,i=!this.props.taskPermissions.canEdit||(0,la.c)(this.props.taskPermissions.checklistPermissions,la.j.DisableCheckedStateToggling);return ml(pl(this.props.theme,this.props.styles,o,n,r,s,i))}constructor(e,t){super(e,t),this.onCardClick=e=>{const{onTaskCardClick:t,task:o}=this.props;Ye.a.isButtonPress(e)&&null!=t&&(t(o.id),e.stopPropagation())},this.showAssigneeLimitError=()=>{this.props.callbacks.showAssigneeLimitError(this.props.task.id)},this.onOpenAssignCallout=()=>{var e;this.setState({isPeoplePickerVisible:!0}),this.props.callbacks.onOpenAssignCallout&&this.props.callbacks.onOpenAssignCallout(this.props.task.planId),null!=(null===(e=this.props.task.creationSource)||void 0===e?void 0:e.publication)&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.onTaskCardCompleteClick=e=>{const{task:t,callbacks:o,loggers:n}=this.props;var r,s;(rc.v.create().setImmediate(()=>{const e=t.toggleCompletionState();o.onUpdateTask(t,e)}),t.isComplete())?n.usageLogger.logData(this.name(),g.M.TaskReactivateButtonClicked,{taskCreationSourceType:null!==(r=t.taskCreationSourceType)&&void 0!==r?r:""}):n.usageLogger.logData(this.name(),g.M.TaskCompleteButtonClicked,{taskCreationSourceType:null!==(s=t.taskCreationSourceType)&&void 0!==s?s:""})},this.disableFocusZone=e=>{Ye.a.getKey(e)===Le.D.TAB&&this.props.disableFocusZone()},this.onIgnoreClick=e=>{e.stopPropagation()},this.stopKeyUpPropagation=e=>{e.stopPropagation()},this.stopMouseClickEventPropagation=e=>{e.stopPropagation()},this.onImageLoadingStateChange=e=>{this.setState({taskPreviewImageLoadState:e})},this.onAttachmentClick=(e,t)=>{var o;if(t.stopPropagation(),t.preventDefault(),e){this.logUsage("ClickAttachment");try{this.props.callbacks.onOpenLink(this.props.taskDetails.references[e])}catch(n){this.props.callbacks.showInfoBanner(Na.fc.UnopenableAttachmentLinkInfo)}}null!=(null===(o=this.props.task.creationSource)||void 0===o?void 0:o.publication)&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.onPreviewCheckboxChanged=(e,t)=>{const{taskDetails:o,callbacks:n,onFocusContainer:r,loggers:s}=this.props;if(null===t||void 0===t||t.stopPropagation(),null===t||void 0===t||t.preventDefault(),kn.n.ChangeFocusBeforeRemovalIFocusableAlt(this._checklistItems,r,e.id),null!=o){const t=o.checkChecklistItem(e.id,!0);n.onUpdateTaskDetails(o,t),s.usageLogger.logData("TaskCardChecklist","Checklist item is marked as complete")}},this.toggleBucketMenu=e=>{this.props.taskPermissions.canUpdateBucket&&(e.stopPropagation(),this.setState(e=>({isBucketMenuVisible:!e.isBucketMenuVisible})))},this.dismissBucketMenu=()=>{this.setState({isBucketMenuVisible:!1})},this.setBucket=(e,t)=>{const o=this.props.task.setProperty("bucketId",""!==t.key?t.key:null);this.props.callbacks.onUpdateTask(this.props.task,o),this.dismissBucketMenu()},this.getAssigneePool=()=>null==this.props.callbacks.getAssigneePool?[]:this.props.callbacks.getAssigneePool(this.props.task.id)||[],this.onAnimatedPreviewContentClick=e=>{e.stopProp()},this.onAssignUser=(e,t,o)=>{const{task:n,callbacks:r}=this.props;null!=n&&null!=r.onAssignTask&&-1===n.getAssigneeIds().indexOf(e)&&r.onAssignTask(e,n.id,t,o)},this.onUnassignUser=e=>{if(null!=this.props.task&&null!=this.props.callbacks.onUpdateTask&&-1!==this.props.task.getAssigneeIds().indexOf(e)){const t=this.props.task.getClone();delete t.assignments[e],me()(t.assignments)&&this.state.isPeoplePickerVisible&&this.setState({isPeoplePickerVisible:!1}),this.props.callbacks.onUpdateTask(this.props.task,t)}},this.onCloseAssignCallout=()=>{this.setState({isPeoplePickerVisible:!1})},this.getZeroTermQueryAssignmentResults=()=>this.props.callbacks.getAssigneeSuggestions(this.props.task.planId,this.props.task),this.tenantSearchAlertUser=e=>{this.props.callbacks.alertUser("SharedComponents_TenantUserSearchResultsToastTitle",[e.toString()])},this.giveUserAccessToPlan=e=>{this.props.callbacks.addUserToContainer(e,this.props.task.planId)},this.preventDefault=e=>{e.preventDefault()},this.onClickIndicator=()=>{var e;null!=(null===(e=this.props.task.creationSource)||void 0===e?void 0:e.publication)&&this.props.callbacks.fetchTaskContainerPermissions(this.props.task)},this.state={isBucketMenuVisible:!1,taskPreviewImageLoadState:Mr.P6.notLoaded,isPeoplePickerVisible:!1,labelsHovered:!1,reactPlayerInstance:null}}}mc.contextType=Ra;class Cc extends Ma{renderComponent(){const e=Ea(this.props.styles),t=z.createElement("div",{key:this.props.entity.id,id:this.props.entity.id,className:e.root,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"aria-label":this.props.entity.title,"aria-posinset":this.props.taskBoardCardPositionInColumnGroup+1,"aria-setsize":this.props.totalTasksInColumnGroup,"data-dnd-role":"card","data-is-focusable":!0,role:"listitem",onClick:this.onClick.bind(this),tabIndex:0,onKeyDown:this.handleOnKeyDown.bind(this),onKeyUp:this.handleOnKeyUp.bind(this),ref:e=>{this._taskBoardCardElement=e}},this.cardRenderer());return this.props.taskPermissions.canEdit&&this.props.connectDragSource&&this.props.connectDropTarget&&null!==(o=this.props.connectDragSource(this.props.connectDropTarget(t)))&&void 0!==o?o:t;var o}cardSource(){return{beginDrag:e=>({entity:e.entity,index:e.index,sourceColumnValue:e.columnValue,secondaryGrouping:e.secondaryGrouping,props:e})}}componentDidUpdate(e,t){var o,n,r;(gn()(t,this.state)&&gn()(e,this.props)||t.enableFocusZone!==this.state.enableFocusZone||this.props.setRef(this._taskBoardCardElement,this.props.entity.id),e.isDragging!==this.props.isDragging)&&(null===(o=(n=this.props).onCardDragStateChange)||void 0===o||o.call(n,null!==(r=this.props.isDragging)&&void 0!==r&&r))}cardRenderer(){const{canAddGuests:e,currentUserId:t,entity:o,maxAssignees:n,onDelete:r,onTaskCardClick:s,showPlanTitle:i,showPreview:a,showCopyLinkToTask:l,taskBoardCardCallbacks:d,taskPermissions:u}=this.props,h=(0,c.A)((0,c.A)({},d.taskCallbacks),{},{onUpdateTask:(e,t)=>{this.onUpdateTask(e,t)}}),g=d.getTaskHighlightedType(this.props.entity);this.props.isOver&&(g.assigneeHighlighted=!0);let m=[];const C=null!=o.planId?d.getTaskPlanDetails(o.planId):null,k=d.getTaskPlanLabelUsageCounts(o.planId);return m=oo.U.getILabelArray((null===C||void 0===C?void 0:C.categories)||[],k),z.createElement(mc,{key:o.id,task:o,taskBucket:null!=o.bucketId?d.getTaskBucket(o.bucketId):null,taskDetails:d.getTaskDetails(o.id),taskPlan:null!=o.planId?d.getTaskPlan(o.planId):null,taskPlanLabels:m,callbacks:h,showBucketTitle:!i&&d.getCurrentTaskGroupingState()!==p.Yc.Bucket,showPlanTitle:i,showPreview:a,showCopyLinkToTask:l,highlightType:g,isFocusZoneEnabled:this.state.enableFocusZone,maxAssignees:n,onDelete:r,onFocusContainer:()=>this.setFocusOnCard(),onTaskCardClick:s,completeBtnRef:this._completeBtnRef,moreBtnRef:this._moreBtnRef,disableFocusZone:this.disableFocusZone.bind(this),currentUserId:t,taskPermissions:u,canAddGuests:e,theme:this.props.theme,loggers:this.context})}onDrop(e,t,o){if(!t||"memberCard"!==t.getItemType())return;const n=t.getItem();if(-1===e.entity.getAssigneeIds().indexOf(n.user.id)){if(e.maxAssignees&&e.entity.getAssigneeIds().length>=e.maxAssignees)return void e.taskBoardCardCallbacks.showAssigneeLimitError(e.entity.id);const t=e.entity.getClone();t.assignments[n.user.id]=new mr.I(e.currentUserId,new Date),e.taskBoardCardCallbacks.taskCallbacks.onUpdateTask(e.entity,t)}}onClick(){this.props.onTaskCardClick(this.props.entity.id)}handleOnKeyDown(e){e.stopPropagation(),e.target===e.currentTarget&&(this.lastKeyDown=e.keyCode)}disableFocusZone(){this.setState({enableFocusZone:!1})}handleOnKeyUp(e){e.stopPropagation();const{entity:t,columnValue:o,onKeyboardTaskReorder:n,onTaskCardClick:r,taskPermissions:s}=this.props;e.keyCode===this.lastKeyDown&&(e.keyCode===Le.D.DOWN_ARROW&&e.ctrlKey&&s.canEdit?n&&n(o,t,!1):e.keyCode===Le.D.UP_ARROW&&e.ctrlKey&&s.canEdit?n&&n(o,t,!0):e.keyCode===Le.D.SPACE||e.keyCode===Le.D.ENTER?r(t.id):e.keyCode===Le.D.RIGHT_ARROW&&(e.preventDefault(),this.setState({enableFocusZone:!0},()=>{s.canEdit?this._completeBtnRef.current&&this._completeBtnRef.current.focus():this._moreBtnRef.current&&this._moreBtnRef.current.focus()}))),this.lastKeyDown=null}setFocusOnCard(){null!=this._taskBoardCardElement&&this._taskBoardCardElement.focus()}onUpdateTask(e,t){if(e.percentComplete!==t.percentComplete)switch((0,ao.Fk)(t.percentComplete)){case co.$.NotStarted:this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()!==p.Yc.Progress&&(0,ao.Fk)(e.percentComplete)!==co.$.Complete||null==this.props.restoreFocusOnMoveTask?this.setFocusOnCard():this.props.restoreFocusOnMoveTask(t.id);break;case co.$.InProgress:break;case co.$.Complete:null!=this.props.restoreFocusOnMoveTask&&this.props.restoreFocusOnMoveTask(t.id);break;default:return}this.props.taskBoardCardCallbacks.taskCallbacks.onUpdateTask(e,t)}constructor(e,t){super(e,t),this._completeBtnRef=z.createRef(),this._moreBtnRef=z.createRef(),this.state={enableFocusZone:!1}}}const kc=Fa()((0,Wo.I)("card",Cc.prototype.cardSource(),Cc.prototype.cardCollect),(0,ua.T)("memberCard",Cc.prototype.cardTarget(),Cc.prototype.cardTargetCollect))(Cc),bc=(0,Q.J9)(function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ea.Board,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,a=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=Pa;switch(e){case ce.Sx.LoopLight:case ce.Sx.LoopDark:c=va;case ce.Sx.Light:case ce.Sx.Dark:case ce.Sx.TeamsLight:case ce.Sx.TeamsDark:case ce.Sx.TeamsContrast:case ce.Sx.SharePoint:}const p={root:fa(e,o,r,a,l),columnHeader:[Aa(e),{"> .addButtonContainer":[(0,Ne.$Z)(),(0,Ne.gS)(),{marginBottom:"17px"}]}],titleSection:[wa(e,n),o===ea.List&&[Ne.cc,Pc(e),{borderRadius:"4px",margin:"4px 0",padding:"0 9px",height:"40px"}],{"> .headerImage":[(0,Ne.$Z)(),(0,Ne.gS)(),Ne.cc],"> .editMenu":[(0,Ne.$Z)(),{display:"block","button.editMenuLauncher":[Ne.xK,{width:"24px",cursor:"pointer",opacity:0,":focus":{opacity:1}}],"& .stayOpen button.editMenuLauncher":{opacity:1}}],":hover":{"> .editMenu button.editMenuLauncher":{opacity:1}},"> .columnCollapseButton":[Ne.xK,(0,Ne.$Z)(),(0,Ne.gS)(),{margin:"0 ".concat(Sa),"> .plannerIcon":[(0,Ne.$Z)(),{fontSize:Y.s.large,verticalAlign:"middle",cursor:"pointer",transition:"transform 0.2s ease-in-out",transform:i?"rotate(0deg)":"rotate(180deg)"}],":hover":[e===ce.Sx.TeamsContrast&&{color:Re.z.TeamsContrastHyperlinkColor}]}]}],addButton:Tc(e,s),scrollable:[(0,Ne.GD)("auto"),(0,Ne.gS)("column"),i&&{display:"none "},(0,Ne.Ss)(e),o===ea.Board&&!r&&{overflowY:"hidden",overflowX:"hidden",":hover":{overflowY:"auto"}},{marginTop:"-9px",paddingLeft:ba,paddingRight:ba,"> *":[(0,Ne.$Z)(),{width:c,":last-child":{flex:"1 0 auto","> .listWrapper > .listboxGroup":{paddingBottom:"36px"}}}],"> .primarySection":{minHeight:"10px",paddingTop:Ue.B.ShadowMargin}}]};return(0,Y.TW)(p,t)}),Tc=(e,t)=>{let o=!0,n={},r="none",s="",i="",a="",l="40px",c=Ue.B.PlannerBorderRadius,p=Pa;switch(e){case ce.Sx.Light:break;case ce.Sx.Dark:i=ar.kd.gray170;break;case ce.Sx.TeamsLight:i=ar.kd.gray30;break;case ce.Sx.TeamsDark:i=ar.kd.gray150;break;case ce.Sx.TeamsContrast:o=!1,r="1px solid "+Re.z.White,s=Re.z.Black,i=Re.z.TeamsContrastHyperlinkColor,a=Re.z.TeamsContrastHyperlinkColor;break;case ce.Sx.SharePoint:break;case ce.Sx.LoopLight:case ce.Sx.LoopWorkspaceLight:case ce.Sx.LoopDark:case ce.Sx.LoopWorkspaceDark:l=ha,c=Ue.B.LoopBorderRadius,p=va,n=xa(e)}return[(0,Ne.$Z)(p),(0,Ne.gS)(),Ne.cc,(0,Oe.kE)(),(0,Ne.NX)(e),(0,Ne._D)(e),o&&Ue.B.CardShadow,{height:l,marginTop:Ta,padding:"0px ".concat("10px"),border:r,borderRadius:c,boxSizing:"border-box",fontSize:Y.s.mediumPlus,font:"inherit",transition:"color 0.167s ease-in-out, background 0.167s ease-in-out",cursor:"pointer",":hover":[i&&{backgroundColor:i},s&&{color:s},a&&{borderColor:a}],"> .plannerIcon":[(0,Ne.$Z)(),{padding:"0px ".concat("6px")}],"> .addTaskText":[(0,Ne.GD)(),{padding:"0px ".concat("6px"),fontSize:Y.s.medium}]},n]},Sc=(0,Q.J9)(e=>({root:(0,Y.Zq)("taskBoardColumn",e.root),columnHeader:(0,Y.Zq)("columnHeader",e.columnHeader),addButton:(0,Y.Zq)("addButton",e.addButton),titleSection:(0,Y.Zq)("titleSection",e.titleSection),scrollable:(0,Y.Zq)("scrollable",e.scrollable)})),Pc=e=>{let t="";switch(e){case ce.Sx.Light:t="rgba(255, 255, 255, 0.8)";break;case ce.Sx.Dark:t="rgba(41, 40, 39, 0.8)"}return t?{backgroundColor:t}:{}},vc="14px",xc=(0,Q.J9)((e,t,o)=>{let n=Pa;switch(e){case ce.Sx.LoopLight:case ce.Sx.LoopDark:n=va;case ce.Sx.Light:case ce.Sx.Dark:case ce.Sx.TeamsLight:case ce.Sx.TeamsDark:case ce.Sx.TeamsContrast:case ce.Sx.SharePoint:}const r={root:[(0,Ne.gS)("column"),{"> .addControlContainer":{marginTop:"-".concat(Ue.B.ShadowMargin),padding:"".concat(Ta," 0")}}],sectionToggleButton:[Ne.xK,(0,Ne.$Z)("40px"),(0,Ne.gS)(),Ne.cc,(0,Ne.aS)(e),Pc(e),{width:n,marginTop:"0px",marginBottom:"6px",borderRadius:"4px",fontSize:Y.s.medium,cursor:"pointer","> .toggleText":[(0,Ne.GD)("auto"),(0,Ne.q0)("ellipsis"),{padding:"0 ".concat(vc),fontSize:Y.s.medium}],"> .sectionItemCount":[(0,Ne.GD)()],"> .icon":[(0,Ne.$Z)(),(0,Ne.gS)(),Ne.cc,{padding:"0 ".concat(vc),"> .plannerIcon":[(0,Ne.$Z)(),{transition:"transform 0.2s ease-in-out",transform:o?"rotate(180deg)":"rotate(0deg)"}]}]}],placeholderCard:[{position:"absolute",width:n,marginTop:Ta,marginBottom:Ta,inset:0,backgroundColor:Da(e)},(e===ce.Sx.LoopLight||e===ce.Sx.LoopDark)&&{borderRadius:Ue.B.LoopBorderRadius}],bottomDropZone:{flex:"1 1 auto",boxSizing:"border-box",height:"26px"},listBoxGroup:{position:"relative"},screenReaderOnly:{maxWidth:ya}};return(0,Y.TW)(r,t)}),yc=(0,Q.J9)(e=>({root:(0,Y.Zq)("taskBoardColumnGroup",e.root),sectionToggleButton:(0,Y.Zq)("sectionToggleButton",e.sectionToggleButton),placeholderCard:(0,Y.Zq)("placeholderCard",e.placeholderCard),bottomDropZone:(0,Y.Zq)("bottomDropZone",e.bottomDropZone),screenReaderOnly:(0,Y.Zq)("screenReaderOnly",e.screenReaderOnly),listBoxGroup:(0,Y.Zq)("listBoxGroup",e.listBoxGroup)}));var fc=o(39068),Ac=o(56434),wc=o.n(Ac),Dc=o(91246),Bc=o(44459);class Ec extends da{componentDidUpdate(e,t){let o=[],n=!1;if(e.data!==this.props.data){const t=e.data.slice(0,this.state.numCardsToRender);o=this.props.data.slice(0,this.state.numCardsToRender),n=!gn()(o,t)}if(n&&!me()(o)){const e=o.filter(e=>!Dc.o.isPlexTempId(e.id));for(const t of e)this.props.fetchTaskPreview(t.id);return void(0,mo.qj)(e).map(e=>this.props.fetchPermissionsWithTaskContext(e))}if(t.numCardsToRender!==this.state.numCardsToRender&&!me()(this.props.data)){const e=this.props.data.slice(t.numCardsToRender,this.state.numCardsToRender).filter(e=>!Dc.o.isPlexTempId(e.id));for(const t of e)this.props.fetchTaskPreview(t.id);(0,mo.qj)(e).map(e=>this.props.fetchPermissionsWithTaskContext(e))}}renderComponent(){var e;const t=this.getClassNames(),o=z.createElement("button",{className:t.sectionToggleButton,"data-dnd-role":"sectionToggle","aria-expanded":this.state.showSection,onClick:this.toggleShowSection},z.createElement("h4",{className:"toggleText"},this.props.callbacks.sectionTitleProvider?this.props.callbacks.sectionTitleProvider(this.state.showSection):""),z.createElement("div",{className:"sectionItemCount"},this.props.data.length),z.createElement("div",{className:"icon"},z.createElement(xe.I,ot.Ju)));this._taskBoardCards=[];const n=this.props.data.slice(0,this.state.numCardsToRender).map((e,t)=>this.renderEntityCard(e,t));this.props.isOver&&null!==this.state.placeholderIndex&&n.splice(this.state.placeholderIndex,0,z.createElement("div",{style:{position:"relative"},className:"placeholderCardContainer",key:"placeholder","data-dnd-role":"placeholder"},z.createElement("div",{style:{opacity:0,visibility:"hidden"}},z.createElement(kc,{key:"placeholder card",index:null,entity:this.state.draggedEntity,columnValue:this.props.columnValue,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,maxAssignees:this.props.maxAssignees,showPreview:this.props.displayMode===ea.Board,showPlanTitle:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,secondaryGrouping:!1,onKeyboardTaskReorder:this.props.onKeyboardTaskReorder,onDelete:()=>{},onTaskCardClick:()=>{},setRef:()=>{},currentUserId:this.props.currentUserId,taskPermissions:{canAssign:!0,canDelete:!0,canEditDescription:!0,attachmentPermissions:ca.I.DisableNone,canEditTitle:!0,canUpdateDueDate:!0,canUpdatePriority:!0,canUpdatePriorityToUrgent:!0,checklistPermissions:la.j.DisableNone},canAddGuests:!0,theme:this.props.theme})),z.createElement("div",{className:t.placeholderCard})));let r=!1;this.props.data&&this.state.numCardsToRender<this.props.data.length&&(r=!0);let s="";this.props.modifiedTaskIds&&(1===this.props.modifiedTaskIds.length?s=Ie.p.Strings.TaskBoardColumn_ModifiedTasksSingularAriaLabel:this.props.modifiedTaskIds.length>1&&(s=vt.G(Ie.p.Strings.TaskBoardColumn_ModifiedTasksPluralAriaLabel,this.props.modifiedTaskIds.length)));const i=this.props.canMoveTaskWithinSameColumn?Ie.p.Strings.TaskCard_MovableTaskCardAriaLabel:Ie.p.Strings.TaskCard_TaskCardAriaLabel,a=z.createElement("div",{className:(0,Qe.A)(this.props.columnGroupClassName,t.root),"data-dnd-role":"columnGroup","data-can-drag-to-scroll":"true",ref:this.resolveRef(this,"columnGroup")},this.props.isCollapsable?o:null,null!=this.props.callbacks.addCardControlProvider&&this.props.showAddEntityCard?this.renderAddCardControl():null,z.createElement("div",{className:"listWrapper"},this.state.showSection&&!me()(n)?z.createElement("div",{className:(0,Qe.A)("listboxGroup",t.listBoxGroup),role:"list","data-can-drag-to-scroll":"true"},z.createElement("div",{className:(0,Qe.A)(fc.Z,t.screenReaderOnly)},s+this.props.columnName+i),z.createElement(Zo.H,{id:"taskColumn",hasMoreItemsToRender:r,orientation:Zo.Q.Vertical,onLastElementIsVisible:()=>this.handleInView()},n)):null),this.state.showSection?z.createElement("div",{"data-dnd-role":"bottomDropZone","data-can-drag-to-scroll":"true",className:t.bottomDropZone}):null);return this.props.disableColumnChanges||!this.props.connectDropTarget?a:null!==(e=this.props.connectDropTarget(a))&&void 0!==e?e:a}groupTarget(){const e=super.groupTarget();return{drop:(t,o,n)=>{var r;if(t.disableDragInto&&"card"===o.getItemType()){if(o.getItem().sourceColumnValue!==t.columnValue)return}return null===(r=e.drop)||void 0===r?void 0:r.call(e,t,o,n)},hover:An()((t,o,n)=>{if(t.disableCustomOrderCards){const e=n;if(e.onHover(t,o,n),"card"===o.getItemType()){const n=o.getItem(),r=o.getClientOffset();if(null==r)return;e._previousPointerYPosition=r.y;let s=document.elementFromPoint(r.x,r.y);s=e.findTarget(s);const i=wc()(e.props.data);let a=i.indexOf(n.entity);-1===a&&(null!=t.findPlaceHolderIndex?a=t.findPlaceHolderIndex(i,e.props.columnValue,n.entity):(i.push(n.entity),i.sort(Bc.BY),a=i.indexOf(n.entity))),s&&"topDropZone"===s.getAttribute("data-dnd-role")&&e.setPlaceholder(a,n),s&&"bottomDropZone"===s.getAttribute("data-dnd-role")&&e.setPlaceholder(a,n),s&&"card"===s.getAttribute("data-dnd-role")&&e.setPlaceholder(a,n),s&&"sectionToggle"===s.getAttribute("data-dnd-role")&&(!1===e.state.showSection&&e.setState({showSection:!0}),e.setPlaceholder(a,n))}}else{var r;null===(r=e.hover)||void 0===r||r.call(e,t,o,n)}},50),canDrop:(t,o)=>{if(t.taskBoardCardCallbacks.taskCallbacks.getFlights().EnableProjectTasksForPlannerWeb&&"card"===o.getItemType()&&o.getItem()){const e=o.getItem(),n=e.props.taskPermissions;if(e.sourceColumnValue!==t.columnValue&&n){const e=t.taskBoardCardCallbacks.getCurrentTaskGroupingState();if(e===p.Yc.Progress&&!n.canUpdateProgress)return!1;if(e===p.Yc.Priority&&!n.canUpdatePriority)return!1;if(e===p.Yc.DueDate&&!n.canUpdateDueDate)return!1;if(e===p.Yc.Bucket&&!n.canUpdateBucket)return!1;if(e===p.Yc.Assignee&&!n.canAssign)return!1;if(e===p.Yc.Category&&!n.canUpdateAppliedLabels)return!1}else if(e.sourceColumnValue===t.columnValue&&n){if(e.secondaryGrouping!==t.secondaryGrouping&&!n.canUpdateProgress)return!1}}return!e.canDrop||e.canDrop(t,o)}}}getLastTaskCard(){return me()(this._taskBoardCards)?null:this._taskBoardCards[this._taskBoardCards.length-1].element}renderAddCardControl(){const e=this.props.callbacks.addCardControlProvider&&this.props.toggleAddCardControl?this.props.callbacks.addCardControlProvider(this.props.toggleAddCardControl.bind(this)):null;return z.createElement("div",{key:"addCardControl",className:"addControlContainer"},e)}renderEntityCard(e,t){return z.createElement(kc,{key:e.id,index:t,entity:e,columnValue:this.props.columnValue,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,maxAssignees:this.props.maxAssignees,showPreview:this.props.displayMode===ea.Board,showPlanTitle:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,secondaryGrouping:this.props.secondaryGrouping,onKeyboardTaskReorder:this.props.onKeyboardTaskReorder,onDelete:e=>{this.restoreFocusOnMoveTask(e),this.props.taskBoardCardCallbacks.onDeleteTask(e)},onTaskCardClick:this.onClickTaskCard,setRef:(e,t)=>null!=e&&this._taskBoardCards.push({element:e,id:t}),restoreFocusOnMoveTask:this.restoreFocusOnMoveTask,currentUserId:this.props.currentUserId,taskPermissions:this.props.getTaskPermissions(e),totalTasksInColumnGroup:this.props.data.length,taskBoardCardPositionInColumnGroup:t,canAddGuests:this.props.canAddGuests,onCardDragStateChange:this.props.onCardDragStateChange,theme:this.props.theme})}handleInView(){this.setState({numCardsToRender:this.state.numCardsToRender+Ec.infiniteScrollIncrementSize})}getClassNames(){return yc(xc(this.props.theme,this.props.styles,this.state.showSection))}constructor(e,t){if(super(e,t),this.toggleShowSection=()=>{this.logUsage(g.M.ToggleColumnGroupSection,{sectionId:this.props.columnValue,isCollapsed:String(this.state.showSection),isCompleteSection:String(this.props.secondaryGrouping)}),super.toggleShowSection()},this.restoreFocusOnMoveTask=e=>{const t=null==this.props.altFocusElement?this.columnGroup:this.props.altFocusElement;kn.n.ChangeFocusBeforeRemovalIFocusable(this._taskBoardCards,t,e)},this.onClickTaskCard=e=>{this.props.data.forEach((t,o)=>{t.id===e&&(this._taskDetailsTaskIndex=o)}),this.props.openTaskDetails(e,e=>{this.onTaskDetailsEditorDismiss(e)})},this.onTaskDetailsEditorDismiss=e=>{kn.n.RestoreFocusAfterRemovalAlt(this._taskBoardCards.map(e=>e.element),()=>{this.props.altFocusElement&&this.props.altFocusElement.focus()},this._taskDetailsTaskIndex)},this.state={draggedEntity:null,placeholderIndex:null,showSection:!this.props.isCollapsable,showAddEntityCard:!1,numCardsToRender:Ec.infiniteScrollIncrementSize},!me()(e.data)){const t=e.data.slice(0,this.state.numCardsToRender);for(const e of t)this.props.fetchTaskPreview(e.id);(0,mo.qj)(t).map(e=>this.props.fetchPermissionsWithTaskContext(e))}}}Ec.infiniteScrollIncrementSize=10;const Ic=(0,ua.T)("card",Ec.prototype.groupTarget(),Ec.prototype.groupCollect)(Ec);var Fc,Lc=o(53986),Mc=o(61804),Nc=function(){return Nc=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Nc.apply(this,arguments)};!function(e){e[e.None=0]="None",e[e.Dragging=1]="Dragging",e[e.Scrolling=2]="Scrolling"}(Fc||(Fc={}));var Rc=function(){function e(e,t){var o=this;if(this.options={maxScrollSpeed:1.2,maxSpeedZoneSize:20,maxScrollZoneSize:200,scrollZoneScale:.2,updateScrollSpeedThrottleInterval:50,minDragDistanceForScrolling:50},this.scrollState=Fc.None,this.hasPointerLeftDragStartArea=!1,this.xSpeed=0,this.ySpeed=0,this.canScrollX=!1,this.canScrollY=!1,this.updateScrollSpeed=An()(function(){if(null!=o.pointerCoord&&null!=o.initialPointerCoord&&o.scrollState!==Fc.None){if(!o.hasPointerLeftDragStartArea){var e=o.initialPointerCoord,t=e.x,n=e.y,r=o.pointerCoord,s=r.x,i=r.y,a=Math.abs(s-t),l=Math.abs(i-n);if(a<o.options.minDragDistanceForScrolling&&l<o.options.minDragDistanceForScrolling)return;o.hasPointerLeftDragStartArea=!0}var c=o.element.getBoundingClientRect(),p=c.left,d=c.right,u=c.top,h=c.bottom,g=c.width,m=c.height,C=o.options,k=C.maxScrollSpeed,b=C.maxSpeedZoneSize,T=C.maxScrollZoneSize,S=C.scrollZoneScale;if(o.canScrollX&&u<o.pointerCoord.y&&o.pointerCoord.y<h){var P=Math.min(T,g*S);o.xSpeed=Uc(o.pointerCoord.x,p,d,P,b,k)}else o.xSpeed=0;if(o.canScrollY&&p<o.pointerCoord.x&&o.pointerCoord.x<d){var v=Math.min(T,m*S);o.ySpeed=Uc(o.pointerCoord.y,u,h,v,b,k)}else o.ySpeed=0;0!==o.xSpeed||0!==o.ySpeed?o.setScrollState(Fc.Scrolling):o.setScrollState(Fc.Dragging)}},this.options.updateScrollSpeedThrottleInterval),this.element=e,t&&(this.options=Nc(Nc({},this.options),t)),this.options.maxScrollSpeed<=0)throw new Error("maxScrollSpeed must be greater than 0");if(this.options.maxSpeedZoneSize<0)throw new Error("maxSpeedZoneSize cannot be negative");if(this.options.maxScrollZoneSize<0)throw new Error("maxScrollZoneSize cannot be negative");if(this.options.scrollZoneScale<=0||this.options.scrollZoneScale>.5)throw new Error("scrollZoneScale must be between 0 and 0.5");if(this.options.updateScrollSpeedThrottleInterval<0)throw new Error("updateScrollSpeedThrottleInterval cannot be negative");if(this.options.minDragDistanceForScrolling<0)throw new Error("minDragDistanceForScrolling cannot be negative")}return e.prototype.setIsDragging=function(e){e?this.scrollState===Fc.None&&this.setScrollState(Fc.Dragging):this.setScrollState(Fc.None)},e.prototype.setPointerCoord=function(e){null==this.initialPointerCoord&&(this.initialPointerCoord=e),this.pointerCoord=e,this.updateScrollSpeed()},e.prototype.setScrollState=function(e){this.scrollState!==e&&(this.scrollState===Fc.None?this.checkElementCanScroll():this.scrollState===Fc.Scrolling&&this.endScroll(),this.scrollState=e,e===Fc.None?this.resetState():e===Fc.Scrolling&&this.startScroll())},e.prototype.startScroll=function(){var e,t=this,o=function(n){if(t.scrollState===Fc.Scrolling){var r=null!=e?n-e:0;e=n;var s=t.xSpeed*r,i=t.ySpeed*r;0===s&&0===i||t.element.scrollBy(s,i),t.rafId=window.requestAnimationFrame(o)}};this.rafId=window.requestAnimationFrame(o)},e.prototype.endScroll=function(){null!=this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=null)},e.prototype.resetState=function(){this.xSpeed=0,this.ySpeed=0,this.pointerCoord=null,this.initialPointerCoord=null,this.hasPointerLeftDragStartArea=!1,this.canScrollX=!1,this.canScrollY=!1},e.prototype.checkElementCanScroll=function(){this.canScrollX=this.element.scrollWidth>this.element.clientWidth,this.canScrollY=this.element.scrollHeight>this.element.clientHeight},e}();function Uc(e,t,o,n,r,s){var i=t+n,a=o-n,l=n-r;return e<t+r?-s:e<i?-((i-e)/l*s):e>o-r?s:e>a?(e-a)/l*s:0}function Oc(e,t){var o=z.useContext(Mc.M).dragDropManager;if(!o)throw new Error("Unable to get dragDropManager from context. Wrap this in <DndProvider>.");z.useEffect(function(){if(null!=e.current){var n=new Rc(e.current,t),r=o.getMonitor(),s=r.subscribeToStateChange(function(){n.setIsDragging(r.isDragging())}),i=r.subscribeToOffsetChange(function(){var e=r.getClientOffset();e&&n.setPointerCoord(e)});return function(){s(),i()}}},[o,e,t])}const Hc=["scrollerOptions"],Vc=["scrollerOptions"],Gc=z.forwardRef((e,t)=>{const{scrollerOptions:o}=e,n=(0,Lc.A)(e,Hc);return Oc(t,o),z.createElement("ul",(0,c.A)((0,c.A)({},n),{},{ref:t}))}),Wc=z.forwardRef((e,t)=>{const{scrollerOptions:o}=e,n=(0,Lc.A)(e,Vc);return Oc(t,o),z.createElement("div",(0,c.A)((0,c.A)({},n),{},{ref:t}))});var _c=o(8403),zc=o(61460),Zc=o.n(zc),Kc=o(22317);class qc extends aa{columnCollect(e,t){return{isDragging:t.isDragging(),connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview()}}componentDidMount(){this.props.autoFocus&&!this.props.showAddEntityCard&&this.columnElement&&this.columnElement.focus()}renderComponent(){var e;const t=this.getClassNames();let o="";this.props.modifiedTaskIds&&(1===this.props.modifiedTaskIds.length?o=Ie.p.Strings.TaskBoardColumn_ModifiedTasksSingularAriaLabel:this.props.modifiedTaskIds.length>1&&(o=vt.G(Ie.p.Strings.TaskBoardColumn_ModifiedTasksPluralAriaLabel,this.props.modifiedTaskIds.length)));const n=z.createElement("li",{ref:this.resolveRef(this,"columnElement"),"data-is-focusable":!0,className:t.root,style:{display:this.props.isDragging?"none":""},"data-index":this.props.index,"data-dnd-role":!0===this.props.disableDrag?void 0:"column",id:"column_".concat(this.props.pivotValue),tabIndex:0,"aria-label":this.props.disableDrag?vt.G(Ie.p.Strings.TaskBoardColumn_ColumnTitleAriaLabel,this.props.title)+o:vt.G(Ie.p.Strings.TaskBoardColumn_ColumnTitleAriaLabel,this.props.title)+o+Ie.p.Strings.TaskBoardColumn_ColumnAriaLabel,onKeyDown:this.onKeyDown},z.createElement(Kc.pL,{rootMargin:"500px"},this.renderColumnContentCallback.bind(this)));return this.props.disableColumnChanges||!this.props.connectDragPreview?n:null!==(e=this.props.connectDragPreview(n))&&void 0!==e?e:n}renderColumnHeader(){const e=this.getClassNames(),t=this.props.headerImage&&z.createElement("div",{className:"headerImage"},this.props.headerImage),o=vt.G(Ie.p.Strings.TaskBoardColumn_AddButtonContainerAriaLabel,this.props.title),n=z.createElement("div",{className:"addButtonContainer"},z.createElement("div",{className:(0,Qe.A)(e.addButton,"active_0"),onClick:e=>{this.toggleAddCardControl(e)},onKeyPress:e=>{this.toggleAddCardControl(e)},"aria-label":o,role:"button",tabIndex:0,title:Ie.p.Strings.TaskBoardColumn_AddButtonContainerTooltipText,ref:this.resolveRef(this,"addTaskButtonElement")},z.createElement(xe.I,ot.D5),z.createElement("span",{className:"addTaskText"},Ie.p.Strings.TaskBoardColumn_AddTaskButtonText))),r=null!=this.props.callbacks.addCardControlProvider&&!this.props.disableColumnChanges&&!this.props.disableAddTask;return z.createElement("div",{className:e.columnHeader,draggable:!this.props.disableDrag},z.createElement("div",{className:"columnHeaderTitle passive_1"},z.createElement("div",{className:e.titleSection},t,this.renderColumnTitle(),this.renderEditMenu(),!!this.props.isCollapsable&&z.createElement("button",{className:"columnCollapseButton",onClick:e=>{this.toggleShowSection(e)},"aria-expanded":!this.state.isCollapsed,"aria-label":this.props.title},z.createElement(xe.I,(0,c.A)((0,c.A)({},ot.Ju),{},{className:(0,Qe.A)(ot.Ju.className,this.state.isCollapsed?"straight":"rotated")}))))),r&&n)}renderColumnBody(){const e=this.getClassNames(),t=this.props.enableAutoScrollOnDragItem?Wc:"div";return z.createElement(t,{className:e.scrollable,"data-can-drag-to-scroll":"true",ref:this.columnBodyRef},this.renderPrimarySection(),this.props.useSecondaryClassification?this.renderSecondarySection():null)}renderPrimarySection(){let e=this.props.data;this.props.useSecondaryClassification&&this.props.callbacks.secondaryClassifier&&(e=pn()(this.props.data,e=>!this.props.callbacks.secondaryClassifier(e)));const t={addCardControlProvider:this.props.callbacks.addCardControlProvider,valueSetter:this.props.callbacks.valueSetter,secondaryValueSetter:this.props.callbacks.secondaryValueSetter},o=this.addTaskButtonElement||this.props.emptyColumnFocusElement||this.columnElement,n=e.map(e=>e.id),r=this.props.modifiedTaskIds?Zc()(this.props.modifiedTaskIds,n):[];return z.createElement(Ic,{columnGroupClassName:"primarySection",columnName:this.props.title,columnValue:this.props.pivotValue,modifiedTaskIds:r,data:e,callbacks:t,isCollapsable:!1,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,onKeyboardTaskReorder:this.onKeyboardTaskReorder,showAddEntityCard:this.props.showAddEntityCard,toggleAddCardControl:()=>this.toggleAddCardControl(),secondaryGrouping:!1,disableCustomOrderCards:this.props.disableCustomOrderCards,disableDragInto:this.props.disableDragInto,findPlaceHolderIndex:this.props.findPlaceHolderIndex,altFocusElement:null!==o&&void 0!==o?o:void 0,openTaskDetails:this.props.openTaskDetails,ref:this.resolveRef(this,"primaryTaskBoardColumnGroup"),fetchTaskPreview:this.props.fetchTaskPreview,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,getTaskPermissions:this.props.getTaskPermissions,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:this.props.canMoveTaskWithinSameColumn,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext,onCardDragStateChange:this.onCardDragStateChange})}renderSecondarySection(){if(!this.props.callbacks.secondaryClassifier)return null;const e=pn()(this.props.data,e=>this.props.callbacks.secondaryClassifier(e));if(this._secondarySectionLength=e.length,0===this._secondarySectionLength)return null;const t={sectionTitleProvider:this.props.callbacks.secondarySectionTitleProvider,valueSetter:this.props.callbacks.valueSetter,secondaryValueSetter:this.props.callbacks.secondaryValueSetter},o=null==this.primaryTaskBoardColumnGroup?null:this.primaryTaskBoardColumnGroup.getDecoratedComponentInstance().getLastTaskCard(),n=null==o?this.addTaskButtonElement:o,r=e.map(e=>e.id),s=this.props.modifiedTaskIds?Zc()(this.props.modifiedTaskIds,r):[];return z.createElement(Ic,{columnGroupClassName:"secondarySection",columnName:this.props.title,columnValue:this.props.pivotValue,data:e,modifiedTaskIds:s,callbacks:t,isCollapsable:!0,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,onKeyboardTaskReorder:this.onKeyboardTaskReorder,showAddEntityCard:this.props.showAddEntityCard,secondaryGrouping:!0,disableCustomOrderCards:this.props.disableCustomOrderCards,findPlaceHolderIndex:this.props.findPlaceHolderIndex,openTaskDetails:this.props.openTaskDetails,altFocusElement:null!==n&&void 0!==n?n:void 0,fetchTaskPreview:this.props.fetchTaskPreview,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,disableDragInto:this.props.disableDragInto,getTaskPermissions:this.props.getTaskPermissions,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:this.props.canMoveTaskWithinSameColumn,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext,onCardDragStateChange:this.onCardDragStateChange})}renderColumnContentCallback(e){let{inView:t,ref:o}=e;return t||!this.props.bucketVirtualization||this.props.isDragging||this.state.isCardDragged?z.createElement("div",{ref:o,className:"columnContent"},this.props.connectDragSource?this.props.connectDragSource(this.renderColumnHeader()):this.renderColumnHeader(),this.renderColumnBody(),this.state.isDeleteDialogOpen?this.getDeleteDialog():null):z.createElement("div",{ref:o,className:"columnContent"})}renderEditMenu(){if(this.state.isEditingTitle||this.props.disableColumnChanges||!this.props.canEditTitle&&!this.props.canDeleteColumn&&!this.props.canMoveColumnLeft&&!this.props.canMoveColumnRight)return null;const e=z.createElement(En.K,{className:"editMenuLauncher",onClick:this.toggleEditMenu,iconProps:ot.XP,ariaLabel:Ie.p.Strings.TaskBoardColumn_MoreOptionsAriaLabel,title:Ie.p.Strings.TaskBoardColumn_MoreOptionsAriaLabel,"aria-expanded":this.state.isEditMenuVisible,"aria-haspopup":!0,elementRef:this.editMenuLauncher,plannerTheme:this.props.theme}),t=[];this.props.canEditTitle&&t.push({key:"Edit",name:Ie.p.Strings.TaskBoardColumn_RenameBucket,onClick:this.startEditingColumnTitle}),this.props.canDeleteColumn&&t.push({key:"Delete",name:Ie.p.Strings.TaskBoardColumn_DeleteBucket,onClick:this.openDeleteDialog}),this.props.canMoveColumnRight&&t.push({key:"MoveRight",name:Ie.p.Strings.TaskBoardColumn_MoveBucketRight,onClick:this.moveBucket.bind(this,!0)}),this.props.canMoveColumnLeft&&t.push({key:"MoveLeft",name:Ie.p.Strings.TaskBoardColumn_MoveBucketLeft,onClick:this.moveBucket.bind(this,!1)});const o=z.createElement($e.l,{shouldFocusOnMount:!0,items:t,directionalHint:Xe.A.bottomAutoEdge,target:this.editMenuLauncher,onDismiss:this.dismissEditMenu,appTheme:this.props.theme}),n=(0,Qe.A)("editMenu",{stayOpen:this.state.isEditMenuVisible});return z.createElement("div",{className:n},e,this.state.isEditMenuVisible?o:null)}renderColumnTitle(){if(this.state.isEditingTitle)return z.createElement(ra.A,{className:"editColumnTextField",autoComplete:"off",autoFocus:!0,tabIndex:0,placeholder:this.props.title,onKeyUp:this.columnTitleKeyUp,onKeyDown:this.columnTitleTextfieldKeyDown,onBlur:this.onTextFieldBlur,onChange:(e,t)=>{this.columnTitleChanged(t)},ariaLabel:Ie.p.Strings.TaskBoardColumn_EditTitleAriaLabel,value:this.state.updatedTitle,maxLength:_c.f.TitleMaxLength,styleType:sa.u.Bucket,appTheme:this.props.theme});{const e=(0,Qe.A)("columnTitle",{readOnly:!this.props.canEditTitle||this.props.disableColumnChanges});return this.props.canEditTitle&&!this.props.disableColumnChanges?z.createElement("div",{className:e,tabIndex:0,onClick:this.startEditingColumnTitle,onKeyDown:this.startEditingColumnTitle,role:"button",title:this.props.title,ref:this.columnTitle},z.createElement("h3",null,this.props.title)):z.createElement("div",{className:e,title:this.props.title},z.createElement("h3",null,this.props.title))}}getDeleteDialog(){const e=(0,Ee.S9)(this.props.theme),t=(0,Ee.XK)(this.props.theme);return z.createElement(Ae.l,{hidden:!this.state.isDeleteDialogOpen,onDismiss:this.dismissDeleteDialog.bind(this),dialogContentProps:{className:ce.vt,type:we.h.normal,title:"null"===this.props.pivotValue?Ie.p.Strings.TaskBoardColumn_DeleteUncategorizedTitle:vt.G(Ie.p.Strings.TaskBoardColumn_DeleteBucketText,this.props.title),subText:"null"===this.props.pivotValue?Ie.p.Strings.TaskBoardColumn_DeleteUncategorizedTasksSubtext:Ie.p.Strings.TaskBoardColumn_DeleteBucketTasksText,styles:t},styles:e,modalProps:{className:"deleteColumnDialog",containerClassName:ce.bI,isBlocking:!1}},z.createElement(De.E,null,z.createElement(q.j,{onClick:this.deleteColumn},Ie.p.Strings.TaskBoardColumn_DeleteBucketButtonText),z.createElement(j.Y,{onClick:this.dismissDeleteDialog},Ie.p.Strings.TaskBoardColumn_CancelDelete)))}getClassNames(){const e=!this.props.canEditTitle||this.props.disableColumnChanges;return Sc(bc(this.props.theme,this.props.styles,this.props.displayMode,e,this.props.isSlimView,this.props.showAddEntityCard,this.state.isCollapsed,this.props.isTeamsSplitUI,le.B.isUnoContext))}constructor(e,t){var o;super(e,t),o=this,this.editMenuLauncher=z.createRef(),this.columnTitle=z.createRef(),this.SET_FOCUS_TIMEOUT=60,this.columnBodyRef=z.createRef(),this.toggleAddCardControl=e=>{(null==e||Ye.a.isButtonPress(e))&&(this.props.callbacks.addCardControlProvider&&(this.props.showAddEntityCard&&this.addTaskButtonElement?(this.addTaskButtonElement.focus(),this.props.onCloseAddTaskCard()):this.props.onOpenAddTaskCardFromAddTaskButton(),this.props.toggleAddTaskFormVisibility(this.props.pivotValue)),null!=e&&e.stopPropagation())},this.toggleShowSection=e=>{null!=e&&(e.stopPropagation(),e.preventDefault());const t=this.props.pivotValue===co.$.Complete;this.logUsage(g.M.ToggleColumnGroupSection,{sectionId:this.props.pivotValue,isCollapsed:String(!this.state.isCollapsed),isCompleteSection:String(t)}),this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isCollapsed:!e.isCollapsed}))},this.toggleEditMenu=()=>{this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isEditMenuVisible:!e.isEditMenuVisible}))},this.dismissEditMenu=()=>{this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isEditMenuVisible:!1}))},this.startEditingColumnTitle=e=>{e.stopPropagation(),Ye.a.isButtonPress(e)&&(this.props.setTaskBoardEditMode($c.Edit),this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isEditingTitle:!0,updatedTitle:this.props.title})))},this.onKeyDown=e=>{if(e.stopPropagation(),this.props.disableColumnChanges||!this.props.onReorderColumn)return;const t=!(0,Me.jI)();e.ctrlKey&&e.shiftKey&&e.keyCode===Le.D.Period?(e.preventDefault(),this.props.onReorderColumn(this.props.pivotValue,t)):e.ctrlKey&&e.shiftKey&&e.keyCode===Le.D.Comma&&(e.preventDefault(),this.props.onReorderColumn(this.props.pivotValue,!t))},this.onTextFieldBlur=e=>{this.updateColumnTitle(),this.dismissEditTitle(!1)},this.moveBucket=e=>{setTimeout(()=>{this.setFocusOnMoreMenu()},this.SET_FOCUS_TIMEOUT),this.props.onReorderColumn&&(e?this.props.onReorderColumn(this.props.pivotValue,!0):this.props.onReorderColumn(this.props.pivotValue,!1))},this.columnTitleKeyUp=e=>{e.stopPropagation()},this.columnTitleTextfieldKeyDown=e=>{const t=Ye.a.getKey(e);t===Le.D.ESCAPE?this.dismissEditTitle():t===Le.D.ENTER&&(this.updateColumnTitle(),this.dismissEditTitle())},this.columnTitleChanged=e=>{this.setState(t=>(0,c.A)((0,c.A)({},t),{},{updatedTitle:e}))},this.updateColumnTitle=()=>{this.props.updateColumnTitle&&(this.state.updatedTitle&&""!==this.state.updatedTitle.trim()&&this.state.updatedTitle!==this.props.title&&this.props.updateColumnTitle(this.state.updatedTitle),""===this.state.updatedTitle&&this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()===p.Yc.Category&&this.state.updatedTitle!==this.props.title&&this.props.updateColumnTitle(""))},this.dismissEditTitle=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o.props.setTaskBoardEditMode($c.Drag),o.setState(e=>(0,c.A)((0,c.A)({},e),{},{isEditingTitle:!1,updatedTitle:o.props.title}),()=>{var t;e&&(null===(t=o.columnTitle)||void 0===t||null===(t=t.current)||void 0===t||t.focus())})},this.openDeleteDialog=()=>{this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isDeleteDialogOpen:!0}))},this.dismissDeleteDialog=()=>{this.setFocusOnMoreMenu(),this.setState(e=>(0,c.A)((0,c.A)({},e),{},{isDeleteDialogOpen:!1}))},this.deleteColumn=()=>{this.setState(e=>({isDeleteDialogOpen:!1}),()=>{"null"===this.props.pivotValue&&this.context.usageLogger.logData("TaskBoardColumn",g.M.DeleteUncategorizedBucket),null!=this.props.onDeleteColumn&&this.props.onDeleteColumn(this.props.pivotValue)})},this.onKeyboardTaskReorder=(e,t,o)=>{if(!this.props.data)return;const n=this.getSortAfterBeforeTasks(t,o,this.props.data);null===n[0]&&null===n[1]||this.props.callbacks.valueSetter(t,n[0],n[1],e)},this.getSortAfterBeforeTasks=(e,t,o)=>{let n=null,r=null;const s=o.indexOf(e);if(t){if(0===s)return[r,n];for(let t=s-1;t>=0&&(e.isComplete()!==o[t].isComplete()||(n?r||(r=o[t]):n=o[t],!r||!n));t--);}else{if(s===o.length-1)return[r,n];for(let t=s+1;t<o.length&&(e.isComplete()!==o[t].isComplete()||(r?n||(n=o[t]):r=o[t],!r||!n));t++);}return[r,n]},this.setFocusOnMoreMenu=()=>{this.editMenuLauncher.current?this.editMenuLauncher.current.focus():null!=this.addTaskButtonElement&&this.addTaskButtonElement.focus()},this.onCardDragStateChange=e=>{this.setState({isCardDragged:e})},this._secondarySectionLength=0,this.state={showAddEntityCard:!1,isCollapsed:this.props.isCollapsed||!1,isEditingTitle:!1,updatedTitle:this.props.title,isEditMenuVisible:!1,isDeleteDialogOpen:!1,isCardDragged:!1}}}const jc=(0,Wo.I)("column",qc.prototype.columnSource(),qc.prototype.columnCollect)(qc),Qc="32px",Yc=(0,ze.vb)((0,ze.jz)(Ue.B.TopHeaderIconHorizontalOffset)-(0,ze.jz)(ga)),Jc=(0,Q.J9)(function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ea.Board,n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;const i=Rt.d.isLoopTheme(e);let a=ya,l=ga;switch(e){case ce.Sx.LoopLight:case ce.Sx.LoopDark:a=va,l=ma;break;case ce.Sx.TeamsLight:case ce.Sx.TeamsDark:case ce.Sx.TeamsContrast:s||(l=Ca);case ce.Sx.Light:case ce.Sx.Dark:case ce.Sx.SharePoint:}const c={root:[(0,Ne.GD)(),(0,Ne.gS)(),o===ea.Board&&{"> ul.columnsList":{padding:s?"0 ".concat(Yc," 0 15px"):"0 ".concat(Yc)},".sharepointApp &":{padding:"".concat(Ue.B.SharepointContentTopPadding," ").concat(Ue.B.SharepointHorizontalPadding," ").concat(Ue.B.SharepointContentBottomPadding)}},o===ea.List&&{marginLeft:Ue.B.ShadowMargin}],columnsList:[(0,Ne.GD)(),o===ea.Board&&[(0,Ne.gS)(),{overflowX:"auto",overflowY:"hidden","> li":[(0,Ne.$Z)(a)]}],o===ea.List&&[(0,Ne.gS)("column"),{"> li":[(0,Ne.$Z)()]}]],createColumn:[fa(e,o,n,r,s),{"> .columnContent > .columnHeader":[Aa(e),{"> .columnHeaderTitle > .titleSection":[wa(e,!1),i&&{overflow:"visible","> .columnTitle":[(0,Ne.$Z)(),{".plannerIcon":[(0,Ne.$Z)("auto"),(0,Ne._D)(e),xa(e),(0,Oe.kE)(),{display:"flex",width:Qc,height:Qc,borderRadius:"8px"}],"> span":{display:"none"}}]}]}]}],addColumnButton:[Ne.xK,(0,Ne.aS)(e),{cursor:"pointer",":hover":[(0,Ne.aS)(e)]}],placeholderColumn:[{width:a,padding:"0 ".concat(l),boxSizing:"content-box",backgroundColor:Da(e),"> div":{opacity:0,visibility:"hidden"}},(e===ce.Sx.LoopLight||e===ce.Sx.LoopDark)&&{borderRadius:Ue.B.LoopBorderRadius}]};return(0,Y.TW)(c,t)}),Xc=(0,Q.J9)(e=>({root:(0,Y.Zq)("taskBoardView",e.root),columnsList:(0,Y.Zq)("columnsList",e.columnsList),createColumn:(0,Y.Zq)("createColumn",e.createColumn),addColumnButton:(0,Y.Zq)("addColumnButton",e.addColumnButton),placeholderColumn:(0,Y.Zq)("placeholderColumn",e.placeholderColumn)}));var $c;!function(e){e[e.Edit=0]="Edit",e[e.Drag=1]="Drag"}($c||($c={}));class ep extends na{renderComponent(){var e;const t=this.getClassNames(),o=this.props.columnDefinitions;this._boardColumns=[];const n=o.map((e,t)=>this.renderBoardViewColumn(e,t)),r=null!=this.state.draggedColumnIndex?this.props.columnDefinitions[this.state.draggedColumnIndex]:null;this.props.isOver&&null!=this.state.placeholderIndex&&this.state.placeholderIndex>=0&&null!=r&&n.splice(this.state.placeholderIndex,0,z.createElement("li",{className:t.placeholderColumn,key:"placeholder","data-dnd-role":"placeholder"},z.createElement("div",null,this.renderBoardViewColumn(r,null))));const s=this.props.enableDragToScroll?{onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp}:null,i=this.props.enableAutoScrollOnDragItem?Gc:"ul",a=z.createElement("div",{className:t.root},z.createElement(i,(0,c.A)({className:t.columnsList,ref:this.boardViewUlElementRef},s),n,this.renderCreateColumn()));return this.props.disableColumnChanges||!this.props.connectDropTarget?a:null!==(e=this.props.connectDropTarget(a))&&void 0!==e?e:a}componentDidUpdate(e,t){this.shouldSetFocus&&this.addColumnButton&&(this.addColumnButton.focus(),this.shouldSetFocus=!1)}renderBoardViewColumn(e,t){var o;const{callbacks:n}=this.props,r={secondaryClassifier:n.secondaryClassifier,secondarySectionTitleProvider:n.secondarySectionTitleProvider,secondaryValueSetter:n.secondaryValueSetter,valueSetter:(t,o,r,s)=>n.valueSetter(t,e.pivotValue,o,r,s),addCardControlProvider:n.addCardControlProvider?t=>n.addCardControlProvider(e.pivotValue,null,e.dataEntities?e.dataEntities[0]:null,()=>{},t):void 0},s=null!=e.pivotValue?e.pivotValue.toString():"null",i=null===e.pivotValue||0===this.state.interactionMode||!e.canEditTitle||!this.props.enableColumnMove||this.props.disableColumnChanges,a=null!==(o=this.props.enableColumnMove)&&void 0!==o&&o,l=e.dataEntities?e.dataEntities.map(e=>e.id):[],c=this.props.modifiedTaskIds?Zc()(this.props.modifiedTaskIds,l):[];return z.createElement(jc,{autoFocus:this.props.autoFocus&&0===t,key:s,data:e.dataEntities,modifiedTaskIds:c,canEditTitle:e.canEditTitle,canDeleteColumn:e.canDeleteColumn,canMoveColumnRight:a&&e.canMoveColumnRight,canMoveColumnLeft:a&&e.canMoveColumnLeft,updateColumnTitle:e.onUpdateTitle,onDeleteColumn:e=>this.onDeleteColumn(e),onReorderColumn:(e,t)=>this.onReorderColumn(e,t),useSecondaryClassification:this.props.useSecondaryClassification,callbacks:r,taskBoardCardCallbacks:this.props.taskBoardCardCallbacks,title:e.title,pivotValue:s,index:t,disableDrag:i,setTaskBoardEditMode:this.setTaskBoardEditMode.bind(this),isCollapsable:e.isCollapsable,isCollapsed:e.isCollapsed,headerImage:e.headerImage,maxAssignees:this.props.maxAssignees,displayMode:this.props.displayMode,showPlanTitleOnCard:this.props.showPlanTitleOnCard,showCopyLinkToTask:this.props.showCopyLinkToTask,toggleAddTaskFormVisibility:this.props.toggleAddTaskFormVisibility,onOpenAddTaskCardFromAddTaskButton:this.props.onOpenAddTaskCardFromAddTaskButton,onCloseAddTaskCard:this.props.onCloseAddTaskCard,showAddEntityCard:!(!this.props.showAddEntityCardCallback||this.props.disableColumnChanges)&&this.props.showAddEntityCardCallback(s),disableAddTask:e.disableAddTask,disableCustomOrderCards:e.disableCustomOrderCards,disableDragInto:e.disableDragInto,findPlaceHolderIndex:e.findPlaceHolderIndex,openTaskDetails:this.props.openTaskDetails,emptyColumnFocusElement:this.props.emptyColumnFocusElement,ref:e=>{null!=(null===e||void 0===e?void 0:e.getDecoratedComponentInstance())&&this._boardColumns.push({element:e.getDecoratedComponentInstance().columnElement,id:s})},fetchTaskPreview:this.props.fetchReferencePreviewForTask,currentUserId:this.props.currentUserId,disableColumnChanges:this.props.disableColumnChanges,getTaskPermissions:this.props.getTaskPermissions,bucketVirtualization:this.props.bucketVirtualization,isSlimView:this.props.isSlimView,canAddGuests:this.props.canAddGuests,theme:this.props.theme,canMoveTaskWithinSameColumn:e.canMoveTaskWithinSameColumn,enableAutoScrollOnDragItem:this.props.enableAutoScrollOnDragItem,isTeamsSplitUI:this.props.isTeamsSplitUI,fetchPermissionsWithTaskContext:this.props.fetchPermissionsWithTaskContext})}setTaskBoardEditMode(e){this.setState(t=>(0,c.A)((0,c.A)({},t),{},{interactionMode:e}))}renderCreateColumn(){if(this.props.columnCreationEnabled){const e=this.getClassNames();return z.createElement("li",{className:e.createColumn},z.createElement("div",{className:"columnContent","data-can-drag-to-scroll":"true"},z.createElement("div",{className:"columnHeader"},z.createElement("div",{className:"columnHeaderTitle"},z.createElement("h3",{className:"titleSection"},this.renderAddColumnControlArea())))))}return null}renderAddColumnControlArea(){if(this.props.disableColumnChanges)return null;const e=this.getClassNames();return this.state.showAddColumnControl?z.createElement("form",{onSubmit:this.createColumn.bind(this),autoComplete:"off",className:"editColumnTextField"},z.createElement(ra.A,{className:"active_1",autoFocus:!0,tabIndex:0,placeholder:this.props.createColumnPlaceholder,onKeyUp:this.onCreateColumnKeyUp.bind(this),onBlur:this.createColumn.bind(this),onChange:(e,t)=>{this.columnNameChanged(t)},ariaLabel:this.props.createColumnButtonText,value:this.state.newColumnName,maxLength:_c.f.TitleMaxLength,styleType:sa.u.Bucket,appTheme:this.props.theme})):z.createElement("button",{className:(0,Qe.A)("columnTitle",e.addColumnButton),onClick:this.toggleAddColumnControl.bind(this),ref:this.resolveRef(this,"addColumnButton"),title:Ie.p.Strings.TaskBoardColumn_AddNewBucket,"aria-label":Ie.p.Strings.TaskBoardColumn_AddNewBucket},z.createElement(xe.I,ot.D5),z.createElement("span",{className:"active_1"}," ",this.props.createColumnButtonText))}toggleAddColumnControl(){this.setState(e=>(0,c.A)((0,c.A)({},e),{},{showAddColumnControl:!e.showAddColumnControl,newColumnName:"",interactionMode:1}))}onCreateColumnKeyUp(e){Ye.a.getKey(e)===Le.D.ESCAPE&&this.dismissAddColumn()}createColumn(e){e.preventDefault(),""!==this.state.newColumnName&&null!=this.props.createColumnCallback&&this.props.createColumnCallback(this.state.newColumnName),this.dismissAddColumn()}dismissAddColumn(){null!=this.props.createColumnCallback&&(this.shouldSetFocus=!0),this.setState(e=>(0,c.A)((0,c.A)({},e),{},{showAddColumnControl:!1,newColumnName:"",interactionMode:1}))}columnNameChanged(e){this.setState(t=>(0,c.A)((0,c.A)({},t),{},{newColumnName:e}))}onReorderColumn(e,t){if(this.props.taskBoardCardCallbacks.getCurrentTaskGroupingState()!==p.Yc.Bucket)return;if(!this.props.callbacks.onColumnDrop)return;const o=this.props.columnDefinitions,n=un()(o,t=>t.pivotValue===e);if(-1===n)return;let r=null,s=null;t?(s=o[n+1]?o[n+1].pivotValue:null,r=o[n+2]?o[n+2].pivotValue:null):(s=o[n-2]?o[n-2].pivotValue:null,r=o[n-1]?o[n-1].pivotValue:null),null==r&&null==s||this.props.callbacks.onColumnDrop(e,s,r)}onDeleteColumn(e){kn.n.ChangeFocusBeforeRemovalIFocusable(this._boardColumns,this.addColumnButton,e),null!=this.props.deleteColumnCallback&&this.props.deleteColumnCallback(e)}getClassNames(){return Xc(Jc(this.props.theme,this.props.styles,this.props.displayMode,this.props.isSlimView,this.props.isTeamsSplitUI,le.B.isUnoContext))}constructor(e,t){super(e,t),this.shouldSetFocus=!1}}const tp=(0,ua.T)("column",ep.prototype.boardTarget(),ep.prototype.boardCollect)(ep);var op=o(15018),np=o(34717);const rp=Ue.B.userBubbleDiameter,sp="3px",ip="5px",ap="10px",lp=Ue.B.ShadowMargin,cp=(0,Q.J9)((e,t)=>{const o=Rt.d.isLoopTheme(e);let n=Pa,r="228px",s=Ue.B.PlannerBorderRadius;switch(e){case ce.Sx.LoopLight:case ce.Sx.LoopDark:n=va,r="200px",s=Ue.B.LoopBorderRadius;case ce.Sx.Light:case ce.Sx.Dark:case ce.Sx.TeamsLight:case ce.Sx.TeamsDark:case ce.Sx.TeamsContrast:case ce.Sx.SharePoint:}const i={root:[(0,Ne.gS)("column","nowrap"),(0,Ne.NX)(e),(0,Oe.kE)(),{position:"relative",width:n,marginTop:lp,borderRadius:s,".ms-Callout &":{marginTop:"0px"},".setFieldsSection":[(0,Ne.$Z)(),{padding:"0px ".concat("16px")}]},e!==ce.Sx.TeamsContrast&&{boxShadow:Ue.B.hoverShadow},e===ce.Sx.TeamsContrast&&{backgroundColor:Re.z.Black,border:"1px solid ".concat(Re.z.White),boxSizing:"border-box"}],titleSection:[(0,Ne.gS)("row"),(0,Ne.$Z)(),{marginTop:"16px",marginBottom:(0,ze.vb)((0,ze.jz)(ap)-(0,ze.jz)(sp)),"> .plannerIcon":[(0,Ne.$Z)("20px"),{marginRight:ap,color:Re.z.NeutralTertiary},e===ce.Sx.TeamsContrast&&{color:Re.z.White}]}],textField:[(0,Ne.$Z)(r),!o&&(0,Oe.kE)(),{".ms-Callout &":[(0,Ne.$Z)("192px")],".ms-TextField-fieldGroup":(0,Ne.nK)(e)}],property:[(0,Ne.gS)(),(0,Ne.$Z)(),(0,Ne.aS)(e),!o&&(0,Oe.kE)(),{alignItems:"center",padding:"".concat(sp," 0px ").concat(o?"0px":sp," 0px"),minHeight:rp,fontSize:Y.s.medium,"> .launcher":[Ne.xK,(0,Ne.gS)("row","nowrap"),(0,Ne.GD)(),{cursor:"pointer",alignItems:"center",width:"100%","> *":{margin:ip},"> i":[(0,Ne.$Z)("20px"),{marginLeft:"0"}],"> span, > div":[(0,Ne.GD)()]},o&&{":hover":[(0,Ne._D)(e),(0,Oe.cP)({borderRadius:"4px"}),{".plannerIcon > span":(0,Oe.h8)()}]}]}],addTaskButton:[(0,Ne.$Z)(o?"32px":"44px"),(0,Ne.jU)(e),o&&{width:"236px",alignSelf:"center",marginBottom:"10px"},{fontSize:Y.s.medium,color:Re.z.White,border:"none",marginTop:(0,ze.vb)((0,ze.jz)("14px")-(0,ze.jz)(sp)/2),borderRadius:o?Ue.B.LoopButtonBorderRadius:"0 0 ".concat(Ue.B.PlannerBorderRadius," ").concat(Ue.B.PlannerBorderRadius),"&:hover":[{cursor:"pointer"},o&&(0,Oe.cP)()]}]};return(0,Y.TW)(i,t)}),pp=(0,Q.J9)(e=>({root:(0,Y.Zq)("addTaskCard",e.root),titleSection:(0,Y.Zq)("titleSection",e.titleSection),textField:(0,Y.Zq)("addTaskTextField",e.textField),property:(0,Y.Zq)("property",e.property),addTaskButton:(0,Y.Zq)("addTaskButton",e.addTaskButton)})),dp=(0,Q.J9)(e=>{const t=Rt.d.isLoopTheme(e);return{root:[(0,Ne.GD)(),{width:"100%"},t&&{":hover":[(0,Oe.cP)({borderRadius:"4px"}),{".plannerIcon > span":(0,Oe.h8)()}]}],assigneeRow:[{"> .ms-Facepile-addButton i":{margin:"2px 10px 10px 0px"},"> .ms-Facepile":{margin:"6px 0px"}}],assignDiv:t&&{":hover":{"> .plannerIcon, .assignLabel":[(0,Ne._D)(e),(0,Oe.h8)()]}},addFriendIcon:{margin:"".concat(ip," 10px ").concat(ip," 0px")}}});var up=o(98352),hp=o(14740),gp=o.n(hp),mp=o(12759),Cp=o.n(mp),kp=o(97943);class bp extends pe.${name(){return"AddTaskCard"}renderComponent(){const e=this.getClassNames(),t=this.renderSetBucket(e),o=this.renderSetDueDate(e),n=this.renderAssignPicker(e);return z.createElement("div",{"aria-label":Ie.p.Strings.AddTaskCard_AddTaskFormAriaLabel,className:(0,Qe.A)(e.root,"walkthroughStep2"),ref:this.resolveRef(this,"addTaskCardElement"),onBlur:this.onAddTaskCardBlur,onClick:this.stopPropagation,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp},z.createElement("div",{className:"setFieldsSection"},this.renderTitleSection(e),!this.props.hideSetBucket&&t,!this.props.hideSetDueDate&&o,!this.props.hideSetAssignment&&n),z.createElement("button",{className:e.addTaskButton,onClick:this.createTask},Ie.p.Strings.AddTaskCard_AddTaskButtonText))}renderTitleSection(e){return z.createElement("div",{className:e.titleSection},z.createElement(xe.I,ot.vx),this.renderTextField(e.textField))}renderTextField(e){const t={className:e,autoFocus:this.props.autoFocus,tabIndex:0,placeholder:Ie.p.Strings.AddTaskCard_AddTaskPlaceholderText,onClick:this.stopPropagation,onKeyPress:this.createTask,onChange:(e,t)=>{this.taskNameChanged(t)},ariaLabel:Ie.p.Strings.AddTaskCard_TaskNameText,value:this.state.newTaskName,errorMessage:this.state.taskNameErrorMsg,styleType:sa.u.Dialog,maxLength:op.i.TitleMaxLength,appTheme:this.props.theme},o=(0,c.A)((0,c.A)({uniqueIdentifier:this.state.newTaskId},t),{},{styles:(0,up.pS)(t.appTheme,t.styleType),highlightStyle:(0,Ne.H)(t.appTheme),onDateChange:this.onSmartControlDateChange});return this.props.renderSmartTextField&&this.state.showSmartTextField?this.props.renderSmartTextField(o):z.createElement(ra.A,t)}renderSetBucket(e){if(0===this.props.buckets.length)return null;""===this.defaultBucketId&&(this.defaultBucketId=this.props.buckets[0].id);const t=[];let o=null;this.props.buckets.forEach(e=>{this.state.bucketId===e.id&&(o=e),t.push({key:e.id,name:e.title,checked:this.state.bucketId===e.id,onClick:this.setBucket})});const n=z.createElement($e.l,{shouldFocusOnMount:!0,items:t,directionalHint:Xe.A.bottomAutoEdge,target:this._bucketMenuElement,onDismiss:this.dismissBucketMenu,appTheme:this.props.theme}),r=null==o?Ie.p.Strings.AddTaskCard_BucketText:o.title;return z.createElement("div",{className:(0,Qe.A)("addTaskBucket",e.property)},z.createElement("button",{className:"launcher",ref:e=>this._bucketMenuElement=e,onClick:this.toggleBucketMenu,title:r,"aria-label":vt.G(Ie.p.Strings.AddTaskCard_BucketButtonAriaLabel,r)},z.createElement(xe.I,ot.fD),z.createElement("span",null,r)),this.state.isBucketMenuVisible?n:null)}renderSetDueDate(e){const t=null==this.state.dueDate?Ie.p.Strings.AddTaskCard_DueDateText:vt.G(Ie.p.Strings.AddTaskCard_DueDateValueText,ic.lz.FormatDate(Zi()(this.state.dueDate))),o=Hl(Ol(this.props.theme,this.props.styles)).callout;return z.createElement("div",{className:(0,Qe.A)("addTaskDueDate",e.property)},z.createElement("button",{className:"launcher",ref:e=>this._dueDateButtonElement=e,onClick:this.onDueDateClick,title:t},z.createElement(xe.I,ot.cx),z.createElement("span",null,t)),this.state.showCalendar&&z.createElement(Bt.P,{ariaLabel:Ie.p.Strings.TaskEditor_SelectEndDateAriaLabel,isBeakVisible:!1,className:(0,Qe.A)("ms-DatePicker-callout",o),gapSpace:0,doNotLayer:!1,role:"dialog",target:this._dueDateButtonElement,directionalHint:Xe.A.bottomLeftEdge,onDismiss:this.onDueDateCalendarDismiss,setInitialFocus:!0},z.createElement(wt.Y,{isClickableOutsideFocusTrap:!0},z.createElement(Rl.V,{onSelectDate:this.onSelectDueDate,onDismiss:this.onDueDateCalendarDismiss,isMonthPickerVisible:!1,value:null==this.state.dueDate?void 0:this.state.dueDate.toDate(),today:new Date,theme:this.props.theme}))))}renderAssignPicker(e){return z.createElement("div",{className:(0,Qe.A)("addTaskAssignee",e.property),ref:this.resolveRef(this,"addTaskAssignee")},this.renderAssignmentControl())}renderAssignmentControl(){var e;const t=gp()(Cn()(this.state.assignedToUserIds,e=>this.props.getUser(e)));return z.createElement(Ha.UI,{layout:Ha.Yn.Compact,assignees:t,currentUserId:this.props.currentUserId,canEditAssignments:!0,canEditAccessPermissions:this.props.canAddUser,canGiveAccessToGuests:this.props.canAddGuests,canAssignToResourcesWithoutAccess:this.props.canAddUser,canAccessPlanViaSharedContainerOnly:null!==(e=this.props.canAccessPlanViaSharedContainerOnly)&&void 0!==e&&e,minQueryTermLength:ce.c9.MinCharsNeededToSearch,maxAssignees:this.props.maxAssignees,maxDisplayablePersonas:ce.eg.MaxDisplayablePersonasAddTaskCard,addIconPlacement:Ha.aq.BeforeAssignees,strings:{assignControlIconTitle:Ie.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlLauncherText:Ie.p.Strings.TaskAssignmentControl_AssignControlLauncherText,assignControlAssignToMeButtonText:Ie.p.Strings.TaskAssignmentControl_AssignToMeLabel,readonlyFieldPermissionsTooltip:Ie.p.Strings.SharedComponents_ReadonlyFieldPermissionsTooltip,assignControlAriaLabelSuffix:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelSuffix,assignControlAriaLabelPrefix:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefix,assignControlAriaLabelPrefixNoAssignees:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelPrefixNoAssignees,assignControlListSeparator:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelListSeparator,assignControlAriaLabelConstruction:Ie.p.Strings.TaskAssignmentControl_AssignControlAriaLabelConstruction,assignmentFilterPlaceholderText:Ie.p.Strings.AssignmentPicker_AssignFilterPlaceholder,assignmentFilterAriaLabel:Ie.p.Strings.AssignmentPicker_AssignFilterPlaceholder,noResultsFoundText:Ie.p.Strings.AssignmentPicker_NoResultsFoundText,giveAccessTooltipText:Ie.p.Strings.AssignmentPicker_GiveAccessButtonAriaLabel,unassignUserButtonText:Ie.p.Strings.AssignmentPicker_UnassignUserButtonAriaLabel,assignedSectionHeader:Ie.p.Strings.AssignmentPicker_AssignedSectionHeader,queryLoadingText:Ie.p.Strings.AssignmentPicker_LoadingText,suggestedSectionHeader:Ie.p.Strings.AssignmentPicker_SuggestedSectionHeader,personaRoleGuest:Ie.p.Strings.AssignmentPicker_PersonaRoleGuest,personaRoleNonMember:Ie.p.Strings.AssignmentPicker_PersonaRoleNonMember,personaCompoundRole:Ie.p.Strings.AssignmentPicker_PersonaCompoundSubText,suggestedAssigneeMostAvailableUser:Ie.p.Strings.AssignmentPicker_SuggestedAssigneeMostAvailableUser,suggestedAssigneePlanTopAssignee:Ie.p.Strings.AssignmentPicker_SuggestedAssigneePlanTopAssignee,suggestedAssigneeSimilarTitle:Ie.p.Strings.AssignmentPicker_SuggestedAssigneeSimilarTitle,suggestedAssigneeUserTopAssignee:Ie.p.Strings.AssignmentPicker_SuggestedAssigneeUserTopAssignee},onRenderPersona:this.props.onRenderPersona,getUsersWithPlanAccess:()=>this.props.getAssigneePool()||[],getZeroTermQueryResults:this.getZeroTermQueryAssignmentResults,onAssignUser:this.onAssignUser,onUnassignUser:this.onUnassignUser,onGivePlanAccess:this.giveUserAccessToPlan,onOpenAssignCallout:this.onOpenAssignCallout,getSearchQueryResults:this.props.getUsersWithKeyword,getUserPhoto:this.props.getUserPhoto,showAssigneeLimitError:this.props.showAssigneeLimitError,alertUser:this.tenantSearchAlertUser,theme:this.props.theme,renderAssignToMeButton:this.props.enableSuggestedAssigneeUI,styles:dp(this.props.theme)})}alertUser(){this.props.alertUser("SharedComponents_AddTaskErrorToastTitle")}taskNameChanged(e){this.setState(t=>({newTaskName:e,taskNameErrorMsg:""!==e.trim()?"":t.taskNameErrorMsg}))}resetControl(){this.setState({newTaskId:Dc.o.generate(),newTaskName:"",taskNameErrorMsg:"",bucketId:this.defaultBucketId,showCalendar:!1,dueDate:this.props.defaultDueDate,assignedToUserIds:[],showSmartTextField:!0})}isFormDirty(){return null!=this.state.newTaskName&&""!==this.state.newTaskName.trim()||!gn()(this.state.dueDate,this.props.defaultDueDate)||!me()(this.state.assignedToUserIds)||this.state.bucketId!==this.defaultBucketId}getClassNames(){return pp(cp(this.props.theme,this.props.styles))}constructor(e,t){super(e,t),this.onAddTaskCardBlur=e=>{const t=e.relatedTarget||document.activeElement;(0,kp.s)(this.addTaskCardElement,t)||t.className.indexOf("addButton")>=0||t.className.indexOf("addTaskButton")>=0||this.isFormDirty()||this.props.toggleAddCard(e)},this.toggleBucketMenu=e=>{e.stopPropagation(),this.setState(e=>({isBucketMenuVisible:!e.isBucketMenuVisible}))},this.setBucket=(e,t)=>{e.stopPropagation(),this.setState({bucketId:t.key,isBucketMenuVisible:!1})},this.dismissBucketMenu=()=>{this.setState({isBucketMenuVisible:!1})},this.onDueDateClick=e=>{e.stopPropagation(),this.setState(e=>({showCalendar:!e.showCalendar}))},this.onDueDateCalendarDismiss=()=>{this.setState({showCalendar:!1})},this.onSelectDueDate=e=>{this.setState({showCalendar:!1,dueDate:null!=e?ic.lz.ToUTC10am(Zi()(e)):void 0,showSmartTextField:!1})},this.onSmartControlDateChange=e=>{this.setState({dueDate:e?ic.lz.ToUTC10am(Zi()(e)):this.props.defaultDueDate})},this.onOpenAssignCallout=()=>{this.props.onOpenAssignCallout(this.props.planId)},this.onAssignUser=(e,t,o)=>{const{onAssignNonMember:n,getAssigneePool:r}=this.props,s=r()||[];this.setState(r=>{if(-1===r.assignedToUserIds.indexOf(e)){const i=()=>{r.assignedToUserIds.push(e),null===o||void 0===o||o()};Jn()(s,t=>t.id===e)?i():null===n||void 0===n||n(e,this.state.newTaskId,t,i)}return r});const i=this.props.getUser(e),a=null!=i?i.displayName:"";this.props.alertUser("SharedComponents_AssignUserToastTitle",[a])},this.onUnassignUser=e=>{this.setState(t=>{const o=t.assignedToUserIds.indexOf(e);return-1!==o&&t.assignedToUserIds.splice(o,1),t});const t=this.props.getUser(e),o=null!=t?t.displayName:"";this.props.alertUser("SharedComponents_UnassignUserToastTitle",[o])},this.createTask=e=>{const{currentUserId:t,planId:o,createTask:n}=this.props;e.stopPropagation();if(Ye.a.getKey(e)===Le.D.ENTER||"click"===e.type){if(""===this.state.newTaskName.trim())return this.setState({taskNameErrorMsg:Ie.p.Strings.SharedComponents_AddTaskErrorToastTitle}),void this.alertUser();const r=Cp()(this.state.assignedToUserIds,(e,o)=>(e[o]=new mr.I(t,new Date),e),{});n(np.Y.builder.withPropertyBag({id:this.state.newTaskId,title:this.state.newTaskName,planId:o,percentComplete:(0,ao.BK)(co.$.NotStarted),bucketId:""!==this.state.bucketId?this.state.bucketId:null,dueDate:null==this.state.dueDate?void 0:Zi()(this.state.dueDate),assignments:r}).build()),this.resetControl(),this.props.closeOnKeyPress&&this.props.toggleAddCard(e)}},this.onKeyDown=e=>{const t=Ye.a.getKey(e);this._lastKeyDown=null==e?null:t},this.onKeyUp=e=>{Ye.a.getKey(e)===Le.D.ESCAPE&&this._lastKeyDown===Le.D.ESCAPE&&this.props.toggleAddCard(e),this._lastKeyDown=null},this.stopPropagation=e=>{e.stopPropagation()},this.getZeroTermQueryAssignmentResults=()=>this.props.getAssigneeSuggestions(this.props.planId,np.Y.builder.withPropertyBag({id:Dc.o.generate(),title:this.state.newTaskName,planId:this.props.planId}).build()),this.tenantSearchAlertUser=e=>{this.props.alertUser("SharedComponents_TenantUserSearchResultsToastTitle",[e.toString()])},this.giveUserAccessToPlan=e=>{this.props.addUserToContainer(e,this.props.planId)},this.defaultBucketId="",0!==this.props.buckets.length&&(this.defaultBucketId=this.props.buckets[0].id),this.state={newTaskId:Dc.o.generate(),newTaskName:"",taskNameErrorMsg:"",bucketId:this.defaultBucketId,isBucketMenuVisible:!1,showCalendar:!1,dueDate:e.defaultDueDate,assignedToUserIds:[],showSmartTextField:!0}}}const Tp=(0,Q.J9)((e,t)=>{const o={main:[{position:"relative",backgroundColor:Re.z.ThemePrimary,boxSizing:"border-box",padding:"20px",width:"340px"},e===ce.Sx.Light&&{color:Re.z.White},e===ce.Sx.Dark&&{color:Re.z.NeutralLight}],header:{fontSize:Y.s.large},title:[e===ce.Sx.Light&&{color:Re.z.White},e===ce.Sx.Dark&&{color:Re.z.NeutralLight}],subText:[{fontSize:Y.s.medium,margin:"".concat("16px"," 0")},e===ce.Sx.Light&&{color:Re.z.White},e===ce.Sx.Dark&&{color:Re.z.NeutralLight}],actions:[(0,Ne.gS)(),{alignItems:"center"}],left:(0,Ne.GD)(),detail:{fontSize:Y.s.xSmall},right:[(0,Ne.$Z)(),{"> .nextButton":[(0,Ne.$Z)(),e===ce.Sx.Light&&{backgroundColor:Re.z.White,color:Re.z.ThemePrimary},e===ce.Sx.Dark&&{color:Re.z.NeutralLight}]}]};return(0,Y.TW)(o,t)}),Sp=(0,Q.J9)((e,t)=>{const o=Tp(e,t);return{main:(0,Y.Zq)("walkthroughStep_main",o.main),header:(0,Y.Zq)("header",o.header),title:(0,Y.Zq)("title",o.title),subText:(0,Y.Zq)("subText",o.subText),actions:(0,Y.Zq)("actions",o.actions),left:(0,Y.Zq)("left",o.left),detail:(0,Y.Zq)("detail",o.detail),right:(0,Y.Zq)("right",o.right)}}),Pp={border:"none",backgroundColor:Re.z.ThemePrimary,boxShadow:"0px 0px 15px -5px rgba(0, 0, 0, 0.4)"},vp={root:Pp,beak:Pp},xp=(0,Q.J9)(e=>({root:[{position:"absolute",right:"0",top:"0"},e===ce.Sx.Light&&{color:Re.z.White},e===ce.Sx.Dark&&{color:Re.z.NeutralLight}]}));class yp extends pe.${name(){return"WalkthroughStep"}renderComponent(){const e=this.getClassNames(),t=z.createElement(fr.K,{className:(0,Qe.A)("ms-TeachingBubble-closebutton","closeButton"),iconProps:ot.s5,title:Ie.p.Strings.WalkthroughStep_Walkthrough_CloseButtonText,ariaLabel:Ie.p.Strings.WalkthroughStep_Walkthrough_CloseButtonText,onClick:this.onSkipButtonDown.bind(this),styles:xp(this.props.theme)});return z.createElement(Bt.P,{className:"walkthroughStep",target:this.props.target,gapSpace:this.props.gapSpace||0,directionalHint:this.props.direction||Xe.A.bottomCenter,doNotLayer:null==this.props.doNotLayer||this.props.doNotLayer,setInitialFocus:!0,styles:vp},z.createElement("div",{className:e.main,tabIndex:0,"aria-label":vt.G(Ie.p.Strings.WalkthroughStep_Walkthrough_CombinedTextAriaLabel,this.props.detail,this.props.title,this.props.subtitle)},z.createElement("div",{className:e.header},z.createElement("div",{className:e.title},this.props.title)),t,z.createElement("div",{className:"inner"},z.createElement("div",{className:"content"},z.createElement("div",{className:e.subText},this.props.subtitle)),z.createElement("div",{className:e.actions},z.createElement("div",{className:e.left},z.createElement("div",{className:e.detail},this.props.detail)),z.createElement("div",{className:e.right},this.props.showNextButton&&this.props.onNextClicked&&z.createElement(q.j,{className:"nextButton",onClick:this.props.onNextClicked.bind(this)},this.getNextButtonText()))))))}onSkipButtonDown(e){Ye.a.isButtonPress(e)&&this.props.onSkipClicked&&this.props.onSkipClicked()}getNextButtonText(){return this.props.isLastStep?Ie.p.Strings.WalkthroughStep_Walkthrough_FinishButtonText:Ie.p.Strings.WalkthroughStep_Walkthrough_NextButtonText}getClassNames(){const{theme:e,styles:t}=this.props;return Sp(e,t)}constructor(e,t){super(e,t)}}class fp extends Cr.M{name(){return g.M.PlannerWalkthrough}async fetchCriticalData(e,t){if(!this.fetchCriticalDataWhenComponentDidUpdate(e,t))return;let o=null;if(0!==e.tasks.length||e.currentUserDetails.getDidActiveWalkthrough()){if(0!==e.tasks.length&&!e.currentUserDetails.getDidPassiveWalkthrough()){if(!e.isFirstRunExperience||!e.isSessionFromTaskLink){(await this.props.actionCreatorProviders.walkthroughActionCreator()).startWalkthrough(ce.hs.Passive),o=e.currentUserDetails.setFirstRunExperienceDataProperty("didPassiveWalkthrough",!0)}}}else{(await this.props.actionCreatorProviders.walkthroughActionCreator()).startWalkthrough(ce.hs.Active),o=e.currentUserDetails.setFirstRunExperienceDataProperty("didActiveWalkthrough",!0).setFirstRunExperienceDataProperty("didPassiveWalkthrough",!0)}if(null!=o){(await this.props.actionCreatorProviders.userActionCreator()).updateUserDetails(e.currentUserDetails,o)}}fetchNonCriticalData(e,t){}renderComponent(){const e=this.getWalkthroughStepDetail();return null==e?null:z.createElement(yp,e)}getWalkthroughStepDetail(){if(this.props.walkthroughStore.getCurrentWalkthroughMode()===ce._9.Walkthrough){const e=this.props.walkthroughStore.getCurrentWalkthroughStepIndex();return null==e?null:this.getWalkthroughStep(this.props.walkthroughStore.getCurrentWalkthroughType(),e)}return null}checkForCriticalDataReady(){return!0}fetchCriticalDataWhenComponentDidUpdate(e,t){return null==this.props.walkthroughStore.getCurrentWalkthroughStepIndex()&&null!=this.props.currentUser&&null!=this.props.currentUserDetails&&null!=this.props.tasks&&null!=this.props.buckets&&0!==this.props.buckets.length&&null!=this.props.users&&0===this.props.currentUser.totalTasksCreated}async onNextClicked(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).showNextStep()}async onSkipClicked(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).skipWalkthrough(this.props.walkthroughStore.getCurrentWalkthroughType(),this.props.walkthroughStore.getCurrentWalkthroughStepIndex())}async onCompletion(){(await this.props.actionCreatorProviders.walkthroughActionCreator()).completeWalkthrough(this.props.walkthroughStore.getCurrentWalkthroughType())}getWalkthroughStep(e,t){if(e===ce.hs.Active)switch(t){case 0:return{target:".active_0",title:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step0_Title,subtitle:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step0_Subtitle,detail:this.getDescriptionText(1,4),direction:Xe.A.rightTopEdge,onSkipClicked:this.onSkipClicked.bind(this),gapSpace:30,theme:this.props.theme};case 1:return{target:".active_1",title:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step1_Title,subtitle:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step1_Subtitle,detail:this.getDescriptionText(2,4),direction:Xe.A.bottomLeftEdge,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 2:return{target:".active_2",title:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step2_Title,subtitle:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step2_Subtitle,detail:this.getDescriptionText(3,4),direction:Xe.A.bottomLeftEdge,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 3:return{target:".active_3",title:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step3_Title,subtitle:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Active_Step3_Subtitle,detail:this.getDescriptionText(4,4),direction:Xe.A.rightCenter,isLastStep:!0,onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};default:return null}else{if(e!==ce.hs.Passive)throw new Error("NotImplementedException: Unknown WalkthroughType requested");switch(t){case 0:return{target:".passive_0",title:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step0_Title,subtitle:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step0_Subtitle,detail:this.getDescriptionText(1,3),direction:Xe.A.rightCenter,showNextButton:!0,onNextClicked:this.onNextClicked.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 1:return{target:".passive_1",title:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step1_Title,subtitle:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step1_Subtitle,detail:this.getDescriptionText(2,3),direction:Xe.A.bottomLeftEdge,showNextButton:!0,onNextClicked:this.onNextClicked.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};case 2:return{target:".passive_2",title:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step2_Title,subtitle:Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_Passive_Step2_Subtitle,detail:this.getDescriptionText(3,3),direction:Xe.A.rightCenter,isLastStep:!0,showNextButton:!0,onNextClicked:this.onCompletion.bind(this),onSkipClicked:this.onSkipClicked.bind(this),theme:this.props.theme};default:return null}}}getDescriptionText(e,t){return vt.G(Ie.p.Strings.PlanTaskBoardWalkthrough_Walkthrough_StepDescription,e.toString(),t.toString())}constructor(e,t){super(e,t),this.state={}}}var Ap=o(25246);const wp="calc(100% - ".concat((0,ze.vb)((0,ze.jz)(Ue.B.TopHeaderHeight)+(0,ze.jz)(Ue.B.TopHeaderPaddingTop)+(0,ze.jz)(Ue.B.TopHeaderPaddingBottom)),")"),Dp="calc(100% - ".concat((0,ze.vb)((0,ze.jz)(Ue.B.TopHeaderHeight)+(0,ze.jz)(Ue.B.SharepointContentTopPadding)),")"),Bp="calc(100% - ".concat((0,ze.vb)((0,ze.jz)(Ue.B.TeamsTopHeaderHeight)+(0,ze.jz)(Ue.B.TopHeaderPaddingTop)+(0,ze.jz)(Ue.B.TeamsTopHeaderMargin)),")"),Ep=(0,Q.J9)((e,t,o,n)=>{const r=yi(e,o),s={root:[(0,Ne.gS)("column","nowrap"),e!==ce.Sx.SharePoint&&(0,Ne.GD)(),e===ce.Sx.SharePoint&&{minHeight:"800px"}],taskBoardViewLandmark:[(0,Ne.GD)("0px"),(0,Ne.gS)("column","nowrap"),t&&e===ce.Sx.TeamsLight&&{background:Ue.B.HeaderlessTeamsBackgroundColor},o&&{marginLeft:"16px"}]};return(0,Y.pB)(void 0,r,s,n)}),Ip=(0,Q.J9)(e=>(0,c.A)((0,c.A)({},Ai(e)),{},{root:(0,Y.Zq)("planTaskBoardPage",e.root),taskBoardViewLandmark:(0,Y.Zq)("taskBoardViewLandmark",e.taskBoardViewLandmark)})),Fp=(0,Q.J9)((e,t)=>({root:{position:"relative",width:"100%",height:e===ce.Sx.SharePoint?Dp:wp,".teamsApp &":{height:t?"100%":Bp}},columnsList:{}}));var Lp=o(74065),Mp=o.n(Lp),Np=(o(87424),o(9376),o(7670));function Rp(e,t,o,n,r,s,i){if(!e||!t)return[];const a=[],l=Hi()(o,"id");return(0,Np.Fy)(e,t,l,r).forEach(e=>{var t,o;const r=null!=e.pivotValue?null!==(t=l[e.pivotValue])&&void 0!==t?t:s(e.pivotValue):null,c=e,p=null==r&&null!=e.pivotValue;var d;c.canEditTitle=!1,c.isCollapsable=n,c.isCollapsed=!1,c.title=r?r.formattedDisplayName:null!=e.pivotValue?(d=e.pivotValue,(0,js.W_)(d)?Ie.p.Strings.AssignmentPicker_PersonaRoleNonMember:Ie.p.Strings.PlannerApp_FormerUserName):Ie.p.Strings.PlannerApp_UnassignedText,c.disableAddTask=p,c.disableDragInto=p,c.headerImage=i&&r&&null!==(o=i(r))&&void 0!==o?o:void 0,c.canMoveTaskWithinSameColumn=!0,a.push(c)}),a}function Up(e,t,o,n,r,s,i,a){if(!e||!t||!o)return[];const l=[],c=a?(0,Np.wA)(e,t,o):(0,Np.M1)(e,t,o);if(1===c.length){if(null!=c[0].dataEntities&&0===c[0].dataEntities.length)return[];if(null==o)return[]}return null===i||void 0===i||i(c),c.forEach((e,t)=>{const i=e;if(null==e.pivotValue)i.canDeleteColumn=n,i.canEditTitle=!1,i.canMoveColumnLeft=!1,i.canMoveColumnRight=!1,i.title=Ie.p.Strings.Bucket_NullBucketLabel,i.headerImage=r();else{const r=Jn()(o,t=>t.id===e.pivotValue);null!=r&&(i.canDeleteColumn=n,i.canEditTitle=!!s,i.canMoveColumnLeft=1!==t,i.canMoveColumnRight=t!==c.length-1,i.title=r.title,i.onUpdateTitle=s?e=>{s(r,e)}:void 0)}i.isCollapsed=!1,i.isCollapsable=!n,i.canMoveTaskWithinSameColumn=!0,(null!=i.pivotValue||null!=i.dataEntities&&0!==i.dataEntities.length)&&l.push(i)}),l}function Op(e,t,o,n,r,s){if(!t||!o)return[];const i=[];return(r!==Bi.t.Plan&&null!=s?(0,Np.PG)(t,n,s):(0,Np.py)(t,o,n)).forEach(t=>{if(null==t.pivotValue)return void e.logTrace(507778442,E.k.Warning,"Null progress group pivot value");const o=t;o.canEditTitle=!1,o.isCollapsable=!n,o.isCollapsed=!1,o.title=np.Y.getProgressTitle(t.pivotValue),o.canMoveTaskWithinSameColumn=!0,i.push(o)}),i}function Hp(e,t,o,n,r,s){if(!e)return[];const i=[];return(0,Np.Qc)(e,o).forEach(e=>{const a=e,l=e.pivotValue;if(a.canDeleteColumn=!1,a.canEditTitle=null!=l&&!!r,a.canMoveColumnLeft=!1,a.canMoveColumnRight=!1,a.isCollapsable=!n,a.isCollapsed=!1,null==l)a.title=Ie.p.Strings.Labels_UnlabeledText;else{const e=o[l];a.title=null!=e&&""!==e?e:oo.U.getLabelPlaceholderByIndex(l)}a.disableCustomOrderCards=!0,a.onUpdateTitle=r&&null!=l?e=>r(l,t,e):void 0,a.headerImage=s&&null!=l?s(l):void 0,a.canMoveTaskWithinSameColumn=!1,i.push(a)}),i}function Vp(e,t){const o=[];return(0,Np.GU)(e).forEach(e=>{const n=e;n.canEditTitle=!1,n.canDeleteColumn=!1,n.canMoveColumnRight=!1,n.canMoveColumnLeft=!1,n.title=function(e){switch(e){case p.Tt.Future:return Ie.p.Strings.PlannerApp_FutureDueDateText;case p.Tt.Late:return Ie.p.Strings.PlannerApp_LateDueDateText;case p.Tt.NextWeek:return Ie.p.Strings.PlannerApp_NextWeekDueDateText;case p.Tt.NoDate:return Ie.p.Strings.PlannerApp_NoDateDueDateText;case p.Tt.ThisWeek:return Ie.p.Strings.PlannerApp_ThisWeekDueDateText;case p.Tt.Today:return Ie.p.Strings.PlannerApp_TodayDueDateText;case p.Tt.Tomorrow:return Ie.p.Strings.PlannerApp_TomorrowDueDateText;default:return""}}(n.pivotValue),n.isCollapsable=t,n.isCollapsed=!1,n.disableCustomOrderCards=!0,n.findPlaceHolderIndex=Np.fS,n.canMoveTaskWithinSameColumn=!1,o.push(n)}),o}function Gp(e,t){const o=[];return(0,Np.K5)(e).forEach(e=>{const n=e;n.canEditTitle=!1,n.canDeleteColumn=!1,n.canMoveColumnRight=!1,n.canMoveColumnLeft=!1,n.title=np.Y.getPriorityText(n.pivotValue),n.isCollapsable=t,n.isCollapsed=!1,n.disableCustomOrderCards=!0,n.findPlaceHolderIndex=Np.pU,n.canMoveTaskWithinSameColumn=!1,o.push(n)}),o}class Wp extends $i{name(){return d.EC.PlanTaskboard}setupCallbacks(){super.setupCallbacks(),this.taskBoardCallbacks={getCurrentTaskGroupingState:()=>this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),getTaskBucket:e=>null!=e?this.props.bucketStore.getBucket(e):null,getTaskDetails:e=>null!=e?this.props.taskStore.getTaskDetails(e):null,getTaskGroupId:e=>null!=e?this.props.planStore.getContainerIdForPlan(e):null,getTaskPlan:e=>null!=e?this.props.planStore.getPlan(e):null,getTaskPlanDetails:e=>null!=e?this.props.planStore.getPlanDetails(e):null,getTaskPlanLabelUsageCounts:e=>this.props.aggregatesStore.getLabelUsageCountsForPlan(e),getTaskHighlightedType:this.getTaskHighlightedType,onDeleteTask:this.onDeleteTask,showAssigneeLimitError:this.onShowAssigneeLimitError,taskCallbacks:(0,c.A)({isTaskOnMyDay:this.props.isTaskOnMyDay,toggleMyDayForTask:this.props.toggleMyDayForTask},this.taskCardCallbacks)}}getViewClassNames(){return Ip(this.getViewStyles())}getViewStyles(){return Ep(this.props.appContextStore.getCurrentTheme(),le.B.headerlessMode,le.B.isUnoContext,this.props.styles)}isAddTaskCardShowing(){return!0}generateColumnAddTaskPivotValue(){var e,t;const{viewPartitionKey:o,loggers:n}=this.props,r=this.props.planStore.getPlan(o);if(null==r)return;const s=null==this.state?void 0:this.state.columnAddTaskPivotValue;if(void 0!==s)return s;const i=this.getTaskData();if(!this.checkForCriticalViewDataReady())return;if(0!==i.length)return null;const a=null!==(e=this.getTaskboardTaskFormatData())&&void 0!==e?e:[];let l=[];const c=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext);switch(c){case p.Yc.Bucket:l=Up(i,Hi()(a,"id"),this.props.bucketStore.getBucketsForPlan(o),!0,this.renderUncategorizedBucketHeaderImage);break;case p.Yc.Progress:l=Op(n.traceLogger,i,Hi()(a,"id"),!0,this.taskAccessContext);break;case p.Yc.Assignee:l=Rp(i,Hi()(a,"id"),this.getContainerMembers(r.container.externalId),!1,this.props.appContextStore.getCurrentUserId(),this.taskCardCallbacks.getUser,this.renderAssigneeHeaderImage);break;case p.Yc.Category:const e=this.props.planStore.getPlanDetails(o);l=Hp(i,o,null!==(t=null===e||void 0===e?void 0:e.categories)&&void 0!==t?t:[],!0,this.onUpdateCategoryTitle);break;case p.Yc.DueDate:l=Vp(i,!1);break;case p.Yc.Priority:l=Gp(i,!1);break;case p.Yc.None:case p.Yc.Plan:break;default:return void Qi.f.unreachableCase(c,e=>{n.traceLogger.logTrace(508060124,E.k.Error,e)})}if(0!==l.length&&(0!==i.length||le.B.clientType!==h.s.Webpart)){if(this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext)===p.Yc.Bucket){let e=0;for(;null==l[e].pivotValue;)e++;return this.props.bucketStore.getBucketStatus(l[e].pivotValue)!==Ap.v.Created?void 0:l[e].pivotValue}var d;return null===l[0].pivotValue?"null":null===(d=l[0].pivotValue)||void 0===d?void 0:d.toString()}}renderComponent(){const{viewPartitionKey:e,appContextStore:t}=this.props,o=le.B.clientType!==h.s.Plex||le.B.isUnoContext?null:this.renderWalkthrough(),n=this.getThemedPageStyles(e);return z.createElement(z.Fragment,null,z.createElement("div",{className:(0,Qe.A)(this.getViewClassNames().root),style:n},this.renderMessageBar(),this.renderViewCommandBar(),this.renderPartitionedView(t.getCurrentTheme()),o))}componentDidUpdate(e,t){super.componentDidUpdate(e,t);const{viewPartitionKey:o}=this.props;e.viewPartitionKey!==o&&(this.loggedUnbucketedTasks=!1,this.setState({columnAddTaskPivotValue:void 0}))}componentDidMount(){super.componentDidMount(),this.logUsage(g.M.PlanTaskBoard_Navigated);const{loggers:e}=this.props;le.B.clientType!==h.s.Plex&&le.B.clientType!==h.s.Teams||Se.q.logFloodgateActivity(g.M.LoadTaskBoard,e.traceLogger)}storeDidUpdate(){if(super.storeDidUpdate(),void 0===this.state.columnAddTaskPivotValue){const e=this.generateColumnAddTaskPivotValue();void 0!==e&&this.setState(t=>(0,c.A)((0,c.A)({},t),{},{columnAddTaskPivotValue:e}))}}renderPlanView(){return this.renderTaskBoard()}renderTaskBoard(){var e,t;const{flights:o,viewPartitionKey:n,loggers:r}=this.props,s=this.props.planStore.getPlan(n);if(null==s)return null;const i=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),a=this.getTaskData(),l=this.getTaskboardTaskFormatData(),c=Hi()(l,"id"),d=this.props.viewStore.getCurrentTaskFilter(this.getViewKey()),g=this.props.viewStore.getFilterExceptions(),m=a.filter(e=>np.Y.ApplyEntityFilter(e,d,g));let C;this.isAddTaskCardShowing()&&(C=this.generateAddCardControlProvider());const k={valueSetter:(e,t,o,n,r)=>{},secondaryClassifier:e=>!1,secondaryValueSetter:(e,t)=>{},secondarySectionTitleProvider:e=>Ie.p.Strings.PlannerApp_CompletedSectionText,onColumnDrop:async(e,t,o)=>{let n=null,r=null,s=null;if(null!=e&&i===p.Yc.Bucket){if(n=this.props.bucketStore.getBucket(e),null!=t&&(r=this.props.bucketStore.getBucket(t)),null!=o&&(s=this.props.bucketStore.getBucket(o)),null==n)return;const i=n.setProperty("orderHint",ji.O.generateOrderHintBetween(s?s.orderHint:null,r?r.orderHint:null));(await this.props.actionCreatorProviders.bucketActionCreator()).updateBucket(n,i)}},addCardControlProvider:C};let b,T=[],S=!1,P=!1,v=!1,x="",y="";const f=s?this.props.permissionsStore.getPlanPermissions(s):this.props.permissionsStore.getDefaultPlanPermissions();switch(i){case p.Yc.Bucket:P=!0,T=Up(m,c,this.props.bucketStore.getBucketsForPlan(n),!0,this.renderUncategorizedBucketHeaderImage,this.onUpdateBucketTitle,this.logUnbucketedTasksCount),S=!0,k.valueSetter=(e,t,o,n,r)=>this.bucketBoardValueSetter(c,e,t,o,n,r),k.secondaryClassifier=this.completedTaskClassifier,k.secondaryValueSetter=this.completedSectionValueSetter,v=f.canAddBuckets,b=async e=>{let t=null;const o=Mp()(T);if(o){const e=this.props.bucketStore.getBucketsForPlan(n),r=Jn()(e,e=>e.id===o.pivotValue);t=r?r.orderHint:null}const r=_c.f.builder.withPropertyBag({id:"",title:e,planId:n,orderHint:ji.O.generateOrderHintBetween(null,t)}).withLocallyUniqueId().build();(await this.props.actionCreatorProviders.bucketActionCreator()).createBucket(r)},y=Ie.p.Strings.PlannerApp_AddBucket,x=Ie.p.Strings.PlannerApp_AddBucketPlaceHolder;break;case p.Yc.Progress:T=Op(r.traceLogger,m,c,!0,this.taskAccessContext),S=!1,k.valueSetter=(e,t,o,n,r)=>this.progressBoardValueSetter(c,e,t,o,n,r);break;case p.Yc.Assignee:T=Rp(m,c,this.getContainerMembers(s.container.externalId),!1,this.props.appContextStore.getCurrentUserId(),this.taskCardCallbacks.getUser,this.renderAssigneeHeaderImage),S=!0,k.valueSetter=(e,t,o,n,r)=>this.assignedToBoardValueSetter(c,e,t,o,n,r),k.secondaryClassifier=this.completedTaskClassifier,k.secondaryValueSetter=this.completedSectionValueSetter;break;case p.Yc.Category:const o=null!==(e=null===(t=this.props.planStore.getPlanDetails(n))||void 0===t?void 0:t.categories)&&void 0!==e?e:[];T=Hp(m,n,o,!0,this.onUpdateCategoryTitle,this.renderCategoryHeaderImage),S=!0,k.valueSetter=this.categoryBoardValueSetter,k.secondaryClassifier=this.completedTaskClassifier,k.secondaryValueSetter=this.completedSectionValueSetter;break;case p.Yc.DueDate:T=Vp(m,!1),S=!0,k.valueSetter=this.dueDateBoardValueSetter,k.secondaryClassifier=this.completedTaskClassifier,k.secondaryValueSetter=this.completedSectionValueSetter;break;case p.Yc.Priority:T=Gp(m,!1),S=!0,k.valueSetter=this.priorityBoardValueSetter,k.secondaryClassifier=this.completedTaskClassifier,k.secondaryValueSetter=this.completedSectionValueSetter;break;case p.Yc.None:case p.Yc.Plan:break;default:Qi.f.unreachableCase(i,e=>{this.props.loggers.traceLogger.logTrace(508060123,E.k.Error,e)})}const A=n,w=this.props.appContextStore.getClientFlavor(),D=this.props.appContextStore.getCurrentTheme();return z.createElement(Ra.Provider,{value:this.getViewContext()},z.createElement(Bn.H,{className:this.getViewClassNames().taskBoardViewLandmark,role:"main"},z.createElement(tp,{autoFocus:le.B.clientType!==h.s.Webpart&&this.props.autoFocus&&!this.state.isFilterMenuVisible,key:A,displayMode:ea.Board,columnCreationEnabled:v,createColumnCallback:b,createColumnButtonText:y,createColumnPlaceholder:x,columnDefinitions:T,modifiedTaskIds:this.props.wywaStore.getModifiedTaskIds(),deleteColumnCallback:i===p.Yc.Bucket?this.onDeleteBucket:void 0,enableColumnMove:P,useSecondaryClassification:S,maxAssignees:le.B.clientSettings.MaxTaskAssignees,callbacks:k,taskBoardCardCallbacks:this.taskBoardCallbacks,toggleAddTaskFormVisibility:this.onToggleAddTaskFormVisibility,onOpenAddTaskCardFromAddTaskButton:this.onOpenAddTaskCardFromAddTaskButton,onCloseAddTaskCard:this.onCloseAddTaskCard,showAddEntityCardCallback:this.showAddEntityCardCallback,showPlanTitleOnCard:!1,showCopyLinkToTask:this.props.showCopyLinkToTask,openTaskDetails:this.onOpenTaskDetailsEditor,fetchReferencePreviewForTask:this.fetchReferencePreviewForTask,currentUserId:this.props.appContextStore.getCurrentUserId(),disableColumnChanges:!f.canEdit,getTaskPermissions:this.getTaskPermissions,bucketVirtualization:o.BucketVirtualization,isSlimView:this.props.isSlimView,canAddGuests:this.props.permissionsStore.getUserPermissions().canAddGuests,enableAutoScrollOnDragItem:o.EnableImprovedDragScroll,theme:D,enableDragToScroll:!0,isTeamsSplitUI:this.props.appContextStore.getFlights().EnableTeamsSplitUI&&(w===u.g.TeamsPersonalApp||w===u.g.TeamsTab),fetchPermissionsWithTaskContext:this.fetchPermissionsWithTaskContext,styles:Fp(D,le.B.headerlessMode)})))}renderWalkthrough(){var e,t;const{viewPartitionKey:o,planStore:n}=this.props,r=n.getPlan(o);return null==r?null:z.createElement(fp,{buckets:null!==(e=this.props.bucketStore.getBucketsForPlan(o))&&void 0!==e?e:[],tasks:null!==(t=this.props.taskStore.getTasksForPlan(o))&&void 0!==t?t:[],users:this.getContainerMembers(r.container.externalId),currentUser:this.props.userStore.getCurrentUser(),currentUserDetails:this.props.userStore.getCurrentUserDetails(),dispatcherEventManagement:this.props.dispatcherEventManagement,walkthroughStore:this.props.walkthroughStore,actionCreatorProviders:this.props.actionCreatorProviders,isFirstRunExperience:this.props.isFirstRunExperience,isSessionFromTaskLink:this.props.isSessionFromTaskLink,theme:this.props.appContextStore.getCurrentTheme()})}constructor(e,t){super(e,t),this.generateAddCardControlProvider=()=>(e,t,o,n,r)=>{var s;const i=this.props.planStore.getPlan(this.props.viewPartitionKey);if(null==i)return null;const a=this.props.viewStore.getCurrentTaskGroupingState(this.taskAccessContext),l=i.container.externalId,c=this.canUserAddMembers(i),u=this.canUserAccessPlanViaSharedContainerOnly(i.id),g=c||u,m=null!==(s=this.props.bucketStore.getBucketsForPlan(this.props.viewPartitionKey))&&void 0!==s?s:[];return m.sort(Xt.k),z.createElement(bp,{autoFocus:!!this.state.isAddTaskCardOpenedFromAddTaskButton||this.props.appContextStore.getLastRouteChangeSource()!==d.jf.LeftNav&&le.B.clientType!==h.s.Webpart&&!this.state.isFilterMenuVisible,createTask:n=>{this.onCreateTask(n,e,t,o)},planId:this.props.viewPartitionKey,toggleAddCard:r,closeOnKeyPress:!1,canAddUser:c,canAccessPlanViaSharedContainerOnly:u,buckets:m,defaultDueDate:void 0,hideSetAssignment:a===p.Yc.Assignee,hideSetBucket:a===p.Yc.Bucket,hideSetDueDate:a===p.Yc.DueDate,getUser:this.taskCardCallbacks.getUser,getUserPhoto:this.taskCardCallbacks.getUserPhoto,getUsersWithKeyword:g?this.taskCardCallbacks.getUsersWithKeyword:void 0,getAssigneePool:l?this.getContainerMembers.bind(this,l):()=>[],maxAssignees:le.B.clientSettings.MaxTaskAssignees,showAssigneeLimitError:this.onShowAssigneeLimitError,currentUserId:this.props.appContextStore.getCurrentUserId(),onRenderPersona:this.onRenderPersona,alertUser:this.alertUser,onOpenAssignCallout:this.onOpenAssignCallout,enableSuggestedAssigneeUI:this.props.flights.EnableSuggestedAssignee,addUserToContainer:this.onAddUserToContainer,canAddGuests:this.props.permissionsStore.getUserPermissions().canAddGuests,theme:this.props.appContextStore.getCurrentTheme(),getAssigneeSuggestions:this.onGetAssigneeSuggestion,onAssignNonMember:this.onAssignTask,renderSmartTextField:this.props.renderSmartTextField})},this.renderCategoryHeaderImage=e=>z.createElement(eo.l,{index:e,isCollapsed:!1,title:"",showBorder:!0,theme:this.props.appContextStore.getCurrentTheme()}),this.renderAssigneeHeaderImage=e=>null==e?null:z.createElement(Nt.f,{user:e,onLoad:this.onRenderPersona,containerId:"userContainer-assigneeHeader-".concat(e.id)},z.createElement(Lt.F,{id:e.id,imageUrl:this.props.userStore.getUserPhotoById(e.id)||void 0,size:Mt.WH.size32,hidePersonaDetails:!0})),this.onToggleAddTaskFormVisibility=e=>{this.state.columnAddTaskPivotValue===e||null==e?this.setState(e=>(0,c.A)((0,c.A)({},e),{},{columnAddTaskPivotValue:null})):this.setState(t=>(0,c.A)((0,c.A)({},t),{},{columnAddTaskPivotValue:e}))},this.onOpenAddTaskCardFromAddTaskButton=async()=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_AddNewTaskButtonExpanded"),this.setState({isAddTaskCardOpenedFromAddTaskButton:!0})},this.onCloseAddTaskCard=async()=>{(await this.props.actionCreatorProviders.notificationActionCreator()).enqueueHiddenToast("SharedComponents_AddNewTaskButtonCollapsed"),this.setState({isAddTaskCardOpenedFromAddTaskButton:!1})},this.onUpdateBucketTitle=async(e,t)=>{const o=e.setProperty("title",t);(await this.props.actionCreatorProviders.bucketActionCreator()).updateBucket(e,o)},this.onUpdateCategoryTitle=async(e,t,o)=>{const n=this.props.planStore.getPlanDetails(t);if(!n||n.categories[e]===o)return;const r=n.categories.slice();r[e]=o;const s=n.setProperty("categories",r);(await this.props.actionCreatorProviders.planActionCreator()).updatePlanDetails(n,s)},this.logUnbucketedTasksCount=e=>{this.loggedUnbucketedTasks||null==e[0]||null==e[0].dataEntities||(this.props.loggers.usageLogger.logData(this.name(),"Unbucketed Tasks Count",{planId:this.props.viewPartitionKey,numTasks:String(e[0].dataEntities.length)}),this.loggedUnbucketedTasks=!0)},this.showAddEntityCardCallback=e=>this.state.columnAddTaskPivotValue===e,this.setupCallbacks(),this.state={highlightField:p.JS.None,highlightValue:void 0,columnAddTaskPivotValue:this.generateColumnAddTaskPivotValue(),isCardChangingCompletedSection:!1,isFilterMenuVisible:!1,isAddTaskCardOpenedFromAddTaskButton:!1}}}},17961:(e,t,o)=>{var n=o(8760)();e.exports=n},22867:(e,t,o)=>{var n=o(26600),r=n&&new n;e.exports=r},27530:e=>{e.exports={}},48991:(e,t,o)=>{var n=o(80523),r=o(52990),s=o(2112),i=o(54052),a=o(22761),l=o(79360),c=Object.prototype.hasOwnProperty;function p(e){if(a(e)&&!i(e)&&!(e instanceof n)){if(e instanceof r)return e;if(c.call(e,"__wrapped__"))return l(e)}return new r(e)}p.prototype=s.prototype,p.prototype.constructor=p,e.exports=p},52990:(e,t,o)=>{var n=o(21817),r=o(2112);function s(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}s.prototype=n(r.prototype),s.prototype.constructor=s,e.exports=s},54555:(e,t,o)=>{"use strict";o.d(t,{G:()=>x});var n=o(65804),r=o(56851),s=o(65043),i=o(89379),a=o(17066),l=o(27480),c=o(40440),p=o(56420),d=o(15199),u=o(13706),h=o(20751),g="SearchBox",m={root:{height:"auto"},icon:{fontSize:"12px"}},C={iconName:"Clear"},k={ariaLabel:"Clear text"},b=(0,i.Z)(),T=s.forwardRef(function(e,t){var o=e.ariaLabel,n=e.className,i=e.defaultValue,T=void 0===i?"":i,S=e.disabled,P=e.underlined,v=e.styles,x=e.labelText,y=e.placeholder,f=void 0===y?x:y,A=e.theme,w=e.clearButtonProps,D=void 0===w?k:w,B=e.disableAnimation,E=void 0!==B&&B,I=e.showIcon,F=void 0!==I&&I,L=e.onClear,M=e.onBlur,N=e.onEscape,R=e.onSearch,U=e.onKeyDown,O=e.iconProps,H=e.role,V=e.onChange,G=e.onChanged,W=s.useState(!1),_=W[0],z=W[1],Z=s.useRef(),K=(0,c.k)(e.value,T,function(e,t){e&&e.timeStamp===Z.current||(Z.current=null===e||void 0===e?void 0:e.timeStamp,null===V||void 0===V||V(e,t),null===G||void 0===G||G(t))}),q=K[0],j=K[1],Q=String(q),Y=s.useRef(null),J=s.useRef(null),X=(0,p.a)(Y,t),$=(0,d.B)(g,e.id),ee=D.onClick,te=b(v,{theme:A,className:n,underlined:P,hasFocus:_,disabled:S,hasInput:Q.length>0,disableAnimation:E,showIcon:F}),oe=(0,a.G1)(e,a.QQ,["className","placeholder","onFocus","onBlur","value","role"]),ne=s.useCallback(function(e){var t;null===L||void 0===L||L(e),e.defaultPrevented||(j(""),null===(t=J.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault())},[L,j]),re=s.useCallback(function(e){null===ee||void 0===ee||ee(e),e.defaultPrevented||ne(e)},[ee,ne]),se=s.useCallback(function(e){z(!1),null===M||void 0===M||M(e)},[M]),ie=function(e){j(e.target.value,e)};return function(e,t,o){s.useImperativeHandle(e,function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()},blur:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.blur()},hasFocus:function(){return o}}},[t,o])}(e.componentRef,J,_),s.createElement("div",{role:H,ref:X,className:te.root,onFocusCapture:function(t){var o;z(!0),null===(o=e.onFocus)||void 0===o||o.call(e,t)}},s.createElement("div",{className:te.iconContainer,onClick:function(){J.current&&(J.current.focus(),J.current.selectionStart=J.current.selectionEnd=0)},"aria-hidden":!0},s.createElement(h.I,(0,r.__assign)({iconName:"Search"},O,{className:te.icon}))),s.createElement("input",(0,r.__assign)({},oe,{id:$,className:te.field,placeholder:f,onChange:ie,onInput:ie,onBlur:se,onKeyDown:function(e){switch(e.which){case l.c.escape:null===N||void 0===N||N(e),Q&&!e.defaultPrevented&&ne(e);break;case l.c.enter:R&&(R(Q),e.preventDefault(),e.stopPropagation());break;default:null===U||void 0===U||U(e),e.defaultPrevented&&e.stopPropagation()}},value:Q,disabled:S,role:"searchbox","aria-label":o,ref:J})),Q.length>0&&s.createElement("div",{className:te.clearButton},s.createElement(u.K,(0,r.__assign)({onBlur:se,styles:m,iconProps:C},D,{onClick:re}))))});T.displayName=g;var S=o(52195),P=o(50605),v={root:"ms-SearchBox",iconContainer:"ms-SearchBox-iconContainer",icon:"ms-SearchBox-icon",clearButton:"ms-SearchBox-clearButton",field:"ms-SearchBox-field"};var x=(0,n.I)(T,function(e){var t,o,n,r,s,i=e.theme,a=e.underlined,l=e.disabled,c=e.hasFocus,p=e.className,d=e.hasInput,u=e.disableAnimation,h=e.showIcon,g=i.palette,m=i.fonts,C=i.semanticColors,k=i.effects,b=(0,S.Km)(v,i),T={color:C.inputPlaceholderText,opacity:1},x=g.neutralSecondary,y=g.neutralPrimary,f=g.neutralLighter,A=g.neutralLighter,w=g.neutralLighter;return{root:[b.root,m.medium,S.S8,{color:C.inputText,backgroundColor:C.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",borderRadius:k.roundedCorner2,border:"1px solid ".concat(C.inputBorder),height:32,selectors:(t={},t[S.up]={borderColor:"WindowText"},t[":hover"]={borderColor:C.inputBorderHovered,selectors:(o={},o[S.up]={borderColor:"Highlight"},o)},t[":hover .".concat(b.iconContainer)]={color:C.inputIconHovered},t)},!c&&d&&{selectors:(n={},n[":hover .".concat(b.iconContainer)]={width:4},n[":hover .".concat(b.icon)]={opacity:0,pointerEvents:"none"},n)},c&&["is-active",{position:"relative"},(0,S.Sq)(C.inputFocusBorderAlt,a?0:k.roundedCorner2,a?"borderBottom":"border")],h&&[{selectors:(r={},r[":hover .".concat(b.iconContainer)]={width:32},r[":hover .".concat(b.icon)]={opacity:1},r)}],l&&["is-disabled",{borderColor:f,backgroundColor:w,pointerEvents:"none",cursor:"default",selectors:(s={},s[S.up]={borderColor:"GrayText"},s)}],a&&["is-underlined",{borderWidth:"0 0 1px 0",borderRadius:0,padding:"1px 0 1px 8px"}],a&&l&&{backgroundColor:"transparent"},d&&"can-clear",p],iconContainer:[b.iconContainer,{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:C.inputIcon,cursor:"text"},c&&{width:4},l&&{color:C.inputIconDisabled},!u&&{transition:"width ".concat(S.cs.durationValue1)},h&&c&&{width:32}],icon:[b.icon,{opacity:1},c&&{opacity:0,pointerEvents:"none"},!u&&{transition:"opacity ".concat(S.cs.durationValue1," 0s")},h&&c&&{opacity:1}],clearButton:[b.clearButton,{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:0,margin:"-1px 0px",selectors:{"&:hover .ms-Button":{backgroundColor:A},"&:hover .ms-Button-icon":{color:y},".ms-Button":{borderRadius:(0,P.jI)(i)?"1px 0 0 1px":"0 1px 1px 0"},".ms-Button-icon":{color:x}}}],field:[b.field,S.S8,(0,S.CX)(T),{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:C.inputText,flex:"1 1 0px",minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"}}},l&&{color:C.disabledText}]}},void 0,{scope:"SearchBox"})},60911:(e,t,o)=>{var n=o(27530),r=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",o=n[t],s=r.call(n,t)?o.length:0;s--;){var i=o[s],a=i.func;if(null==a||a==e)return i.name}return t}},62264:(e,t,o)=>{"use strict";o.d(t,{g:()=>u});var n=o(65043),r=o(16112),s=o(66783),i=o(52195),a=o(66151),l=o(56415);const c="34px",p=(0,s.J9)(e=>({root:[(0,a.q0)("ellipsis"),(0,a.aS)(e),{height:c,cursor:"default","> button":[a.xK,(0,a.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:"2px solid ".concat(l.z.ThemeSecondary)}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:i.BO.semibold,lineHeight:c,margin:"auto"}}]})),d=(0,s.J9)(e=>({root:(0,i.Zq)("primaryTextSection",e.root)}));class u extends r.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:o}=this.props,r=this.getClassNames();return n.createElement("div",{className:r.root,title:e},null!=t?n.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":o,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},n.createElement("span",null,e)):n.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return d(p(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=n.createRef(),this.onTitleClick=()=>{var e,t,o;null===(e=(t=this.props).onClickTitleButton)||void 0===e||e.call(t,null!==(o=this.titleButtonRef.current)&&void 0!==o?o:void 0)}}}},77711:(e,t,o)=>{"use strict";o.d(t,{$:()=>i});var n=o(65043),r=o(16112),s=o(91900);class i extends r.${renderComponent(){const{children:e,planContainerId:t,onRender:o}=this.props;return t?n.createElement(s.n,{containerId:t,onLoad:o},e):n.createElement(n.Fragment,null,e)}constructor(e,t){super(e,t),this.name=()=>"PlanPhotoContainer"}}},79360:(e,t,o)=>{var n=o(80523),r=o(52990),s=o(91980);e.exports=function(e){if(e instanceof n)return e.clone();var t=new r(e.__wrapped__,e.__chain__);return t.__actions__=s(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},80523:(e,t,o)=>{var n=o(21817),r=o(2112);function s(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}s.prototype=n(r.prototype),s.prototype.constructor=s,e.exports=s},88218:(e,t,o)=>{var n=o(22867),r=o(75713),s=n?function(e){return n.get(e)}:r;e.exports=s},90402:(e,t,o)=>{var n=o(80523),r=o(88218),s=o(60911),i=o(48991);e.exports=function(e){var t=s(e),o=i[t];if("function"!=typeof o||!(t in n.prototype))return!1;if(e===o)return!0;var a=r(o);return!!a&&e===a[0]}},91900:(e,t,o)=>{"use strict";o.d(t,{n:()=>p});var n=o(65043),r=o(16112),s=o(22317),i=o(66783),a=o(52195);const l=(0,i.J9)(()=>({anchor:{minHeight:"1px"}})),c=(0,i.J9)(e=>({anchor:(0,a.Zq)("virtualContainer-anchor",e.anchor)}));class p extends r.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return n.createElement(n.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return n.createElement("div",{className:"virtualContainer-wrapper"},n.createElement(s.pL,{onChange:this.handleInView,triggerOnce:!0},n.createElement("div",{className:e.anchor})))}getClassNames(){return c(l())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}},94283:(e,t,o)=>{"use strict";o.d(t,{k:()=>d});var n=o(55491),r=o.n(n),s=o(54320),i=o.n(s),a=o(91246);class l{build(){return new d(this)}fromSensitivityLabelResource(e){var t;const o=null===(t=e.sublabels)||void 0===t?void 0:t.map(e=>(new l).fromSensitivityLabelResource(e));return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:e.groupAllowGuestUsers,groupPrivacy:e.groupPrivacy,sublabels:o})}fromGraphResource(e){var t;const o=null===(t=e.sublabels)||void 0===t?void 0:t.map(e=>(new l).fromGraphResource(e));let n=this.groupAllowGuestUsers,r=this.groupPrivacy;const s=e.labelActions;if(s&&!i()(s))for(const i of s)if("protectGroup"===i.name){var a,c;n=null!==(a=i.allowGuestUsers)&&void 0!==a&&a,r=null!==(c=i.privacy)&&void 0!==c?c:this.groupPrivacy;break}return this.withPropertyBag({id:e.id,name:e.name,displayName:e.displayName,description:e.description,toolTip:e.toolTip,isDefault:e.isDefault,priority:e.priority,groupAllowGuestUsers:n,groupPrivacy:r,sublabels:o})}withPropertyBag(e){var t,o;return this.id=e.id||this.id,this.name=e.name||this.name,this.displayName=e.displayName||this.displayName,this.description=e.description||this.description,this.toolTip=e.toolTip||this.toolTip,this.isDefault=null!==(t=e.isDefault)&&void 0!==t?t:this.isDefault,this.priority=e.priority||this.priority,this.groupAllowGuestUsers=null!==(o=e.groupAllowGuestUsers)&&void 0!==o?o:this.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy||this.groupPrivacy,this.sublabels=e.sublabels||this.sublabels,this}withValidData(){return this.withPropertyBag({id:a.o.generate()})}constructor(){this.id="",this.name="",this.displayName="",this.description="",this.toolTip="",this.isDefault=!1,this.priority=0,this.groupAllowGuestUsers=!0,this.groupPrivacy="",this.sublabels=null}}var c=o(21382),p=o(86053);class d{static get builder(){return new l}static getDefaultSensitivityLabel(e){if(i()(e))return null;let t=null;return r()(e,e=>{if(e.isDefault?t=e:null!=e.sublabels&&r()(e.sublabels,e=>{if(e.isDefault)return t=e,!1}),null!=t)return!1}),t}static getSensitivityLabel(e,t){if(i()(e)||i()(t))return null;let o=null;return r()(t,t=>{if(t.id===e?o=t:null!=t.sublabels&&r()(t.sublabels,t=>{if(t.id===e)return o=t,!1}),null!=o)return!1}),o}static getParentSensitivityLabel(e,t){if(i()(e)||i()(t))return null;let o=null;return r()(t,t=>{if(null!=t.sublabels&&r()(t.sublabels,n=>{if(n.id===e)return o=t,!1}),null!=o)return!1}),o}static getFullSensitivityTitle(e,t){var o;if(i()(e)||i()(t))return"";const n=d.getSensitivityLabel(e,t),r=d.getParentSensitivityLabel(e,t);return n&&r?c.G(p.p.Strings.SensitivityLabel_FullTitle,r.displayName,n.displayName):null!==(o=null===n||void 0===n?void 0:n.displayName)&&void 0!==o?o:""}constructor(e){this.id=e.id,this.name=e.name,this.displayName=e.displayName,this.description=e.description,this.toolTip=e.toolTip,this.isDefault=e.isDefault,this.priority=e.priority,this.groupAllowGuestUsers=e.groupAllowGuestUsers,this.groupPrivacy=e.groupPrivacy,this.sublabels=null,null!=e.sublabels&&(this.sublabels=[],e.sublabels.forEach(e=>{this.sublabels.push(new d(e))}))}}},96426:(e,t,o)=>{"use strict";o.d(t,{p:()=>p});var n=o(56851),r=o(65043),s=o(11638),i=o(47507),a=o(64819),l=o(52195),c=(0,o(66783).J9)(function(e,t){return(0,l.TW)({root:[(0,l.gm)(e,{inset:1,highContrastStyle:{outlineOffset:"-4px",outline:"1px solid Window"},borderColor:"transparent"}),{height:24}]},t)}),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,o=e.theme;return r.createElement(s.Y,(0,n.__assign)({},this.props,{styles:c(o,t),onRenderDescription:i.K}))},t=(0,n.__decorate)([(0,a.T)("MessageBarButton",["theme","styles"],!0)],t)}(r.Component)}}]);
//# sourceMappingURL=plantaskboardpage.38336c42.chunk.js.map