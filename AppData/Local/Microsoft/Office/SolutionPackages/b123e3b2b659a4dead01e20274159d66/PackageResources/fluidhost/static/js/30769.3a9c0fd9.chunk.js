"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[30769],{30769:(t,e,o)=>{o.r(e),o.d(e,{CdnCodeLoaderFactory:()=>u,LoopRegistrationId:()=>n.J});var n=o(38314);function r(t){return new Promise(e=>setTimeout(()=>e(),t))}function i(t,e,o){return s(t,[],e,o)}function s(t,e,o,n){let i;const a=[t(e.length).then(t=>(i=t,!1))];return n&&n.timeoutMs>0&&a.push(r(n.timeoutMs).then(()=>!0)),Promise.race(a).then(a=>(a&&(i=null===n||void 0===n?void 0:n.onTimeout()),!o||!o.filter(i)||e.length>=o.maxRetries?{result:i,tries:e}:r(o.backoffFn(e.length)).then(()=>(e.push(i),s(t,e,o,n)))))}async function a(t,e,o){return new Promise((n,r)=>{var i,s;const a=t.document,c=a.createElement("script"),d=null!==(i=null===o||void 0===o||null===(s=o.trustedTypesPolicy)||void 0===s?void 0:s.createScriptURL(e,{allowedScriptOrigins:o.allowedOrigins}))&&void 0!==i?i:e;c.src=d,c.async=!1,c.charset="utf-8",c.crossOrigin="anonymous",c.onload=n,c.onerror=()=>r(new Error("Failed to download the script at url: ".concat(e,", isUserOnline: ").concat(t.navigator.onLine))),a.head.appendChild(c)})}var c=o(51238);class d{constructor(t){this.audience=t.audience,this.windowContext=t.windowContext,this.trustedTypesPolicy=t.trustedTypesPolicy}canLoad(t){return t.packageName===n.J}async load(t){if(!this.canLoad(t))throw new Error("Incompatible loop code details.");const e=await this.determineCdnUrl(),o=this.trustedTypesPolicy&&{trustedTypesPolicy:await this.trustedTypesPolicy,allowedOrigins:["https://cdn.forms.office.net"]};await((t,e,o)=>{let n=3;return function r(){return a(t,e,o).catch(()=>(n-=1,0===n?a(t,e,o):r()))}()})(this.windowContext,e,o);const r=this.windowContext[n.J];if(!r)throw new Error("Could not fetch loop module from the window object.");return{module:r,details:t}}async determineCdnUrl(){const t=this.getTargetEnvironment(),e="https://cdn.forms.office.net/forms/loop/formsCodeLoaderDetails-".concat(t,".json?r=").concat((0,c.A)()),o=await function(t,e,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return i(()=>{const o=performance.now();return fetch(t,e).then(t=>{const e=t;return e.durationMs=Math.round(performance.now()-o),e}).catch(t=>({status:window.navigator.onLine?710:709,ok:!1,durationMs:Math.round(performance.now()-o)}))},o,{timeoutMs:n,onTimeout:()=>({status:707,ok:!1,durationMs:n})})}(e,{method:"GET"},{maxRetries:3,filter:(r=[500,599],t=>t&&r.includes(t.status)),backoffFn:(n=500,t=>n)});var n,r;if(!o.result.ok||200!==o.result.status)throw new Error("Failed to fetch ".concat(e));return(await o.result.json()).codeLoaderFile}getTargetEnvironment(){switch(this.audience){case"Automation":case"SyntheticTraffic":case"Local":case"Staging":return"staging";case"Dogfood":return"df";case"Microsoft":return"msft";default:return"prod"}}}const u={instantiateLoopCodeLoader:t=>Promise.resolve(new d(t))}}}]);
//# sourceMappingURL=30769.3a9c0fd9.chunk.js.map