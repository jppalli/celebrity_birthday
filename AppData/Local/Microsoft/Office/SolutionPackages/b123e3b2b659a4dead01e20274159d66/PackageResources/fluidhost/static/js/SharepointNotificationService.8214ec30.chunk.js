"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[33884],{10600:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(27106);function o(e){return function(){return new i(e.apply(this,arguments))}}function i(e){var t,n;function o(t,n){try{var s=e[t](n),a=s.value,c=a instanceof r.A;Promise.resolve(c?a.v:a).then(function(n){if(c){var r="return"===t?"return":"next";if(!a.k||n.done)return o(r,n);n=e[r](n).value}i(s.done?"return":"normal",n)},function(e){o("throw",e)})}catch(e){i("throw",e)}}function i(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?o(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise(function(i,s){var a={key:e,arg:r,resolve:i,reject:s,next:null};n?n=n.next=a:(t=n=a,o(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)}},19495:(e,t,n)=>{function r(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new o(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function o(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return o=function(e){this.s=e,this.n=e.next},o.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new o(e)}n.d(t,{A:()=>r})},27106:(e,t,n)=>{function r(e,t){this.v=e,this.k=t}n.d(t,{A:()=>r})},30946:(e,t,n)=>{function r(e){const t=btoa(e);return t.replace(/(\+|\/|\=)/g,e=>{if("+"===e)return"-";if("/"===e)return"_";if("="===e)return"";throw new TypeError("Unexpected match ".concat(e," encountered in urlEncodeBase64String. Only +/= are to be replaced."))})}n.d(t,{A7:()=>i,x7:()=>s});var o=n(60835);async function i(e,t,n){const{siteUrl:r,driveId:i,fileId:a}=t,c=await(0,o.sN)(e,r,i,a,n);if(!c)throw new Error("Failed to fetch file sharepoint ids");return s(c,a)}function s(e,t){const{siteId:n,webId:o,listId:i}=e;return"SPO_".concat(r("".concat(n,",").concat(o,",").concat(i)),"_").concat(t)}},55138:(e,t,n)=>{n.r(t),n.d(t,{SharepointNotificationService:()=>Do});var r=n(27051),o=n(51238),i=n(47373),s=n(33788),a=n(60835),c=n(48680);const u="writeToJsonObject",d="writeToFacetJsonObject",l="processJsonObject";function p(e){return null!==e&&"undefined"!==typeof e}function f(e,t){return(t|=0)<e.Min?e.Min:t>e.Max?e.Max:t}function v(e,t,n){return p(t)?Array.isArray(t)?V(t,n,(t,n)=>v(e,t,n)):f(e,t):null}v.bind(null,{Min:-128,Max:127}),v.bind(null,{Min:0,Max:255}),v.bind(null,{Min:-32768,Max:32767});const h={Min:0,Max:65535},m=(v.bind(null,h),v.bind(null,{Min:-2147483648,Max:2147483647})),I=v.bind(null,{Min:0,Max:4294967295}),y={Min:Number.MIN_SAFE_INTEGER,Max:Number.MAX_SAFE_INTEGER},C=(v.bind(null,y),{Min:0,Max:Number.MAX_SAFE_INTEGER});v.bind(null,C);const g=function(e,t){return p(e)?Array.isArray(e)?V(e,t,g):e:null},A=function(e,t){return p(e)?Array.isArray(e)?V(e,t,A):p(e)&&""!==e?e:null:null},P=function(e,t){return p(e)?Array.isArray(e)?V(e,t,P):A(e.toISOString(),t):null},S=new Date(0);class w{constructor(e){this.value=e}static createNew(){return new w("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}toString(){return this.value}valueOf(){return this.toString().toLowerCase()}}w.Empty=new w("00000000-0000-0000-0000-000000000000");const T=function(e,t){return p(e)?Array.isArray(e)?V(e,t,T):e!==w.Empty?A(e.toString(),t):null:null},x=w.Empty;function N(e){return function(e){return null!==e&&["number","string","boolean","object"].indexOf(typeof e)>=0}(e)&&!Array.isArray(e)}function b(e){return null!==e&&"object"===typeof e&&!Array.isArray(e)}function R(e){if(b(e)){const t={};for(const n in e)t[n]=R(e[n]);return t}if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;++n){let r=e[n];N(r)&&t.push(r)}return t}return e}const k=function(e,t){return p(e)?Array.isArray(e)?V(e,t,k):R(e):null};class O{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.Major=e,this.Minor=t,this.Build=n,this.Revision=r}toString(){let e=this.Major+"."+this.Minor;return(this.Build>0||this.Revision>0)&&(e+="."+this.Build,this.Revision>0&&(e+="."+this.Revision)),e}valueOf(){function e(e){return(e>>12&15).toString(16)+(e>>8&15).toString(16)+(e>>4&15).toString(16)+(15&e).toString(16)}return e(this.Major)+e(this.Minor)+e(this.Build)+e(this.Revision)}}const D=function(e,t){return p(e)?Array.isArray(e)?V(e,t,D):A(e.toString(),t):null};new O;function E(e){const t=[];for(let n=0;n<e;++n)t.push(n);return t}function M(e){const t=[];for(let n=0;n<e;++n)t.push(1<<n);return t}function U(e){return Object.keys(e).sort((t,n)=>e[t]-e[n])}function L(e){return Object.keys(e).filter(e=>"None"!==e).sort((t,n)=>e[t]-e[n])}function F(e,t,n,r){if(!p(e))return null;if(Array.isArray(e))return V(e,r,(e,r)=>F(e,t,n,r));if(8&r)return I(e,r);const o=Math.min(t.length,n.length);for(let i=0;i<o;++i)if(t[i]===e)return A(n[i],r);return A(e.toString(),r)}function j(e,t,n,r){if(!p(e))return null;if(Array.isArray(e))return V(e,r,(e,r)=>j(e,t,n,r));if(8&r)return I(e,r);const o=[],i=Math.min(t.length,n.length);for(let s=0;s<i;++s){const r=t[s];if(e&r&&(o.push(n[s]),(e&=~r)<1))break}return e>0&&o.push(e.toString()),o.length<1?A("None",r):A(o.join(","),r)}function B(e,t){return e&t}function V(e,t,n){if(!p(e)||e.length<1)return null;const r=[];for(const o of e){const e=n(o,t);p(e)&&!Array.isArray(e)&&r.push(e)}return r}const _=function(e){return 16777215&(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)|(255&e)<<24|4},W=function(e){return(-16777216&e)>>24};function J(e,t){try{return t(e)}finally{e.exit()}}class G{constructor(){this.artifacts=new Map,this.parent=G.current,G.current=this}static getOrCreateArtifact(e,t){for(let r=G.current;r;r=r.parent){const e=r.artifacts.get(t);if(e)return e}const n=e();return p(G.current)&&G.current.artifacts.set(t,n),n}exit(){G.current=this.parent}}G.current=null;const H=Symbol();function K(){return{SettingProvider:{getSetting:(e,t)=>t}}}function q(){return G.getOrCreateArtifact(K,H)}const z=function(e,t){return p(e)?Array.isArray(e)?V(e,t,z):e.toJsonValue(t):null},X=function(e,t,n){return p(e)?Array.isArray(e)?V(e,t,(e,t)=>X(e,t,n)):(1&t||4&t||e.TypeName!=n||(t|=1),e.toJsonValue(t)):null};function Q(e,t,n,r){if(p(n))for(const o of n){let t=e[o];b(t)||(e[o]=t={}),e=t}p(r)&&(e[t]=r)}class Y{update(e){}toJsonValue(e){const t=function(e,t){return 1&t||4&t?{}:2&t?{__metadata:{type:e}}:{__type:e}}(this.TypeName,e);return this[l](t,e,this[u],this[d]),t}toFacetJsonValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.toJsonValue(_(e,t))}toJson(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return JSON.stringify(this.toJsonValue(e))}toFacetJson(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.toJson(_(e,t))}[u](e,t){}[d](e,t){}[l](e,t,n,r){J(new G,()=>{4&t?r.call(this,e,t):n.call(this,e,t)})}}class $ extends Y{constructor(){super(...arguments),this.TypeClassification=2}}class Z{static convertTo(e,t){return pe(t)}}class ee{static getOrCreate(){return G.getOrCreateArtifact(ee.create,ee.artifactId)}static getPersonIndex(e){return p(e)?ee.findPerson(e):null}static addPerson(e){if(p(e)){let o=ee.findAndUpdatePerson(e);p(o)||(o=new pn,ee.updatePerson(o,e),ee.getOrCreate().push(o));for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const e of n)p(o.Roles)?o.Roles.indexOf(e)<0&&o.Roles.push(e):o.Roles=[e]}}static addPeople(e){if(p(e)){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const t of e)ee.addPerson(t,...n)}}static create(){return[]}static findAndUpdatePerson(e){const t=ee.findPerson(e);if(t>=0){const n=ee.getOrCreate()[t];return ee.updatePerson(n,e),n}return null}static findPerson(e){const t=ee.getOrCreate();for(var n=0;n<t.length;++n){const r=t[n];if(p(r.Provider)&&""!==r.Provider){if(r.Provider===e.Provider&&r.Id===e.Id)return n;if(p(e.Provider)&&""!==e.Provider)continue}if(p(r.Email)&&""!==r.Email){if(r.Email===e.Email)return n;if(p(e.Email)&&""!==e.Email)continue}if(p(r.Name)&&""!==r.Name&&r.Name===e.Name)return n}return-1}static updatePerson(e,t){p(e.Provider)&&""!==e.Provider||(e.Provider=t.Provider,e.Id=t.Id),p(e.Email)&&""!==e.Email||(e.Email=t.Email),p(e.Name)&&""!==e.Name||(e.Name=t.Name)}}ee.artifactId=Symbol();class te{static convertToArray(e,t){const n=ee.getOrCreate();return t instanceof tr?(ee.addPerson(t.Creator,"Creator","InThread"),ee.addPeople(t.AnchorCreators,"AnchorCreator"),ee.addPerson(t.ParentAuthor,"RepliedTo","InThread"),ee.addPeople(t.Participants,"InThread"),ee.addPerson(t.TaskCreator,"TaskCreator"),ee.addPeople(t.TaskAssignees,"ExistingAssignee"),te.processCommentPreview(t.Preview),n):t instanceof er?(ee.addPerson(t.Creator,"Creator"),ee.addPeople(t.AnchorCreators,"AnchorCreator"),ee.addPerson(t.TaskCreator,"TaskCreator"),ee.addPeople(t.TaskAssignees,"ExistingAssignee"),te.processCommentPreview(t.Preview),n):t instanceof Zn?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.Mentionee,"Mentioned"),ee.addPerson(t.TaskCreator,"TaskCreator"),ee.addPeople(t.TaskAssignees,"ExistingAssignee"),te.processCommentPreview(t.CommentPreview),n):t instanceof Wn?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.Mentionee,"Mentioned"),n):t instanceof rr?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.CommentThreadCreator,"CommentThreadCreator"),ee.addPeople(t.Assignees,"NewAssignee"),te.processCommentPreview(t.CommentPreview),n):t instanceof ir?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.TaskCreator,"TaskCreator"),ee.addPeople(t.Assignees,"ExistingAssignee"),ee.addPeople(t.NewAssignees,"NewAssignee"),te.processCommentPreview(t.CommentPreview),n):t instanceof or?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.TaskCreator,"TaskCreator"),ee.addPeople(t.Assignees,"ExistingAssignee"),te.processCommentPreview(t.CommentPreview),n):t instanceof sr?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.TaskCreator,"TaskCreator"),ee.addPeople(t.Assignees,"Assignee"),ee.addPeople(t.PreviousAssignees,"PreviousAssignee"),n):t instanceof ar?(ee.addPerson(t.Creator,"Creator"),n):t instanceof ur?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.CommentCreator,"CommentCreator"),ee.addPerson(t.LatestReactor,"LatestReactor"),n):t instanceof lr?(ee.addPerson(t.Creator,"Creator"),ee.addPeople(t.Mentionees,"Mentioned"),ee.addPeople(t.PreviousMentionees,"PreviousMentionee"),n):t instanceof dr?(ee.addPerson(t.Creator,"Creator"),ee.addPerson(t.LatestReactor,"LatestReactor"),ee.addPeople(t.TargetActors,"TargetActor"),n):t instanceof pr?(ee.addPerson(t.Creator,"Creator"),ee.addPeople(t.Actors,"Actor"),n):t instanceof fr?(ee.addPerson(t.Creator,"Creator"),n):t instanceof vr?(ee.addPerson(t.Creator,"Creator"),ee.addPeople(t.Recipients,"Recipient"),te.processPersonStateInfo(t.ContentStateInfo),n):n}static processCommentPreview(e){if(p(e))if(te.processPreviewFragment(e.Anchor,"AnchorCreator"),e instanceof $n){if(te.processPreviewFragment(e.Comment,"CommentCreator","InThread"),te.processPreviewFragment(e.RootComment,"RepliedTo","InThread"),p(e.RecentComments))for(const t of e.RecentComments)te.processPreviewFragment(t,"InThread")}else te.processPreviewFragment(e.Comment,"CommentCreator")}static processPreviewFragment(e){if(p(e)){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ee.addPerson(e.Creator,...n)}}static processPersonStateInfo(e){e instanceof gr&&p(e)&&ee.addPeople(e.Person,"RuleTrigger")}}class ne{static convertToOptional(e,t){return!!de(t)||t.NotifiedInBand}}class re{static convertTo(e,t){if(t instanceof Gn&&p(t.Data)){const e="Office"+pe(t.Data);return t.Data instanceof _n?e+bn(t.Data.Action,0):e}return pe(t)}}class oe{static convertTo(e,t){return t instanceof Gn&&p(t.Data)&&p(t.Data.SourceAppId)?t.Data.SourceAppId.toString():p(t.SourceAppId)?t.SourceAppId.toString():"3d9f2b8c-fab8-4011-a098-2652bdd0b55d"}}class ie{static convertTo(e,t){switch(t.SourcePlatform){case Tn.Win32:case Tn.WinRT:case Tn.Windows:return In.Windows;case Tn.Android:return In.Android;case Tn.Mac:return In.MacOS;case Tn.iOS:return In.iOS;case Tn.Linux:return In.Linux;case Tn.tvOS:return In.tvOS;default:return In.Unknown}}}class se{static convertTo(e,t){var n;if(!p(t)||!p(t.Creator)||!p(t.Creator.RawId)&&t.Creator.RawIdKind!=On.Self)return null;const r=new Cn,o=t.Creator.RawProvider==Rn.LiveId,i=null!==(n=t.Creator.RawId)&&void 0!==n?n:"";return r.IdKind=o?fn.MSA:fn.AAD,r.TenantId=t.Creator.TenantId,p(t.Creator.RawIdKind)?t.Creator.RawIdKind==On.OID?r.Id=o?"OID:"+i:i:t.Creator.RawIdKind==On.PUID?r.Id=o?i:"PUID:"+i:t.Creator.RawIdKind==On.CID?r.Id="CID:"+i:r.Id="Self":r.Id=o?"CID:"+i:i,r}}class ae{static convertTo(e,t){return t.TypeClassification}}class ce{static convertToOptional(e,t){if(!le(t))return t.NotifiedInBand}}class ue{static convertToOptional(e,t){if(le(t))return!0}}function de(e){return e instanceof jn&&(!!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const o of n)if(0===B(e,o))return!1;return!0}(function(e){return B(q().SettingProvider.getSetting("Pipelines."+e.TypeName,e.DefaultPipelines),e.AllowedPipelines)}(e),Un.Substrate)&&(!p(e.NotifiedInBand)||!e.NotifiedInBand))}function le(e){return e instanceof Gn&&(!!p(e.Data)&&de(e.Data))}function pe(e){let t=e.TypeName,n="";const r=t.lastIndexOf(".");return r>=0&&(n=t.substring(0,r),t=t.substring(r+1)),"Common"===n?t:n+t}const fe="Name",ve="Email",he="Provider",me="PictureUrl",Ie="Roles",ye="User",Ce="Unknown",ge="File",Ae="Windows",Pe="Android",Se="Linux",we="tvOS",Te="IdKind",xe="TenantId",Ne="DriveId",be="DriveItemId",Re="SiteUrl",ke="SiteId",Oe="WebId",De="ListId",Ee="ItemId",Me="CreatorEmail",Ue="Unspecified",Le="Count",Fe="CustomerContent",je="EUII",Be="Completed",Ve="InProgress",_e="None",We="RawProvider",Je="RawId",Ge="RawIdKind",He="Created",Ke="Observed",qe="SourceApp",ze="SourcePlatform",Xe="SourceSessionId",Qe="Timestamp",Ye="ActivitySource",$e="PreprocessorOptions",Ze="Creator",et="CustomProperties",tt="Application",nt="AppName",rt="SourceAppVersion",ot="Device",it="SourceAppContext",st="NotifiedInBand",at="SuppressSendToSubstrate",ct="SensitivityLabelId",ut="ContentId",dt="Data",lt="NavigationId",pt="Action",ft="StartTime",vt="EndTime",ht="Status",mt="Locale",It="Item",yt="SendToActivityService",Ct="NotStarted",gt="Title",At="DueDate",Pt="Priority",St="Content",wt="Common.PreviewOptions",Tt="Anchor",xt="Comment",Nt="ThreadId",bt="CommentThreadId",Rt="Options",kt="Common.CommentPreview",Ot="ThreadLength",Dt="RootComment",Et="RecentComments",Mt="CommentThreadIsTask",Ut="CommentPreview",Lt="Preview",Ft="CommentPreviewAbsenceReason",jt="PreviewAbsenceReason",Bt="TaskCreatedDate",Vt="Updates",_t="LatestEmoji",Wt="EmojiCounts",Jt="LatestReaction",Gt="ReactionCounts",Ht="TargetId",Kt="TargetPreview",qt="TotalReactorCount",zt="State",Xt="StatusLabel",Qt="PreviousState",Yt="MessagePreview",$t="Source",Zt="ComponentEdit",en="CorrelationId",tn="ContainerKind",nn="ContentChangeRuleTriggered",rn="ContentSourceName",on="ContentStateInfo",sn="ActivityCompliance",an="Purple",cn="Green",un="Pink",dn="Orange",ln=Object.assign;class pn extends Y{constructor(){super(),this.TypeName="Unified.Person"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,"Id",null,A(this.Id,t)),Q(e,fe,null,A(this[fe],t)),Q(e,ve,null,A(this[ve],t)),Q(e,he,null,A(this[he],t)),Q(e,me,null,A(this[me],t)),Q(e,Ie,null,A(this[Ie],t)))}}!function(e){const t=E(2),n=U(e)}({[ye]:0,System:1});const fn={AAD:0,MSA:1},vn=function(e){const t=E(2),n=U(e);return(e,r)=>F(e,t,n,r)}(fn),hn={[Ce]:0,EXO:1,SPO:2,OXO:3,MileIQ:4,AFS:5,Teams:6,Stream:7,ODB:8,MicrosoftPowerBI:9,Yammer:10},mn=function(e){const t=E(11),n=U(e);return(e,r)=>F(e,t,n,r)}(hn),In=(function(e){const t=E(4),n=U(e)}({[Ce]:0,Message:1,[ge]:2,Calendar:3}),{[Ce]:0,[Ae]:1,[Pe]:2,iOS:3,MacOS:4,[Se]:5,[we]:6}),yn=function(e){const t=E(7),n=U(e);return(e,r)=>F(e,t,n,r)}(In);class Cn extends Y{constructor(){super(),this.TypeName="SIGS.Actor",this[Te]=0}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||(Q(e,"ActorIdType",null,vn(this[Te],t)),Q(e,"ActorId",null,A(this.Id,t)),Q(e,"AadTenantId",null,A(this[xe],t)),Q(e,"ActorType",null,A(ye,t)))}}class gn extends Y{[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||Q(e,"Url",null,A(this.Url,t))}}class An extends gn{constructor(){super(),this.TypeName="SIGS.GraphDocumentInfo"}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||(Q(e,Ne,null,A(this[Ne],t)),Q(e,be,null,A(this[be],t)))}}class Pn extends An{constructor(){super(),this.TypeName="SIGS.SharePointDocumentInfo"}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||(Q(e,Re,null,A(this[Re],t)),Q(e,xe,null,T(this[xe],t)),Q(e,ke,null,T(this[ke],t)),Q(e,Oe,null,T(this[Oe],t)),Q(e,De,null,T(this[De],t)),Q(e,Ee,null,T(this[Ee],t)),Q(e,Me,null,A(this[Me],t)))}}const Sn={[Ce]:0,Word:1,Excel:2,PowerPoint:3,Outlook:4,OneNote:5,FluidApp:6,Visio:7,Planner:8,Whiteboard:9,TeamsApp:10,Designer:11,BizChat:12,AIHub:13},wn=function(e){const t=E(14),n=U(e);return(e,r)=>F(e,t,n,r)}(Sn),Tn={[Ce]:0,Win32:1,WinRT:2,[Pe]:3,Mac:4,iOS:5,Web:6,Server:7,[Ae]:8,[Se]:9,[we]:10},xn=function(e){const t=E(11),n=U(e);return(e,r)=>F(e,t,n,r)}(Tn),Nn=(function(e){const t=E(3),n=U(e)}({[Ue]:0,EditSession:1,PreExisting:2}),{Create:0,Update:1,Delete:2}),bn=function(e){const t=E(3),n=U(e);return(e,r)=>F(e,t,n,r)}(Nn),Rn={[Ce]:0,LiveId:1,OrgId:2,ActiveDirectory:3,ADAL:4,SSPI:5,OAuth2:6,Badger:7,[Le]:8},kn=function(e){const t=E(9),n=U(e);return(e,r)=>F(e,t,n,r)}(Rn),On={OID:0,PUID:1,CID:2,Self:3},Dn=function(e){const t=E(4),n=U(e);return(e,r)=>F(e,t,n,r)}(On),En=function(e){const t=E(12),n=U(e),r=[[n[0],"AccessControl",n[2],n[3],n[4],n[5],n[6],n[7],n[8],"SystemMetaData",n[10],n[11]]],o=new Map([[2,r[0]],[3,r[0]]]),i=e=>4&e?(e=>{var t;return null!==(t=o.get(e))&&void 0!==t?t:n})(W(e)):n;return(e,n)=>F(e,t,i(n),n)}({[Ue]:0,AccessControlData:1,[Fe]:2,[je]:3,SupportData:4,AccountData:5,PublicPersonalData:6,EUPI:7,OII:8,SystemMetadata:9,PublicNonPersonalData:10,[Le]:11}),Mn=function(e){const t=E(3),n=U(e);return(e,r)=>F(e,t,n,r)}({[Be]:0,[Ve]:1,CompletedMissingStart:2}),Un={[_e]:0,Host:1,Substrate:2};!function(e){const t=M(2),n=L(e)}(Un);class Ln extends Y{constructor(){super(),this.TypeName="Base.UserInfo"}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||(Q(e,"Id",null,A(this.Id,t)),Q(e,fe,null,A(this[fe],t)),Q(e,ve,null,A(this[ve],t)),Q(e,he,null,A(this[he],t)),Q(e,xe,null,A(this[xe],t)),Q(e,We,null,kn(this[We],t)),Q(e,Je,null,A(this[Je],t)),Q(e,Ge,null,Dn(this[Ge],t)))}}class Fn extends ${constructor(){super(),ln(this,{Id:x,[He]:S,Finalized:S,[Ke]:S,[qe]:0,[ze]:0,[Xe]:x})}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,"Id",null,T(this.Id,t)),Q(e,Qe,null,P(this[He],t)),Q(e,"AppSessionId",[Ye],T(this[Xe],t))),3===n&&(Q(e,"SignalInstanceId",[$e],T(this.Id,t)),Q(e,"SendToONotify",[$e],g(ue.convertToOptional({},this),t))),2!==n&&3!==n||(Q(e,"ActorDetails",[et],z(this[Ze],1|t)),Q(e,nt,[tt],wn(this[qe],t)),Q(e,"AppVer",[tt],D(this[rt],t)),Q(e,"Platform",[et,"DeviceDetails"],xn(this[ze],t)),Q(e,"OsVer",[ot],D(this.SourcePlatformVersion,t)),Q(e,"DeviceId",[ot],A(this.SourceDeviceId,t)),Q(e,"UserAgent",[ot],A(this.SourceUserAgent,t)),Q(e,"ClientIp",[ot],A(this.SourceIpAddress,t)),Q(e,"Context",[et,"ApplicationDetails"],k(this[it],t)),Q(e,st,[et],g(ce.convertToOptional({},this),t))),0===n&&(Q(e,"HostTimestamp",null,P(this[Ke],t)),Q(e,nt,[Ye],wn(this[qe],t)),Q(e,"AppVersion",[Ye],D(this[rt],t)),Q(e,"AppPlatform",[Ye],xn(this[ze],t)),Q(e,"AppContext",[Ye],k(this[it],t)),Q(e,st,null,g(ne.convertToOptional({},this),t)))}}class jn extends Fn{get DefaultPipelines(){return Un.Substrate}get AllowedPipelines(){return Un.Substrate}[d](e,t){super[d](e,t);var n=W(t);0===n&&Q(e,at,null,g(this[at],t)),0!==n&&1!==n||(Q(e,ct,null,A(this[ct],t)),Q(e,"Type",null,A(Z.convertTo({},this),t)),Q(e,"People",null,z(te.convertToArray({},this),1|t)))}}class Bn extends jn{}class Vn extends Bn{constructor(){super(),this.ContentOrigin=0}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,ut,[dt],A(this[ut],t)),Q(e,lt,[dt],A(this[lt],t)))}}class _n extends Vn{constructor(){super(),this[pt]=0}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||Q(e,"ContentAction",[dt],bn(this[pt],t))}}class Wn extends _n{get AllowedPipelines(){return this.Action===Nn.Update?Un.None:super.AllowedPipelines}}class Jn extends Fn{constructor(){super(),this[ft]=S,this[vt]=S}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||(Q(e,ft,null,P(this[ft],t)),Q(e,vt,null,P(this[vt],t)),Q(e,ht,null,Mn(this[ht],t)),Q(e,"CV",null,A(this.CorrelationVector,t)),Q(e,mt,null,A(this[mt],t)),Q(e,"Workload",[tt],mn(this.AppWorkload,t)),Q(e,Ee,[It],A(this[Ee],t)),Q(e,"ContainerType",[It],A(this.ItemContainerKind,t)),Q(e,"ContainerId",[It],A(this.ItemContainerId,t)),Q(e,"ContainerTypeId",[et],A(this.CustomContainerTypeId,t)),Q(e,"SignalType",null,A(re.convertTo({},this),t)),Q(e,"Actor",null,z(se.convertTo({},this),1|t)),Q(e,"Os",[ot],yn(ie.convertTo({DefaultValue:0},this),t)),Q(e,"Compliance",null,En(ae.convertTo({DefaultValue:0},this),t)),Q(e,"AadAppId",[tt],A(oe.convertTo({},this),t)),Q(e,"ItemType",[It],A(ge,t)))}}class Gn extends Jn{[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||(Q(e,"FileDetails",[et],X(this.DocumentInfo,-2&t,"SIGS.DocumentInfo")),Q(e,"ActivityDetails",[et],X(this[dt],-2&_(1,t),"Base.NormalActivity"))),3===n&&Q(e,yt,[$e],g(this[yt],t))}}const Hn={UnsupportedClient:0,ProtectedDocument:1,Unnecessary:2},Kn=function(e){const t=E(3),n=U(e),r=[["Unsupported_Client","Encrypted","NotNeeded"]],o=new Map([[0,r[0]],[1,r[0]]]),i=e=>4&e?(e=>{var t;return null!==(t=o.get(e))&&void 0!==t?t:n})(W(e)):n;return(e,n)=>F(e,t,i(n),n)}(Hn),qn=function(e){const t=E(3),n=U(e);return(e,r)=>F(e,t,n,r)}({[Ct]:0,[Ve]:1,[Be]:2}),zn=function(e){const t=E(4),n=U(e);return(e,r)=>F(e,t,n,r)}({Urgent:0,Important:1,Medium:2,Low:3}),Xn=function(e){const t=M(5),n=L(e);return(e,r)=>j(e,t,n,r)}({[_e]:0,Assignees:1,[gt]:2,[At]:4,[ht]:8,[Pt]:16}),Qn=function(e){const t=E(1),n=U(e);return(e,r)=>F(e,t,n,r)}({Like:0});(function(e){const t=E(3),n=U(e)})({[Ce]:0,Local:1,Sharepoint:2}),function(e){const t=E(6),n=U(e)}({[Ct]:0,[Ve]:1,ReadyForReview:2,[Be]:3,Blocked:4,Custom:5});class Yn extends Y{constructor(){super(),this.TypeName=kt}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,"LocationText",null,A(this.Location,t)),Q(e,Tt,null,z(this[Tt],1|t)),Q(e,xt,null,z(this[xt],1|t)),Q(e,bt,null,A(this[Nt],t)),Q(e,Rt,null,X(this[Rt],-2&t,wt)))}}class $n extends Yn{constructor(){super(),this.TypeName="Common.CommentReplyPreview",this[Ot]=0}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,Dt,null,z(this[Dt],1|t)),Q(e,Et,null,z(this[Et],1|t)),Q(e,"ThreadCommentCount",null,m(this[Ot],t)))}}class Zn extends Wn{constructor(){super(),this.TypeName="Common.Mention"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,"ParentContentId",[dt],A(this.CommentContentId,t)),Q(e,bt,[dt],A(this[bt],t)),Q(e,Mt,[dt],g(this[Mt],t)),Q(e,Lt,null,X(this[Ut],-2&t,kt)),Q(e,jt,[dt],Kn(this[Ft],t)))}}class er extends _n{constructor(){super(),this.TypeName="Common.Comment"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,bt,[dt],A(this[Nt],t)),Q(e,Mt,[dt],g(this.ThreadIsTask,t)),Q(e,Lt,null,X(this[Lt],-2&t,kt)),Q(e,jt,[dt],Kn(this[jt],t)))}}class tr extends er{constructor(){super(),this.TypeName="Common.CommentReply"}}class nr extends Bn{[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,bt,[dt],A(this[bt],t)),Q(e,lt,[dt],A(this[lt],t)),Q(e,Lt,null,X(this[Ut],-2&t,kt)),Q(e,jt,[dt],Kn(this[Ft],t)))}}class rr extends nr{constructor(){super(),this.TypeName="Common.TaskCreation"}}class or extends nr{}class ir extends or{constructor(){super(),this.TypeName="Common.TaskReassignment"}}class sr extends _n{constructor(){super(),this.TypeName="Common.CanvasTask"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,gt,[dt],A(this[gt],t)),Q(e,Bt,[dt],P(this[Bt],t)),Q(e,At,[dt],P(this[At],t)),Q(e,ht,[dt],qn(this[ht],t)),Q(e,Pt,[dt],zn(this[Pt],t)),Q(e,Vt,[dt],Xn(this[Vt],t)))}}class ar extends Bn{}class cr extends Vn{[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,_t,[dt],A(this[_t],t)),Q(e,Wt,[dt],z(this[Wt],1|t)))}}class ur extends cr{constructor(){super(),this.TypeName="Common.CommentReactionUpdate"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,Jt,[dt],Qn(this[Jt],t)),Q(e,Gt,[dt],z(this[Gt],1|t)))}}class dr extends cr{constructor(){super(),this.TypeName="Common.TargetedReactionUpdate"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,Ht,[dt],A(this[Ht],t)),Q(e,Kt,[dt],k(this[Kt],t)),Q(e,qt,[dt],I(this[qt],t)))}}class lr extends _n{constructor(){super(),this.TypeName="Common.Recap"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||Q(e,St,["Recap"],k(this[St],t))}}class pr extends _n{constructor(){super(),this.TypeName="Common.StatusLabel"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,zt,[Xt],z(this[zt],1|t)),Q(e,Qt,[Xt],z(this[Qt],1|t)),Q(e,Yt,[Xt],k(this[Yt],t)))}}class fr extends Vn{constructor(){super(),this.TypeName="Common.ComponentEdit"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,$t,[Zt],A(this[$t],t)),Q(e,pt,[Zt],A(this[pt],t)),Q(e,en,[Zt],A(this[en],t)))}}class vr extends Vn{constructor(){super(),this.TypeName="Common.ContentChangeRuleTriggered",this[tn]=yr}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,tn,[nn],Ir(this[tn],t)),Q(e,rn,[nn],A(this[rn],t)),Q(e,on,[nn],X(this[on],-2&t,"ContentChangeRuleTriggered.ContentStateInfo")))}}class hr extends Gn{constructor(){super(),this.TypeName="Common.ActivitySignalWithoutContent",this.TypeClassification=3}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||Q(e,sn,[et],A(je,t))}}class mr extends Gn{constructor(){super(),this.TypeName="Common.ActivitySignalWithContent"}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||Q(e,sn,[et],A(Fe,t))}}(function(e){const t=E(10),n=U(e)})({Circle:0,CircleHalfFilled:1,RightArrowCircle:2,CheckmarkCircle:3,CircleLineFilled:4,[an]:5,[cn]:6,Grey:7,[un]:8,[dn]:9}),function(e){const t=E(12),n=U(e)}({Red:0,[dn]:1,Yellow:2,DarkBrown:3,LightGreen:4,[cn]:5,DarkTeal:6,Blue:7,[an]:8,[un]:9,Silver:10,Gray:11});const Ir=function(e){const t=E(2),n=U(e);return(e,r)=>F(e,t,n,r)}({Paragraph:0,Table:1}),yr=0;class Cr extends Y{}class gr extends Cr{constructor(){super(),this.TypeName="ContentChangeRuleTriggered.PersonStateInfo"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||Q(e,"Dummy",["Person"],A("",t))}}class Ar extends Y{constructor(){super(),this.TypeName="Vroom.WrappedActivity",this.Id=x}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||(Q(e,"Id",null,T(this.Id,t)),Q(e,"activity",null,X(this.Activity,-2&t,"Base.Activity")))}}class Pr extends Y{constructor(){super(),this.TypeName="Vroom.PatchStreamPayload"}[d](e,t){super[d](e,t);var n=W(t);0!==n&&1!==n||Q(e,"value",null,z(this.Activities,1|t))}}class Sr extends Y{constructor(){super(),this.TypeName="Transport.PreprocessorPayload"}[d](e,t){super[d](e,t);var n=W(t);2!==n&&3!==n||Q(e,"activities",null,X(this.Signals,-2&t,"Base.ActivitySignal"))}}!function(e){const t=E(16),n=U(e)}({Success:0,UnknownError:1,BadRequest:2,AccessDenied:3,SignalTypeNotFound:4,SignalAlreadyExists:5,Disabled:6,InternalError:7,Throttled:8,ServiceUnavailable:9,QuotaExceeded:10,SignalTooLarge:11,SigsBadRequest:12,ExpiredRpsProxyTicket:13,UserNotFound:14,InvalidToken:15});var wr=n(56218),Tr=n(10600),xr=n(19495),Nr=n(83125),br=n(30946),Rr=n(29018),kr=n(72376),Or=n(40635),Dr=n(37805),Er=n(93537);function Mr(e){return B(e.DefaultPipelines,e.AllowedPipelines)}function Ur(e,t,n){return Hr(e,t,n)}function Lr(e){return Kr(e)&&"string"===typeof e.code&&qr(e.message)&&zr(e["@onedrive.errorReasonForTelemetry"])}function Fr(e){return Kr(e)&&Lr(e.error)}function jr(e){return Kr(e)&&"string"===typeof e.Id&&qr(e.ServerId)&&qr(e.Message)&&zr(e.Status)&&("undefined"===typeof e.Error||Lr(e.Error))}function Br(e){return Kr(e)&&Xr(e.Status,0,"Success")&&"undefined"===typeof e.Error}function Vr(e){return Kr(e)&&"string"===typeof e.Id&&zr(e.Status)&&qr(e.Message)}function _r(e){return Kr(e)&&Xr(e.Status,0,"Success")}function Wr(e,t,n,r){const{siteUrl:i,siteId:s,webId:a,listId:c,listItemUniqueId:u}=n,d=function(e,t){if(e){if("Enterprise"===e.tokenProvider.identityType&&e.tenantId)return"SPO:SPO_".concat(t.siteId,"@SPO_").concat(e.tenantId);if("Consumer"===e.tokenProvider.identityType)return e.rosterId}return}(e,n),l=new Pn;l.SiteUrl=i,l.TenantId=null!==e&&void 0!==e&&e.tenantId?new w(e.tenantId):void 0,l.SiteId=new w(s),l.WebId=new w(a),l.ListId=new w(c),l.ItemId=new w(u);const p=function(e){if(e.TypeClassification===Gr)return new mr;return new hr}(r);return r.SignalId||(r.SignalId=new w((0,o.A)())),p.Id=r.SignalId,p.Creator=r.Creator,p.Created=r.Created,p.Finalized=r.Finalized,p.Observed=r.Observed,p.SourceApp=r.SourceApp,p.SourceAppVersion=r.SourceAppVersion,p.SourcePlatform=r.SourcePlatform,p.SourcePlatformVersion=r.SourcePlatformVersion,p.SourceDeviceId=r.SourceDeviceId,p.SourceUserAgent=r.SourceUserAgent,p.SourceIpAddress=r.SourceIpAddress,p.SourceAppContext=r.SourceAppContext,p.NotifiedInBand=r.NotifiedInBand,p.StartTime=r.Created,p.EndTime=r.Created,p.ItemId=t,p.Data=r,p.DocumentInfo=l,p.AppWorkload=hn.SPO,p.ItemContainerId=d,p.CustomContainerTypeId=null===e||void 0===e?void 0:e.containerTypeId,p}function Jr(e,t,n){return J(new G,()=>(q().SettingProvider={getSetting:(t,n)=>Hr(e,t,n)},t.toFacetJson(n)))}const Gr=2;function Hr(e,t,n){return(0,c.AU)("ActivityTransport."+t,n,null===e||void 0===e?void 0:e.settingsProvider)}function Kr(e){return"object"===typeof e&&null!==e}function qr(e){return"undefined"===typeof e||"string"===typeof e}function zr(e){return"undefined"===typeof e||"number"===typeof e||"string"===typeof e}function Xr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"undefined"===typeof e||n.includes(e)}const Qr=Symbol(),Yr="OutgoingActivity",$r="ActivityResult";function Zr(e,t,n,r){var o;const i=null!==(o=e[Qr])&&void 0!==o?o:Un.None,s=ro($r,e,i);s.TryCount=t.tries.length;const a=t.result.headers.get("SPRequestGuid");if(a&&(s.RequestId=a),s.Status=t.result.status,s.Success=!1,n){const t=function(e,t){const n=t.toLowerCase();return e.value.find(e=>e.Id.toLowerCase()===n)}(n,e.Id.toString());t&&(s.Success=!t.Error&&(!t.Status||"Success"===t.Status),t.Error?s.Error=t.Error.code:s.Success||(s.Error=t.Status),t.ServerId&&(s.ServerId=t.ServerId))}else r&&(s.Error=r.error.code);return s}function eo(e,t,n,r){let o,i;if(e instanceof Gn&&p(e.Data)){var s;const t=null!==(s=e[Qr])&&void 0!==s?s:Un.None;o=oo($r,e,t),i=e.Data.Id}else o=no($r,e),i=e.Id;o.TryCount=t.tries.length;const a=t.result.headers.get("Request-Id");if(a&&(o.RequestId=a),o.Status=t.result.status,o.Success=!1,n){const e=function(e,t){const n=t.toLowerCase();return e.find(e=>e.Id.toLowerCase()===n)}(n,i.toString());e&&(o.Success=!e.Status||"Success"===e.Status,o.Success||(o.Error=e.Status,e.Message&&(o.Message=e.Message)))}else r&&(o.Error=r.error.code);return o}function to(e,t,n){const r=no($r,e);r.TryCount=t.tries.length;const o=t.result.headers.get("Request-Id");return o&&(r.RequestId=o),r.Status=t.result.status,r.Success=t.result.ok,n&&(r.Error=n.error.code),r}function no(e,t){return io(e,t)}function ro(e,t,n){const r=io(e,t);return r.Pipelines=n,r}function oo(e,t,n){let r;return p(t.Data)?(r=ro(e,t.Data,n),r.ActivitySignalId=t.Id.toString()):r=no(e,t),r}function io(e,t){const n={eventName:e,category:"Generic",TypeName:t.TypeName,ActivityId:t.Id.toString(),Age:new Date(Date.now()).valueOf()-t.Created.valueOf()};return t instanceof _n&&(n.Action=t.Action),t instanceof er&&(n.HasParent=t instanceof tr&&p(t.ParentAuthor),n.HasPreview=p(t.Preview),p(t.PreviewAbsenceReason)&&(n.PreviewAbsenceReason=t.PreviewAbsenceReason)),(t instanceof Zn||t instanceof nr)&&(n.HasPreview=p(t.CommentPreview),p(t.CommentPreviewAbsenceReason)&&(n.PreviewAbsenceReason=t.CommentPreviewAbsenceReason)),n}var so=n(46507);const ao="unknown";async function co(e,t){const n=e.logger?(0,r.A)((0,r.A)({},e),{},{logger:new Nr.p("ActivityTransport",e.logger)}):e;t.forEach(Co.bind(null,n));const o=await async function(e,t){const n=[];var r,o=!1,i=!1;try{for(var s,a=(0,xr.A)(function(e,t){return lo.apply(this,arguments)}(e,t));o=!(s=await a.next()).done;o=!1){const e=s.value;n.push(e)}}catch(c){i=!0,r=c}finally{try{o&&null!=a.return&&await a.return()}finally{if(i)throw r}}return n}(n,t);return(await Promise.all([mo(n,o.filter(Ao)),Io(n,o.filter(Po))])).every(e=>e)}class uo{constructor(e,t,n){this.provider=e,this.kind=t,this.id=n}}function lo(){return(lo=(0,Tr.A)(function*(e,t){const n=yield(0,wr.A)(async function(e){if(!po(e))return;try{return await(0,br.A7)(e.tokenProvider,e)}catch(t){return}}(e)),r=yield(0,wr.A)(async function(e){if(!po(e))return;const{siteUrl:t,driveId:n,fileId:r}=e;try{return await(0,a.sN)(e.tokenProvider,t,n,r)}catch(o){return}}(e));for(const a of t)if(n&&Po(a)){var o;const t=no(Yr,a);null===(o=e.logger)||void 0===o||o.send(t),yield a}else if(Ao(a)){const t=Mr(a);if(t&Un.Host){var i;const n=ro(Yr,a,t);null===(i=e.logger)||void 0===i||i.send(n),a[Qr]=t,yield a}if(n&&r&&t&Un.Substrate){var s;const o=Wr(e,n,r,a),i=oo(Yr,o,t);null===(s=e.logger)||void 0===s||s.send(i),o[Qr]=t,yield o,a.SuppressSendToSubstrate=!0}}})).apply(this,arguments)}function po(e){var t,n;return!!(So(e)||null!==(t=e.senderIdentity)&&void 0!==t&&t.puid||fo(e)&&null!==(n=e.senderIdentity)&&void 0!==n&&n.cid)}function fo(e){return Ur(e,"EnableCidSupport",!0)}function vo(e){return Ur(e,"UseInstrumentedAuthorizedFetchWithRetry",!0)}function ho(e){return Ur(e,"UseSerializeToJson",!0)}async function mo(e,t){var n;if(t.length<1)return!0;const o=new Pr;o.Activities=t.map(go);const i=(0,Rr.$)(e.siteUrl),s={getToken:t=>{if(!t)throw Error("Options must be specified");const n=(0,r.A)((0,r.A)({},t),{},{siteUrl:e.siteUrl,driveId:e.driveId,itemId:e.fileId});return e.tokenProvider.getToken(["".concat(i,"/files.readwrite.all")],n)},url:"".concat(i,"/_api/v2.1/drives/").concat(e.driveId,"/items/").concat(e.fileId,"/office_activityStream"),tenantId:null===(n=e.senderIdentity)||void 0===n?void 0:n.tenantId,requestInit:{method:"PATCH",headers:{"Content-Type":"application/json"},body:ho(e)?Jr(e,o,0):o.toFacetJson(0)},retryPolicy:kr._9,tokenPolicy:(0,kr.N$)(e.tokenProvider)},a=vo(e)&&e.logger?await(0,Or.g)((0,r.A)((0,r.A)({},s),{},{logger:e.logger,nameForLogging:"SendActivitiesToHost"})):await(0,Or.y)(s),c=await a.result.json();return function(e,t,n,r){const o=n.result.ok&&(s=r,Kr(s)&&Array.isArray(s.value)&&s.value.every(jr))?r:void 0,i=!n.result.ok&&Fr(r)?r:void 0;var s;for(const c of t){var a;const t=Zr(c,n,o,i);null===(a=e.logger)||void 0===a||a.send(t)}}(e,t,a,c),a.result.ok&&(Kr(u=c)&&Array.isArray(u.value)&&u.value.every(Br));var u}async function Io(e,t){if(t.length<1)return!0;try{return(await Promise.all(t.map(yo.bind(null,e)))).every(e=>e)}catch(n){return!1}}async function yo(e,t){var n;if(!function(e){return p(e.Creator)&&p(e.Creator.RawIdKind)}(t))return!1;let o,i,s;const a=function(e){var t,n;return(0,so.l)(null!==(t=null===(n=e.environment)||void 0===n?void 0:n.audience)&&void 0!==t?t:"Production")}(e),c=t instanceof Gn;if(c){o="".concat(a,"/signalpreprocessor/v1/office");const e=new Sr;e.Signals=[t],i=e,s=3}else o="".concat(a,"/api/v2.0/me/signals"),i=t,s=2;const u=[429,500];(function(e){return Ur(e,"AddResponsesToRetryWhitelist",!0)})(e)&&u.push(709,710);const d={getToken:t=>{if(t)return e.tokenProvider.getToken(["".concat(a,"/Signals-Internal.ReadWrite")],t);throw Error("Options must be specified")},url:o,tenantId:null===(n=e.senderIdentity)||void 0===n?void 0:n.tenantId,requestInit:{method:"POST",headers:{"Content-Type":"application/json",Prefer:'exchange.behavior="SignalAccessV2,OpenComplexTypeExtensions"',"X-SignalInstanceId":t.Id.toString(),"X-AnchorMailbox":e.senderIdentity.upn},body:ho(e)?Jr(e,i,s):i.toFacetJson(s)},retryPolicy:{maxRetries:2,backoffFn:(0,Dr.FT)(500),filter:(0,Er.sC)(u)}},l=vo(e)&&e.logger?await(0,Or.g)((0,r.A)((0,r.A)({},d),{},{logger:e.logger,nameForLogging:"SendSignalToSubstrate"})):await(0,Or.y)(d),f=await l.result.json();return function(e,t,n,r,o){const i=!n.result.ok&&Fr(r)?r:void 0;if(o){const o=n.result.ok&&(c=r,Array.isArray(c)&&c.every(Vr))?r:void 0;for(const r of t){var s;const t=eo(r,n,o,i);null===(s=e.logger)||void 0===s||s.send(t)}}else for(const u of t){var a;const t=to(u,n,i);null===(a=e.logger)||void 0===a||a.send(t);break}var c}(e,[t],l,f,c),c?l.result.ok&&(v=f,Array.isArray(v)&&v.every(_r)):l.result.ok;var v}function Co(e,t){if(e.senderIdentity&&!t.Creator)if(fo(e)){const{provider:n,kind:r,id:o}=function(e,t){const{LiveId:n,ADAL:r}=Rn,{OID:o,PUID:i,CID:s}=On,{oid:a,puid:c,cid:u}=t;if("Consumer"===e.identityType)return c?new uo(n,i,c):u?new uo(n,s,u):a&&a!==ao?new uo(n,o,a):new uo(n);const d="Enterprise"===e.identityType?r:void 0;return a&&a!==ao?new uo(d,o,a):c?new uo(d,i,c):u?new uo(d,s,u):new uo(d)}(e.tokenProvider,e.senderIdentity);t.Creator=new Ln,t.Creator.Id=o,t.Creator.Name=e.senderIdentity.name,t.Creator.Email=e.senderIdentity.upn,t.Creator.TenantId=e.senderIdentity.tenantId,t.Creator.RawProvider=n,t.Creator.RawId=t.Creator.Id,t.Creator.RawIdKind=r}else t.Creator=new Ln,t.Creator.Id=function(e){var t,n;if("Consumer"===e.tokenProvider.identityType&&null!==(t=e.senderIdentity)&&void 0!==t&&t.puid)return e.senderIdentity.puid;const r=So(e);if(r)return r;if(null!==(n=e.senderIdentity)&&void 0!==n&&n.puid)return e.senderIdentity.puid;return}(e),t.Creator.Name=e.senderIdentity.name,t.Creator.Email=e.senderIdentity.upn,t.Creator.TenantId=e.senderIdentity.tenantId,t.Creator.RawProvider=function(e){if("Consumer"===e.tokenProvider.identityType)return Rn.LiveId;if("Enterprise"===e.tokenProvider.identityType)return Rn.ADAL;return}(e),t.Creator.RawId=t.Creator.Id,t.Creator.RawIdKind=function(e){var t,n;if("Consumer"===e.tokenProvider.identityType&&null!==(t=e.senderIdentity)&&void 0!==t&&t.puid)return On.PUID;if(So(e))return On.OID;if(null!==(n=e.senderIdentity)&&void 0!==n&&n.puid)return On.PUID;return}(e)}function go(e){const t=new Ar;return t.Activity=e,t.Id=e.Id,t}function Ao(e){return e instanceof jn}function Po(e){return e instanceof Jn}function So(e){var t;const n=null===(t=e.senderIdentity)||void 0===t?void 0:t.oid;return n===ao?void 0:n}var wo=n(99671);const To="GetDocumentInfoError",xo="AppContextError",No="MissingAuthorInformation",bo="NotificationActivityStreamError",Ro="NonODSPResolvedUrl",ko="NotifyAtMention",Oo="QueueAtMentionNotification";class Do{constructor(e){if(this.props=e,!this.props.fileId||!this.props.driveId||!this.props.siteUrl)throw new Error("Invalid file information: fileId, driveId or siteUrl might be missing")}get Disposable(){return this}dispose(){}get NotificationService(){return this}async notifyAtMention(e,t,n){const{siteUrl:r,driveId:o,fileId:i}=this.props,s={siteUrl:r,driveId:o,itemId:i,dataStorePath:t};return this.sendNotification(e,t,n,ko,s)}async queueAtMentionNotification(e){let{recipient:t,atMentionId:n,contentId:o,navigationPath:s,resolvedUrl:c,threadId:u}=e;const{siteUrl:d,driveId:l,fileId:p,appName:f,logger:v}=this.props,h={itemId:p,driveId:l,siteUrl:d},m=((e,t,n)=>{var r;if(!t)return n&&(0,i.Ot)(n,{eventName:To}),e;if(!(0,a.g2)(t)){const t=new Error("Invalid file information: ResolvedUrl is not of the expected ODSP type");return n&&(0,i.hO)(n,{eventName:To},t),e}return{driveId:t.driveId,siteUrl:t.siteUrl,itemId:t.itemId,containerPackageName:null===(r=t.codeHint)||void 0===r?void 0:r.containerPackageName}})(h,c,v);let I,y;if(c&&(0,a.g2)(c)){var C,g,A;const e={siteUrl:c.siteUrl,driveId:c.driveId,itemId:c.itemId};I=null===(C=c.codeHint)||void 0===C?void 0:C.containerPackageName,y=((e,t)=>{const{siteUrl:n,driveId:r,itemId:o}=t,i=new URL(n).hostname,{siteUrl:s,driveId:a,itemId:c}=e;return i!==new URL(s).hostname||r!==a||o!==c})(h,e)?void 0:await(null===(g=(A=this.props).getFileContext)||void 0===g?void 0:g.call(A,c,o))}const P=(0,r.A)((0,r.A)({},m),{},{dataStorePath:o,containerPackageName:I,appName:f,context:y});return c&&!(0,a.g2)(c)&&(P.dataStorePath="",v&&(0,i.hO)(v,{eventName:Ro})),this.sendNotification(t.userPrincipalName,o,s,Oo,P,n,u,c)}getAppContext(e){let t,n;if(e)try{t={fluidComponents:JSON.parse(e)}}catch(r){r instanceof Error&&(n=r)}return{appContext:t,appContextError:n}}async notifyOfficeActivityStream(e,t,n,i,s,a,c){const{correlationId:u}=this.props,d=(0,r.A)((0,r.A)({},this.props),{},{fileId:i.itemId,driveId:i.driveId,siteUrl:i.siteUrl}),l=function(e,t){const n=(0,wo.kt)(e);if(t.includeFluidSignature)return n;const r=new URLSearchParams(atob(n));return r.delete("fluid"),btoa(r.toString())}(i,{includeFluidSignature:!0}),p=new Zn;p.Id=new w((0,o.A)()),p.Created=p.Observed=new Date,p.SourceApp=Sn.FluidApp,p.SourcePlatform=Tn.Web,p.SourceSessionId=u?new w(u):x,p.SourceAppContext=s,p.ContentId=null!==a&&void 0!==a?a:t,p.NavigationId=l,p.CommentThreadId=c,p.Action=Nn.Create,p.Mentionee=new Ln,p.Mentionee.Email=e,p.CommentPreviewAbsenceReason=Hn.UnsupportedClient,n.addAdditionalProps({activityId:p.Id.toString(),contentId:p.ContentId});const f=this.getSetting("EnableActivityFiltering",!0)?this.props.filterActivity:void 0;return!(f&&!await f(p))&&await co(d,[p])}async sendNotification(e,t,n,o,i,a,c,u){const{getHostAppContext:d}=this.props,l=s.m.start("NotifyOfficeActivityStream",this.props.logger);if(!e)return l.setResult(!1,{navigationPath:n.length>0,entryPoint:o,errorType:No}),!1;const{appContext:p,appContextError:f}=d?{appContext:d(u)}:this.getAppContext(n);try{const s=await this.notifyOfficeActivityStream(e,t,l,i,p,a,c);return l.setResult(s&&!f,(0,r.A)({appContextSent:!!p,notifyActivity:s,navigationPath:n.length>0,entryPoint:o},f&&{errorType:xo}),f),s}catch(v){return l.setResult(!1,{appContextSent:!!p,notifyActivity:!1,navigationPath:n.length>0,entryPoint:o,errorType:bo},v),!1}}getSetting(e,t){return(0,c.AU)("SharepointNotificationService."+e,t,this.props.settingsProvider)}}},56218:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(27106);function o(e){return new r.A(e,0)}}}]);
//# sourceMappingURL=SharepointNotificationService.8214ec30.chunk.js.map