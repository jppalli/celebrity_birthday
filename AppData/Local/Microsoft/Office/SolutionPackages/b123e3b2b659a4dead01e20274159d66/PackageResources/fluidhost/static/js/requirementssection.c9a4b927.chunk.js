"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[62672],{37374:(e,t,r)=>{r.r(t),r.d(t,{RequirementsSection:()=>J});var o=r(27051),s=r(77508),n=r(16112),a=r(31537),i=r(6017),l=r(20751),p=r(11638),m=r(4648),c=r(58189),d=r(9442),u=r(39410),h=r(62264),v=r(67239),A=r(65043),S=r(70149);const g=()=>(0,S.L)(()=>r.e(84465).then(r.bind(r,52514))).then(e=>({default:e.FormAttachmentsList})),C=(0,A.lazy)(g),q=()=>(0,S.L)(()=>Promise.all([r.e(17323),r.e(81514)]).then(r.bind(r,49784))).then(e=>({default:e.ApprovalRequestSection})),R=(0,A.lazy)(q);var F=r(69412),f=r(8480),T=r(13862),k=r(82229),x=r(86634),b=r(59846),E=r(56415),B=r(66783),N=r(52195),I=r(66151),D=r(4705);const y="20px",L=(0,B.J9)((e,t,r)=>{const o={".ms-Label":[(0,D.oQ)(e),(0,I.gS)("row")],".plannerCheckMark":[e===s.Sx.TeamsContrast&&{color:E.z.White},{color:E.z.PlannerSecondary,hight:"16px",width:"12px",paddingLeft:"4px"}],".labelTag":[{marginLeft:"4px"}]},n={margin:"".concat(y," 0px")},a={margin:"".concat(y," 0px")},i=[(0,I.gS)(),{marginTop:"5px",":hover":{".deleteApprovalButton":{display:"flex"}}}],l={color:(0,I.Qt)(e),paddingInlineEnd:"10px"},p=[!0===t&&{color:E.z.PlannerSecondary},!1===t&&{color:(0,I.Qt)(e)},{paddingInlineStart:"12px"}],m=[{".plannerCheckMark":{color:E.z.DarkRed}}],c=[e===s.Sx.TeamsContrast&&{color:E.z.White},e===s.Sx.TeamsLight&&{color:E.z.TeamsAppBrand00},e===s.Sx.TeamsDark&&{color:E.z.TeamsDarkPurple},{display:"inline-block",verticalAlign:"bottom",padding:"4px"}],d=[(0,I.$Z)(),{margin:"5px",fontSize:N.s.size14}],u=[(0,I.gS)("column"),{width:"385px",padding:"16px 16px 20px 16px",".header":[(0,I.gS)("row"),{justifyContent:"space-between",".primaryTextSectionTitle":{margin:"0px"}}],".ms-Callout-beakCurtain":{backgroundColor:"inherit"},".ms-Callout-beak":[{backgroundColor:"inherit"},e===s.Sx.TeamsContrast&&{border:"".concat(E.z.White," solid 1px")}]}],h=[(0,I.$Z)(),{display:"none",marginLeft:"auto",".ms-Button":{color:"inherit",backgroundColor:"inherit",margin:0,padding:0},"&.forceShow":{display:"flex"}}],v=[(0,I.gS)("row"),{alignItems:"center",gap:"8px"}];return(0,N.TW)({root:o,addRequirementButton:{height:"35px"},formsSection:n,approvalsSection:a,approvalsContainer:i,approvalsIcon:c,approvalRequirementText:d,addFormCallout:u,deleteApprovalButton:h,asterisk:l,okCheckmark:m,fractionOfRequiredForms:p,tooltip:{maxWidth:"250px"},requirementsTitleContainer:v},r)}),P=(0,B.J9)(e=>{const t=(0,I.cK)(e);return(0,o.A)((0,o.A)({},t),{},{root:[t.root,{height:"35px"}]})}),U=(0,B.J9)(e=>({root:(0,N.Zq)("requirementsSection",e.root),addRequirementButton:(0,N.Zq)("addRequirementButton",e.addRequirementButton),formsSection:(0,N.Zq)("formsSection",e.formsSection),approvalsSection:(0,N.Zq)("approvalsSection",e.approvalsSection),approvalsContainer:(0,N.Zq)("approvalsContainer",e.approvalsContainer),approvalsIcon:(0,N.Zq)("approvalsIcon",e.approvalsIcon),approvalRequirementText:(0,N.Zq)("approvalRequirementText",e.approvalRequirementText),addFormCallout:(0,N.Zq)("addFormCallout",e.addFormCallout),deleteApprovalButton:(0,N.Zq)("deleteApprovalButton",e.deleteApprovalButton),asterisk:(0,N.Zq)("asterisk",e.asterisk),okCheckmark:(0,N.Zq)("okCheckmark",e.okCheckmark),fractionOfRequiredForms:(0,N.Zq)("fraction",e.fractionOfRequiredForms),tooltip:(0,N.Zq)("tooltip",e.tooltip),requirementsTitleContainer:(0,N.Zq)("requirementsTitleContainer",e.requirementsTitleContainer)}));var Z=r(2908),_=r(86053),w=r(40135),z=r(21382);class J extends n.${name(){return"RequirementsSection"}componentDidUpdate(e,t){this.props.createdFormId!==e.createdFormId&&this.setState({isAddFormCalloutVisible:!!this.props.createdFormId})}renderComponent(){const{root:e}=this.getClassNames();return A.createElement("div",{className:e},this.renderAddRequirementsSection(),this.renderFormsSection(),this.renderAddFormCallout(),this.renderApprovalsSection())}renderAddRequirementsSection(){const{maxRequiredForms:e,maxRequiredApprovals:t}=this.props,{addRequirementButton:r,requirementsTitleContainer:s}=this.getClassNames(),n={maxWidth:"250px"};return this.canUpdateFormRequirement()||this.canUpdateApprovalRequirement()?A.createElement(A.Fragment,null,A.createElement("div",{className:s},A.createElement(a.J,null,_.p.Strings.RequirementsSection_RequirementsSectionTitle),A.createElement(f.S,{plannerTheme:this.props.theme,directionalHint:i.A.rightCenter,content:z.G(_.p.Strings.RequirementsSection_InfoIconTooltipText,e,t),tooltipProps:n},A.createElement(l.I,(0,o.A)((0,o.A)({},b.h_),{},{tabIndex:0})))),A.createElement(p.Y,{split:!0,menuProps:{items:this.props.addRequirementButtonMenuItems,styles:(0,x.Zo)(this.props.theme)},styles:P(this.props.theme),className:r},_.p.Strings.RequirementsSection_AddRequirementButtonText)):null}renderFormsSection(){const{enableFormsRequirement:e,formAttachmentsListProps:t}=this.props,{formsSection:r}=this.getClassNames();if(!e||0===t.taskAttachmentRowItems.length)return null;const o=this.canSubmitForm()?_.p.Strings.TaskEditor_FormRequirementSubmitFormTitle:_.p.Strings.RequirementsSection_FormRequirementSectionTitle;return A.createElement("div",{className:r},A.createElement(a.J,null,o,this.renderAsterisk(),this.renderFormsCompletedAdditionalHeader(),this.renderFormsRequirementCount()),this.renderFormAttachmentsList())}renderAsterisk(){const{asterisk:e}=this.getClassNames(),t=this.getTheNumberOfActiveForms();return this.canSubmitForm()&&0!==t?A.createElement("span",{className:e},"*"):null}renderFormsRequirementCount(){const{forms:e}=this.props,{fractionOfRequiredForms:t}=this.getClassNames(),r=e?e.length:0;if(!this.canSubmitForm()||r<2)return null;const o=this.getTheNumberOfActiveForms(),s=z.G(_.p.Strings.TaskEditor_FormsFraction,r-o,r);return A.createElement("span",{className:t},s)}renderFormsCompletedAdditionalHeader(){const{okCheckmark:e}=this.getClassNames(),t=this.getTheNumberOfActiveForms();return this.canSubmitForm()?0===t?A.createElement(l.I,(0,o.A)({className:e},b.r8)):A.createElement(F.l,{index:1,isCollapsed:!1,title:_.p.Strings.TaskEditor_ShowMandatoryChecklistToggleLabel,showBorder:!1,theme:this.props.theme}):null}renderApprovalsSection(){const{approvalsSection:e,approvalsContainer:t,approvalRequirementText:r,approvalsIcon:s,deleteApprovalButton:n}=this.getClassNames();if(!this.props.enableApprovalsRequirement||!this.props.isApprovalRequired||!this.canUpdateApprovalRequirement()&&!this.canUpdateApprovalRequest())return null;if(this.canUpdateApprovalRequirement()){const i=this.state.deleteApprovalFocused?"forceShow":"";return A.createElement("div",{className:e},A.createElement(a.J,null,_.p.Strings.RequirementsSection_ApprovalRequirementSectionTitle),A.createElement("div",{className:t},A.createElement(l.I,(0,o.A)((0,o.A)({},b.hn),{},{className:(0,m.A)(b.hn.className,s)})),A.createElement("div",{className:r},_.p.Strings.RequirementsSection_ApprovalRequirementText),A.createElement("div",{className:"".concat(n," ").concat(i)},A.createElement(v.K,{className:"deleteApprovalIconButton",iconProps:b.pJ,ariaLabel:_.p.Strings.RequirementsSection_RemoveApprovalButtonTitle,title:_.p.Strings.RequirementsSection_RemoveApprovalButtonTitle,onClick:this.onClickDeleteApproval,onFocus:this.onDeleteApprovalFocus,onBlur:this.onDeleteApprovalBlur,plannerTheme:this.props.theme}))))}return A.createElement(A.Suspense,{fallback:A.createElement(w.W,null)},A.createElement(R,{theme:this.props.theme,approvalInfo:this.props.approvalInfo,getAssigneePoolForApproval:this.props.getAssigneePoolForApproval,getUserPhoto:this.props.getUserPhoto,currentUserId:this.props.currentUserId,onCancelApproval:this.props.onCancelApproval,onClearApproval:this.props.onClearApproval,onUpdateApproval:this.props.onUpdateApproval,onSendApprovalRequest:this.props.onSendApprovalRequest,approvalDetailInfo:this.props.approvalDetailInfo,selectedApprover:this.props.selectedApprover,isApprovalDataLoading:this.props.isApprovalDataLoading,onSelectApprover:this.props.onSelectApprover,onReloadApprovalData:this.props.onReloadApprovalData,isTaskCompleted:this.props.isTaskCompleted}))}renderFormAttachmentsList(){return A.createElement(A.Suspense,{fallback:A.createElement(A.Fragment,null)},A.createElement(C,(0,o.A)((0,o.A)({},this.props.formAttachmentsListProps),{},{createdFormId:this.props.createdFormId,createdFormRef:this.createdFormActionButtonRef})))}renderAddFormCallout(){const{addFormCallout:e}=this.getClassNames();return this.state.isAddFormCalloutVisible&&this.createdFormActionButtonRef.current?A.createElement(u.P,{target:this.createdFormActionButtonRef,isBeakVisible:!0,gapSpace:0,doNotLayer:!1,directionalHint:i.A.topLeftEdge,styles:(0,Z.df)(this.props.theme),className:e,setInitialFocus:!0,onDismiss:this.onAddFormCalloutDismiss},A.createElement(c.Y,{isClickableOutsideFocusTrap:!0},A.createElement("div",{className:"header"},A.createElement(h.g,{titleText:_.p.Strings.RequirementsSection_AddFormCalloutTitle,theme:this.props.theme}),A.createElement(v.K,{iconProps:b.s5,title:_.p.Strings.RequirementsSection_CloseButtonText,ariaLabel:_.p.Strings.RequirementsSection_CloseButtonAriaLabel,onClick:this.onAddFormCalloutDismiss,plannerTheme:this.props.theme})),A.createElement("p",null,_.p.Strings.RequirementsSection_AddFormCalloutBody),A.createElement(d.N,{href:s.$j.addFormsRequirement,target:"_blank",rel:"noopener noreferrer"},_.p.Strings.SharedComponents_LearnMoreLink))):null}getTheNumberOfActiveForms(){const{forms:e}=this.props;return e?e.filter(e=>null===e.formResponse).length:0}canSubmitForm(){return!(0,T.M)(this.props.formPermissions,T.J.DisableSubmitForm)}canUpdateFormRequirement(){return!(0,T.M)(this.props.formPermissions,T.J.DisableUpdateFormRequirement)}canUpdateApprovalRequirement(){return!(0,k.P)(this.props.approvalPermissions,k.u.DisableUpdateApprovalRequirement)}canUpdateApprovalRequest(){return!(0,k.P)(this.props.approvalPermissions,k.u.DisableUpdateApprovalRequest)}getClassNames(){const{theme:e,styles:t}=this.props,r=this.getTheNumberOfActiveForms();return U(L(e,0===r,t))}constructor(e,t){super(e,t),this.createdFormActionButtonRef=A.createRef(),this.onClickDeleteApproval=()=>{this.props.onDeleteApprovalRequirement(),this.setState({deleteApprovalFocused:!1})},this.onDeleteApprovalFocus=()=>{this.setState({deleteApprovalFocused:!0})},this.onDeleteApprovalBlur=()=>{this.setState({deleteApprovalFocused:!1})},this.onAddFormCalloutDismiss=()=>{this.setState({isAddFormCalloutVisible:!1})},this.state={isAddFormCalloutVisible:!!this.props.createdFormId,deleteApprovalFocused:!1}}}},62264:(e,t,r)=>{r.d(t,{g:()=>d});var o=r(65043),s=r(16112),n=r(66783),a=r(52195),i=r(66151),l=r(56415);const p="34px",m=(0,n.J9)(e=>({root:[(0,i.q0)("ellipsis"),(0,i.aS)(e),{height:p,cursor:"default","> button":[i.xK,(0,i.q0)("ellipsis"),{cursor:"pointer",width:"100%",":hover > span":{borderBottom:"2px solid ".concat(l.z.ThemeSecondary)}}],"> .primaryTextSectionTitle":{fontSize:"17px",fontWeight:a.BO.semibold,lineHeight:p,margin:"auto"}}]})),c=(0,n.J9)(e=>({root:(0,a.Zq)("primaryTextSection",e.root)}));class d extends s.${name(){return"HeaderTitle"}renderComponent(){const{titleText:e,onClickTitleButton:t,titleButtonAriaLabel:r}=this.props,s=this.getClassNames();return o.createElement("div",{className:s.root,title:e},null!=t?o.createElement("button",{className:"primaryTextSectionTitle",onClick:this.onTitleClick,"aria-label":r,id:"primaryTextSectionTitleId",ref:this.titleButtonRef},o.createElement("span",null,e)):o.createElement("h2",{className:"primaryTextSectionTitle",id:"primaryTextSectionTitleId"},e))}getClassNames(){return c(m(this.props.theme))}constructor(e,t){super(e,t),this.titleButtonRef=o.createRef(),this.onTitleClick=()=>{var e,t,r;null===(e=(t=this.props).onClickTitleButton)||void 0===e||e.call(t,null!==(r=this.titleButtonRef.current)&&void 0!==r?r:void 0)}}}}}]);
//# sourceMappingURL=requirementssection.c9a4b927.chunk.js.map