"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[81514],{49784:(e,t,r)=>{r.r(t),r.d(t,{ApprovalRequestSection:()=>Ue});var o=r(27051),n=r(16112),i=r(39410),a=r(66151),s=r(66783),p=r(52195),l=r(75472);const c="24px",d=(0,s.J9)((e,t)=>(0,p.TW)({addApproverPicker:[{borderRadius:"5px",height:"450px"}],compactPeoplePicker:[{width:"260px",marginTop:"15px",marginInline:"15px"}]},t)),u=(0,s.J9)((e,t)=>{const r={root:[(0,a.NX)(e),{padding:"".concat("16px"," 0px")}],calloutMain:[(0,a.aS)(e),(0,a.NX)(e),{overflowY:"hidden"}]};return(0,p.TW)(r,t)}),v=(0,s.J9)((e,t)=>{const r={root:[{margin:"0px ".concat(c," ").concat((0,l.vb)((0,l.jz)(c)/2)," ").concat(c)}],text:{border:"none","::after":(0,a.T4)(e)},input:[(0,a.aS)(e),(0,a.zK)(e),(0,a.Oj)(e),{minHeight:"34px"}]};return(0,p.TW)(r,t)}),h=(0,s.J9)(e=>({addApproverPicker:(0,p.Zq)("addApproverPicker",e.addApproverPicker),compactPeoplePicker:(0,p.Zq)("compactPeoplePicker",e.compactPeoplePicker)}));var m=r(65043),A=r(50605),g=r(6017),C=r(17323),f=r(86053);const S={mostRecentlyUsedHeaderText:f.p.Strings.AddApprover_AddApproverPicker_Suggestions,noResultsFoundText:f.p.Strings.AddApprover_AddApproverPicker_NoResultsFound,loadingText:f.p.Strings.AddApprover_AddApproverPicker_Loading,showRemoveButtons:!1};class _ extends n.${name(){return"AddApproverPicker"}renderComponent(){const e=this.getClassNames(),t=e=>this.props.peopleList.filter(t=>function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())}(t.text,e)),r=(0,A.jI)();return m.createElement(i.P,{isBeakVisible:!1,gapSpace:0,doNotLayer:!0,target:this.props.targetElement,directionalHint:r?g.A.leftTopEdge:g.A.rightTopEdge,className:e.addApproverPicker,styles:u(this.props.theme),onDismiss:this.props.onDismissPicker,setInitialFocus:!0},m.createElement(C.HQ,{className:e.compactPeoplePicker,onResolveSuggestions:(e,r,o)=>{if(e){let n=t(e);return n=D(n,r),n=o?n.slice(0,o):n,n}return[]},onEmptyResolveSuggestions:e=>D(this.props.peopleList,e),getTextFromItem:x,pickerSuggestionsProps:S,onChange:this.props.onSelectedPerson,styles:v(this.props.theme)}))}getClassNames(){return h(d(this.props.theme))}constructor(e,t){super(e,t),this.state={}}}function x(e){var t;return null!==(t=e.text)&&void 0!==t?t:""}function D(e,t){return e.filter(e=>!function(e,t){if(0===(null===t||void 0===t?void 0:t.length))return!1;return t.filter(t=>t.text===e.text).length>0}(e,t))}var k,T=r(65804),y=r(56851),q=r(89379),R=r(27480),P=r(78233),b=r(9833),I=r(17066);!function(e){e[e.normal=0]="normal",e[e.compact=1]="compact"}(k||(k={}));var B=r(82014),N=r(19487),E=(0,q.Z)(),w=m.createContext({}),U=function(e){function t(t){var r=e.call(this,t)||this;return r._rootElement=m.createRef(),r._onClick=function(e){r._onAction(e)},r._onKeyDown=function(e){e.which!==R.c.enter&&e.which!==R.c.space||r._onAction(e)},r._onAction=function(e){var t=r.props,o=t.onClick,n=t.onClickHref,i=t.onClickTarget,a=(0,N.k_)(r.context);o?o(e):!o&&n&&(i?a.open(n,i,"noreferrer noopener nofollow"):a.location.href=n,e.preventDefault(),e.stopPropagation())},(0,P.f)(r),(0,b.A)("DocumentCard",t,{accentColor:void 0}),r}return(0,y.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,r=t.onClick,o=t.onClickHref,n=t.children,i=t.type,a=t.accentColor,s=t.styles,p=t.theme,l=t.className,c=(0,I.G1)(this.props,I.JM,["className","onClick","type","role"]),d=!(!r&&!o);this._classNames=E(s,{theme:p,className:l,actionable:d,compact:i===k.compact}),i===k.compact&&a&&(e={borderBottomColor:a});var u={role:this.props.role||(d?r?"button":"link":void 0),tabIndex:d?0:void 0};return m.createElement("div",(0,y.__assign)({ref:this._rootElement,role:"group",className:this._classNames.root,onKeyDown:d?this._onKeyDown:void 0,onClick:d?this._onClick:void 0,style:e},c),m.createElement(w.Provider,{value:u},n))},t.prototype.focus=function(){this._rootElement.current&&this._rootElement.current.focus()},t.defaultProps={type:k.normal},t.contextType=B._0,t}(m.Component),M=r(42815),W={root:"ms-DocumentCardPreview",icon:"ms-DocumentCardPreview-icon",iconContainer:"ms-DocumentCardPreview-iconContainer"},L={root:"ms-DocumentCardActivity",multiplePeople:"ms-DocumentCardActivity--multiplePeople",details:"ms-DocumentCardActivity-details",name:"ms-DocumentCardActivity-name",activity:"ms-DocumentCardActivity-activity",avatars:"ms-DocumentCardActivity-avatars",avatar:"ms-DocumentCardActivity-avatar"},F={root:"ms-DocumentCardTitle"},O={root:"ms-DocumentCardLocation"},j={root:"ms-DocumentCard",rootActionable:"ms-DocumentCard--actionable",rootCompact:"ms-DocumentCard--compact"},H=(0,T.I)(U,function(e){var t,r,o=e.className,n=e.theme,i=e.actionable,a=e.compact,s=n.palette,l=n.fonts,c=n.effects,d=(0,p.Km)(j,n);return{root:[d.root,{WebkitFontSmoothing:"antialiased",backgroundColor:s.white,border:"1px solid ".concat(s.neutralLight),maxWidth:"320px",minWidth:"206px",userSelect:"none",position:"relative",selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(M.Y2," &:focus, :host(.").concat(M.Y2,") &:focus")]=(0,p.Sq)(s.neutralSecondary,c.roundedCorner2),t[".".concat(O.root," + .").concat(F.root)]={paddingTop:"4px"},t)},i&&[d.rootActionable,{selectors:{":hover":{cursor:"pointer",borderColor:s.neutralTertiaryAlt},":hover:after":{content:'" "',position:"absolute",top:0,right:0,bottom:0,left:0,border:"1px solid ".concat(s.neutralTertiaryAlt),pointerEvents:"none"}}}],a&&[d.rootCompact,{display:"flex",maxWidth:"480px",height:"108px",selectors:(r={},r[".".concat(W.root)]={borderRight:"1px solid ".concat(s.neutralLight),borderBottom:0,maxHeight:"106px",maxWidth:"144px"},r[".".concat(W.icon)]={maxHeight:"32px",maxWidth:"32px"},r[".".concat(L.root)]={paddingBottom:"12px"},r[".".concat(F.root)]={paddingBottom:"12px 16px 8px 16px",fontSize:l.mediumPlus.fontSize,lineHeight:"16px"},r)}],o]}},void 0,{scope:"DocumentCard"}),V=r(72799),Z=r(44388),J=(0,q.Z)(),z=function(e){function t(t){var r=e.call(this,t)||this;return r._titleElement=m.createRef(),r._truncateTitle=function(){r._needMeasurement&&r._async.requestAnimationFrame(r._truncateWhenInAnimation)},r._truncateWhenInAnimation=function(){var e=r.props.title,t=r._titleElement.current;if(t){var o=getComputedStyle(t);if(o.width&&o.lineHeight&&o.height){var n=t.clientWidth,i=t.scrollWidth;r._clientWidth=n;var a=Math.floor((parseInt(o.height,10)+5)/parseInt(o.lineHeight,10));t.style.whiteSpace="";var s=i/(parseInt(o.width,10)*a);if(s>1){var p=e.length/s-3;return r.setState({truncatedTitleFirstPiece:e.slice(0,p/2),truncatedTitleSecondPiece:e.slice(e.length-p/2)})}}}},r._shrinkTitle=function(){var e=r.state,t=e.truncatedTitleFirstPiece,o=e.truncatedTitleSecondPiece;if(t&&o){var n=r._titleElement.current;if(!n)return;(n.scrollHeight>n.clientHeight+5||n.scrollWidth>n.clientWidth)&&r.setState({truncatedTitleFirstPiece:t.slice(0,t.length-1),truncatedTitleSecondPiece:o.slice(1)})}},(0,P.f)(r),r._async=new V.j(r),r._events=new Z.g(r),r._clientWidth=void 0,r.state={truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0},r}return(0,y.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this;if(this.props.title!==e.title&&this.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0}),e.shouldTruncate!==this.props.shouldTruncate){var r=(0,N.k_)(this.context);this.props.shouldTruncate?(this._truncateTitle(),this._async.requestAnimationFrame(this._shrinkTitle),this._events.on(r,"resize",this._updateTruncation)):this._events.off(r,"resize",this._updateTruncation)}else this._needMeasurement&&this._async.requestAnimationFrame(function(){t._truncateWhenInAnimation(),t._shrinkTitle()})},t.prototype.componentDidMount=function(){if(this.props.shouldTruncate){this._truncateTitle();var e=(0,N.k_)(this.context);this._events.on(e,"resize",this._updateTruncation)}},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype.render=function(){var e=this,t=this.props,r=t.title,o=t.shouldTruncate,n=t.showAsSecondaryTitle,i=t.styles,a=t.theme,s=t.className,p=this.state,l=p.truncatedTitleFirstPiece,c=p.truncatedTitleSecondPiece;return this._classNames=J(i,{theme:a,className:s,showAsSecondaryTitle:n}),o&&l&&c?m.createElement(w.Consumer,null,function(t){var o=t.role,n=t.tabIndex;return m.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:r,tabIndex:n,role:o},l,"\u2026",c)}):m.createElement(w.Consumer,null,function(t){var o=t.role,n=t.tabIndex;return m.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:r,tabIndex:n,role:o,style:e._needMeasurement?{whiteSpace:"nowrap"}:void 0},r)})},Object.defineProperty(t.prototype,"_needMeasurement",{get:function(){return!!this.props.shouldTruncate&&void 0===this._clientWidth},enumerable:!1,configurable:!0}),t.prototype._updateTruncation=function(){var e=this;this._timerId||(this._timerId=this._async.setTimeout(function(){delete e._timerId,e._clientWidth=void 0,e.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0})},250))},t.contextType=B._0,t}(m.Component),Y=(0,T.I)(z,function(e){var t,r=e.theme,o=e.className,n=e.showAsSecondaryTitle,i=r.palette,a=r.fonts,s=r.effects;return{root:[(0,p.Km)(F,r).root,n?a.medium:a.large,{padding:"8px 16px",display:"block",overflow:"hidden",position:"relative",wordWrap:"break-word",height:n?"45px":"38px",lineHeight:n?"18px":"21px",color:n?i.neutralSecondary:i.neutralPrimary,selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(M.Y2," &:focus, :host(.").concat(M.Y2,") &:focus")]=(0,p.Sq)(i.neutralSecondary,s.roundedCorner2),t)},o]}},void 0,{scope:"DocumentCardTitle"}),G=r(9011),X=r(72721),K=r(63485),$=r(11638);const Q="239px",ee=(0,s.J9)((e,t)=>{const r={addApproverDraft:[{borderRadius:"10px",".DraftTitle":{borderBottom:"1px solid lightgray",fontWeight:"bold",fontSize:"12px",width:Q,height:"20px",backgroundColor:"rgba(0,0,0,0)"},".DraftPerson":[{margin:"10px",width:Q}],".DraftButtonGroup":{marginBottom:"10px",width:Q}}],draftButton:{borderRadius:"5px",marginLeft:"10px","&.ms-Button--primary":[(0,a.jU)(e)],"&.ms-Button--default":[(0,a.i9)(e)]}};return(0,p.TW)(r,t)}),te=(0,s.J9)(e=>({addApproverDraft:(0,p.Zq)("addApproverDraft",e.addApproverDraft),draftButton:(0,p.Zq)("draftButton",e.draftButton)})),re="10px",oe="10px",ne="12px",ie=(0,s.J9)((e,t)=>{const r={titleSection:[(0,a.gS)(),(0,a.aS)(e),{".requiredMark":{color:(0,a.Qt)(e)},".labelTag":{marginRight:re,marginLeft:re}}],historySection:{marginTop:oe,marginBottom:oe},linkSection:[(0,a.NX)(e),(0,a.gS)(),{".addApproverText":[{textAlign:"start",marginLeft:"10px"}]}],retryButton:{"&.ms-Button--default":[(0,a.i9)(e)]},addApproverButton:[{"> button":[(0,a.BP)(e),(0,a.gS)(),{border:"none",background:"none",fontSize:p.s.medium,cursor:"pointer"}]}],approvalsSection:{margin:"".concat("20px"," 0px")}};return(0,p.TW)(r,t)}),ae=(0,s.J9)((e,t)=>{const r={root:[(0,a.aS)(e),(0,a.NX)(e),(0,a.au)(e),{".ms-DocumentCardTitle":(0,a.aS)(e),".ms-Persona-primaryText":(0,a.aS)(e),".ms-Persona-secondaryText":(0,a.aS)(e),width:"270px"}]};return(0,p.TW)(r,t)}),se=(0,s.J9)(e=>({primaryText:{fontSize:ne,fontWeight:500,":hover":[(0,a.aS)(e)]},secondaryText:{fontSize:ne}})),pe=(0,s.J9)((e,t)=>{const r={label:[{margin:"0px"}]};return(0,p.TW)(r,t)}),le=(0,s.J9)(e=>({titleSection:(0,p.Zq)("titleSection",e.titleSection),historySection:(0,p.Zq)("historySection",e.historySection),linkSection:(0,p.Zq)("linkSection",e.linkSection),retryButton:(0,p.Zq)("retryButton",e.retryButton),addApproverButton:(0,p.Zq)("addApproverButton",e.addApproverButton),approvalsSection:(0,p.Zq)("approvalsSection",e.approvalsSection)}));class ce extends n.${name(){return"AddApproverDraft"}renderComponent(){const e=this.getClassNames();return m.createElement(H,{styles:ae(this.props.theme),className:e.addApproverDraft},m.createElement(Y,{title:f.p.Strings.AddApprover_AddApproverDraft_SendApprovalRequestFor,className:"DraftTitle",styles:ae(this.props.theme)}),m.createElement(G.F,(0,o.A)((0,o.A)({className:"DraftPerson"},this.props.selectedPerson),{},{size:X.WH.size32,presence:X.As.online,styles:se(this.props.theme)})),m.createElement("div",{className:"DraftButtonGroup"},m.createElement(K.j,{styles:pe(this.props.theme),className:e.draftButton,onClick:this.props.onSendRequest},f.p.Strings.AddApprover_AddApproverDraft_SendRequest),m.createElement($.Y,{styles:pe(this.props.theme),className:e.draftButton,onClick:this.props.onDiscard},f.p.Strings.AddApprover_AddApproverDraft_Discard)))}getClassNames(){return te(ee(this.props.theme))}constructor(e,t){super(e,t),this.state={}}}var de,ue,ve=r(38752),he=r(78332),me=r(98571),Ae=r(67239),ge=r(40520),Ce=r(52342),fe=r(54845),Se=r(80493),_e=r(48770);!function(e){e.Approve="Approve",e.Reject="Reject"}(de||(de={})),function(e){e.NotSpecified="NotSpecified",e.Owner="Owner",e.Approver="Approver",e.DelegatedAccess="DelegatedAccess"}(ue||(ue={}));var xe=r(59846);const De="10px",ke=(0,s.J9)((e,t)=>{const r={approvalCardDetail:[{borderRadius:"10px",".infoSection":[(0,a.gS)(),{margin:"5px",justifyContent:"space-between"}],".StatusText":[(0,a.au)(e),{borderBottomWidth:"1px",borderBottomStyle:"solid",fontWeight:"bold",fontSize:"14px",height:"20px"}],".personStatus":{float:"left",marginLeft:De},".actionButtons":{marginTop:De,marginBottom:De,button:{marginLeft:De}}}],moreButton:[(0,a.NX)(e),{float:"right",marginRight:De}],dialog:[(0,a.aS)(e),{".ms-Dialog-main":{borderRadius:"10px"}}],dialogButton:{borderRadius:"5px","&.ms-Button--primary":[(0,a.jU)(e)],"&.ms-Button--default":[(0,a.i9)(e)]}};return(0,p.TW)(r,t)}),Te=(0,s.J9)(e=>({title:[(0,a.aS)(e),(0,a.NX)(e)],topButton:{".ms-Dialog-button":[(0,a.aS)(e),(0,a.NX)(e),{":hover":[(0,a.aS)(e),{backgroundColor:"transparent"}]}]},inner:[(0,a.aS)(e),(0,a.NX)(e)]})),ye=(0,s.J9)(e=>({approvalCardDetail:(0,p.Zq)("approvalCardDetail",e.approvalCardDetail),dialog:(0,p.Zq)("dialog",e.dialog),dialogButton:(0,p.Zq)("dialogButton",e.dialogButton),moreButton:(0,p.Zq)("moreButton",e.moreButton)}));class qe extends n.${name(){return"ApprovalCardDetail"}renderComponent(){var e;const t=this.getClassNames(),r={imageUrl:this.props.showCardInfo.imageUrl,imageInitials:this.props.showCardInfo.imageInitials,text:this.convertStatusText().personText,secondaryText:this.props.showCardInfo.showPeople};return m.createElement(H,{styles:ae(this.props.theme),className:t.approvalCardDetail},m.createElement(Y,{title:null!==(e=this.convertStatusText().titleText)&&void 0!==e?e:"",className:"StatusText"}),m.createElement("div",{className:"infoSection"},m.createElement(G.F,(0,o.A)((0,o.A)({className:"personStatus"},r),{},{size:X.WH.size40,styles:se(this.props.theme)})),m.createElement("div",{ref:this._moreChoiceRef},m.createElement(Ae.K,{className:t.moreButton,disabled:!this.props.enableMoreButtons,key:"more",iconProps:xe.XP,onClick:this.onTaskDialogMoreButtonClicked.bind(this),plannerTheme:this.props.theme}))),this.showApproverActions()?this.renderActionButtons():null,this.renderMoreOptionsContextMenu(),this.props.showCardInfo.status===_e.q.Requested?this.renderCancelDialog():this.props.showCardInfo.status===_e.q.Approved?this.renderClearDialog():null)}convertStatusText(){switch(this.props.showCardInfo.status){case _e.q.Requested:return{titleText:f.p.Strings.AddApprover_ApprovalCardDetail_StatusApprovalRequested,personText:f.p.Strings.AddApprover_ApprovalCardDetail_WaitingOn};case _e.q.Approved:return{titleText:f.p.Strings.AddApprover_ApprovalCardDetail_FinalStatusApproved,personText:f.p.Strings.AddApprover_ApprovalCardDetail_ApprovedBy};case _e.q.Rejected:case _e.q.Cancelled:case _e.q.UnknownFutureValue:default:return{titleText:f.p.Strings.AddApprover_AddApproverPicker_NAMark,personText:f.p.Strings.AddApprover_AddApproverPicker_NAMark}}}getClassNames(){return ye(ke(this.props.theme))}onTaskDialogMoreButtonClicked(e){this.setState(e=>(0,o.A)((0,o.A)({},e),{},{isDialogContextMenuOpen:!e.isDialogContextMenuOpen}))}renderMoreOptionsContextMenu(){if(!this.state.isDialogContextMenuOpen)return null;const e=[];switch(this.props.showCardInfo.status){case _e.q.Requested:e.push({key:"cancelRequest",name:f.p.Strings.AddApprover_ApprovalCardDetail_CancelRequest,title:f.p.Strings.AddApprover_ApprovalCardDetail_CancelRequest,iconProps:xe.s5,onClick:this.changeDialogCancelConfirmStatus.bind(this)}),this.props.userRole!==ue.Approver&&this.props.userRole!==ue.Owner||e.push({key:"viewInApp",name:f.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,title:f.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,iconProps:xe.M8,onClick:this.redirectToApprovalPage.bind(this)});break;case _e.q.Approved:e.push({key:"clearRequest",name:f.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,title:f.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,iconProps:xe.s5,onClick:this.changeDialogClearConfirmStatus.bind(this)}),this.props.userRole!==ue.Approver&&this.props.userRole!==ue.Owner||e.push({key:"viewInApp",name:f.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,title:f.p.Strings.AddApprover_ApprovalCardDetail_ViewInApprovalsApp,iconProps:xe.M8,onClick:this.redirectToApprovalPage.bind(this)});case _e.q.Rejected:case _e.q.Cancelled:case _e.q.UnknownFutureValue:}return m.createElement(me.l,{shouldFocusOnMount:!0,target:this._moreChoiceRef.current,onDismiss:this.onMoreContextMenuDismiss.bind(this),directionalHint:g.A.bottomLeftEdge,items:e,appTheme:this.props.theme})}renderCancelDialog(){const e={type:ge.h.normal,title:f.p.Strings.AddApprover_ApprovalCardDetail_CancelApprovalRequest,closeButtonAriaLabel:f.p.Strings.AddApprover_AddApproverPicker_CloseDialogAriaLabel,subText:f.p.Strings.AddApprover_ApprovalCardDetail_CancelApprovalRequestQuestion,styles:Te(this.props.theme)},t=this.getClassNames(),r={isBlocking:!0,className:t.dialog};return m.createElement(Ce.l,{hidden:!this.state.isDialogCancelConfirmOpen,onDismiss:this.changeDialogCancelConfirmStatus.bind(this),dialogContentProps:e,modalProps:r,minWidth:this.dialogWidth},m.createElement(fe.E,null,m.createElement(K.j,{onClick:this.onCancelApproval.bind(this),text:f.p.Strings.AddApprover_ApprovalCardDetail_YesCancel,className:t.dialogButton}),m.createElement($.Y,{onClick:this.changeDialogCancelConfirmStatus.bind(this),text:f.p.Strings.AddApprover_ApprovalCardDetail_Close,className:t.dialogButton})))}renderClearDialog(){const e={type:ge.h.normal,title:f.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequest,closeButtonAriaLabel:f.p.Strings.AddApprover_AddApproverPicker_CloseDialogAriaLabel,subText:f.p.Strings.AddApprover_ApprovalCardDetail_ClearApprovalRequestQuestion,styles:Te(this.props.theme)},t=this.getClassNames(),r={isBlocking:!0,className:t.dialog};return m.createElement(Ce.l,{hidden:!this.state.isDialogClearConfirmOpen,onDismiss:this.changeDialogClearConfirmStatus.bind(this),dialogContentProps:e,modalProps:r},m.createElement(fe.E,null,m.createElement(K.j,{onClick:this.onClearApproval.bind(this),text:f.p.Strings.AddApprover_ApprovalCardDetail_YesClear,className:t.dialogButton}),m.createElement($.Y,{onClick:this.changeDialogClearConfirmStatus.bind(this),text:f.p.Strings.AddApprover_ApprovalCardDetail_Close,className:t.dialogButton})))}renderActionButtons(){const e=this.getClassNames();return m.createElement("div",{className:"actionButtons"},m.createElement(K.j,{styles:pe(this.props.theme),onClick:this.onUpdateApproval.bind(this,de.Approve),text:f.p.Strings.AddApprover_ApprovalCardDetail_Approve,className:e.dialogButton}),m.createElement($.Y,{styles:pe(this.props.theme),onClick:this.onUpdateApproval.bind(this,de.Reject),text:f.p.Strings.AddApprover_ApprovalCardDetail_Reject,className:e.dialogButton}))}onMoreContextMenuDismiss(){this.setState({isDialogContextMenuOpen:!1})}changeDialogCancelConfirmStatus(){this.setState(e=>(0,o.A)((0,o.A)({},e),{},{isDialogCancelConfirmOpen:!e.isDialogCancelConfirmOpen}))}changeDialogClearConfirmStatus(){this.setState(e=>(0,o.A)((0,o.A)({},e),{},{isDialogClearConfirmOpen:!e.isDialogClearConfirmOpen}))}onCancelApproval(){this.props.onCancelApproval(),this.changeDialogCancelConfirmStatus()}onClearApproval(){this.props.onClearApproval(),this.changeDialogClearConfirmStatus()}onUpdateApproval(e){this.props.onUpdateApproval(e)}showApproverActions(){return this.props.showCardInfo.status===_e.q.Requested&&this.props.userRole===ue.Approver}redirectToApprovalPage(){const e="Default-".concat(ve.B.tenantId),t=this.props.approvalId,r=this.props.userRole,o="".concat(r,":").concat(t,":").concat("/providers/Microsoft.ProcessSimple/environments/approvalViews",":").concat(e),n=encodeURIComponent('{"subEntityId":"'.concat(o,'"}')),i="https://".concat(ve.B.clientSettings.TeamsSettings.TeamsHostName,"/l/entity/").concat(he.uc.ApprovalApp,"/approvals?context=").concat(n);Se.b.safelyOpenExternalUrl(i)}constructor(e,t){super(e,t),this.dialogWidth="600px",this._moreChoiceRef=m.createRef(),this.state={isDialogContextMenuOpen:!1,isDialogCancelConfirmOpen:!1,isDialogClearConfirmOpen:!1}}}var Re,Pe=r(69412),be=r(40135),Ie=r(31537),Be=r(20751),Ne=r(21382),Ee=r(44535),we=r(91834);!function(e){e[e.Loading=0]="Loading",e[e.RetryButton=1]="RetryButton",e[e.Link=2]="Link",e[e.AddApproverDraft=3]="AddApproverDraft",e[e.ApprovalCardDetail=4]="ApprovalCardDetail",e[e.UnknownError=5]="UnknownError"}(Re||(Re={}));class Ue extends n.${name(){return"ApprovalRequestSection"}renderComponent(){const e=this.getClassNames(),t=this.generateApprovalCardDetailCardInfo(),r=this.getApprovalCardType();return 0===r?m.createElement(be.W,null):m.createElement("div",{className:e.approvalsSection},m.createElement("div",{className:e.titleSection},m.createElement(Ie.J,null,f.p.Strings.AddApprover_ApprovalRequestSection_ApprovalRequest,this.renderTitleMark(),this.renderStatusTag())),1===r&&this.renderRetryButton(),this.renderHistorySection(),2===r&&this.renderLinkSection(),3===r&&m.createElement(ce,{theme:this.props.theme,selectedPerson:this.convertUserToApprovalPersona(this.props.selectedApprover),onDiscard:this.onDiscard,onSendRequest:this.onClickSendApprovalRequestButton}),4===r&&m.createElement(qe,{theme:this.props.theme,showCardInfo:t,approvalId:this.props.approvalInfo.approvalId,userRole:this.getUserRole(),onCancelApproval:this.onClickCancelApprovalRequestButton,onClearApproval:this.props.onClearApproval,onUpdateApproval:this.onClickUpdateApprovalRequestButton,enableMoreButtons:!this.props.isTaskCompleted}))}getApprovalCardType(){var e,t,r;return this.props.isApprovalDataLoading||(null===(e=this.props.approvalDetailInfo)||void 0===e?void 0:e.status)===we.ZB.Updating?0:this.props.approvalInfo?this.props.approvalDetailInfo?this.isApprovalDataValid()&&(null===(t=this.props.approvalInfo)||void 0===t?void 0:t.approvalStatus)!==_e.q.Rejected&&(null===(r=this.props.approvalInfo)||void 0===r?void 0:r.approvalStatus)!==_e.q.Cancelled?this.generateApprovalCardDetailCardInfo()?4:5:this.props.selectedApprover?3:2:1:this.props.selectedApprover?3:2}isApprovalDataValid(){return!(this.isApprovalError()||this.isApprovalDetailError()||!this.getApproverDisplayInfo())}isApprovalError(){var e,t;return!(null!==(e=this.props.approvalInfo)&&void 0!==e&&e.approvalId)||(null===(t=this.props.approvalInfo)||void 0===t?void 0:t.approvalStatus)===_e.q.UnknownFutureValue}isApprovalDetailError(){var e,t,r,o;return!(null!==(e=this.props.approvalDetailInfo)&&void 0!==e&&e.data)||(null===(t=this.props.approvalDetailInfo)||void 0===t?void 0:t.status)===we.ZB.DeleteFailed||(null===(r=this.props.approvalDetailInfo)||void 0===r?void 0:r.status)===we.ZB.Failed||(null===(o=this.props.approvalDetailInfo)||void 0===o?void 0:o.status)===we.ZB.Inaccessible}renderRetryButton(){return m.createElement("div",null,m.createElement(Ie.J,null,f.p.Strings.AddApprover_ApprovalRequestSection_ApprovalDetailAPIErrorMessage),m.createElement($.Y,{className:this.getClassNames().retryButton,text:f.p.Strings.AddApprover_ApprovalRequestSection_Retry,onClick:this.props.onReloadApprovalData}))}renderTitleMark(){var e;return(null===(e=this.props.approvalInfo)||void 0===e?void 0:e.approvalStatus)===_e.q.Approved?m.createElement(Be.I,xe.r8):m.createElement("text",{className:"requiredMark"},"*")}renderStatusTag(){var e;let t=1,r=f.p.Strings.AddApprover_ApprovalRequestSection_Required;if(null!==(e=this.props.approvalInfo)&&void 0!==e&&e.approvalId)switch(this.props.approvalInfo.approvalStatus){case _e.q.Requested:t=2,r=f.p.Strings.AddApprover_ApprovalRequestSection_Pending;break;case _e.q.Approved:t=3,r=f.p.Strings.AddApprover_ApprovalRequestSection_Approved;case _e.q.Cancelled:case _e.q.Rejected:case _e.q.UnknownFutureValue:}return m.createElement(Pe.l,{index:t,isCollapsed:!1,title:r,showBorder:!1,theme:this.props.theme})}renderHistorySection(){if(!this.isApprovalDataValid())return null;const e=this.convertStatusText();return m.createElement("div",{className:this.getClassNames().historySection},m.createElement("b",null,e.resultText),e.requestText)}renderLinkSection(){return m.createElement("div",{className:this.getClassNames().linkSection},!this.props.selectedApprover&&this.renderAddApproverLink(),this.state.isPickerVisible&&this.renderAddApproverPicker())}renderAddApproverLink(){return m.createElement("div",{ref:this._linkButtonRef,className:this.getClassNames().addApproverButton},m.createElement("button",{onClick:this.onClickAddApproverLink},m.createElement(Be.I,xe.D5),m.createElement("span",{className:"addApproverText"},f.p.Strings.AddApprover_AddApproverLink_AddAnApprover)))}renderAddApproverPicker(){return m.createElement(_,{theme:this.props.theme,peopleList:this.convertAssignees(),onSelectedPerson:this.onSelectedPerson,targetElement:this._linkButtonRef.current,onDismissPicker:this.onDismissApproverPicker})}generateApprovalCardDetailCardInfo(){var e;const t=this.getApproverDisplayInfo();if(null===(e=this.props.approvalInfo)||void 0===e||!e.approvalId||!t)return null;return{status:this.props.approvalInfo.approvalStatus,showPeople:t.approverName,imageUrl:t.approverImage,imageInitials:Ee.$.parseInitialsFromName(t.approverName)}}getApproverDisplayInfo(){var e,t,r,o;const n=null!==(e=null===(t=this.props.approvalDetailInfo)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.approvers)&&void 0!==e?e:[];if(0===n.length||null===n[0])return null;const i=this.getUserInPrincipals(n[0]);return i?{approverName:null!==(r=i.displayName)&&void 0!==r?r:"",approverImage:null!==(o=i.thumbnailPhoto)&&void 0!==o?o:""}:null}getUserInPrincipals(e){var t,r;return null!==(t=null===(r=this.props.approvalDetailInfo)||void 0===r||null===(r=r.data)||void 0===r||null===(r=r.principals)||void 0===r?void 0:r.find(t=>(null===t||void 0===t?void 0:t.id)===e))&&void 0!==t?t:null}convertStatusText(){var e,t,r,o,n,i;const a=this.getApproverDisplayInfo(),s=null===(e=this.props.approvalDetailInfo)||void 0===e?void 0:e.data,p=null!==(t=null===(r=this.getUserInPrincipals(null===s||void 0===s||null===(o=s.owner)||void 0===o?void 0:o.id))||void 0===r?void 0:r.displayName)&&void 0!==t?t:"",l=null!==(n=null===a||void 0===a?void 0:a.approverName)&&void 0!==n?n:"",c=new Date(s.creationDate),d=c.toLocaleDateString(),u=c.toLocaleTimeString(),v=new Date(s.completionDate),h=v.toLocaleDateString(),m=v.toLocaleTimeString();switch(null===(i=this.props.approvalInfo)||void 0===i?void 0:i.approvalStatus){case _e.q.Requested:return{resultText:"",requestText:Ne.G(f.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Requested,p,l,d,u)};case _e.q.Approved:return{resultText:Ne.G(f.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Approved,l,h,m),requestText:Ne.G(f.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,p,d,u)};case _e.q.Rejected:return{resultText:Ne.G(f.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Rejected,l,h,m),requestText:Ne.G(f.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,p,d,u)};case _e.q.Cancelled:return{resultText:Ne.G(f.p.Strings.AddApprover_ApprovalRequestSection_ResultText_Cancelled,p,h,m),requestText:Ne.G(f.p.Strings.AddApprover_ApprovalRequestSection_RequestText_Other,p,d,u)};case _e.q.UnknownFutureValue:default:return{resultText:f.p.Strings.AddApprover_ApprovalRequestSection_UnknownStatus_ErrorMessage,requestText:f.p.Strings.AddApprover_ApprovalRequestSection_UnknownStatus_ErrorMessage}}}convertAssignees(){return this.props.getAssigneePoolForApproval().map(e=>this.convertUserToApprovalPersona(e))}convertUserToApprovalPersona(e){const t=this.props.getUserPhoto(e.id);return{user:e,imageUrl:null==t?void 0:t,text:e.displayName}}getUserRole(){var e;const t=null===(e=this.props.approvalDetailInfo)||void 0===e?void 0:e.data,r=null===t||void 0===t?void 0:t.owner,o=null===t||void 0===t?void 0:t.approvers;return null!==o&&void 0!==o&&o.includes(this.props.currentUserId)?ue.Approver:(null===r||void 0===r?void 0:r.id)===this.props.currentUserId?ue.Owner:ue.NotSpecified}getClassNames(){return le(ie(this.props.theme))}constructor(e,t){super(e,t),this._linkButtonRef=m.createRef(),this.onSelectedPerson=e=>{this.props.onSelectApprover(e.length>0?e[0].user:null),this.setState({isPickerVisible:!1})},this.onClickSendApprovalRequestButton=()=>{this.props.onSendApprovalRequest()},this.onDiscard=()=>{this.props.onSelectApprover(null)},this.onClickUpdateApprovalRequestButton=e=>{this.props.onUpdateApproval(e)},this.onClickCancelApprovalRequestButton=()=>{this.props.onCancelApproval()},this.onClickAddApproverLink=()=>{this.setState(e=>(0,o.A)((0,o.A)({},e),{},{isPickerVisible:!e.isPickerVisible}))},this.onDismissApproverPicker=()=>{this.setState({isPickerVisible:!1})},this.state={isPickerVisible:!1}}}}}]);
//# sourceMappingURL=approvalrequestsection.808fd845.chunk.js.map