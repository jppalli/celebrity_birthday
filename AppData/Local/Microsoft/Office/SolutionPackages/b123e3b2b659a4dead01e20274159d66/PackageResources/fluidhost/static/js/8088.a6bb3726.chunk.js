"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[8088],{8088:(e,t,a)=>{a.d(t,{js:()=>r,FX:()=>c,am:()=>o});var s=a(18206),n=a(76899),i=a(47860);(0,s.sG)(async function(e,t,a,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:360;const o=await(0,s.fV)(t=>e.getToken(["user.read"],t),"".concat("Consumer"===e.identityType?"https://graph.microsoft.com/beta/":"","me/photos/").concat(i,"x").concat(i,"/$value"),a,"GetMyPhoto",t,void 0,{signal:n},s.XM);return 200===o.status?URL.createObjectURL(await o.blob()):o.status},function(e,t,a,s){return arguments.length>4&&void 0!==arguments[4]?arguments[4]:360});const o=(0,s.sG)(async function(e,t,a,i,o,r){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:96;const c=await(0,s.fV)(t=>e.getToken(["user.readbasic.all"],t),"users/".concat(t,"/photos/").concat(l,"x").concat(l,"/$value"),a,"GetUserPhoto",i,o,{signal:r},s.XM);if(200===c.status){if((0,n.Fr)()){const e=new FileReader,a=new Promise(t=>{e.onloadend=function(){t(e.result)}});return e.readAsDataURL(await c.blob()),{userPrincipalName:t,pictureUrl:await a}}return{userPrincipalName:t,pictureUrl:URL.createObjectURL(await c.blob())}}return c.status},(e,t,a,s,n,i)=>"".concat(t,",").concat(i));const r=(0,s.sG)(async(e,t,a)=>{if("Consumer"===e.identityType)return 404;const n=await(0,s.fV)(t=>e.getToken(["user.read"],t),"organization?$select=displayName",t,"GetMyCompanyName",a,void 0,void 0,s.XM);if(200===n.status){var i;const e=await n.json(),t=null===e||void 0===e||null===(i=e.value)||void 0===i||null===(i=i[0])||void 0===i?void 0:i.displayName;if(t)return t}return n.status},()=>"_");(0,s.sG)(async(e,t,a,n,i,o)=>{const r=await(0,s.fV)(t=>e.getToken(["user.readbasic.all"],t),"users/".concat(encodeURIComponent(t),"?$select=id,displayName,mail,userPrincipalName,userType"),a,"GetUserDetails",n,i,{signal:o},s.XM);if(200===r.status){const{id:e,displayName:t,mail:a,userPrincipalName:s,userType:n}=await r.json();return{id:e,userPrincipalName:s,displayName:t,mail:a,userType:n}}return r.status},(e,t)=>t);let l;function c(e,t,a){return l||(l=(0,s.fV)(t=>e.getToken(["files.read"],t),"me/drive?select=owner,id,sharepointIds",a,"GetMyDrive",t,void 0,void 0,s.XM).then(async e=>{var t,a;if(!e.ok)return void(l=void 0);const s=await e.json();if(!s.sharePointIds||!s.id)throw new Error("Unexpected response: missing drive info");return{url:s.sharePointIds.siteUrl,title:null!==(t=null===(a=s.owner.user)||void 0===a?void 0:a.displayName)&&void 0!==t?t:"",driveId:s.id,groupId:"",bannerImageUrl:"",id:s.sharePointIds.siteId}}).catch(e=>{throw l=void 0,e}),l)}(0,s.sG)(async(e,t,a,n)=>{if("Enterprise"!==t.identityType)return"";const i=await(0,s.fV)(e=>t.getToken(["user.readbasic.all"],e),"users/".concat(e,"?$select=givenName"),a,"GetUserGivenName",n,void 0,void 0,s.XM);if(200===i.status){const{givenName:e}=await i.json();if(e)return e}return i.status},e=>e),(0,s.sG)(async(e,t,a,n)=>{const o=["?$select=assignedLabels,displayName,mail","photo/$value"].map((t,a)=>({id:"request_".concat(a),method:"GET",url:"groups/".concat(e,"/").concat(t),headers:{"Content-Type":"application/json"}})),r=await async function(e,t,a,n,o,r,l){let c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8?arguments[8]:void 0;const d="".concat((0,i.o)(a),"/v1.0/$batch"),p=[];for(let i=0;i<e.length;i+=20){const v=e.slice(i,i+20),m={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requests:v})},f=await(0,s.fV)(t,d,a,n,o,r,m,l,c,u);if(!f.ok)throw new Error("Batch request failed with status code ".concat(f.status,"."));const h=await f.json();p.push(...h.responses)}return p}(o,e=>t.getToken(["Group.Read.All"],e),a,"GetGroupDetails",n,void 0,s.XM,0,void 0),l=new Map(r.map(e=>[e.id,e])),c=l.get("request_0"),u=l.get("request_1");let d,p,v,m;if(200!==(null===c||void 0===c?void 0:c.status))return null===c||void 0===c?void 0:c.status;{const e=c.body;d=e.displayName,p=e.assignedLabels,v=e.mail}if(200===(null===u||void 0===u?void 0:u.status)){const e=u.body;m="data:image/png;base64,".concat(e)}return{displayName:d,assignedLabels:p,mail:v,photoUrl:m}},e=>e),(0,s.sG)(async(e,t,a,n)=>{const i=await(0,s.fV)(e=>t.getToken(["Group.Read.All"],e),"/groups?$select=displayName&$filter=startswith(mail, '".concat(encodeURIComponent(e),"')"),a,"GetGroupDetailsFromMail",n,void 0,void 0,s.XM);if(200===i.status){const e=(await i.json()).value;if(e.length>0){return e[0]}return}return i.status},e=>e)}}]);
//# sourceMappingURL=8088.a6bb3726.chunk.js.map