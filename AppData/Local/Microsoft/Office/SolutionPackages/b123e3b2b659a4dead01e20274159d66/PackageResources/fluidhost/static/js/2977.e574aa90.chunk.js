"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[2977],{959:(e,n,t)=>{function r(e){return{disallowServiceTelemetry:e.disallowServiceTelemetry,hostSessionId:e.hostSessionId,hostCorrelationId:e.hostCorrelationId,scenarioStartTime:e.scenarioStartTime}}function o(e){return new i(e.disallowServiceTelemetry,e.hostCorrelationId,e.hostSessionId,e.scenarioStartTime)}t.d(n,{G:()=>r,X:()=>o});var i=function(){function e(e,n,t,r){this.disallowServiceTelemetry=e,this.hostCorrelationId=n,this.hostSessionId=t,this.scenarioStartTime=r}return Object.defineProperty(e.prototype,"TelemetryConfig",{get:function(){return this},enumerable:!1,configurable:!0}),e}()},2977:(e,n,t)=>{t.d(n,{C:()=>l});var r=t(51870),o=t(64726),i=t(55656),a=t(90773),s=t(959),u=t(48153),c=t(34537);function l(e,n){var t=new r.t(n),l={};return e.tokenProvider&&(l.tokenProvider=(0,o.N)(e.tokenProvider,t)),e.userContext&&(l.userContext=(0,i.X)(e.userContext)),e.odspFileInfo&&(l.odspFileInfo=e.odspFileInfo),e.whiteboardMessageProvider&&(l.whiteboardMessageProvider=(0,a.q)(e.whiteboardMessageProvider,t)),e.whiteboardConfiguration&&(l.whiteboardConfiguration=e.whiteboardConfiguration),e.telemetryConfig&&(l.telemetryConfig=(0,s.G)(e.telemetryConfig)),e.internationalizationContext&&(l.internationalizationContext=(0,u.E)(e.internationalizationContext)),e.hostCapabilitiesProvider&&(l.hostCapabilitiesProvider=(0,c.m)(e.hostCapabilitiesProvider,t)),l}},34537:(e,n,t)=>{t.d(n,{l:()=>c,m:()=>u});var r=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(n){i(n)}}function s(e){try{u(r.throw(e))}catch(n){i(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,s)}u((r=r.apply(e,n||[])).next())})},o=function(e,n){var t,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(u){s=[6,u],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i="convert_board_data",a="on_whiteboard_load_start",s="view_converted_board_items";function u(e,n){var t=this;return e.onWhiteboardLoadStart&&n.setHandlerForSubchannel(a,function(){return r(t,void 0,void 0,function(){var n;return o(this,function(t){return[2,null===(n=e.onWhiteboardLoadStart)||void 0===n?void 0:n.call(e)]})})}),e.convertBoardItems&&n.setHandlerForSubchannel(i,function(n){return r(t,void 0,void 0,function(){var t,r;return o(this,function(o){return t=n,[2,null===(r=e.convertBoardItems)||void 0===r?void 0:r.call(e,t.boardData)]})})}),e.viewConvertedBoardItems&&n.setHandlerForSubchannel(s,function(){return r(t,void 0,void 0,function(){var n;return o(this,function(t){return[2,null===(n=e.viewConvertedBoardItems)||void 0===n?void 0:n.call(e)]})})}),{}}function c(e){return new l(e)}var l=function(){function e(e){this.messageResponseCoordinator=e}return e.prototype.onWhiteboardLoadStart=function(){return Promise.resolve(this.messageResponseCoordinator.sendMessageToSubchannel(a,{}))},e.prototype.convertBoardItems=function(e){var n={boardData:e};return Promise.resolve(this.messageResponseCoordinator.sendMessageToSubchannel(i,n))},e.prototype.viewConvertedBoardItems=function(){return Promise.resolve(this.messageResponseCoordinator.sendMessageToSubchannel(s,{}))},Object.defineProperty(e.prototype,"HostCapabilitiesProvider",{get:function(){return this},enumerable:!1,configurable:!0}),e}()},48153:(e,n,t)=>{function r(e){return{uiLocale:e.uiLocale,defaultContentDirection:e.defaultContentDirection}}function o(e){return new i(e.uiLocale,e.defaultContentDirection)}t.d(n,{E:()=>r,x:()=>o});var i=function(){function e(e,n){this.uiLocale=e,this.defaultContentDirection=n}return Object.defineProperty(e.prototype,"InternationalizationContext",{get:function(){return this},enumerable:!1,configurable:!0}),e}()},51870:(e,n,t)=>{t.d(n,{d:()=>o,t:()=>r});var r=function(){function e(e){var n=this;this.subchannelHandlers=new Map,e.setOnMessageReceived(function(t){if(t.subchannel){var r=n.subchannelHandlers.get(t.subchannel);r?r(t.data).then(function(n){e.send({type:"success",sequenceNum:t.sequenceNum,data:n})}).catch(function(n){e.send({type:"failure",sequenceNum:t.sequenceNum,message:n.message})}):e.send({type:"failure",sequenceNum:t.sequenceNum,message:"subchannel ".concat(t.subchannel," does not exist")})}})}return e.prototype.setHandlerForSubchannel=function(e,n){this.subchannelHandlers.set(e,n)},e}(),o=function(){function e(e){var n=this;this.messageChannel=e,this.sequenceNumber=1,this.openPromises=new Map,e.setOnMessageReceived(function(e){if(e.sequenceNum){var t=n.openPromises.get(e.sequenceNum);if(!t)throw new Error("unexpectedly couldn't find sequence number");switch(n.openPromises.delete(e.sequenceNum),e.type){case"success":t.resolve(e.data);break;case"failure":t.reject(new Error(e.message))}}})}return e.prototype.sendMessageToSubchannel=function(e,n){var t=this,r=this.sequenceNumber;return this.sequenceNumber+=1,this.messageChannel.send({sequenceNum:r,subchannel:e,data:n}),new Promise(function(e,n){t.openPromises.set(r,{resolve:e,reject:n})})},e}()},55656:(e,n,t)=>{function r(e){return{user:e.user,displayName:e.displayName}}function o(e){return new i(e.user,e.displayName)}t.d(n,{W:()=>o,X:()=>r});var i=function(){function e(e,n){this.user=e,this.displayName=n}return Object.defineProperty(e.prototype,"UserContext",{get:function(){return this},enumerable:!1,configurable:!0}),e}()},64726:(e,n,t)=>{t.d(n,{N:()=>a,e:()=>s});var r=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(n){i(n)}}function s(e){try{u(r.throw(e))}catch(n){i(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,s)}u((r=r.apply(e,n||[])).next())})},o=function(e,n){var t,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(u){s=[6,u],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i="token_request";function a(e,n){var t=this;return n.setHandlerForSubchannel(i,function(n){return r(t,void 0,void 0,function(){var t;return o(this,function(r){return t=n,[2,e.getToken(t.scopes,t.options)]})})}),{identityType:e.identityType}}function s(e,n){return new u(e.identityType,n)}var u=function(){function e(e,n){this.identityType=e,this.messageResponseCoordinator=n}return e.prototype.getToken=function(e,n){var t={scopes:e,options:n};return this.messageResponseCoordinator.sendMessageToSubchannel(i,t)},Object.defineProperty(e.prototype,"TokenProvider",{get:function(){return this},enumerable:!1,configurable:!0}),e}()},90773:(e,n,t)=>{t.d(n,{q:()=>a,t:()=>s});var r=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(n){i(n)}}function s(e){try{u(r.throw(e))}catch(n){i(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,s)}u((r=r.apply(e,n||[])).next())})},o=function(e,n){var t,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(u){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(u){s=[6,u],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},i="whiteboard_message_request";function a(e,n){var t=this;return n.setHandlerForSubchannel(i,function(n){return r(t,void 0,void 0,function(){var t;return o(this,function(r){return t=n,[2,e.queryResponseHandler(t.response)]})})}),{}}function s(e){return new u(e)}var u=function(){function e(e){this.messageResponseCoordinator=e}return e.prototype.queryResponseHandler=function(e){var n={response:e};return Promise.resolve(this.messageResponseCoordinator.sendMessageToSubchannel(i,n))},Object.defineProperty(e.prototype,"WhiteboardMessageProvider",{get:function(){return this},enumerable:!1,configurable:!0}),e}()}}]);
//# sourceMappingURL=2977.e574aa90.chunk.js.map