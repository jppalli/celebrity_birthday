const kOverlayId="overwolf-sub-overlay",kModalId="ow-subs-modal",kIframeId="ow-subs-iframe",kLoginIframeId="ow-login-iframe",kChangeThemeMessage="change-theme",kDefaultThemeName="Light",kOVerlayStyle="width: 100%;height: 100%;background: black;opacity: 0.8;position: fixed;top: 0;left: 0; z-index: 2147483647!important;",kModalStyle="width: 1032px;height: 633px;position: fixed;top: 0;right: 0;bottom: 0;left: 0;margin: auto; z-index: 2147483647!important;",kIframeStyle="width: 100%;height: 100%;border: 0;",kUnpackedIframePrefix="/dist/",kOpkIframePrefix="/",IframeMessage={Close:"ow-subs-close-iframe",BringToFront:"ow-subs-bring-to-front"};window.overwolf.profile.subscriptions.inapp={show:async(e,o="Light",n=!0)=>{if(handleShowArgErrors(e,o))return;const i=await getAppId();if(!i)return void console.error("Failed to get app manifest");let r=document.querySelector(`#${kIframeId}`);if(r)return void console.log("overwolfSubscription iframe already exists");const t=document.body.style.zoom;r=createIframe(`overwolf-extension://ojgnfnbjckbpfaciphphehonokbggjhpnnoafack/react/in-app-subscription.html?appId=${i}&planId=${e}&theme=${o}&zoom=${t}`);const p=createModal(r),s=n?window.overwolf.profile.subscriptions.inapp.hide:()=>{},a=createOverlay(s);document.body.append(a),document.body.append(p),window.overwolf.profile.subscriptions.inapp.onInAppSubModalOpened.trigger()},hide:()=>{hideWindow(window.overwolf.profile.subscriptions.inapp.onInAppSubModalClosed.trigger)},changeTheme:e=>{if(!e)return;const o=document.querySelector(`#${kIframeId}`);o&&o.contentWindow.postMessage({text:"change-theme",theme:e},"*")},onInAppSubModalOpened:{listeners:[],addListener:e=>{window.overwolf.profile.subscriptions.inapp.onInAppSubModalOpened.listeners.push(e)},removeListener:e=>{const o=window.overwolf.profile.subscriptions.inapp.onInAppSubModalOpened.listeners,n=o.indexOf(e);n>=0&&o.splice(n,1)},trigger:()=>{window.overwolf.profile.subscriptions.inapp.onInAppSubModalOpened.listeners.forEach(e=>e())}},onInAppSubModalClosed:{listeners:[],addListener:e=>{window.overwolf.profile.subscriptions.inapp.onInAppSubModalClosed.listeners.push(e)},removeListener:e=>{const o=window.overwolf.profile.subscriptions.inapp.onInAppSubModalClosed.listeners,n=o.indexOf(e);n>=0&&o.splice(n,1)},trigger:()=>{window.overwolf.profile.subscriptions.inapp.onInAppSubModalClosed.listeners.forEach(e=>e())}},enums:{Theme:{Light:"Light",Dark:"Dark"}}},window.overwolf.profile.login={},window.overwolf.profile.login.inapp={onInAppLoginModalClosed:{listeners:[],addListener:e=>{window.overwolf.profile.login.inapp.onInAppLoginModalClosed.listeners.push(e)},removeListener:e=>{const o=window.overwolf.profile.login.inapp.onInAppLoginModalClosed.listeners,n=o.indexOf(e);n>=0&&o.splice(n,1)},trigger:()=>{window.overwolf.profile.login.inapp.onInAppLoginModalClosed.listeners.forEach(e=>e())}},onInAppLoginModalOpened:{listeners:[],addListener:e=>{window.overwolf.profile.login.inapp.onInAppLoginModalOpened.listeners.push(e)},removeListener:e=>{const o=window.overwolf.profile.login.inapp.onInAppLoginModalOpened.listeners,n=o.indexOf(e);n>=0&&o.splice(n,1)},trigger:()=>{window.overwolf.profile.login.inapp.onInAppLoginModalOpened.listeners.forEach(e=>e())}},showLogin:async(e="Light",o=!0)=>{let n=document.querySelector("#ow-login-iframe");if(n)return void console.log("overwolfSubscription iframe already exists");const i=document.body.style.zoom;n=createIframe(`overwolf-extension://ojgnfnbjckbpfaciphphehonokbggjhpnnoafack/react/in-app-login.html?theme=${e}&zoom=${i}`);const r=createModal(n),t=o?window.overwolf.profile.login.inapp.hide:()=>{},p=createOverlay(t);document.body.append(p),document.body.append(r),window.overwolf.profile.login.inapp.onInAppLoginModalOpened.trigger()},hide:()=>{hideWindow(window.overwolf.profile.login.inapp.onInAppLoginModalClosed.trigger)}};const hideWindow=e=>{const o=document.querySelector(`#${kOverlayId}`);o&&o.remove();const n=document.querySelector(`#${kModalId}`);n&&n.remove(),e()},getAppId=()=>new Promise(e=>{overwolf.extensions.current.getManifest(o=>{o.success||e(null),e(o.UID)})}),handleMessage=e=>{switch(e.data.type){case IframeMessage.Close:hideIframeByName(e.data.iframeId);break;case IframeMessage.BringToFront:overwolf.windows.getCurrentWindow(e=>{e.window&&window.overwolf.windows.BringToFront(e.window.name)})}},hideIframeByName=e=>{"ow-subs-iframe"===e?window.overwolf.profile.subscriptions.inapp.hide():"ow-login-iframe"===e&&window.overwolf.profile.login.inapp.hide()},handleShowArgErrors=(e,o)=>{const n="overwolf.profile.subscriptions.inapp.show";if(!e)throw new Error(`The function |${n}| requires 1 mandatory parameters and 1 optional parameters: int planId, optional Theme theme. 0 parameters passed.`);if(isNaN(e))throw new Error(`|${n}| Wrong parameter type in position 1. Should be int.`);if(console.log(o),o&&"string"==typeof o){const e=window.overwolf.profile.subscriptions.inapp.enums.Theme;if(!Object.keys(e).map(e=>e.toUpperCase()).includes(o.toUpperCase()))throw new Error(`|${n}| Wrong parameter type in position 2. Should be Theme.`)}return!1},createOverlay=e=>{const o=document.createElement("div");return o.id=kOverlayId,o.style=kOVerlayStyle,o.addEventListener("click",e),o},createModal=e=>{const o=document.createElement("div");return o.id=kModalId,o.style=kModalStyle,o.append(e),o},createIframe=e=>{const o=document.createElement("iframe");return o.id=kIframeId,o.style=kIframeStyle,o.src=e,o};window.addEventListener("message",handleMessage);