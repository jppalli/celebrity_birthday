"use strict";(self.webpackChunkredlauncher_frontend=self.webpackChunkredlauncher_frontend||[]).push([[86],{2513:(F,M,o)=>{o.d(M,{k:()=>p});var r=o(9359),h=o(7716);let p=(()=>{class l{constructor(){this.toastDataSubject=new r.x,this.toastData$=this.toastDataSubject.asObservable()}open(d){this.toastDataSubject.next(d)}}return l.\u0275fac=function(d){return new(d||l)},l.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},2247:(F,M,o)=>{o.d(M,{p:()=>r});var r=(()=>{return(h=r||(r={})).Warning="warning",h.Error="error",r;var h})()},8147:(F,M,o)=>{o.d(M,{n:()=>L});var r=o(3815),p=o(4121),l=o(6466),c=o(5114),d=o(9877),D=o(9210),e=o(2247),t=o(7716),v=o(2513);let L=(()=>{class _{constructor(u,P,C){this.toastService=u,this.gameDetection=P,this.nativeFrontendCommunication=C,this.listOfLaunchedGames=[],this.listOfLaunchedGamesSubject=new p.X(this.listOfLaunchedGames),this.listOfLaunchedGames$=this.listOfLaunchedGamesSubject.asObservable().pipe((0,l.d)(1)),this.nativeFrontendCommunication.register(c.l9.Game,c.lL.LaunchFailed,(b,n)=>{const m=this.gameDetection.getLauncherPlatform();this.toastService.open({messageSlug:"game__lunch_error_message",slugParams:{platform:(0,r.capitalize)(m)},type:e.p.Error}),this.remove({platform:b,gameId:n})})}ngOnDestroy(){this.nativeFrontendCommunication.unregister(c.l9.Game,c.lL.LaunchFailed)}add(u){this.listOfLaunchedGames.push(u),this.listOfLaunchedGamesSubject.next(this.listOfLaunchedGames)}remove(u){this.listOfLaunchedGames=this.listOfLaunchedGames.filter(P=>!(0,r.isEqual)(P,u)),this.listOfLaunchedGamesSubject.next(this.listOfLaunchedGames)}}return _.\u0275fac=function(u){return new(u||_)(t.LFG(v.k),t.LFG(D.H),t.LFG(d.W))},_.\u0275prov=t.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},3185:(F,M,o)=>{o.d(M,{w:()=>f});var r=o(4121),h=o(9359),p=o(5696),l=o(7969),c=o(1927),d=o(3815),e=o(9877),t=o(5114),v=o(1843),L=o(4621),_=o(7716);let f=(()=>{class u{constructor(C,b,n){this.nativeFrontendCommunication=C,this.redLogger=b,this.metrics=n,this.redModDeployFailedSubject=new r.X(null),this.redModsDeploySucceededSubject=new h.x,this.redModDeployFailed$=this.redModDeployFailedSubject.asObservable(),this.redModDeploySucceeded$=this.redModsDeploySucceededSubject.asObservable(),this.isRedModDeployInProgressSubject=new r.X(!1),this.isRedModDeployInProgress$=this.isRedModDeployInProgressSubject.asObservable(),this.deploymentPercentageSubject=new r.X(0),this.deploymentPercentage$=this.deploymentPercentageSubject.asObservable(),this.isRedModEnabled$=(0,p.a)([this.nativeFrontendCommunication.getRegisteredObservable(t.l9.Game,t.lp.IsRedModsEnabled),this.redModDeployFailed$]).pipe((0,l.U)(([m,x])=>(0,d.isNull)(m)?null:!x&&m)),this.isRedModAvailable$=this.isRedModEnabled$.pipe((0,l.U)(m=>!(0,d.isNull)(m)),(0,c.O)(!1)),this.nativeFrontendCommunication.register(t.l9.Game,t.lL.RedModsDeployStarted,()=>{this.nativeFrontendCommunication.register(t.l9.Game,t.lL.RedModsDeployProgress,m=>{(0,d.isNumber)(m)?this.deploymentPercentageSubject.next(m):this.redLogger.error("Native returned not a number as deployment percentage")}),this.redModDeployFailedSubject.next(null),this.isRedModDeployInProgressSubject.next(!0)}),this.nativeFrontendCommunication.register(t.l9.Game,t.lL.RedModsDeploySucceeded,()=>{this.nativeFrontendCommunication.unregister(t.l9.Game,t.lL.RedModsDeployProgress),this.deploymentPercentageSubject.next(100),this.redModDeployFailedSubject.next(null),this.redModsDeploySucceededSubject.next(null),this.isRedModDeployInProgressSubject.next(!1)}),this.nativeFrontendCommunication.register(t.l9.Game,t.lL.RedModsDeployFailed,m=>{this.nativeFrontendCommunication.unregister(t.l9.Game,t.lL.RedModsDeployProgress),this.redModDeployFailedSubject.next(m),this.isRedModDeployInProgressSubject.next(!1),this.metrics.modsDeploymentFailed(m)})}setRedModEnabledStatus(C){this.isRedModDeployInProgressSubject.getValue()&&!C&&this.nativeFrontendCommunication.call(t.l9.Game,t.Lc.AbortRedModDeploy),this.nativeFrontendCommunication.call(t.l9.Game,t.Lc.SetRedModsEnabled,C)}}return u.\u0275fac=function(C){return new(C||u)(_.LFG(e.W),_.LFG(v.l),_.LFG(L.K))},u.\u0275prov=_.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},2946:(F,M,o)=>{o.d(M,{b:()=>B});var r=o(5696),h=o(9593),p=o(7969),l=o(5598),c=o(4970),d=o(3815),D=o(3185),e=o(7716),t=o(8583),v=o(2096);const L=function(s){return{width:s}};var f=(()=>{return(s=f||(f={})).Progress="progress",s.Error="error",s.Complete="complete",s.Idle="idle",f;var s})();let u=(()=>{class s{constructor(){this.modifier=null,this.seleniumId="launcherProgressBar"}}return s.\u0275fac=function(a){return new(a||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["launcher-progress-bar"]],inputs:{percentage:"percentage",modifier:"modifier"},decls:8,vars:8,consts:[[1,"launcher-progress-bar__info"],[1,"launcher-progress-bar__title"],[1,"launcher-progress-bar__percentage"],[1,"launcher-progress-bar"],[1,"launcher-progress-bar__filling",3,"ngClass","ngStyle"]],template:function(a,i){1&a&&(e.TgZ(0,"div",0),e.TgZ(1,"span",1),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.TgZ(4,"span",2),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"div",3),e._UZ(7,"div",4),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,4,"progress")," "),e.xp6(3),e.hij(" ",i.percentage+"%"," "),e.xp6(2),e.Q6J("ngClass","launcher-progress-bar__filling--"+i.modifier)("ngStyle",e.VKq(6,L,i.percentage+"%")))},directives:[t.mk,t.PC],pipes:[v.Ot],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.launcher-progress-bar__info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px;width:100%;height:24px;font-size:16px;font-weight:700}.launcher-progress-bar__percentage[_ngcontent-%COMP%]{font-weight:400}.launcher-progress-bar[_ngcontent-%COMP%]{border-radius:4px;width:100%;height:4px;background-color:#f2f2f21a}.launcher-progress-bar__filling[_ngcontent-%COMP%]{border-radius:4px;height:4px;background-color:#fcee09;transition:width .5s;transition-timing-function:ease}.launcher-progress-bar__filling--error[_ngcontent-%COMP%]{background-color:#ff5e51}.launcher-progress-bar__filling--complete[_ngcontent-%COMP%]{background-color:#43f8c0}.launcher-progress-bar__filling--idle[_ngcontent-%COMP%]{background-color:#f2f2f266}"],changeDetection:0}),s})();var P=o(9877),C=o(9210),b=o(8147),n=o(5114),m=o(5029),x=o(3304);function R(s,y){1&s&&e._UZ(0,"div",9)}function I(s,y){if(1&s){const a=e.EpF();e.TgZ(0,"flat-button",10),e.NdJ("galaxyClick",function(){return e.CHM(a),e.oxw().openLogs()}),e.TgZ(1,"span",11),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.qZA()}2&s&&(e.uIk("selenium-id","seeLogs"),e.xp6(2),e.hij(" ",e.lcZ(3,2,"see_logs")," "))}function T(s,y){1&s&&(e.TgZ(0,"span",12),e._uU(1),e.ALo(2,"transloco"),e.qZA()),2&s&&(e.uIk("selenium-id","launchingText"),e.xp6(1),e.hij(" ",e.lcZ(2,2,"launching_game")," "))}function A(s,y){if(1&s){const a=e.EpF();e.TgZ(0,"flat-button",13),e.NdJ("galaxyClick",function(){return e.CHM(a),e.oxw().retryDeploy()}),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e.qZA()}2&s&&(e.uIk("selenium-id","retryDeployMods"),e.xp6(2),e.Oqu(e.lcZ(3,2,"retry")))}var O=(()=>{return(s=O||(O={})).InProgress="red_mod__modal_deploy",s.Success="complete",O;var s})();let B=(()=>{class s{constructor(a,i,S,Z){this.redModService=a,this.gameMonitor=i,this.gameDetection=S,this.nativeFrontendCommunication=Z,this.statusSlug=O.InProgress,this.shouldShowLaunchingText=!1,this.percentage$=this.redModService.deploymentPercentage$,this.redModDeploymentFailed$=this.redModService.redModDeployFailed$.pipe((0,p.U)(g=>!((0,d.isNull)(g)||g===n.oF.RedModAborted))),this.shouldDisablePlayWithoutMods$=(0,r.a)([this.redModService.isRedModDeployInProgress$,this.redModDeploymentFailed$,this.gameMonitor.listOfLaunchedGames$.pipe((0,p.U)(g=>g.some(E=>(0,d.isEqual)(E,this.gameInstance))))]).pipe((0,p.U)(([g,E,G])=>G||!g&&!E)),this.subscription=new h.w0,this.RedModeErrorCodeToSlugMap={[n.oF.RedModCrashed]:"error__red_mod_crashed",[n.oF.RedModAborted]:"error__red_mod_aborted",[n.oF.BadGameRoot]:"error__bad_game_root",[n.oF.InvalidOptions]:"error__invalid_options",[n.oF.MissingBaseScriptFiles]:"error__missing_base_script_files",[n.oF.MissingBaseTweakFiles]:"error__missing_base_tweak_files",[n.oF.ConflictingScriptMods]:"error__conflicting_script_mods",[n.oF.ConflictingTweakMods]:"error__conflicting_tweak_mods",[n.oF.FailedToLoadScriptFileContent]:"error__failed_to_load_script_file_content",[n.oF.ScriptCompilationFailed]:"error__script_compilation_failed",[n.oF.TweakCompilationFailed]:"error__tweak_compilation_failed",[n.oF.ScriptBlobSaveFailed]:"error__script_blob_save_failed",[n.oF.TweakBaseBlobNotFound]:"error__tweak_base_blob_not_found",[n.oF.CustomSoundHasInvalidName]:"error__custom_sound_has_invalid_name",[n.oF.CustomSoundNoFileSpecified]:"error__custom_sound_no_file_specified",[n.oF.CustomSoundFileNotFound]:"error__custom_sound_file_not_found",[n.oF.CustomSoundFileCannotBeRead]:"error__custom_sound_file_cannot_be_read",[n.oF.CustomSoundInvalidFileFormat]:"error__custom_sound_invalid_file_format",[n.oF.FailedToSaveModsConfig]:"error__failed_to_save_mods_config",[n.oF.Unknown]:"error__unknown"},(0,r.a)([this.gameDetection.launcherGame$,this.gameDetection.launcherPlatform$]).pipe((0,l.q)(1)).subscribe(([g,E])=>this.gameInstance={platform:E,gameId:g}),this.subscription.add(this.redModService.redModDeploySucceeded$.subscribe(()=>{this.progressBarModifier=f.Complete,this.shouldShowLaunchingText=!0,this.statusSlug=O.Success,this.startGame()})),this.subscription.add(this.redModService.redModDeployFailed$.pipe((0,c.h)(g=>!(0,d.isNull)(g))).subscribe(g=>{this.progressBarModifier=g===n.oF.RedModAborted?f.Idle:f.Error,this.statusSlug=this.RedModeErrorCodeToSlugMap[g]}))}playWithoutMods(){this.shouldShowLaunchingText=!0,this.redModService.setRedModEnabledStatus(!1),this.startGame()}retryDeploy(){this.statusSlug=O.InProgress,this.progressBarModifier=f.Progress,this.redModService.setRedModEnabledStatus(!0)}openLogs(){this.nativeFrontendCommunication.call(n.l9.Game,n.Lc.OpenRedModsLogs)}ngOnDestroy(){this.subscription.unsubscribe()}startGame(){this.gameMonitor.listOfLaunchedGames$.pipe((0,l.q)(1),(0,p.U)(a=>a.some(i=>(0,d.isEqual)(i,this.gameInstance))),(0,c.h)(a=>!a)).subscribe(()=>{this.gameMonitor.add(this.gameInstance);const a=this.nativeFrontendCommunication.get(n.l9.Game,n.lp.InitialGameEditions)[0];this.nativeFrontendCommunication.call(n.l9.Game,n.Lc.LaunchInitialGame,a)})}}return s.\u0275fac=function(a){return new(a||s)(e.Y36(D.w),e.Y36(b.n),e.Y36(C.H),e.Y36(P.W))},s.\u0275cmp=e.Xpm({type:s,selectors:[["red-mod-modal"]],decls:23,vars:28,consts:[[1,"red-mod-modal_content"],[1,"red-mod-modal__progress-bar",3,"percentage","modifier"],[1,"red-mod-modal__status"],["class","red-mod-modal__status-separator",4,"ngIf"],["class","red-mod-modal__logs-button","buttonPadding","none","transparent","true",3,"galaxyClick",4,"ngIf"],["class","red-mod-modal__launching-text",4,"ngIf"],[1,"red-mod-modal__buttons"],["buttonPadding","small","transparent","true",3,"galaxyClick",4,"ngIf"],["buttonRole","redModModal","buttonPadding","small",1,"red-mod-modal__play-button",3,"galaxyClick"],[1,"red-mod-modal__status-separator"],["buttonPadding","none","transparent","true",1,"red-mod-modal__logs-button",3,"galaxyClick"],[1,"red-mod-modal__see-the-logs"],[1,"red-mod-modal__launching-text"],["buttonPadding","small","transparent","true",3,"galaxyClick"]],template:function(a,i){1&a&&(e.TgZ(0,"div",0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"transloco"),e.qZA(),e._UZ(4,"launcher-progress-bar",1),e.ALo(5,"async"),e.TgZ(6,"div",2),e.TgZ(7,"span"),e._uU(8),e.ALo(9,"transloco"),e.qZA(),e.YNc(10,R,1,0,"div",3),e.ALo(11,"async"),e.YNc(12,I,4,4,"flat-button",4),e.ALo(13,"async"),e.YNc(14,T,3,4,"span",5),e.qZA(),e.qZA(),e.TgZ(15,"div",6),e.YNc(16,A,4,4,"flat-button",7),e.ALo(17,"async"),e.TgZ(18,"flat-button",8),e.NdJ("galaxyClick",function(){return i.playWithoutMods()}),e.ALo(19,"async"),e.TgZ(20,"span"),e._uU(21),e.ALo(22,"transloco"),e.qZA(),e.qZA(),e.qZA()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,12,"red_mod__modal_description")),e.xp6(2),e.Q6J("percentage",e.lcZ(5,14,i.percentage$))("modifier",i.progressBarModifier),e.xp6(3),e.uIk("selenium-id","mod_status"),e.xp6(1),e.hij(" ",e.lcZ(9,16,i.statusSlug)," "),e.xp6(2),e.Q6J("ngIf",e.lcZ(11,18,i.redModDeploymentFailed$)||i.shouldShowLaunchingText),e.xp6(2),e.Q6J("ngIf",e.lcZ(13,20,i.redModDeploymentFailed$)),e.xp6(2),e.Q6J("ngIf",i.shouldShowLaunchingText),e.xp6(2),e.Q6J("ngIf",e.lcZ(17,22,i.redModDeploymentFailed$)),e.xp6(2),e.uIk("disabled",e.lcZ(19,24,i.shouldDisablePlayWithoutMods$)?"":null)("selenium-id","playWithoutMods"),e.xp6(3),e.Oqu(e.lcZ(22,26,"red_mod__modal_play_without_mods")))},directives:[u,t.O5,m.T,x.U],pipes:[v.Ot,t.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;height:268px;font-size:16px;line-height:24px}.red-mod-modal__progress-bar[_ngcontent-%COMP%]{margin:36px 0 12px}.red-mod-modal__status[_ngcontent-%COMP%]{display:flex;align-items:center}.red-mod-modal__status-separator[_ngcontent-%COMP%]{margin:0 12px;border-radius:50%;height:2px;width:2px;background:#f2f2f2}.red-mod-modal__see-the-logs[_ngcontent-%COMP%]{white-space:nowrap}.red-mod-modal__logs-button[_ngcontent-%COMP%]{text-decoration:underline}.red-mod-modal__launching-text[_ngcontent-%COMP%]{font-weight:100}.red-mod-modal__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.red-mod-modal__play-button[_ngcontent-%COMP%]{width:176px;color:#f2f2f2;margin-inline-start:20px}"]}),s})()},4895:(F,M,o)=>{o.d(M,{N:()=>D});var r=o(8583),h=o(2096),p=o(489),l=o(311),c=o(7716);let d=(()=>{class e{}return e.\u0275fac=function(v){return new(v||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[r.ez,h.y4]]}),e})(),D=(()=>{class e{}return e.\u0275fac=function(v){return new(v||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[r.ez,h.y4,p.n,l.K,d]]}),e})()}}]);