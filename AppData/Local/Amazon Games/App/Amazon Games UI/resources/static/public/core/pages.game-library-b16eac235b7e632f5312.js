(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"2Ygb":function(e,t,n){"use strict";function a(e,t){return e+"("+(t.displayName||t.name||"Component")+")"}n.d(t,"a",(function(){return a}))},KeNS:function(e,t,n){"use strict";n.r(t),n.d(t,"GameLibraryPage",(function(){return oe}));var a=n("/MKj"),r=n("ANjH"),i=n("Fw4Y"),l=n("FAVh"),c=n("YJf4"),o=n("mrSG"),s=n("q1tI"),d=n("/7QA"),u=n("GSug"),m=n("3beK"),p=n("ek1v"),g=n("UPR8");function h(e,t){return null==t?void 0:t.every((function(t){return null==e?void 0:e.some((function(e){return t.toLowerCase()===e.toLowerCase()}))}))}var f=n("04Rk"),b=n("7Scu");function v(e){return function(){b.a.markGameAsSeenInLibrary({productId:e})}}var y=n("+kHD"),E=n("ZtYY"),O=n("j9MT"),F=n("wwFB"),j=n("JmDG"),S=n("2Ygb");function C(e,t){var n=s.createContext(t);return{context:n,withContext:function(t){return function(a){var r=function(e){var r=s.useContext(n),i=t(r,e);return s.createElement(a,Object(o.a)({},e,i))};return r.displayName=Object(S.a)("With"+e,a),r}}}}var M=C("GameContextMenuActionsContext",{showGameContextMenu:function(){},hideGameContextMenu:function(){}}),x=M.context;M.withContext;var k=C("GameContextMenuActionsContext",{isOpen:!1}),I=k.context;k.withContext;var w=n("/1Ag");var G=Object(a.b)(null,(function(e){return Object(r.b)({markGameAsSeenInLibrary:v},e)}),null,{areOwnPropsEqual:function(e,t){var n=e.game,a=Object(o.e)(e,["game"]),r=t.game,i=Object(o.e)(t,["game"]);return Object(p.b)(i,a)&&Object(p.a)(n,r)}})((function(e){var t=e.game,n=e.markGameAsSeenInLibrary,a=e.cancelInstall,r=e.install,i=e.launch,l=e.launchMigratedGame,c=e.pauseInstall,m=e.resumeInstall,p=s.useContext(x).showGameContextMenu,g=t.id,h=s.useMemo((function(){return{onInstall:function(){return r(t)},onCancelInstall:function(){return a(t)},onLaunch:function(){return i(g)},onLaunchMigratedGame:function(){return l(t.id)},onPauseInstall:function(){return c(g)},onResumeInstall:function(){return m(g)}}}),[r,t,a,i,l,c,m,g]),f=s.useCallback((function(){return n(g)}),[n,g]),b=s.useCallback((function(e){e.stopPropagation();var n={x:e.clientX,y:e.clientY};p({contextMenuOrigin:n,game:t}),Object(F.d)("game-tile-context-menu",{productId:t.id,productTitle:t.uiMetadata.title})}),[t,p]),v=Object(O.n)(t);t.hasBeenSeenInLibrary||f();var S={"library-card__top":!0,"library-card__top--translucent":v},C=s.createElement("div",{className:Object(j.a)(S),onClick:function(){d.g.history.push({pathname:w.a.GameDetail+"/"+t.id})}},s.createElement("div",{className:"library-card__top__image",title:t.uiMetadata.title,onContextMenu:b},t.uiMetadata.libraryTileArt?s.createElement(u.B,{src:t.uiMetadata.libraryTileArt,alt:t.uiMetadata.title,aspect:u.k.Aspect3x4}):s.createElement(u.j,{ratio:u.k.Aspect3x4},s.createElement(u.R,{className:"library-card--no-image",borderInlineStart:!0,borderInlineEnd:!0,borderBlockStart:!0},s.createElement(E.a,{squareViewBox:!0,noTitle:!0})))));return s.createElement(u.z,null,s.createElement(u.W,{className:"library-card"},s.createElement(u.W,null,C),s.createElement(u.A,null,s.createElement(u.W,{fullHeight:!0,fullWidth:!0,display:u.J.Flex,padding:1,flexDirection:u.K.Column,justifyContent:u.V.Center},s.createElement(y.a,Object(o.a)({game:t},h,{compact:!0}))))))})),R=n("RjZ6"),A=n("qJ4e"),T=n("4rCz"),H=n("Fm/D"),N=n("7Xr4"),D=Object(T.c)("sonic-aga-advanced-filter-genre-menu","Genres"),L=Object(T.c)("sonic-aga-advanced-filter-game-modes-menu","Game Modes"),W=Object(T.c)("sonic-aga-advanced-filter-play-state-menu","Play State"),P=function(e){var t=Object(s.useState)({x:0,y:0,width:0}),n=t[0],a=t[1],r=Object(s.useState)(""),i=r[0],l=r[1],c=s.useCallback((function(e,t){var n=e.currentTarget.getBoundingClientRect();a({x:n.x,y:n.y,width:n.width}),l(t)}),[]),d=function(e){return s.createElement(u.W,{padding:{inlineEnd:1}},s.createElement(u.Z,{label:String(e),type:u.ab.Prime}))},m=e.advancedFilter,p=e.changeAdvancedFilter,h=s.useCallback((function(e){var t=m.genres;if(t.includes(e)){var n=t.filter((function(t){return t!==e}));p(Object(o.a)(Object(o.a)({},m),{genres:n}))}else p(Object(o.a)(Object(o.a)({},m),{genres:Object(o.f)(t,[e])}))}),[m,p]),f=e.gameFilterMap.genre,b=[];Object.entries(f).sort((function(e,t){var n=e[0],a=t[0];return Object(N.b)(n)>Object(N.b)(a)?1:-1})).forEach((function(t){var n=t[0],a=t[1],r=Array.from(a).filter((function(t){return e.gameIdsMatchingFilter.has(t)})).length;b.push(s.createElement(R.c,{key:n,value:n,text:Object(N.b)(n),onClick:h,selected:m.genres.includes(n),endIcon:d(r)}))}));var v=s.useCallback((function(e){var t=m.gameModes;if(t.includes(e)){var n=t.filter((function(t){return t!==e}));p(Object(o.a)(Object(o.a)({},m),{gameModes:n}))}else p(Object(o.a)(Object(o.a)({},m),{gameModes:Object(o.f)(t,[e])}))}),[m,p]),y=e.gameFilterMap.gamemode,E=[];Object.entries(y).sort((function(e,t){var n=e[0],a=t[0];return Object(N.a)(n)>Object(N.a)(a)?1:-1})).forEach((function(t){var n=t[0],a=t[1],r=Array.from(a).filter((function(t){return e.gameIdsMatchingFilter.has(t)})).length;E.push(s.createElement(R.c,{key:n,value:n,text:Object(N.a)(n),onClick:v,selected:m.gameModes.includes(n),endIcon:d(r)}))}));var O=s.useState([]),F=O[0],j=O[1];s.useEffect((function(){var t=e.games.filter((function(t){return Array.from(e.gameIdsMatchingFilter).includes(t.id)})),n=[],a=t.filter((function(e){return e.lastPlayedSecondFromEpoc>0})).length;n.push({key:g.c.NotPlayed,value:Object(T.c)("sonic-aga-advanced-filter-not-played","Not Played"),count:t.length-a}),n.push({key:g.c.Played,value:Object(T.c)("sonic-aga-advanced-filter-played","Played"),count:a}),j(n)}),[e.gameIdsMatchingFilter,e.games]);var S=s.useCallback((function(e){m.playState!==e?p(Object(o.a)(Object(o.a)({},m),{playState:g.c[e]})):p(Object(o.a)(Object(o.a)({},m),{playState:null}))}),[m,p]),C=[];F.forEach((function(e){C.push(s.createElement(R.c,{key:e.key,value:e.key,text:e.value,onClick:S,selected:m.playState===e.key,endIcon:d(e.count)}))}));var M=e.shouldClose,x=s.useCallback((function(e){e.currentTarget.contains(e.relatedTarget)||M()}),[M]),k=e.isRtl?{top:n.y,left:n.x-300}:{top:n.y,left:n.x+n.width},I=function(e,t){return s.createElement("div",{style:Object(o.a)(Object(o.a)({},k),{position:"fixed",width:"300px"})},s.createElement(R.b,{shouldClose:M,disableAutofocus:!0,show:i===e,dropdownItems:t,maxHeightInElements:7,stayOpenOnItemClick:!0}))},w=I(D,b),G=I(L,E),A=I(W,C),H=function(t){var n=e.isRtl?u.fb.AngleLeft:u.fb.AngleRight;return s.createElement(u.W,{display:u.J.Flex,padding:{inlineEnd:.5}},t>0&&s.createElement(u.W,{margin:{blockEnd:.5}},s.createElement(u.Z,{label:String(t),type:u.ab.Prime})),s.createElement(u.eb,{asset:n}))},P=function(e,t,n){return s.createElement(R.c,{selected:i===e,key:e,value:e,text:e,onFocus:c,submenu:n,endIcon:H(t)})},J=[];return J.push(P(D,e.advancedFilter.genres.length,w)),J.push(P(L,e.advancedFilter.gameModes.length,G)),J.push(P(W,e.advancedFilter.playState?1:0,A)),s.createElement("div",{onBlur:x},s.createElement(u.W,{display:u.J.Flex,position:u.bb.Relative},s.createElement(R.b,{show:e.show,position:{block:u.p.End,inline:u.q.End},tailTargetSize:{width:30,height:30},offsetX:"60px",shouldClose:M,dropdownItems:J,stayOpenOnItemClick:!0})))},J=function(e){var t=s.useState(!1),n=t[0],a=t[1],r=e.changeAdvancedFilter,i=e.advancedFilter,l=s.useCallback((function(e){e.stopPropagation(),r(Object(o.a)(Object(o.a)({},i),{genres:[],gameModes:[],playState:null}))}),[i,r]),c=s.useCallback((function(){a(!1)}),[]),d=s.useCallback((function(){a(!n)}),[n]),m=e.advancedFilter.gameModes.length+e.advancedFilter.genres.length+(e.advancedFilter.playState?1:0),p=m?{inlineStart:1}:{inline:1};return s.createElement(s.Fragment,null,s.createElement(u.U,{onClick:d},s.createElement(H.i,{padding:Object(o.a)({},p),className:"game-library-nav-filter",display:u.J.Flex},s.createElement(H.i,{display:u.J.Flex},s.createElement(u.eb,{width:20,height:20,asset:u.fb.Filter}),s.createElement(H.i,{display:u.J.Flex,alignItems:H.b.Center,margin:.5},s.createElement(u.I,{fontType:u.N.B300},Object(T.c)("sonic-aga-game-library-filter-button","Filter")),m>0&&s.createElement(H.i,{padding:{inlineStart:1}},s.createElement(u.Z,{label:String(m),type:u.ab.Prime})))),m>0&&s.createElement(u.u,{ariaLabel:Object(T.c)("sonic-aga-game-library-filter-button-clear","Clear Filter"),icon:u.fb.Close,size:u.v.XSmall,onClick:l}))),s.createElement(P,{show:n,isRtl:e.isRtl,games:e.games,advancedFilter:e.advancedFilter,changeAdvancedFilter:e.changeAdvancedFilter,perGameSettings:e.perGameSettings,gameFilterMap:e.gameFilterMap,gameIdsMatchingFilter:e.gameIdsMatchingFilter,shouldClose:c}))},B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderHiddenGamesToggle=function(){var e,n;return t.props.advancedFilter.displayHiddenGames?(e=Object(d.c)("sonic-aga-game-library-navigation-visible-games","Visible Games"),n=u.fb.Hide):(e=Object(d.c)("sonic-aga-game-library-navigation-hidden-games","Hidden Games"),n=u.fb.Show),s.createElement("div",{onClick:t.toggleHiddenGames},s.createElement(u.W,{padding:1,alignItems:u.c.Center},s.createElement(u.nb,{delayInMs:500,label:e},s.createElement(u.u,{ariaLabel:e,icon:n,size:u.v.Small}))))},t.toggleHiddenGames=function(){t.props.advancedFilter.displayHiddenGames?t.props.changeAdvancedFilter(Object(o.a)(Object(o.a)({},t.props.advancedFilter),{displayHiddenGames:!1})):t.props.changeAdvancedFilter(Object(o.a)(Object(o.a)({},t.props.advancedFilter),{displayHiddenGames:!0}))},t.onSearchChange=function(e){var n=e.target.value;t.props.changeSearch(n)},t}return Object(o.c)(t,e),t.prototype.render=function(){return s.createElement(u.W,null,s.createElement(u.W,{fullWidth:!0,className:"game-library-nav__library-padding"}),s.createElement(A.a,null,s.createElement(u.W,{fullWidth:!0,className:"game-library-nav"},s.createElement(u.jb,{fullHeight:!0,display:u.J.Flex,alignItems:u.c.Center,justifyContent:u.V.Between,fullWidth:!0,padding:{inline:2}},s.createElement(u.W,{margin:{block:.5},padding:{inline:1},zIndex:u.wb.Default,display:u.J.Flex,alignItems:u.c.Center},s.createElement(u.I,{fontType:u.N.B500},Object(d.c)("sonic-aga-game-library-sort-by","Sort by:")),this.renderSorting()),s.createElement(u.W,{margin:{inlineEnd:1},display:u.J.Flex,alignItems:u.c.Center,justifyContent:u.V.End},this.renderHiddenGamesToggle(),s.createElement(u.W,{padding:{inlineEnd:1}},this.renderAdvancedFilter()),this.renderSearch())))))},t.prototype.renderSorting=function(){var e=this,t=new Map;t.set(g.b.Newest,Object(d.c)("sonic-aga-game-library-sort-option-newest","Newest")),t.set(g.b.Oldest,Object(d.c)("sonic-aga-game-library-sort-option-oldest","Oldest")),t.set(g.b.RecentlyPlayed,Object(d.c)("sonic-aga-game-library-sort-option-recently-played","Recently Played")),t.set(g.b.Name,Object(d.c)("sonic-aga-game-library-sort-option-installed","Name"));var n=this.props.sorting;return this.renderDropdownWithItems(t,n,(function(t){e.props.changeSorting(g.b[t])}))},t.prototype.renderAdvancedFilter=function(){return s.createElement(J,{games:this.props.games,advancedFilter:this.props.advancedFilter,changeAdvancedFilter:this.props.changeAdvancedFilter,perGameSettings:this.props.perGameSettings,gameFilterMap:this.props.gameFilterMap,gameIdsMatchingFilter:this.props.gameIdsMatchingFilter,isRtl:this.props.isRtl})},t.prototype.renderDropdownWithItems=function(e,t,n){return s.createElement(u.W,{margin:.5},s.createElement(R.d,{style:R.g.Hollow,onChange:n,selectedValue:t},e))},t.prototype.renderSearch=function(){return s.createElement(u.W,{margin:.5},s.createElement("div",{style:{width:220}},s.createElement(u.hb,{onChange:this.onSearchChange,value:this.props.search,placeholder:Object(d.c)("sonic-aga-game-library-search-input-placeholder","Search"),maxLength:80,style:u.S.Hollow,dir:"auto"})))},t}(s.PureComponent),z=function(e){var t,n,a=e.filter,r=e.search;return!a.displayHiddenGames||(null===(t=a.genres)||void 0===t?void 0:t.length)||(null===(n=a.gameModes)||void 0===n?void 0:n.length)||a.playState||r?null:s.createElement(u.W,{className:"no-games-meet-filter",fullWidth:!0,display:u.J.Flex,flexDirection:u.K.Column,alignItems:u.c.Center,textAlign:u.kb.Center},s.createElement(u.Q,{margin:{blockEnd:1}},s.createElement(u.I,{fontType:u.N.D50},Object(T.c)("sonic-aga-no-games-meet-filter-no-hidden-games-header","Your hidden games would be here... if you had any"))),s.createElement(u.I,{fontType:u.N.B400},Object(T.c)("sonic-aga-no-games-meet-filter-no-hidden-games-message",'To hide a game, right click on a game in your library and select "Hide this game"')))},q=function(e){function t(t){var n=e.call(this,t)||this;n.addMoreIfNeeded=function(){void 0===n.addMoreIdleCallbackHandle&&n.state.numTilesToRender<n.state.sortedGames.length&&(n.addMoreIdleCallbackHandle=window.requestIdleCallback((function(){n.addMoreIdleCallbackHandle=void 0,n.setState({numTilesToRender:Math.min(n.state.numTilesToRender+16,n.state.sortedGames.length)})}),{timeout:200}))},n.renderGame=function(e,t){return n.renderedGameIdsSet.add(e.id),s.createElement(u.W,{key:e.uiMetadata.title+"-"+e.id,display:t?void 0:u.J.Hide},s.createElement(G,{game:e,createShortcut:n.props.createShortcut,install:n.props.install,cancelInstall:n.props.cancelInstall,launch:n.props.launch,pauseInstall:n.props.pauseInstall,resumeInstall:n.props.resumeInstall,launchMigratedGame:n.props.launchMigratedGame}))};var a=Object.values(t.games);return n.state={numTilesToRender:16,idsOfGamesMeetingFilter:new Set,sortedGames:Object.values(a),articleTrimmedTitles:U(a)},n.renderedGameIdsSet=new Set,n}return Object(o.c)(t,e),t.getDerivedStateFromProps=function(e){var t,n,a,r,i=(t=e.filter,n=e.advancedFilter,a=e.search,r=e.perGameSettings,function(e){var i;return function(e,t){return e.displayHiddenGames?t:!t}(n,!!(null===(i=r[e.id])||void 0===i?void 0:i.hidden))&&function(e,t){return t===g.a.All||!(function(e){return e.installState===f.s.NotInstalled}(e)===(t===g.a.Installed))}(e,t)&&function(e,t){var n;return!(t&&(null===(n=null==e?void 0:e.uiMetadata)||void 0===n?void 0:n.title)&&e.uiMetadata.title.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())<0)}(e,a)&&function(e,t){var n,a;return 0===(null===(n=t.genres)||void 0===n?void 0:n.length)||h(null===(a=null==e?void 0:e.uiMetadata)||void 0===a?void 0:a.genres,t.genres)}(e,n)&&function(e,t){var n,a;return 0===(null===(n=t.gameModes)||void 0===n?void 0:n.length)||h(null===(a=null==e?void 0:e.uiMetadata)||void 0===a?void 0:a.gameModes,t.gameModes)}(e,n)&&function(e,t){return!t||(g.c.NotPlayed===t?e.lastPlayedSecondFromEpoc<=0:e.lastPlayedSecondFromEpoc>0)}(e,n.playState)}),l=Object.values(e.games),c=U(l);return{idsOfGamesMeetingFilter:new Set(l.filter(i).map((function(e){return e.id}))),sortedGames:K(l,e.sorting,c),articleTrimmedTitles:c}},t.prototype.componentDidUpdate=function(){this.addMoreIfNeeded()},t.prototype.shouldComponentUpdate=function(e,t){var n=this.props,a=(n.games,Object(o.e)(n,["games"])),r=(e.games,Object(o.e)(e,["games"]));return!Object(p.b)(a,r)||!Object(p.a)(this.state,t)},t.prototype.componentDidMount=function(){this.addMoreIfNeeded()},t.prototype.componentWillUnmount=function(){void 0!==this.addMoreIdleCallbackHandle&&window.cancelIdleCallback(this.addMoreIdleCallbackHandle)},t.prototype.render=function(){var e=0===this.state.idsOfGamesMeetingFilter.size;return s.createElement(u.W,null,s.createElement(B,{games:Object.values(this.props.games),search:this.props.search,sorting:this.props.sorting,filter:this.props.filter,changeSearch:this.props.changeSearch,changeSorting:this.props.changeSorting,changeFilter:this.props.changeFilter,changeAdvancedFilter:this.props.changeAdvancedFilter,advancedFilter:this.props.advancedFilter,perGameSettings:this.props.perGameSettings,gameFilterMap:this.props.gameFilterMap,gameIdsMatchingFilter:this.state.idsOfGamesMeetingFilter,isRtl:this.props.isRtl}),this.renderGamesList(),e&&s.createElement(z,{filter:this.props.advancedFilter,search:this.props.search}))},t.prototype.renderGamesList=function(){var e=this,t=0,n=this.state.sortedGames.reduce((function(n,a){return e.state.idsOfGamesMeetingFilter.has(a.id)&&t<e.state.numTilesToRender?(t++,n.push(e.renderGame(a,!0)),n):e.renderedGameIdsSet.has(a.id)?(n.push(e.renderGame(a,!1)),n):n}),[]),a=t<this.state.idsOfGamesMeetingFilter.size;return s.createElement(u.W,{className:"game-library-tiles__tower"},s.createElement(u.qb,{childWidth:u.rb.Small,gutterSize:u.sb.Small},n),a&&s.createElement(u.W,{fullWidth:!0,padding:{block:3},display:u.J.Flex,justifyContent:u.V.Center},s.createElement(u.X,{size:u.ib.Large})))},t}(s.Component);function U(e){var t={};return e.forEach((function(e){var n=e.uiMetadata.title;t[n]=n.replace(/^(an?|the)\s/i,"")})),t}var V=new Intl.Collator("en",{sensitivity:"base"}).compare;function _(e,t){return e<t?1:e>t?-1:0}var Y=function(e,t){return _(e.entitlementDateFromEpoch,t.entitlementDateFromEpoch)};function K(e,t,n){var a=function(e){return function(t,n){var a,r;return V(null!==(a=e[t.uiMetadata.title])&&void 0!==a?a:t.uiMetadata.title,null!==(r=e[n.uiMetadata.title])&&void 0!==r?r:n.uiMetadata.title)}}(n);switch(t){case g.b.Name:return e.sort((function(e,t){return a(e,t)||Y(e,t)}));case g.b.Oldest:return e.sort((function(e,t){return Y(e,t)||a(e,t)})),e.reverse();case g.b.Newest:return e.sort((function(e,t){return Y(e,t)||a(e,t)}));case g.b.RecentlyPlayed:return e.sort((function(e,t){return function(e,t){var n=_(e.lastPlayedSecondFromEpoc,t.lastPlayedSecondFromEpoc);return 0===n?_(e.entitlementDateFromEpoch,t.entitlementDateFromEpoch):n}(e,t)||Y(e,t)}));default:return[]}}var X,Z=n("Bh3T");!function(e){e.ViewDetails="ViewDetails",e.DesktopShortcut="DesktopShortcut",e.Uninstall="Uninstall",e.Repair="Repair",e.ToggleHidden="ToggleHidden"}(X||(X={}));var Q=n("lo/A"),$=n("HBDa"),ee=n("nRGG"),te=n("aCAx"),ne=n("iev8"),ae={uninstallGame:function(e,t){return d.g.logger.info("Requesting uninstall modal"),Object(te.h)(ne.a,{productId:e,gameTitle:t})},repairGame:function(e,t){return d.g.logger.info("Requesting repair modal"),Object(te.h)($.a,{productId:e,gameTitle:t})},createShortcut:ee.a,setGameSpecificSettings:Q.c};var re=Object(a.b)((function(e,t){var n;return{isGameHidden:t.game&&(null===(n=e.userSettings.settings.perGameSettings[t.game.id])||void 0===n?void 0:n.hidden)}}),ae)((function(e){var t=e.shouldClose,n=e.show,a=e.contextMenuOrigin,r=e.game,i=e.isGameHidden,l=e.createShortcut,c=e.repairGame,o=e.uninstallGame,m=e.setGameSpecificSettings,p=s.useState(),g=p[0],h=p[1],f=s.useState({x:0,y:0}),b=f[0],v=f[1],y=s.useRef(null),E=s.useRef(null),j=s.useCallback((function(){r&&c(r.id,r.uiMetadata.title)}),[r,c]),S=s.useCallback((function(){r&&o(r.id,r.uiMetadata.title)}),[r,o]),C=s.useCallback((function(){r&&l(r.id)}),[r,l]),M=s.useCallback((function(){r&&(i?(Object(F.c)("remove-from-hidden",{productId:r.id,productTitle:r.uiMetadata.title}),d.e.info("Un-hiding game with productId '"+r.id+"'")):(Object(F.c)("add-to-hidden",{productId:r.id,productTitle:r.uiMetadata.title}),d.e.info("Hiding game with productId '"+r.id+"'")),m(r.id,{hidden:!i}))}),[r,i,m]);s.useEffect((function(){var e=function(e){n&&(e.stopPropagation(),t())};return window.addEventListener("contextmenu",e,!0),function(){window.removeEventListener("contextmenu",e,!0)}}),[n,t]),s.useLayoutEffect((function(){var e={block:u.p.End,inline:u.q.End};if(y.current){var t="rtl"===getComputedStyle(y.current).direction,r=y.current.getBoundingClientRect(),i={x:0,y:0};if(Math.abs(a.x-r.x)<=3&&Math.abs(a.y-r.y)<=3||(i={x:a.x-r.x,y:a.y-r.y},v(i)),n&&E.current){var l=E.current.getBoundingClientRect();e=function(e,t,n,a,r){var i=function(e,t,n,a){return{fitsUp:t-a>0,fitsDown:t+a<document.documentElement.clientHeight,fitsLeft:e-n>0,fitsRight:e+n<document.documentElement.clientWidth}}(e,t,n,a),l=!i.fitsDown&&i.fitsUp,c=r?!i.fitsLeft&&i.fitsRight:!i.fitsRight&&i.fitsLeft;if(l)return c?{block:u.p.Start,inline:u.q.End}:{block:u.p.Start,inline:u.q.Start};if(c)return{block:u.p.End,inline:u.q.End};return{block:u.p.End,inline:u.q.Start}}(r.x+i.x,r.y+i.y,l.width,l.height,t),h(e)}}}),[n,h,a.x,a.y]);var x=null==r?void 0:r.id,k=s.useCallback((function(){x&&d.g.history.push({pathname:w.a.GameDetail+"/"+x})}),[x]),I=[],G={top:a.y+b.y,left:a.x+b.x};return r&&(I.push(s.createElement(R.c,{key:X.ViewDetails,value:X.ViewDetails,text:Object(d.c)("sonic-aga-game-context-menu-option-view-details","View Details"),onClick:k})),I.push(s.createElement(R.c,{key:X.DesktopShortcut,value:X.DesktopShortcut,text:Object(d.c)("sonic-aga-game-context-menu-option-shortcut","Create desktop shortcut"),onClick:C,disabled:!Object(O.i)(r)||Object(O.n)(r)})),I.push(s.createElement(R.c,{key:X.Repair,value:X.Repair,text:Object(d.c)("sonic-aga-game-context-menu-option-repair","Repair installation"),onClick:j,disabled:!Object(O.a)(r)})),I.push(s.createElement(R.c,{key:X.Uninstall,value:X.Uninstall,text:Object(d.c)("sonic-aga-game-context-menu-option-uninstall","Uninstall"),onClick:S,disabled:!Object(O.b)(r)})),I.push(s.createElement(R.c,{key:X.ToggleHidden,value:X.ToggleHidden,text:i?Object(d.c)("sonic-aga-game-context-menu-option-un-hide-game","Remove from hidden","This will make the game no longer hidden in the user's game library"):Object(d.c)("sonic-aga-game-context-menu-option-hide-game","Hide this game","This will hide the game from the user's game library"),onClick:M}))),s.createElement("div",{ref:y,className:"game-context-menu-layer",style:G},n&&s.createElement(Z.b,{disableScroll:!0}),s.createElement(R.b,{balloonRefDelegate:E,dropdownItems:I,position:g,show:n,shouldClose:t}))})),ie=s.memo((function(e){var t=e.children,n=s.useState(!1),a=n[0],r=n[1],i=s.useState({contextMenuOrigin:{x:0,y:0}}),l=i[0],c=i[1],d=s.useCallback((function(e){c(e),r(!0)}),[c]),u=s.useCallback((function(){r(!1)}),[r]),m=s.useMemo((function(){return{showGameContextMenu:d,hideGameContextMenu:u}}),[u,d]),p=s.useMemo((function(){return{isOpen:a}}),[a]);return s.createElement(x.Provider,{value:m},s.createElement(I.Provider,{value:p},t,s.createElement(re,Object(o.a)({show:a,shouldClose:u},l))))})),le=function(){return s.createElement(u.W,{className:"empty-library-page",fullHeight:!0,fullWidth:!0,display:u.J.Flex,flexDirection:u.K.Column,alignItems:u.c.Center,textAlign:u.kb.Center},s.createElement(u.Q,{margin:{blockEnd:1}},s.createElement(u.I,{fontType:u.N.D50},Object(T.c)("sonic-aga-empty-game-library-header","Your game library is currently empty"))),s.createElement(u.I,{type:u.mb.Span,fontType:u.N.B400},Object(T.c)("sonic-aga-empty-game-library-message","Get started claiming <x:link>Games with Prime</x:link> today!",{"x:link":function(e){return s.createElement(u.Q,{display:u.J.InlineBlock},s.createElement(u.G,{to:{pathname:w.a.Home},key:e},e))}})))},ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChangeFilter=function(e){t.props.filter!==e&&(t.props.changeFilter(e),d.g.history.push(Object(o.a)(Object(o.a)({},d.g.history.location),{search:Object(m.a)(e)})))},t.handleChangeAdvancedFilter=function(e){t.props.advancedFilter.displayHiddenGames===e.displayHiddenGames&&t.arraysMatch(t.props.advancedFilter.gameModes,e.gameModes)&&t.arraysMatch(t.props.advancedFilter.genres,e.genres)&&t.props.advancedFilter.playState===e.playState||t.props.changeAdvancedFilter(e)},t.setLocationFilter=function(e){e.locationFilter&&e.locationFilter!==e.filter&&e.changeFilter(e.locationFilter)},t}return Object(o.c)(t,e),t.prototype.componentDidMount=function(){this.setLocationFilter(this.props)},t.prototype.componentDidUpdate=function(e){this.props.locationFilter!==e.locationFilter&&this.setLocationFilter(this.props)},t.prototype.render=function(){var e=Object.values(this.props.games).length;return this.props.isLoading&&0===e?s.createElement(u.W,{fullWidth:!0,fullHeight:!0,display:u.J.Flex,flexDirection:u.K.Row,justifyContent:u.V.Center,verticalAlign:u.ub.Middle,alignItems:u.c.Center},s.createElement(u.X,{size:u.ib.Large})):s.createElement(u.W,{padding:3},e>0?s.createElement(ie,null,s.createElement(q,{cancelInstall:this.props.cancelInstall,changeSearch:this.props.changeSearch,changeSorting:this.props.changeSorting,createShortcut:this.props.createShortcut,filter:this.props.filter,games:this.props.games,install:this.props.install,launch:this.props.launch,pauseInstall:this.props.pauseInstall,resumeInstall:this.props.resumeInstall,search:this.props.search,sorting:this.props.sorting,uninstall:this.props.uninstall,changeFilter:this.handleChangeFilter,changeAdvancedFilter:this.handleChangeAdvancedFilter,launchMigratedGame:this.props.launchMigratedGame,perGameSettings:this.props.perGameSettings,advancedFilter:this.props.advancedFilter,gameFilterMap:this.props.gameFilterMap,isRtl:this.props.isRtl})):s.createElement(le,null))},t.prototype.arraysMatch=function(e,t){return e.length===t.length&&e.every((function(e){return t.includes(e)}))},t}(s.Component);var oe=Object(a.b)((function(e){return{search:e.gameLibraryNavigation.search,filter:e.gameLibraryNavigation.filter,sorting:e.gameLibraryNavigation.sorting,advancedFilter:e.gameLibraryNavigation.advancedFilter,gameFilterMap:e.gameLibraryNavigation.gameFilterMap,isRtl:e.session.textDirection===i.a.RTL}}),(function(e){return Object(r.b)({changeSearch:l.i,changeSorting:l.j,changeFilter:l.h,changeAdvancedFilter:l.g},e)}))(Object(c.a)(ce))},ek1v:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));n("LvDl");var a=n("/MKj");n("4rCz");function r(e,t,n){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var a=void 0,i=void 0,l=void 0,c=void 0;if(Array.isArray(e)){if((a=e.length)!==t.length)return!1;for(i=a;0!=i--;)if(!r(e[i],t[i],n))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(c=e.entries();!(i=c.next()).done;)if(!t.has(i.value[0]))return!1;for(c=e.entries();!(i=c.next()).done;)if(!r(i.value[1],t.get(i.value[0]),n&&n[i.value[0]]))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(c=e.entries();!(i=c.next()).done;)if(!t.has(i.value[0]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();l=Object.keys(e);var o=Object.keys(t);if(n&&(l=l.filter((function(e){return e in n})),o=o.filter((function(e){return e in n}))),(a=l.length)!==o.length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(t,l[i]))return!1;for(i=a;0!=i--;){var s=l[i];if(("_owner"!==s||!e.$$typeof)&&!r(e[s],t[s],n&&n[s]))return!1}return!0}return e!=e&&t!=t}var i=a.c}}]);