'use strict';Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(){this._callbacks={},this._callbackActive={}}_addCallback(e,t,a,n=!1){e&&"string"==typeof e&&t&&(!this._callbacks[e]&&(this._callbacks[e]=[]),this._callbackActive[e]&&this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice()),this._callbacks[e].push({callback:t,scope:a||this,once:n}))}on(e,t,a){return this._addCallback(e,t,a,!1),this}off(e,t,a){if(e)this._callbackActive[e]&&this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice());else for(const e in this._callbackActive)this._callbacks[e]&&this._callbacks[e]===this._callbackActive[e]&&(this._callbackActive[e]=this._callbackActive[e].slice());if(!e)this._callbacks={};else if(!t)this._callbacks[e]&&(this._callbacks[e]=[]);else{const n=this._callbacks[e];if(!n)return this;let r=n.length;for(let e=0;e<r;e++)n[e].callback===t&&(a&&n[e].scope!==a||(n[e--]=n[--r]));n.length=r}return this}fire(e,t,a,n,r,o,s,d,c){if(!e||!this._callbacks[e])return this;let l;this._callbackActive[e]?(this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice()),l=this._callbacks[e].slice()):this._callbackActive[e]=this._callbacks[e];for(let p=0;(l||this._callbackActive[e])&&p<(l||this._callbackActive[e]).length;p++){const i=(l||this._callbackActive[e])[p];if(i.callback.call(i.scope,t,a,n,r,o,s,d,c),i.once){const t=this._callbacks[e].indexOf(i);-1!==t&&(this._callbackActive[e]===this._callbacks[e]&&(this._callbackActive[e]=this._callbackActive[e].slice()),this._callbacks[e].splice(t,1))}}return l||(this._callbackActive[e]=void 0),this}once(e,t,a){return this._addCallback(e,t,a,!0),this}hasEvent(e){return this._callbacks[e]&&0!==this._callbacks[e].length||!1}}class t extends e{constructor(e,t){super(),this.sceneObject=e,this.nativeClass=t,e&&t&&(this.native=e.native.addComponent(t))}static registerComponentType(e,t,a){this._typeToComponent.has(e)?console.warn("Component::Register component type more than once! Type: "+e):this._typeToComponent.set(e,a);for(const n of t)this._nativeToComponent.has(n)||this._nativeToComponent.set(n,a)}static getComponentFromType(e){return this._typeToComponent.get(e)}static getComponentFronNative(e){return this._nativeToComponent.get(Object.getPrototypeOf(e).RTTI.Name)}initialize(e,t){for(let a=0;a<t.length;a++){const n=t[a];e&&e.hasOwnProperty(n)&&(this[n]=e[n])}}initWithNative(e,t,a){this.sceneObject=e,this.native=t,this.nativeClass=a}destroy(){this.sceneObject&&this.nativeClass&&(this.sceneObject.native.removeComponent(this.nativeClass),this.sceneObject=void 0)}addListener(e,t,a){if(this.native)zn.addNativeListener(this.native,e,t,a);else throw new Error("Invalid native component in Component:addListener")}removeListener(e,t,a){if(this.native)zn.removeNativeListener(this.native,e,t,a);else throw new Error("Invalid native component in Component:removeListener")}get enabled(){return this.native.enabled}set enabled(e){this.native.enabled=e}}t._typeToComponent=new Map,t._nativeToComponent=new Map;var a=effect.Amaz;class n{static createQuadMesh(){const e=new a.Mesh,t=new a.VertexAttribDesc;t.semantic=a.VertexAttribType.POSITION;const n=new a.VertexAttribDesc;n.semantic=a.VertexAttribType.TEXCOORD0;const r=new a.Vector;r.insert(0,t),r.insert(1,n),e.vertexAttribs=r;const i=-1,o=1,s=1,d=[o,s,0,1,1,o,i,0,1,0,-1,i,0,0,0,-1,s,0,0,1],c=new a.FloatVector;for(let e=0;e<d.length;++e)c.insert(e,d[e]);e.vertices=c;const l=new a.SubMesh;l.primitive=a.Primitive.TRIANGLES;const p=[0,1,2,2,3,0],u=new a.UInt16Vector;for(let e=0;e<p.length;++e)u.insert(e,p[e]);return l.indices16=u,l.mesh=e,e.addSubMesh(l),e}}class r{static toPascalCase(e){return e?`${e}`.replace(new RegExp(/[-_]+/,"g")," ").replace(new RegExp(/[^\w\s]/,"g"),"").replace(new RegExp(/\s+(.)(\w*)/,"g"),(e,t,a)=>`${t.toUpperCase()+a.toLowerCase()}`).replace(new RegExp(/\w/),e=>e.toUpperCase()):e}static getFilename(e){return e.substring(e.lastIndexOf("/")+1)}}class i{static createShaderPass(e,t){const n=new a.Pass;n.shaders=e;const r=new a.Map;return r.insert("inPosition",a.VertexAttribType.POSITION),r.insert("inTexCoord",a.VertexAttribType.TEXCOORD0),n.semantics=r,n.renderState=t,n}static createScreenMaterial(e){const t=new a.RenderState;t.viewport=new a.ViewportState,t.viewport.rect=new a.Rect(0,0,1,1),t.viewport.minDepth=0,t.viewport.maxDepth=1;const n=this.createShaderPass(e,t);return this.createMaterial(n)}static createMaterial(e){const t=new a.XShader;t.passes.pushBack(e);const n=new a.Material;n.xshader=t;const r=new a.PropertySheet;return n.properties=r,n}static createRenderTexture(){const e=new a.RenderTexture;return e.depth=1,e.width=640,e.height=360,e.filterMag=a.FilterMode.LINEAR,e.filterMin=a.FilterMode.LINEAR,e.filterMipmap=a.FilterMipmapMode.NONE,e.attachment=a.RenderTextureAttachment.NONE,e}static createRenderTexturePlus(e,t,n,r){const i=new a.RenderTexture;return i.builtinType=a.BuiltInTextureType.NORAML,i.internalFormat=a.InternalFormat.RGBA8,i.dataType=a.DataType.U8norm,i.depth=1,i.attachment=a.RenderTextureAttachment.DEPTH24,i.filterMag=r,i.filterMin=r,i.filterMipmap=a.FilterMipmapMode.NONE,i.width=e,i.height=t,i.colorFormat=n,i}static createTexture2D(){const e=new a.Texture2D;return e.filterMin=a.FilterMode.LINEAR,e.filterMag=a.FilterMode.LINEAR,e}static createShaders(e){const t=new a.Map;for(const n in e){const r=new a.Shader;r.type=a.ShaderType.VERTEX,r.source=e[n].vs;const i=new a.Shader;i.type=a.ShaderType.FRAGMENT,i.source=e[n].fs;const o=new a.Vector;o.insert(0,r),o.insert(1,i),t.insert(n,o)}return t}static createEmptyMaterial(){const e=new a.Material,t=new a.XShader;e.xshader=t;const n=new a.PropertySheet;return e.properties=n,e}static addPassToMaterial(e,t,n,r=!1){const i=new a.Pass,o=new a.Map;for(const i in t){const e=new a.Shader;e.type=a.ShaderType.VERTEX,e.source=t[i].vs;const n=new a.Shader;n.type=a.ShaderType.FRAGMENT,n.source=t[i].fs;const r=new a.Vector;r.pushBack(e),r.pushBack(n),o.insert(i,r)}i.shaders=o;const s=new a.Map;s.insert("inPosition",a.VertexAttribType.POSITION),s.insert("inTexCoord",a.VertexAttribType.TEXCOORD0),i.semantics=s;const d=new a.DepthStencilState;d.depthTestEnable=!1;const c=new a.RenderState;if(c.depthstencil=d,n){d.stencilTestEnable=!0;const e=new a.StencilOpState;e.compareOp=a.CompareOp.EQUAL,e.reference=42,e.writeMask=0,d.stencilFront=e,d.stencilBack=e}if(r){const e=new a.Vector,t=new a.ColorBlendAttachmentState;t.blendEnable=r,t.srcColorBlendFactor=a.BlendFactor.SRC_ALPHA,t.dstColorBlendFactor=a.BlendFactor.ONE_MINUS_SRC_ALPHA,t.srcAlphaBlendFactor=a.BlendFactor.SRC_ALPHA,t.dstAlphaBlendFactor=a.BlendFactor.ONE_MINUS_SRC_ALPHA,t.ColorBlendOp=a.BlendOp.ADD,t.AlphaBlendOp=a.BlendOp.ADD,e.pushBack(t),c.colorBlend=new a.ColorBlendState,c.colorBlend.attachments=e}return i.renderState=c,e.xshader.passes.pushBack(i),i}}class o{constructor(){this._screenMesh=n.createQuadMesh(),this._cmdBuffer=new a.CommandBuffer,this._cmdBufferDirty=!1}onPreUpdate(){this._cmdBuffer.clearAll()}onPostUpdate(){const e=zn.scene.native;e&&this._cmdBufferDirty&&(e.commitCommandBuffer(this._cmdBuffer),this._cmdBufferDirty=!1)}get screenMesh(){return this._screenMesh}cmdBufferSetRenderTexture(e){this._cmdBuffer.setRenderTexture(e),this._cmdBufferDirty=!0}cmdBufferClearRenderTexture(e,t,a,n){this._cmdBuffer.clearRenderTexture(e,t,a,n),this._cmdBufferDirty=!0}cmdBufferDrawMesh(e,t,a,n,r,i){this._cmdBuffer.drawMesh(e,t.native,a,n,r,i),this._cmdBufferDirty=!0}cmdBufferBlit(e,t){this._cmdBuffer.blit(e,t),this._cmdBufferDirty=!0}}class s{static doesSDKSupport(e){const t=a.VERSION.split(".").map(e=>parseInt(e)),n=e.split(".").map(e=>parseInt(e));if(t.length==n.length){for(let e=0;e<t.length;++e){if(n[e]<t[e])return!0;if(n[e]>t[e])return!1}return!0}return!1}}const d="6.1.1",c="10.5.0",l="11.0.0",p="11.7.0",u="11.2.0",g="12.0.0",m="12.8.0",f="14.0.0";(function(e){e.Core="Core",e.Gesture="Gesture",e.Audio="Audio",e.Analytics="Analytics",e.ObjectReferenceInScript="ObjectReferenceInScript",e.RenderChainEvent="RenderChainEvent"})(exports.Feature||(exports.Feature={}));const h=new Map([[exports.Feature.Core,c],[exports.Feature.Gesture,l],[exports.Feature.Audio,u],[exports.Feature.Analytics,g],[exports.Feature.ObjectReferenceInScript,m],[exports.Feature.RenderChainEvent,f]]);var _=effect.Amaz;class y{constructor(e,t,a,n){this._supportMemoryMapping=s.doesSDKSupport(p),this._native=e instanceof _.Color?e:new _.Color(null==e?1:e,null==t?1:t,null==a?1:a,null==n?1:n),this._values=this._supportMemoryMapping?new Float32Array(this._native.getBuffer()):new Float32Array}static fromNative(e){return new y(e)}static eq(e,t){return t&&e&&e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}get native(){return this._native}set(e,t,n,r){return this.a=r,this.r=e,this.g=t,this.b=n,this}get r(){return this._supportMemoryMapping?this._values[y.R]:this._native.r}set r(e){this._supportMemoryMapping?this._values[y.R]=Math.fround(e):this._native.r=e}get g(){return this._supportMemoryMapping?this._values[y.G]:this._native.g}set g(e){this._supportMemoryMapping?this._values[y.G]=Math.fround(e):this._native.g=e}get b(){return this._supportMemoryMapping?this._values[y.B]:this._native.b}set b(e){this._supportMemoryMapping?this._values[y.B]=Math.fround(e):this._native.b=e}get a(){return this._supportMemoryMapping?this._values[y.A]:this._native.a}set a(e){this._supportMemoryMapping?this._values[y.A]=Math.fround(e):this._native.a=e}eq(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}toString(){return`color(R: ${this.r.toFixed(3)}, G: ${this.g.toFixed(3)}, B: ${this.b.toFixed(3)}, A: ${this.a.toFixed(3)})`}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}clone(){return new y(this.r,this.g,this.b,this.a)}static lerp(e,a,n,r){var i=Math.min,o=Math.max;return void 0===r&&(r=new y),n=i(1,o(0,n)),r.r=e.r+n*(a.r-e.r),r.g=e.g+n*(a.g-e.g),r.b=e.b+n*(a.b-e.b),r.a=e.a+n*(a.a-e.a),r}}y.R=0,y.G=1,y.B=2,y.A=3;var v=effect.Amaz;class T{constructor(e,t,a,n){this._supportMemoryMapping=s.doesSDKSupport(p),this._native=e instanceof v.Rect?e:new v.Rect(null==e?0:e,null==t?0:t,null==a?0:a,null==n?0:n),this._values=this._supportMemoryMapping?new Float32Array(this._native.getBuffer()):new Float32Array}static fromNative(e){return new T(e)}static eq(e,t){return t&&e&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}get native(){return this._native}get x(){return this._supportMemoryMapping?this._values[T.X]:this._native.x}set x(e){this._supportMemoryMapping?this._values[T.X]=Math.fround(e):this._native.x=e}get y(){return this._supportMemoryMapping?this._values[T.Y]:this._native.y}set y(e){this._supportMemoryMapping?this._values[T.Y]=Math.fround(e):this._native.y=e}get width(){return this._supportMemoryMapping?this._values[T.Width]:this._native.width}set width(e){this._supportMemoryMapping?this._values[T.Width]=Math.fround(e):this._native.width=e}get height(){return this._supportMemoryMapping?this._values[T.Height]:this._native.height}set height(e){this._supportMemoryMapping?this._values[T.Height]=Math.fround(e):this._native.height=e}eq(e){return e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}toString(){return`Rect(${this.x.toFixed(5)}, ${this.y.toFixed(5)}, ${this.width.toFixed(5)}, ${this.height.toFixed(5)})`}copy(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}clone(){return new T(this.x,this.y,this.width,this.height)}}T.X=0,T.Y=1,T.Width=2,T.Height=3;var x=effect.Amaz,M=x.PixelFormat,S=x.MSAAMode,F=x.RenderTextureAttachment,C=x.Primitive,A=x.WrapMode,I=x.FilterMode,b=x.FilterMipmapMode,R=x.ShaderType,z=x.RendererType,P=x.CullFace,E=x.FrontFace,k=x.PolygonMode,L=x.CompareOp,B=x.BlendFactor,O=x.BlendOp;(function(e){e[e.Portrait=0]="Portrait",e[e.Landscape=1]="Landscape"})(exports.DeviceOrientationMode||(exports.DeviceOrientationMode={})),function(e){var t,a;e[e.Perspective=null==(t=x.CameraType)?void 0:t.PERSPECTIVE]="Perspective",e[e.Orthographic=null==(a=x.CameraType)?void 0:a.ORTHO]="Orthographic"}(exports.CameraType||(exports.CameraType={})),function(e){var t,a,n,r,i;e[e.AfterRender=null==(t=x.CameraEvent)?void 0:t.AFTER_RENDER]="AfterRender",e[e.BeforeRender=null==(a=x.CameraEvent)?void 0:a.BEFORE_RENDER]="BeforeRender",e[e.AfterEverything=null==(n=x.CameraEvent)?void 0:n.AFTER_EVERYTHING]="AfterEverything",e[e.AfterImageEffects=null==(r=x.CameraEvent)?void 0:r.AFTER_IMAGE_EFFECTS]="AfterImageEffects",e[e.RenderImageEffects=null==(i=x.CameraEvent)?void 0:i.RENDER_IMAGE_EFFECTS]="RenderImageEffects"}(exports.CameraRenderEvent||(exports.CameraRenderEvent={})),function(e){var t,a,n,r,i;e[e.Position=null==(t=x.VertexAttribType)?void 0:t.POSITION]="Position",e[e.Normal=null==(a=x.VertexAttribType)?void 0:a.NORMAL]="Normal",e[e.Tangent=null==(n=x.VertexAttribType)?void 0:n.TANGENT]="Tangent",e[e.Color=null==(r=x.VertexAttribType)?void 0:r.COLOR]="Color",e[e.Texcoord0=null==(i=x.VertexAttribType)?void 0:i.TEXCOORD0]="Texcoord0"}(exports.VertexAttribType||(exports.VertexAttribType={})),function(e){var t,a,n,r,i,o,s;e[e.Fit=null==(t=x.StretchMode)?void 0:t.fit]="Fit",e[e.Fill=null==(a=x.StretchMode)?void 0:a.fill]="Fill",e[e.FitWidth=null==(n=x.StretchMode)?void 0:n.fit_width]="FitWidth",e[e.FitHeight=null==(r=x.StretchMode)?void 0:r.fit_height]="FitHeight",e[e.Stretch=null==(i=x.StretchMode)?void 0:i.stretch]="Stretch",e[e.FillCut=null==(o=x.StretchMode)?void 0:o.fill_cut]="FillCut",e[e.ImageSize=null==(s=x.StretchMode)?void 0:s.texture_size]="ImageSize"}(exports.SpriteRenderMode||(exports.SpriteRenderMode={})),function(e){var t,a,n,r,i,o,s;e[e.Normal=null==(t=x.IFSprite2dType)?void 0:t.Normal]="Normal",e[e.Tiled=null==(a=x.IFSprite2dType)?void 0:a.Tiled]="Tiled",e[e.Sliced=null==(n=x.IFSprite2dType)?void 0:n.Sliced]="Sliced",e[e.Filled=null==(r=x.IFSprite2dType)?void 0:r.Filled]="Filled",e[e.Ellipse=null==(i=x.IFSprite2dType)?void 0:i.Ellipse]="Ellipse",e[e.Free=null==(o=x.IFSprite2dType)?void 0:o.Free]="Free",e[e.Corner=null==(s=x.IFSprite2dType)?void 0:s.Corner]="Corner"}(exports.ImageRenderMode||(exports.ImageRenderMode={})),function(e){var t,a,n;e[e.Horizontal=null==(t=x.IFFilledType)?void 0:t.Horizontal]="Horizontal",e[e.Vertical=null==(a=x.IFFilledType)?void 0:a.Vertical]="Vertical",e[e.Radial=null==(n=x.IFFilledType)?void 0:n.Radial]="Radial"}(exports.ImageFillType||(exports.ImageFillType={})),function(e){var t,a,n,r,i,o,s,d,c,l,p,u,g,m,f,h,_,y,v,T,M,S,F,C,A,I,b,R;e[e.Normal=null==(t=x.IFBlendMode)?void 0:t.Normal]="Normal",e[e.Add=null==(a=x.IFBlendMode)?void 0:a.Add]="Add",e[e.Average=null==(n=x.IFBlendMode)?void 0:n.Average]="Average",e[e.Burn=null==(r=x.IFBlendMode)?void 0:r.Burn]="Burn",e[e.Dodge=null==(i=x.IFBlendMode)?void 0:i.Dodge]="Dodge",e[e.Darken=null==(o=x.IFBlendMode)?void 0:o.Darken]="Darken",e[e.Difference=null==(s=x.IFBlendMode)?void 0:s.Difference]="Difference",e[e.Exclusion=null==(d=x.IFBlendMode)?void 0:d.Exclusion]="Exclusion",e[e.Glow=null==(c=x.IFBlendMode)?void 0:c.Glow]="Glow",e[e.HardLight=null==(l=x.IFBlendMode)?void 0:l.Hardlight]="HardLight",e[e.HardMix=null==(p=x.IFBlendMode)?void 0:p.Hardmix]="HardMix",e[e.Lighten=null==(u=x.IFBlendMode)?void 0:u.Lighten]="Lighten",e[e.LinearBurn=null==(g=x.IFBlendMode)?void 0:g.Linearburn]="LinearBurn",e[e.LinearDodge=null==(m=x.IFBlendMode)?void 0:m.Lineardodge]="LinearDodge",e[e.LinearLight=null==(f=x.IFBlendMode)?void 0:f.Linearlight]="LinearLight",e[e.Multiply=null==(h=x.IFBlendMode)?void 0:h.Multiply]="Multiply",e[e.Negation=null==(_=x.IFBlendMode)?void 0:_.Negation]="Negation",e[e.Overlay=null==(y=x.IFBlendMode)?void 0:y.Overlay]="Overlay",e[e.Phoenix=null==(v=x.IFBlendMode)?void 0:v.Phoenix]="Phoenix",e[e.PinLight=null==(T=x.IFBlendMode)?void 0:T.Pinlight]="PinLight",e[e.Reflect=null==(M=x.IFBlendMode)?void 0:M.Reflect]="Reflect",e[e.Screen=null==(S=x.IFBlendMode)?void 0:S.Screen]="Screen",e[e.Softlight=null==(F=x.IFBlendMode)?void 0:F.Softlight]="Softlight",e[e.Substract=null==(C=x.IFBlendMode)?void 0:C.Substract]="Substract",e[e.VividLight=null==(A=x.IFBlendMode)?void 0:A.Vividlight]="VividLight",e[e.SnowColor=null==(I=x.IFBlendMode)?void 0:I.Snowcolor]="SnowColor",e[e.SnowHue=null==(b=x.IFBlendMode)?void 0:b.Snowhue]="SnowHue",e[e.EndFlag=null==(R=x.IFBlendMode)?void 0:R.EndFlag]="EndFlag"}(exports.CanvasBlendMode||(exports.CanvasBlendMode={})),function(e){var t,a,n,r;e[e.None=null==(t=x.IFMaskType)?void 0:t.None]="None",e[e.Rect=null==(a=x.IFMaskType)?void 0:a.Rect]="Rect",e[e.Ellipse=null==(n=x.IFMaskType)?void 0:n.Ellipse]="Ellipse",e[e.Sprites=null==(r=x.IFMaskType)?void 0:r.MaskSprites]="Sprites"}(exports.CanvasMaskType||(exports.CanvasMaskType={})),function(e){var t,a;e[e.Overlay=null==(t=x.IFLayer2dRenderOrderMode)?void 0:t.ScreenOverlay]="Overlay",e[e.Custom=null==(a=x.IFLayer2dRenderOrderMode)?void 0:a.SceneCustom]="Custom"}(exports.CanvasRenderOrder||(exports.CanvasRenderOrder={})),function(e){var t,a,n,r;e[e.Once=null==(t=x.PlayMode)?void 0:t.once]="Once",e[e.Loop=null==(a=x.PlayMode)?void 0:a.loop]="Loop",e[e.PingPong=null==(n=x.PlayMode)?void 0:n.pingpong]="PingPong",e[e.Random=null==(r=x.PlayMode)?void 0:r.random]="Random"}(exports.SeqAnimationPlayMode||(exports.SeqAnimationPlayMode={})),function(e){e[e.Box=0]="Box"}(exports.UIColliderType||(exports.UIColliderType={})),function(e){var t,a,n;e[e.System=null==(t=x.IFUILabelFontType)?void 0:t.System]="System",e[e.TrueType=null==(a=x.IFUILabelFontType)?void 0:a.TrueType]="TrueType",e[e.Bitmap=null==(n=x.IFUILabelFontType)?void 0:n.Bitmap]="Bitmap"}(exports.LabelFontType||(exports.LabelFontType={})),function(e){var t,a,n;e[e.Left=null==(t=x.IFUILabelAlignment)?void 0:t.Left]="Left",e[e.Right=null==(a=x.IFUILabelAlignment)?void 0:a.Right]="Right",e[e.Center=null==(n=x.IFUILabelAlignment)?void 0:n.Center]="Center"}(exports.LabelAlignment||(exports.LabelAlignment={})),function(e){var t,a,n;e[e.AutoSize=null==(t=x.IFUILabelFitType)?void 0:t.AutoSize]="AutoSize",e[e.FitWidth=null==(a=x.IFUILabelFitType)?void 0:a.FitWidth]="FitWidth",e[e.FitSize=null==(n=x.IFUILabelFitType)?void 0:n.FitSize]="FitSize"}(exports.LabelFitType||(exports.LabelFitType={})),function(e){var t,a,n,r;e[e.None=null==(t=x.IFUIGridType)?void 0:t.NONE]="None",e[e.Horizontal=null==(a=x.IFUIGridType)?void 0:a.HORIZONTAL]="Horizontal",e[e.Vertical=null==(n=x.IFUIGridType)?void 0:n.VERTICAL]="Vertical",e[e.Grid=null==(r=x.IFUIGridType)?void 0:r.GRID]="Grid"}(exports.LayoutType||(exports.LayoutType={})),function(e){e[e.Directional=0]="Directional",e[e.Point=1]="Point",e[e.Spot=2]="Spot"}(exports.LightType||(exports.LightType={})),function(e){var t,a,n;e[e.None=null==(t=x.IFUIGridResizeMode)?void 0:t.NONE]="None",e[e.Container=null==(a=x.IFUIGridResizeMode)?void 0:a.CONTAINER]="Container",e[e.Children=null==(n=x.IFUIGridResizeMode)?void 0:n.CHILDREN]="Children"}(exports.LayoutSizeMode||(exports.LayoutSizeMode={})),function(e){var t,a;e[e.Horizontal=null==(t=x.IFUIGridStartAxis)?void 0:t.HORIZONTAL]="Horizontal",e[e.Vertical=null==(a=x.IFUIGridStartAxis)?void 0:a.VERTICAL]="Vertical"}(exports.LayoutGridMode||(exports.LayoutGridMode={})),function(e){var t,a;e[e.TopBottom=null==(t=x.IFUIGridVerticalDirection)?void 0:t.TOP_TO_BOTTOM]="TopBottom",e[e.BottomTop=null==(a=x.IFUIGridVerticalDirection)?void 0:a.BOTTOM_TO_TOP]="BottomTop"}(exports.LayoutVerticalDirection||(exports.LayoutVerticalDirection={})),function(e){var t,a;e[e.LeftRight=null==(t=x.IFUIGridHorizontalDirection)?void 0:t.LEFT_TO_RIGHT]="LeftRight",e[e.RightLeft=null==(a=x.IFUIGridHorizontalDirection)?void 0:a.RIGHT_TO_LEFT]="RightLeft"}(exports.LayoutHorizontalDirection||(exports.LayoutHorizontalDirection={})),function(e){var t,a;e[e.None=null==(t=x.IFUIGridSortingType)?void 0:t.NONE]="None",e[e.Alphabetic=null==(a=x.IFUIGridSortingType)?void 0:a.ALPHABETIC]="Alphabetic"}(exports.LayoutSortMode||(exports.LayoutSortMode={})),function(e){e.Head="head",e.Body="body",e.Hair="hair",e.Sky="sky",e.Building="building",e.Cloth="cloth",e.Ground="ground",e.Hand="hand"}(exports.SegmentationType||(exports.SegmentationType={}));const w=32;(function(e){e[e.Once=1]="Once",e[e.Loop=0]="Loop",e[e.PingPong=-1]="PingPong",e[e.Clamp=-2]="Clamp",e[e.Seek=-3]="Seek"})(exports.AnimationPlayMode||(exports.AnimationPlayMode={})),function(e){e[e.Unknown=0]="Unknown",e[e.Human=1]="Human",e[e.Cat=2]="Cat",e[e.Dog=3]="Dog"}(exports.FaceType||(exports.FaceType={})),function(e){e[e.Whole=0]="Whole",e[e.LeftEye=1]="LeftEye",e[e.RightEye=2]="RightEye",e[e.Nose=3]="Nose",e[e.Mouth=4]="Mouth",e[e.LeftEyeBrow=5]="LeftEyeBrow",e[e.RightEyeBrow=6]="RightEyeBrow",e[e.LeftEar=7]="LeftEar",e[e.RightEar=8]="RightEar",e[e.Contour=9]="Contour"}(exports.FacePart||(exports.FacePart={})),function(e){e[e.Unknown=0]="Unknown",e[e.Angry=1]="Angry",e[e.Disgust=2]="Disgust",e[e.Fear=3]="Fear",e[e.Happy=4]="Happy",e[e.Sad=5]="Sad",e[e.Surprise=6]="Surprise",e[e.Neutral=7]="Neutral"}(exports.FaceExpression||(exports.FaceExpression={})),function(e){e.Detected="detected",e.Lost="lost"}(exports.FaceEvent||(exports.FaceEvent={})),function(e){e[e.None=0]="None",e[e.EyeBlink=1]="EyeBlink",e[e.EyeBlinkLeft=2]="EyeBlinkLeft",e[e.EyeBlinkRight=3]="EyeBlinkRight",e[e.MouthAh=4]="MouthAh",e[e.MouthPout=5]="MouthPout",e[e.HeadYaw=6]="HeadYaw",e[e.HeadPitch=7]="HeadPitch",e[e.BrowJump=8]="BrowJump",e[e.SideNod=9]="SideNod"}(exports.FaceAction||(exports.FaceAction={})),function(e){e[e.Face106=0]="Face106",e[e.Face240=1]="Face240",e[e.Face280=2]="Face280",e[e.Face3d=3]="Face3d",e[e.PetV2=4]="PetV2"}(exports.FaceLandmarkType||(exports.FaceLandmarkType={})),function(e){e.Lost="lost",e.Detected="detected",e.StaticGesture="staticGesture",e.DynamicGesture="dynamicGesture"}(exports.HandEvent||(exports.HandEvent={})),function(e){e[e.HeartA=0]="HeartA",e[e.HeartB=1]="HeartB",e[e.HeartC=2]="HeartC",e[e.HeartD=3]="HeartD",e[e.OK=4]="OK",e[e.HandOpen=5]="HandOpen",e[e.ThumbUp=6]="ThumbUp",e[e.ThumbDown=7]="ThumbDown",e[e.Rock=8]="Rock",e[e.Namaste=9]="Namaste",e[e.PalmUp=10]="PalmUp",e[e.Fist=11]="Fist",e[e.IndexFingerUp=12]="IndexFingerUp",e[e.DoubleFingerUp=13]="DoubleFingerUp",e[e.Victory=14]="Victory",e[e.BigV=15]="BigV",e[e.PhoneCall=16]="PhoneCall",e[e.Beg=17]="Beg",e[e.Thanks=18]="Thanks",e[e.Unknown=19]="Unknown",e[e.Cabbage=20]="Cabbage",e[e.Three=21]="Three",e[e.Four=22]="Four",e[e.Pistol=23]="Pistol",e[e.Rock2=24]="Rock2",e[e.Swear=25]="Swear",e[e.HoldFace=26]="HoldFace",e[e.Salute=27]="Salute",e[e.Spread=28]="Spread",e[e.Pray=29]="Pray",e[e.QiGong=30]="QiGong",e[e.Slide=31]="Slide",e[e.PalmDown=32]="PalmDown",e[e.Pistol2=33]="Pistol2",e[e.NinjaMudra1=34]="NinjaMudra1",e[e.NinjaMudra2=35]="NinjaMudra2",e[e.NinjaMudra3=36]="NinjaMudra3",e[e.NinjaMudra4=37]="NinjaMudra4",e[e.NinjaMudra5=38]="NinjaMudra5",e[e.NinjaMudra6=39]="NinjaMudra6",e[e.NinjaMudra7=40]="NinjaMudra7",e[e.NinjaMudra8=41]="NinjaMudra8",e[e.NinjaMudra9=42]="NinjaMudra9",e[e.NinjaMudra10=43]="NinjaMudra10",e[e.NinjaMudra11=44]="NinjaMudra11",e[e.SpiderHand=45]="SpiderHand",e[e.AvengerHand=46]="AvengerHand",e[e.MaxCount=47]="MaxCount",e[e.Undetect=48]="Undetect",e[e.None=99]="None"}(exports.HandStaticGesture||(exports.HandStaticGesture={})),function(e){e[e.None=0]="None",e[e.Punching=1]="Punching",e[e.Clapping=2]="Clapping",e[e.HighFive=4]="HighFive"}(exports.HandDynamicGesture||(exports.HandDynamicGesture={})),function(e){e[e.Wrist=0]="Wrist",e[e.Thumb3=1]="Thumb3",e[e.Thumb2=2]="Thumb2",e[e.Thumb1=3]="Thumb1",e[e.Thumb0=4]="Thumb0",e[e.Index3=5]="Index3",e[e.Index2=6]="Index2",e[e.Index1=7]="Index1",e[e.Index0=8]="Index0",e[e.Middle3=9]="Middle3",e[e.Middle2=10]="Middle2",e[e.Middle1=11]="Middle1",e[e.Middle0=12]="Middle0",e[e.Ring3=13]="Ring3",e[e.Ring2=14]="Ring2",e[e.Ring1=15]="Ring1",e[e.Ring0=16]="Ring0",e[e.Pinky3=17]="Pinky3",e[e.Pinky2=18]="Pinky2",e[e.Pinky1=19]="Pinky1",e[e.Pinky0=20]="Pinky0",e[e.Center=21]="Center"}(exports.HandKeyPoint||(exports.HandKeyPoint={})),function(e){e.Detected="detected",e.Lost="lost",e.Action="action"}(exports.BodyEvent||(exports.BodyEvent={})),function(e){e[e.Nose=0]="Nose",e[e.Neck=1]="Neck",e[e.RightShoulder=2]="RightShoulder",e[e.RightElbow=3]="RightElbow",e[e.RightWrist=4]="RightWrist",e[e.LeftShoulder=5]="LeftShoulder",e[e.LeftElbow=6]="LeftElbow",e[e.LeftWrist=7]="LeftWrist",e[e.RightHip=8]="RightHip",e[e.RightKnee=9]="RightKnee",e[e.RightAnkle=10]="RightAnkle",e[e.LeftHip=11]="LeftHip",e[e.LeftKnee=12]="LeftKnee",e[e.LeftAnkle=13]="LeftAnkle",e[e.RightEye=14]="RightEye",e[e.LeftEye=15]="LeftEye",e[e.RightEar=16]="RightEar",e[e.LeftEar=17]="LeftEar"}(exports.Body2DKeyPointType||(exports.Body2DKeyPointType={})),function(e){e[e.Hips=0]="Hips",e[e.LeftUpLeg=1]="LeftUpLeg",e[e.RightUpLeg=2]="RightUpLeg",e[e.Spine=3]="Spine",e[e.LeftLeg=4]="LeftLeg",e[e.RightLeg=5]="RightLeg",e[e.Spine1=6]="Spine1",e[e.LeftFoot=7]="LeftFoot",e[e.RightFoot=8]="RightFoot",e[e.Spine2=9]="Spine2",e[e.LeftToe=10]="LeftToe",e[e.RightToe=11]="RightToe",e[e.Neck=12]="Neck",e[e.LeftShoulder=13]="LeftShoulder",e[e.RightShoulder=14]="RightShoulder",e[e.Head=15]="Head",e[e.LeftArm=16]="LeftArm",e[e.RightArm=17]="RightArm",e[e.LeftForeArm=18]="LeftForeArm",e[e.RightForeArm=19]="RightForeArm",e[e.LeftHand=20]="LeftHand",e[e.RightHand=21]="RightHand"}(exports.Body3DKeyPointType||(exports.Body3DKeyPointType={})),function(e){e.Detected="detected",e.Lost="lost"}(exports.AvatarDriveEvent||(exports.AvatarDriveEvent={})),function(e){e[e.LeftEyeLookDown=0]="LeftEyeLookDown",e[e.LeftNoseSneer=1]="LeftNoseSneer",e[e.LeftEyeLookIn=2]="LeftEyeLookIn",e[e.BrowInnerUp=3]="BrowInnerUp",e[e.LeftEyeSquint=4]="LeftEyeSquint",e[e.MouthClose=5]="MouthClose",e[e.RightMouthLowerDown=6]="RightMouthLowerDown",e[e.JawOpen=7]="JawOpen",e[e.MouthShrugLower=8]="MouthShrugLower",e[e.LeftMouthLowerDown=9]="LeftMouthLowerDown",e[e.MouthFunnel=10]="MouthFunnel",e[e.RightEyeLookIn=11]="RightEyeLookIn",e[e.RightEyeLookDown=12]="RightEyeLookDown",e[e.RightNoseSneer=13]="RightNoseSneer",e[e.MouthRollUpper=14]="MouthRollUpper",e[e.JawRight=15]="JawRight",e[e.LeftMouthDimple=16]="LeftMouthDimple",e[e.MouthRollLower=17]="MouthRollLower",e[e.LeftMouthSmile=18]="LeftMouthSmile",e[e.LeftMouthPress=19]="LeftMouthPress",e[e.RightMouthSmile=20]="RightMouthSmile",e[e.RightMouthPress=21]="RightMouthPress",e[e.RightMouthDimple=22]="RightMouthDimple",e[e.MouthLeft=23]="MouthLeft",e[e.RightBrowDown=24]="RightBrowDown",e[e.LeftBrowDown=25]="LeftBrowDown",e[e.LeftMouthFrown=26]="LeftMouthFrown",e[e.LeftEyeBlink=27]="LeftEyeBlink",e[e.LeftCheekSquint=28]="LeftCheekSquint",e[e.LeftBrowOuterUp=29]="LeftBrowOuterUp",e[e.LeftEyeLookUp=30]="LeftEyeLookUp",e[e.JawLeft=31]="JawLeft",e[e.LeftMouthStretch=32]="LeftMouthStretch",e[e.RightMouthStretch=33]="RightMouthStretch",e[e.MouthPucker=34]="MouthPucker",e[e.RightEyeLookUp=35]="RightEyeLookUp",e[e.RightBrowOuterUp=36]="RightBrowOuterUp",e[e.RightCheekSquint=37]="RightCheekSquint",e[e.RightEyeBlink=38]="RightEyeBlink",e[e.LeftMouthUpperUp=39]="LeftMouthUpperUp",e[e.RightMouthFrown=40]="RightMouthFrown",e[e.RightEyeSquint=41]="RightEyeSquint",e[e.JawForward=42]="JawForward",e[e.RightMouthUpperUp=43]="RightMouthUpperUp",e[e.CheekPuff=44]="CheekPuff",e[e.LeftEyeLookOut=45]="LeftEyeLookOut",e[e.RightEyeLookOut=46]="RightEyeLookOut",e[e.RightEyeWide=47]="RightEyeWide",e[e.MouthRight=48]="MouthRight",e[e.LeftEyeWide=49]="LeftEyeWide",e[e.MouthShrugUpper=50]="MouthShrugUpper",e[e.TongueOut=51]="TongueOut"}(exports.AvatarDriveBlendShapeType||(exports.AvatarDriveBlendShapeType={})),function(e){e.Texture="texture",e.Mesh="mesh"}(exports.AssetType||(exports.AssetType={}));const D=64;(function(e){e[e.AR=0]="AR",e[e.UI=1]="UI",e[e.ThreeD=2]="ThreeD",e[e.TwoD=3]="TwoD",e[e.Other=4]="Other"})(exports.ScreenRaycasterType||(exports.ScreenRaycasterType={})),function(e){e.Segmentation="segmentation",e.Face="face",e.CameraInput="cameraInput",e.ImagePicker="imagePicker",e.CaptureFrame="captureFrame"}(exports.AssetSubType||(exports.AssetSubType={})),function(e){e.Possible="possible",e.Began="began",e.Changed="changed",e.Ended="ended",e.Cancelled="cancelled",e.Failed="failed"}(exports.GestureRecognizerState||(exports.GestureRecognizerState={})),function(e){e.Tap="tap",e.Pan="pan",e.Pinch="pinch",e.Rotation="rotation",e.LongPress="longPress",e.DoubleTap="doubleTap"}(exports.GestureType||(exports.GestureType={})),function(e){e.Began="screenRespondBegan",e.Ended="screenRespondEnded",e.Respond="screenRespond"}(exports.ScreenRespondType||(exports.ScreenRespondType={})),function(e){e[e.Once=0]="Once",e[e.Continuous=1]="Continuous"}(exports.TouchRespondType||(exports.TouchRespondType={}));var V=effect.Amaz;const N=["clearColor","clearColorBuffer","clearDepthBuffer","clearStencilBuffer","orthoHeight","near","far","fov","type","viewport","layers","renderOrder"];class H extends t{constructor(e,t){if(e){super(e,"Camera");const a=new V.DynamicBitset(D,0);a.set(0,1),this.native.layerVisibleMask=a,this.initialize(t,N),this.native.renderTexture=new V.SceneOutputRT}else super()}static register(){t.registerComponentType("Camera",this.nativeClasses,H),this.register=()=>void 0}static fromNative(e,t){const a=new H;if(t instanceof V.Camera)a.initWithNative(e,t,"Camera");else throw new Error("Incorrect argument to CameraComponent::fromNative");return a}get renderTexture(){return this.native.renderTexture}set renderTexture(e){this.native.renderTexture=e}get clearColor(){return new y(this.native.clearColor)}set clearColor(e){this.native.clearColor=e.native}get clearColorBuffer(){const e=this.native.clearType;return 1===e||3===e||7===e}set clearColorBuffer(e){let t=this.native.clearType;0===t||4===t||5===t?t=e?1:t:1===t?t=e?1:5:2===t||3===t?t=e?3:2:6===t||7===t?t=e?7:6:void 0;this.native.clearType=t}get clearDepthBuffer(){const e=this.native.clearType;return 2===e||3===e||6===e||7===e}set clearDepthBuffer(e){let t=this.native.clearType;0===t||4===t||5===t?t=e?2:t:1===t||3===t?t=e?3:1:2===t?t=e?e:5:6===t?t=e?6:5:7===t?t=e?7:1:void 0;this.native.clearType=t}get clearStencilBuffer(){const e=this.native.clearType;return 6===e||7===e}set clearStencilBuffer(e){let t=this.native.clearType;0===t||4===t||5===t?t=e?6:t:1===t||3===t?t=e?7:t:2===t||6===t?t=e?6:2:7===t?t=e?7:1:void 0;this.native.clearType=t}get orthoHeight(){return this.native.orthoScale}set orthoHeight(e){this.native.orthoScale=e}get near(){return this.native.zNear}set near(e){this.native.zNear=e}get far(){return this.native.zFar}set far(e){this.native.zFar=e}get fov(){return this.native.fovy}set fov(e){this.native.fovy=e}get type(){return this.native.type}set type(e){this.native.type=e}get viewport(){return new T(this.native.viewport)}set viewport(e){this.native.viewport=e.native}get layers(){const e=[];for(let t=0;t<D;++t)this.native.layerVisibleMask.test(t)&&e.push(t);return e}set layers(e){const t=new V.DynamicBitset(D,0);for(const a of e)if(0<=a&&a<D)t.set(a);else throw new Error("Invalid layer value!");this.native.layerVisibleMask=t}get renderOrder(){return this.native.renderOrder}set renderOrder(e){this.native.renderOrder=e}screenToWorld(e){return this.native.screenToWorldPoint(e.native)}worldToScreen(e){return this.native.worldToScreenPoint(e.native)}}H.nativeClasses=["Camera"],H.register();class U{constructor(e){this._supportMemoryMapping=s.doesSDKSupport(p),this._native=e,this._values=this._supportMemoryMapping?new Float32Array(this._native.getBuffer()):new Float32Array}}U.X=0,U.Y=1,U.Z=2,U.W=3;const G=Math.PI/180,j=180/Math.PI,W=1e-5,X=3.141592653589793,Y=.7071067811865476,q=.002777777777777778;function Z(e,t,a=1e-6){return Math.abs(e-t)<=a}function K(e){return 2*(e*q)*X}var J=effect.Amaz;class Q extends U{constructor(e,t){e instanceof J.Vector2f?super(e):super(new J.Vector2f(null==e?0:e,null==t?0:t))}static fromNative(e){return new Q(e)}static eq(e,t){return e&&t&&e.x===t.x&&e.y===t.y}get native(){return this._native}set(e,t){return this.x=e,this.y=t,this}get x(){return this._supportMemoryMapping?this._values[U.X]:this._native.x}set x(e){this._supportMemoryMapping?this._values[U.X]=Math.fround(e):this._native.x=e}get y(){return this._supportMemoryMapping?this._values[U.Y]:this._native.y}set y(e){this._supportMemoryMapping?this._values[U.Y]=Math.fround(e):this._native.y=e}copy(e){return this.x=e.x,this.y=e.y,this}clone(){return new Q(this.x,this.y)}add(e){return this.x+=e.x,this.y+=e.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}mul(e){return e instanceof Q?(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=e),this}div(e){return e instanceof Q?(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=e),this}eq(e){return e&&this.x===e.x&&this.y===e.y}neg(){return this.x=-this.x,this.y=-this.y,this}inv(){return this.x=1/this.x,this.y=1/this.y,this}dot(e){return this.x*e.x+this.y*e.y}len(){return Math.sqrt(this.dot(this))}lenSq(){return this.dot(this)}angle(e){const t=Math.acos(Math.min(1,Math.max(-1,this.dot(e)/(this.len()*e.len()))));return t*j}normalize(){return this.div(this.len())}isNormalized(){return Z(this.lenSq(),1)}max(e,t){var a=Math.max;return this.set(a(e.x,t.x),a(e.y,t.y))}min(e,t){var a=Math.min;return this.set(a(e.x,t.x),a(e.y,t.y))}abs(){var e=Math.abs;return this.set(e(this.x),e(this.y))}static lerp(e,a,n,r){var i=Math.min,o=Math.max;return void 0===r&&(r=new Q),n=i(1,o(0,n)),r.x=e.x+n*(a.x-e.x),r.y=e.y+n*(a.y-e.y),r}distance(e){const t=e.clone().sub(this);return t.len()}isFinite(){var e=Number.isFinite;return e(this.x)&&e(this.y)}toString(){return`Vector2f(${this.x.toFixed(5)}, ${this.y.toFixed(5)})`}aboutEq(e,t){return Z(this.x,e.x,t)&&Z(this.y,e.y,t)}}const $=["alpha","alphaCascading"];class ee extends t{constructor(e,t,a){if(!(e&&t))super();else if(e.screenTransform)super(e,t),this.initialize(a,this.getProps());else throw new Error("Widget2DComponent can only be added to an 2d sceneObject")}getProps(){return $}get alpha(){return this.native.alpha}set alpha(e){this.native.alpha=e}get alphaCascading(){return this.native.cascadeAlphaEnabled}set alphaCascading(e){this.native.cascadeAlphaEnabled=e}}var te=effect.Amaz;const ae=["renderMode","color","texture","atlas","atlasIndex","filledType","filledStart","filledRange","slicedLeft","slicedRight","slicedTop","slicedBottom","slicedFillCenter","ellipseWidth","ellipseHeight","freeTopLeft","freeTopRight","freeBottomLeft","freeBottomRight","cornerTopLeft","cornerTopRight","cornerBottomLeft","cornerBottomRight"];class ne extends ee{constructor(e,t){super(e,"IFSprite2d",t)}static register(){t.registerComponentType("Image",this.nativeClasses,ne),this.register=()=>void 0}static fromNative(e,t){const a=new ne;if(t instanceof te.IFSprite2d)a.initWithNative(e,t,"IFSprite2d");else throw new Error("Incorrect argument in ImageComponent::fromNative");return a}getProps(){const e=super.getProps();return e.concat(ae)}get renderMode(){return this.native.type}set renderMode(e){this.native.type=e}get color(){return new y(this.native.colorTint)}set color(e){this.native.colorTint=e.native}get texture(){return this.native.texture}set texture(e){this.native.texture=e}get atlas(){return this.native.imageAtlas}set atlas(e){this.native.imageAtlas=e}get atlasIndex(){return this.native.atlasIndex}set atlasIndex(e){this.native.atlasIndex=e}get filledType(){return this.native.filledType}set filledType(e){this.native.filledType=e}get filledStart(){return this.native.filledStartPos}set filledStart(e){this.native.filledStartPos=e}get filledRange(){return this.native.filledRange}set filledRange(e){this.native.filledRange=e}get slicedLeft(){return this.native.slicedLeft}set slicedLeft(e){this.native.slicedLeft=e}get slicedRight(){return this.native.slicedRight}set slicedRight(e){this.native.slicedRight=e}get slicedTop(){return this.native.slicedTop}set slicedTop(e){this.native.slicedTop=e}get slicedBottom(){return this.native.slicedBottom}set slicedBottom(e){this.native.slicedBottom=e}get slicedFillCenter(){return this.native.fillCenter}set slicedFillCenter(e){this.native.fillCenter=e}get ellipseWidth(){return this.native.ellipseX}set ellipseWidth(e){this.native.ellipseX=e}get ellipseHeight(){return this.native.ellipseY}set ellipseHeight(e){this.native.ellipseY=e}get freeTopLeft(){return new Q(this.native.topLeftPoint)}set freeTopLeft(e){this.native.topLeftPoint=e.native}get freeTopRight(){return new Q(this.native.topRightPoint)}set freeTopRight(e){this.native.topRightPoint=e.native}get freeBottomLeft(){return new Q(this.native.bottomLeftPoint)}set freeBottomLeft(e){this.native.bottomLeftPoint=e.native}get freeBottomRight(){return new Q(this.native.bottomRightPoint)}set freeBottomRight(e){this.native.bottomRightPoint=e.native}get cornerTopLeft(){return this.native.topLeft}set cornerTopLeft(e){this.native.topLeft=e}get cornerTopRight(){return this.native.topRight}set cornerTopRight(e){this.native.topRight=e}get cornerBottomLeft(){return this.native.bottomLeft}set cornerBottomLeft(e){this.native.bottomLeft=e}get cornerBottomRight(){return this.native.bottomRight}set cornerBottomRight(e){this.native.bottomRight=e}}ne.nativeClasses=["IFSprite2d"],ne.register();var re=effect.Amaz;const ie=["blendMode","alpha","alphaBlending","mask","clipping"];class oe extends t{constructor(e,t){if(!e)super();else if(e.screenTransform)super(e,"IFLayer2d"),t||(t={}),t&&!t.hasOwnProperty("alphaBlending")&&(t.alphaBlending=!0),this.initialize(t,this.getProps());else throw new Error("CanvasComponent can only be added to an 2d sceneObject")}static register(){t.registerComponentType("Canvas",this.nativeClasses,oe),this.register=()=>void 0}static fromNative(e,t){const a=new oe;if(t instanceof re.IFLayer2d)a.initWithNative(e,t,"IFLayer2d");else throw new Error("Incorrect argument to CanvasComponent::fromNative");return a}getProps(){return ie}get blendMode(){return this.native.blendMode}set blendMode(e){this.native.blendMode=e}get maskType(){return this.native.maskType}set maskType(e){this.native.maskType=e}get renderOrder(){return this.native.renderOrderMode}set renderOrder(e){this.native.renderOrderMode=e}get alpha(){return this.native.blendAlpha}set alpha(e){this.native.blendAlpha=e}get clipping(){return this.native.scissorRectMask}set clipping(e){this.native.scissorRectMask=e}get alphaBlending(){return this.native.blendAlphaCkeck}set alphaBlending(e){this.native.blendAlphaCkeck=e}getDrawCallCount(){return this.native.drawCallNum}}oe.nativeClasses=["IFLayer2d"],oe.register();var se=effect.Amaz;class de extends U{constructor(e,t,a){e instanceof se.Vector3f?super(e):super(new se.Vector3f(null==e?0:e,null==t?0:t,null==a?0:a))}static fromNative(e){return new de(e)}static eq(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.z===t.z}get native(){return this._native}set(e,t,a){return this.x=e,this.y=t,this.z=a,this}get x(){return this._supportMemoryMapping?this._values[U.X]:this._native.x}set x(e){this._supportMemoryMapping?this._values[U.X]=Math.fround(e):this._native.x=e}get y(){return this._supportMemoryMapping?this._values[U.Y]:this._native.y}set y(e){this._supportMemoryMapping?this._values[U.Y]=Math.fround(e):this._native.y=e}get z(){return this._supportMemoryMapping?this._values[U.Z]:this._native.z}set z(e){this._supportMemoryMapping?this._values[U.Z]=Math.fround(e):this._native.z=e}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}clone(){return new de(this.x,this.y,this.z)}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}mul(e){return e instanceof de?(this.x*=e.x,this.y*=e.y,this.z*=e.z):(this.x*=e,this.y*=e,this.z*=e),this}div(e){return e instanceof de?(this.x/=e.x,this.y/=e.y,this.z/=e.z):(this.x/=e,this.y/=e,this.z/=e),this}eq(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z}neg(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}inv(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this}scale(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}len(){return Math.sqrt(this.dot(this))}lenSq(){return this.dot(this)}normalize(){return this.div(this.len())}isNormalized(){return Z(this.lenSq(),1)}max(e,t){var a=Math.max;return this.set(a(e.x,t.x),a(e.y,t.y),a(e.z,t.z)),this}min(e,t){var a=Math.min;return this.set(a(e.x,t.x),a(e.y,t.y),a(e.z,t.z)),this}abs(){var e=Math.abs;return this.set(e(this.x),e(this.y),e(this.z)),this}static lerp(e,a,n,r){var i=Math.min,o=Math.max;return void 0===r&&(r=new de),n=i(1,o(0,n)),r.x=e.x+n*(a.x-e.x),r.y=e.y+n*(a.y-e.y),r.z=e.z+n*(a.z-e.z),r}static slerp(e,a,n,t){void 0===t&&(t=new de);const r=e._native.slerp(a._native,n);return t.set(r.x,r.y,r.z),t}distance(e){return e.clone().sub(this).len()}isFinite(){var e=Number.isFinite;return e(this.x)&&e(this.y)&&e(this.z)}cross(e,t){return this.set(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x),this}static cross(e,t,a){return void 0===a&&(a=new de),a.cross(e,t)}static reflect(e,t,a){return void 0===a&&(a=new de),a.copy(t),a.mul(-2*t.dot(e)).add(e)}toString(){return`Vector3f(${this.x.toFixed(5)}, ${this.y.toFixed(5)}, ${this.z.toFixed(5)})`}aboutEq(e,t){return Z(this.x,e.x,t)&&Z(this.y,e.y,t)&&Z(this.z,e.z,t)}static orthoNormalize(e,t,a){e.native.orthoNormalize(t.native,a.native)}rotateTowards(e,t,a,n){const r=e.native.rotateTowards(t.native,a*G,n);return this.set(r.x,r.y,r.z)}static rotateTowards(e,t,a,n,r){return void 0===r&&(r=new de),r.rotateTowards(e,t,a,n)}moveTowards(e,t,a){const n=e.native.moveTowards(t.native,a);return this.set(n.x,n.y,n.z)}static moveTowards(e,t,a,n){return void 0===n&&(n=new de),n.moveTowards(e,t,a)}}var ce=effect.Amaz;class le extends U{constructor(e,t,a,n){e instanceof ce.Vector4f?super(e):super(new ce.Vector4f(null==e?0:e,null==t?0:t,null==a?0:a,null==n?0:n))}static fromNative(e){return new le(e)}static eq(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}get native(){return this._native}set(e,t,a,n){return this.x=e,this.y=t,this.z=a,this.w=n,this}get x(){return this._supportMemoryMapping?this._values[U.X]:this._native.x}set x(e){this._supportMemoryMapping?this._values[U.X]=Math.fround(e):this._native.x=e}get y(){return this._supportMemoryMapping?this._values[U.Y]:this._native.y}set y(e){this._supportMemoryMapping?this._values[U.Y]=Math.fround(e):this._native.y=e}get z(){return this._supportMemoryMapping?this._values[U.Z]:this._native.z}set z(e){this._supportMemoryMapping?this._values[U.Z]=Math.fround(e):this._native.z=e}get w(){return this._supportMemoryMapping?this._values[U.W]:this._native.w}set w(e){this._supportMemoryMapping?this._values[U.W]=Math.fround(e):this._native.w=e}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}clone(){return new le(this.x,this.y,this.z,this.w)}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}mul(e){return e instanceof le?(this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}div(e){return e instanceof le?(this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w):(this.x/=e,this.y/=e,this.z/=e,this.w/=e),this}eq(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w}neg(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}static lerp(e,a,n,r){var i=Math.min,o=Math.max;return void 0===r&&(r=new le),n=i(1,o(0,n)),r.x=e.x+n*(a.x-e.x),r.y=e.y+n*(a.y-e.y),r.z=e.z+n*(a.z-e.z),r.w=e.w+n*(a.w-e.w),r}toString(){return`Vector4f(${this.x.toFixed(5)}, ${this.y.toFixed(5)}, ${this.z.toFixed(5)}, ${this.w.toFixed(5)})`}isFinite(){var e=Number.isFinite;return e(this.x)&&e(this.y)&&e(this.z)&&e(this.w)}}class pe{constructor(e){this._supportMemoryMapping=s.doesSDKSupport(p),this._native=e,this._values=this._supportMemoryMapping?new Float32Array(this._native.getBuffer()):new Float32Array}}var ue=effect.Amaz;const ge=3;class me extends pe{constructor(e,t,a,n,r,i,o,s,d){e instanceof ue.Matrix3x3f?super(e):super(new ue.Matrix3x3f(null==e?1:e,null==t?0:t,null==a?0:a,null==n?0:n,null==r?1:r,null==i?0:i,null==o?0:o,null==s?0:s,null==d?1:d))}static fromNative(e){return new me(e)}get native(){return this._native}set(e,t,a){var n=Math.fround;return this._supportMemoryMapping?e<ge&&t<ge&&(this._values[e+t*ge]=n(a)):e<ge&&t<ge&&this._native.set(e,t,a),this}get(e,t){return this._supportMemoryMapping?this._values[e+t*ge]:this._native.get(e,t)}getColumn(e,t){return void 0===t&&(t=new de),t.set(this.get(0,e),this.get(1,e),this.get(2,e))}copy(e){for(let t=0;t<ge;++t)for(let a=0;a<ge;++a)this.set(t,a,e.get(t,a));return this}clone(){const e=new me;for(let t=0;t<ge;++t)for(let a=0;a<ge;++a)e.set(t,a,this.get(t,a));return e}eq(e){for(let t=0;t<ge;++t)for(let a=0;a<ge;++a)if(this.get(t,a)!==e.get(t,a))return!1;return!0}static eq(e,t){for(let a=0;a<ge;++a)for(let n=0;n<ge;++n)if(e.get(a,n)!==t.get(a,n))return!1;return!0}identity(){return this.set(0,0,1),this.set(1,0,0),this.set(2,0,0),this.set(0,1,0),this.set(1,1,1),this.set(2,1,0),this.set(0,2,0),this.set(1,2,0),this.set(2,2,1),this}zero(){return this.set(0,0,0),this.set(1,0,0),this.set(2,0,0),this.set(0,1,0),this.set(1,1,0),this.set(2,1,0),this.set(0,2,0),this.set(1,2,0),this.set(2,2,0),this}isIdentity(e){return Z(this.get(0,0),1,e)&&Z(this.get(1,0),0,e)&&Z(this.get(2,0),0,e)&&Z(this.get(0,1),0,e)&&Z(this.get(1,1),1,e)&&Z(this.get(2,1),0,e)&&Z(this.get(0,2),0,e)&&Z(this.get(1,2),0,e)&&Z(this.get(2,2),1,e)}isZero(e){return Z(this.get(0,0),0,e)&&Z(this.get(1,0),0,e)&&Z(this.get(2,0),0,e)&&Z(this.get(0,1),0,e)&&Z(this.get(1,1),0,e)&&Z(this.get(2,1),0,e)&&Z(this.get(0,2),0,e)&&Z(this.get(1,2),0,e)&&Z(this.get(2,2),0,e)}inv(){let e=this.determinant();if(Z(e,0))return this.zero();e=1/e;const t=e*(this.get(1,1)*this.get(2,2)-this.get(1,2)*this.get(2,1)),a=e*-(this.get(1,0)*this.get(2,2)-this.get(1,2)*this.get(2,0)),n=e*(this.get(1,0)*this.get(2,1)-this.get(1,1)*this.get(2,0)),r=e*-(this.get(0,1)*this.get(2,2)-this.get(0,2)*this.get(2,1)),i=e*(this.get(0,0)*this.get(2,2)-this.get(0,2)*this.get(2,0)),o=e*-(this.get(0,0)*this.get(2,1)-this.get(0,1)*this.get(2,0)),s=e*(this.get(0,1)*this.get(1,2)-this.get(0,2)*this.get(1,1)),d=e*-(this.get(0,0)*this.get(1,2)-this.get(0,2)*this.get(1,0)),c=e*(this.get(0,0)*this.get(1,1)-this.get(0,1)*this.get(1,0));return this.set(0,0,t),this.set(1,0,a),this.set(2,0,n),this.set(0,1,r),this.set(1,1,i),this.set(2,1,o),this.set(0,2,s),this.set(1,2,d),this.set(2,2,c),this}mul(e){for(let t=0;t<ge;++t){const a=[this.get(t,0),this.get(t,1),this.get(t,2)];this.set(t,0,a[0]*e.get(0,0)+a[1]*e.get(1,0)+a[2]*e.get(2,0)),this.set(t,1,a[0]*e.get(0,1)+a[1]*e.get(1,1)+a[2]*e.get(2,1)),this.set(t,2,a[0]*e.get(0,2)+a[1]*e.get(1,2)+a[2]*e.get(2,2))}return this}transformVec3(e){return e.set(this.get(0,0)*e.x+this.get(0,1)*e.y+this.get(0,2)*e.z,this.get(1,0)*e.x+this.get(1,1)*e.y+this.get(1,2)*e.z,this.get(2,0)*e.x+this.get(2,1)*e.y+this.get(2,2)*e.z)}static transformVec3(e,t){return e.transformVec3(t)}scale(e){return this.set(0,0,this.get(0,0)*e.x),this.set(1,0,this.get(1,0)*e.x),this.set(2,0,this.get(2,0)*e.x),this.set(0,1,this.get(0,1)*e.y),this.set(1,1,this.get(1,1)*e.y),this.set(2,1,this.get(2,1)*e.y),this.set(0,2,this.get(0,2)*e.z),this.set(1,2,this.get(1,2)*e.z),this.set(2,2,this.get(2,2)*e.z),this}fromScale(e){return this.set(0,0,e.x),this.set(1,0,0),this.set(2,0,0),this.set(0,1,0),this.set(1,1,e.y),this.set(2,1,0),this.set(0,2,0),this.set(1,2,0),this.set(2,2,e.z),this}determinant(){const e=this.get(0,0)*this.get(1,1)*this.get(2,2),t=this.get(0,1)*this.get(1,2)*this.get(2,0),a=this.get(0,2)*this.get(1,0)*this.get(2,1),n=this.get(0,2)*this.get(1,1)*this.get(2,0),r=this.get(0,1)*this.get(1,0)*this.get(2,2),i=this.get(0,0)*this.get(1,2)*this.get(2,1);return e+t+a-n-r-i}transpose(){let e=this.get(0,1);return this.set(0,1,this.get(1,0)),this.set(1,0,e),e=this.get(0,2),this.set(0,2,this.get(2,0)),this.set(2,0,e),e=this.get(1,2),this.set(1,2,this.get(2,1)),this.set(2,1,e),this}static fromEulerAngles(e,t,a,n){var r=Math.sin,i=Math.cos;void 0===n&&(n=new me);const o=i(e*G),s=r(e*G),d=i(t*G),c=r(t*G),l=i(a*G),p=r(a*G);return n.set(0,0,d*l+s*c*p),n.set(0,1,l*s*c-d*p),n.set(0,2,o*c),n.set(1,0,o*p),n.set(1,1,o*l),n.set(1,2,-s),n.set(2,0,-l*c+d*s*p),n.set(2,1,d*l*s+c*p),n.set(2,2,o*d),n}fromAxisAngle(e,t){var a=Math.sin,n=Math.cos;const r=a(t*G),i=n(t*G),o=e.x,s=e.y,d=e.z,c=o*s,l=s*d,p=d*o,u=o*r,g=s*r,m=d*r,f=1-i;return this.set(0,0,f*(o*o)+i),this.set(0,1,f*c-m),this.set(0,2,f*p+g),this.set(1,0,f*c+m),this.set(1,1,f*(s*s)+i),this.set(1,2,f*l-u),this.set(2,0,f*p-g),this.set(2,1,f*l+u),this.set(2,2,f*(d*d)+i),this}static fromAxisAngle(e,t,a){return void 0===a&&(a=new me),a.fromAxisAngle(e,t)}fromToRotation(t,a){const n=new de;n.cross(t,a);const r=t.dot(a);if(r>1-W)return this.identity();if(r<-1+W){const e=new de(0,t.z,-t.y);e.len()<W&&e.set(-t.z,0,t.x),e.normalize();const a=new de;a.cross(e,t);const n=-t.x*t.x,r=-t.y*t.y,i=-t.z*t.z,o=-t.x*t.y,s=-t.x*t.z,d=-t.y*t.z,c=a.x*a.x,l=a.y*a.y,p=a.z*a.z,u=a.x*a.y,g=a.x*a.z,m=a.y*a.z,f=-e.x*e.x,h=-e.y*e.y,_=-e.z*e.z,y=-e.x*e.y,v=-e.x*e.z,T=-e.y*e.z;this.set(0,0,n+c+f),this.set(0,1,o+u+y),this.set(0,2,s+g+v),this.set(1,0,this.get(0,1)),this.set(1,1,r+l+h),this.set(1,2,d+m+T),this.set(2,0,this.get(0,2)),this.set(2,1,this.get(1,2)),this.set(2,2,i+p+_)}else{const e=(1-r)/n.dot(n),t=e*n.x,a=e*n.z,i=t*n.y,o=t*n.z,s=a*n.y;this.set(0,0,r+t*n.x),this.set(0,1,i-n.z),this.set(0,2,o+n.y),this.set(1,0,i+n.z),this.set(1,1,r+e*n.y*n.y),this.set(1,2,s-n.x),this.set(2,0,o-n.y),this.set(2,1,s+n.x),this.set(2,2,r+a*n.z)}return this}static fromToRotation(e,t,a){return void 0===a&&(a=new me),a.fromToRotation(e,t)}fromLookAt(e,t){const a=new de;a.copy(e);let n=a.len();if(n<W)return this.identity();a.div(n);const r=new de;if(r.cross(t,a),n=r.len(),n<W)return this.identity();r.div(n);const i=new de;return i.cross(a,r),Z(1,i.len())?this.fromBasisXYZ(r,i,a):this.identity()}static fromLookAt(e,t,a){return void 0===a&&(a=new me),a.fromLookAt(e,t)}fromBasisXYZ(e,t,a){return this.set(0,0,e.x),this.set(0,1,t.x),this.set(0,2,a.x),this.set(1,0,e.y),this.set(1,1,t.y),this.set(1,2,a.y),this.set(2,0,e.z),this.set(2,1,t.z),this.set(2,2,a.z),this}static fromBasisXYZ(e,t,a,n){return void 0===n&&(n=new me),n.fromBasisXYZ(e,t,a)}orthoNormalVectorFast(e){var t=Math.sqrt,a=Math.abs;const r=new de;if(r.copy(e),a(r.z)>Y){const n=r.y*r.y+r.z*r.z,a=1/t(n);e.x=0,e.y=-r.z*a,e.z=r.y*a}else{const n=r.x*r.x+r.y*r.y,a=1/t(n);e.x=-r.y*a,e.y=r.x*a,e.z=0}return e}orthoNormalize(){let e=this.getColumn(0),t=this.getColumn(1);const a=this.getColumn(2);let n=e.len();n>W?e.div(n):e=new de(1,0,0);let r=e.dot(t);const i=new de;i.copy(e),t.sub(i.mul(r)),n=t.len(),n>W?t.div(n):(i.copy(e),t=this.orthoNormalVectorFast(t));const o=t.dot(a);r=e.dot(a);const s=new de;return s.copy(t),i.copy(e),a.sub(i.mul(r).add(s.mul(o))),n=a.len(),n>W?a.div(n):a.cross(e,t),this.fromBasisXYZ(e,t,a)}sanitizeEuler(e){const t=-1e-4,a=2*X-1e-4;e.x<t?e.x+=2*X:e.x>a&&(e.x-=2*X),e.y<t?e.y+=2*X:e.y>a&&(e.y-=2*X),e.z<t?e.z+=2*X:e.z>a&&(e.z-=2*X)}toEulerAngles(e){var t=Math.atan2,a=Math.asin;return void 0===e&&(e=new de),.999>this.get(1,2)?-.999<this.get(1,2)?(e.x=a(-this.get(1,2)),e.y=t(this.get(0,2),this.get(2,2)),e.z=t(this.get(1,0),this.get(1,1)),this.sanitizeEuler(e),e.x*=j,e.y*=j,e.z*=j,e):(e.x=.5*X,e.y=t(this.get(0,1),this.get(0,0)),e.z=0,this.sanitizeEuler(e),e.set(0,0,0),e):(e.x=.5*-X,e.y=t(-this.get(0,1),this.get(0,0)),e.z=0,this.sanitizeEuler(e),e.set(0,0,0),e)}toAxisAngle(e){const t=this.toEulerAngles(),a=he.fromEulerAngles(t.x,t.y,t.z);return a.toAxisAngle(e)}}var fe=effect.Amaz;class he extends U{constructor(e,t,a,n){e instanceof fe.Quaternionf?super(e):super(new fe.Quaternionf(null==e?0:e,null==t?0:t,null==a?0:a,null==n?1:n))}static fromNative(e){return new he(e)}static identity(){return new he(0,0,0,1)}static fromToRotation(e,t,a){a===void 0&&(a=new he);const n=e.len(),r=t.len();if(n<W||r<W)return a.set(0,0,0,1),a;else{const i=me.fromToRotation(e.div(n),t.div(r));return a.fromMatrix3(i)}}static fromLookAt(e,t,a){a===void 0&&(a=new he);const n=me.fromLookAt(e,t);return n.isIdentity()?(a.set(0,0,0,1),a):a.fromMatrix3(n)}static rotateVec3(e,t){return e.rotateVec3(t)}static slerp(e,a,n,t){void 0===t&&(t=new he);const r=e._native.slerp(a._native,n);return t.set(r.x,r.y,r.z,r.w),t}static fromAxisAngle(e,t,a){return void 0===a&&(a=new he),a.fromAxisAngle(e,t)}static eq(e,t){return e&&t&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}get native(){return this._native}set(e,t,a,n){return this.x=e,this.y=t,this.z=a,this.w=n,this}get x(){return this._supportMemoryMapping?this._values[U.X]:this._native.x}set x(e){this._supportMemoryMapping?this._values[U.X]=Math.fround(e):this._native.x=e}get y(){return this._supportMemoryMapping?this._values[U.Y]:this._native.y}set y(e){this._supportMemoryMapping?this._values[U.Y]=Math.fround(e):this._native.y=e}get z(){return this._supportMemoryMapping?this._values[U.Z]:this._native.z}set z(e){this._supportMemoryMapping?this._values[U.Z]=Math.fround(e):this._native.z=e}get w(){return this._supportMemoryMapping?this._values[U.W]:this._native.w}set w(e){this._supportMemoryMapping?this._values[U.W]=Math.fround(e):this._native.w=e}eq(e){return e&&this.x===e.x&&this.y===e.y&&this.z===e.z&&this.w===e.w}toString(){return`Quaternionf(${this.x.toFixed(5)}, ${this.y.toFixed(5)}, ${this.z.toFixed(5)}, ${this.w.toFixed(5)})`}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}mul(e){return this.set(this.w*e.x+this.x*e.w+this.y*e.z-this.z*e.y,this.w*e.y+this.y*e.w+this.z*e.x-this.x*e.z,this.w*e.z+this.z*e.w+this.x*e.y-this.y*e.x,this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z)}div(e){return this.x/=e,this.y/=e,this.z/=e,this.w/=e,this}neg(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}identity(){return this.set(0,0,0,1),this}static fromEulerAngles(e,t,a,n){n===void 0&&(n=new he);const r=n.native.eulerToQuaternion(new fe.Vector3f(e*G,t*G,a*G));return n.set(r.x,r.y,r.z,r.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}clone(){return new he(this.x,this.y,this.z,this.w)}toEulerAngles(e){const t=this.native.quaternionToEuler();return e.set(t.x*j,t.y*j,t.z*j)}toAxisAngle(e){let t=this.x,a=this.y,n=this.z,r=this.w;0>r&&(t=-t,a=-a,n=-n,r=-r),1<r&&(r=1);const i=2*Math.acos(r);if(Z(i,0))e.set(1,0,0);else{const i=1/Math.sqrt(1-r*r);e.set(t*i,a*i,n*i)}return i}rotateVec3(e){const t=2*this.x,a=2*this.y,n=2*this.z,r=this.x*t,i=this.y*a,o=this.z*n,s=this.x*a,d=this.x*n,c=this.y*n,l=this.w*t,p=this.w*a,u=this.w*n,g=e.clone();return e.x=(1-(i+o))*g.x+(s-u)*g.y+(d+p)*g.z,e.y=(s+u)*g.x+(1-(r+o))*g.y+(c-l)*g.z,e.z=(d-p)*g.x+(c+l)*g.y+(1-(r+i))*g.z,e}fromAxisAngle(e,t){const a=.5*t*G,n=Math.sin(a);return this.set(n*e.x,n*e.y,n*e.z,Math.cos(a))}normalize(){return this.div(this.len())}setZero(){return this.x=0,this.y=0,this.z=0,this.w=0,this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lenSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}inv(){return Z(this.lenSq(),1)?(this.x=-this.x,this.y=-this.y,this.z=-this.z,this):this.setZero()}static fromMatrix4(e,t){t===void 0&&(t=new he);const a=new me(e.get(0,0),e.get(1,0),e.get(2,0),e.get(0,1),e.get(1,1),e.get(2,1),e.get(0,2),e.get(1,2),e.get(2,2));return t.fromMatrix3(a)}indexSet(e,t){0===e?this.x=t:1===e?this.y=t:2===e?this.z=t:3==e&&(this.w=t)}static fromMatrix3(e,t){return void 0===t&&(t=new he),t.fromMatrix3(e)}fromMatrix3(e){var t=Math.sqrt;const a=e.get(0,0)+e.get(1,1)+e.get(2,2);let n=0;if(0<a)n=t(a+1),this.w=.5*n,n=.5/n,this.x=(e.get(2,1)-e.get(1,2))*n,this.y=(e.get(0,2)-e.get(2,0))*n,this.z=(e.get(1,0)-e.get(0,1))*n;else{const a=[1,2,0];let r=0;e.get(1,1)>e.get(0,0)&&(r=1),e.get(2,2)>e.get(r,r)&&(r=2);const i=a[r],o=a[i];if(n=t(e.get(r,r)-e.get(i,i)-e.get(o,o)+1),n<W)return this.setZero();this.indexSet(r,.5*n),n=.5/n,this.w=(e.get(o,i)-e.get(i,o))*n,this.indexSet(i,(e.get(i,r)+e.get(r,i))*n),this.indexSet(o,(e.get(o,r)+e.get(r,o))*n)}return this.normalize()}}var _e=effect.Amaz;const ye=4;class ve extends pe{constructor(e,t,a,n,r,i,o,s,d,c,l,p,u,g,m,f){e instanceof _e.Matrix4x4f?super(e):e instanceof me?super(new _e.Matrix4x4f(e.native)):super(new _e.Matrix4x4f(null==e?1:e,null==t?0:t,null==a?0:a,null==n?0:n,null==r?0:r,null==i?1:i,null==o?0:o,null==s?0:s,null==d?0:d,null==c?0:c,null==l?1:l,null==p?0:p,null==u?0:u,null==g?0:g,null==m?0:m,null==f?1:f))}static fromNative(e){return new ve(e)}get native(){return this._native}set(e,t,a){var n=Math.fround;return this._supportMemoryMapping?e<ye&&t<ye&&(this._values[e+t*ye]=n(a)):e<ye&&t<ye&&this._native.set(e,t,a),this}get(e,t){return this._supportMemoryMapping?this._values[e+t*ye]:this._native.get(e,t)}getRow(e,t){return void 0===t&&(t=new le),t.set(this.get(e,0),this.get(e,1),this.get(e,2),this.get(e,3))}setRow(e,t){return this.set(e,0,t.x),this.set(e,1,t.y),this.set(e,2,t.z),this.set(e,3,t.w),this}getColumn(e,t){return void 0===t&&(t=new le),t.set(this.get(0,e),this.get(1,e),this.get(2,e),this.get(3,e))}setColumn(e,t){return this.set(0,e,t.x),this.set(1,e,t.y),this.set(2,e,t.z),this.set(3,e,t.w),this}getAxisX(e){return void 0===e&&(e=new de),e.set(this.get(0,0),this.get(1,0),this.get(2,0))}setAxisX(e){return this.set(0,0,e.x),this.set(1,0,e.y),this.set(2,0,e.z),this}getAxisY(e){return void 0===e&&(e=new de),e.set(this.get(0,1),this.get(1,1),this.get(2,1))}setAxisY(e){return this.set(0,1,e.x),this.set(1,1,e.y),this.set(2,1,e.z),this}getAxisZ(e){return void 0===e&&(e=new de),e.set(this.get(0,2),this.get(1,2),this.get(2,2))}setAxisZ(e){return this.set(0,2,e.x),this.set(1,2,e.y),this.set(2,2,e.z),this}getTranslation(e){return void 0===e&&(e=new de),e.set(this.get(0,3),this.get(1,3),this.get(2,3))}setTranslation(e){return this.set(0,3,e.x),this.set(1,3,e.y),this.set(2,3,e.z),this}copy(e){for(let t=0;t<ye;++t)for(let a=0;a<ye;++a)this.set(t,a,e.get(t,a));return this}clone(){const e=new ve;for(let t=0;t<ye;++t)for(let a=0;a<ye;++a)e.set(t,a,this.get(t,a));return e}eq(e){for(let t=0;t<ye;++t)for(let a=0;a<ye;++a)if(this.get(t,a)!==e.get(t,a))return!1;return!0}static eq(e,t){for(let a=0;a<ye;++a)for(let n=0;n<ye;++n)if(e.get(a,n)!==t.get(a,n))return!1;return!0}identity(){return this.set(0,0,1),this.set(1,0,0),this.set(2,0,0),this.set(3,0,0),this.set(0,1,0),this.set(1,1,1),this.set(2,1,0),this.set(3,1,0),this.set(0,2,0),this.set(1,2,0),this.set(2,2,1),this.set(3,2,0),this.set(0,3,0),this.set(1,3,0),this.set(2,3,0),this.set(3,3,1),this}zero(){return this.set(0,0,0),this.set(1,0,0),this.set(2,0,0),this.set(3,0,0),this.set(0,1,0),this.set(1,1,0),this.set(2,1,0),this.set(3,1,0),this.set(0,2,0),this.set(1,2,0),this.set(2,2,0),this.set(3,2,0),this.set(0,3,0),this.set(1,3,0),this.set(2,3,0),this.set(3,3,0),this}isIdentity(e){return Z(this.get(0,0),1,e)&&Z(this.get(1,0),0,e)&&Z(this.get(2,0),0,e)&&Z(this.get(3,0),0,e)&&Z(this.get(0,1),0,e)&&Z(this.get(1,1),1,e)&&Z(this.get(2,1),0,e)&&Z(this.get(3,1),0,e)&&Z(this.get(0,2),0,e)&&Z(this.get(1,2),0,e)&&Z(this.get(2,2),1,e)&&Z(this.get(3,2),0,e)&&Z(this.get(0,3),0,e)&&Z(this.get(1,3),0,e)&&Z(this.get(2,3),0,e)&&Z(this.get(3,3),1,e)}isZero(e){return Z(this.get(0,0),0,e)&&Z(this.get(1,0),0,e)&&Z(this.get(2,0),0,e)&&Z(this.get(3,0),0,e)&&Z(this.get(0,1),0,e)&&Z(this.get(1,1),0,e)&&Z(this.get(2,1),0,e)&&Z(this.get(3,1),0,e)&&Z(this.get(0,2),0,e)&&Z(this.get(1,2),0,e)&&Z(this.get(2,2),0,e)&&Z(this.get(3,2),0,e)&&Z(this.get(0,3),0,e)&&Z(this.get(1,3),0,e)&&Z(this.get(2,3),0,e)&&Z(this.get(3,3),0,e)}toArrayCopy(){const e=Array(16);for(let t=0;t<ye;++t)for(let a=0;a<ye;++a)e[a+t*ye]=this.get(a,t);return e}invTRS(){const e=this.toArrayCopy(),t=e[10]*e[5]-e[6]*e[9],a=-e[10]*e[1]+e[2]*e[9],n=e[6]*e[1]-e[2]*e[5],r=-e[10]*e[4]+e[6]*e[8],i=e[10]*e[0]-e[2]*e[8],o=-e[6]*e[0]+e[2]*e[4],s=e[9]*e[4]-e[5]*e[8],d=-e[9]*e[0]+e[1]*e[8],c=e[5]*e[0]-e[1]*e[4],l=e[0]*t+e[1]*r+e[2]*s;if(0===l)return this.zero();const p=1/l;return this.set(0,0,p*t),this.set(1,0,p*a),this.set(2,0,p*n),this.set(3,0,0),this.set(0,1,p*r),this.set(1,1,p*i),this.set(2,1,p*o),this.set(3,1,0),this.set(0,2,p*s),this.set(1,2,p*d),this.set(2,2,p*c),this.set(3,2,0),this.set(0,3,-(this.get(0,0)*e[12]+this.get(0,1)*e[13]+this.get(0,2)*e[14])),this.set(1,3,-(this.get(1,0)*this.get(0,3)+this.get(1,1)*e[13]+this.get(1,2)*e[14])),this.set(2,3,-(this.get(3,0)*this.get(0,3)+this.get(3,1)*this.get(1,3)+this.get(3,2)*e[14])),this.set(3,3,1),this}inv(){return this._native.invert_Full(),this}mul(e){const t=this.toArrayCopy();for(let a=0;a<ye;a++)this.set(a,0,t[a]*e.get(0,0)+t[a+4]*e.get(1,0)+t[a+8]*e.get(2,0)+t[a+12]*e.get(3,0)),this.set(a,1,t[a]*e.get(0,1)+t[a+4]*e.get(1,1)+t[a+8]*e.get(2,1)+t[a+12]*e.get(3,1)),this.set(a,2,t[a]*e.get(0,2)+t[a+4]*e.get(1,2)+t[a+8]*e.get(2,2)+t[a+12]*e.get(3,2)),this.set(a,3,t[a]*e.get(0,3)+t[a+4]*e.get(1,3)+t[a+8]*e.get(2,3)+t[a+12]*e.get(3,3));return this}transformVec4(e){return e.set(this.get(0,0)*e.x+this.get(0,1)*e.y+this.get(0,2)*e.z+this.get(0,3)*e.w,this.get(1,0)*e.x+this.get(1,1)*e.y+this.get(1,2)*e.z+this.get(1,3)*e.w,this.get(2,0)*e.x+this.get(2,1)*e.y+this.get(2,2)*e.z+this.get(2,3)*e.w,this.get(3,0)*e.x+this.get(3,1)*e.y+this.get(3,2)*e.z+this.get(3,3)*e.w)}static transformVec4(e,t){return e.transformVec4(t)}rotateQuat(e){return e.set(this.get(0,0)*e.x+this.get(0,1)*e.y+this.get(0,2)*e.z+this.get(0,3)*e.w,this.get(1,0)*e.x+this.get(1,1)*e.y+this.get(1,2)*e.z+this.get(1,3)*e.w,this.get(2,0)*e.x+this.get(2,1)*e.y+this.get(2,2)*e.z+this.get(2,3)*e.w,this.get(3,0)*e.x+this.get(3,1)*e.y+this.get(3,2)*e.z+this.get(3,3)*e.w)}static rotateQuat(e,t){return e.rotateQuat(t)}transformVec3(e){return e.set(this.get(0,0)*e.x+this.get(0,1)*e.y+this.get(0,2)*e.z,this.get(1,0)*e.x+this.get(1,1)*e.y+this.get(1,2)*e.z,this.get(2,0)*e.x+this.get(2,1)*e.y+this.get(2,2)*e.z)}static transformVec3(e,t){return e.transformVec3(t)}scale(e){return this.set(0,0,this.get(0,0)*e.x),this.set(1,0,this.get(1,0)*e.x),this.set(2,0,this.get(2,0)*e.x),this.set(3,0,this.get(3,0)*e.x),this.set(0,1,this.get(0,1)*e.y),this.set(1,1,this.get(1,1)*e.y),this.set(2,1,this.get(2,1)*e.y),this.set(3,1,this.get(3,1)*e.y),this.set(0,2,this.get(0,2)*e.z),this.set(1,2,this.get(1,2)*e.z),this.set(2,2,this.get(2,2)*e.z),this.set(3,2,this.get(3,2)*e.z),this}determinant(){const e=this.get(0,0),t=this.get(0,1),a=this.get(0,2),n=this.get(0,3),r=this.get(1,0),i=this.get(1,1),o=this.get(1,2),s=this.get(1,3),d=this.get(2,0),c=this.get(2,1),l=this.get(2,2),p=this.get(2,3),u=this.get(3,0),g=this.get(3,1),m=this.get(3,2),f=this.get(3,3);return n*o*c*u-a*s*c*u-n*i*l*u+t*s*l*u+a*i*p*u-t*o*p*u-n*o*d*g+a*s*d*g+n*r*l*g-e*s*l*g-a*r*p*g+e*o*p*g+n*i*d*m-t*s*d*m-n*r*c*m+e*s*c*m+t*r*p*m-e*i*p*m-a*i*d*f+t*o*d*f+a*r*c*f-e*o*c*f-t*r*l*f+e*i*l*f}transpose(){let e=this.get(0,1);return this.set(0,1,this.get(1,0)),this.set(1,0,e),e=this.get(0,2),this.set(0,2,this.get(2,0)),this.set(2,0,e),e=this.get(0,3),this.set(0,3,this.get(3,0)),this.set(3,0,e),e=this.get(1,2),this.set(1,2,this.get(2,1)),this.set(2,1,e),e=this.get(1,3),this.set(1,3,this.get(3,1)),this.set(3,1,e),e=this.get(2,3),this.set(2,3,this.get(3,2)),this.set(3,2,e),this}fromToRotation(e,t){const a=new me;this.identity(),me.fromToRotation(e,t,a);for(let n=0;3>n;++n)for(let e=0;3>e;++e)this.set(n,e,a.get(n,e));return this}static fromToRotation(e,t,a){return void 0===a&&(a=new ve),a.fromToRotation(e,t)}fromBasisXYZ(e,t,a){return this.set(0,0,e.x),this.set(0,1,t.x),this.set(0,2,a.x),this.set(0,3,0),this.set(1,0,e.y),this.set(1,1,t.y),this.set(1,2,a.y),this.set(1,3,0),this.set(2,0,e.z),this.set(2,1,t.z),this.set(2,2,a.z),this.set(2,3,0),this.set(3,0,0),this.set(3,1,0),this.set(3,2,0),this.set(3,3,1),this}static fromBasisXYZ(e,t,a,n){return void 0===n&&(n=new ve),n.fromBasisXYZ(e,t,a)}fromOrtho(e,t,a,n,r,i){this.identity();const o=t-e,s=n-a,d=i-r;return this.set(0,0,2/o),this.set(0,3,-(t+e)/o),this.set(1,1,2/s),this.set(1,3,-(n+a)/s),this.set(2,2,-2/d),this.set(2,3,-(i+r)/d),this}static fromOrtho(e,t,a,n,r,i,o){return void 0===o&&(o=new ve),o.fromOrtho(e,t,a,n,r,i)}fromFrustum(e,t,a,n,r,i){return this.set(0,0,2*r/(t-e)),this.set(0,1,0),this.set(0,2,(t+e)/(t-e)),this.set(0,3,0),this.set(1,0,0),this.set(1,1,2*r/(n-a)),this.set(1,2,(n+a)/(n-a)),this.set(1,3,0),this.set(2,0,0),this.set(2,1,0),this.set(2,2,-(i+r)/(i-r)),this.set(2,3,-(2*i*r)/(i-r)),this.set(3,0,0),this.set(3,1,0),this.set(3,2,-1),this.set(3,3,0),this}static fromFrustum(e,t,a,n,r,i,o){return void 0===o&&(o=new ve),o.fromFrustum(e,t,a,n,r,i)}fromPerspective(e,t,a,n){var r=Math.sin,i=Math.cos;const o=K(.5*e),s=i(o)/r(o),d=a-n;return this.set(0,0,s/t),this.set(0,1,0),this.set(0,2,0),this.set(0,3,0),this.set(1,0,0),this.set(1,1,s),this.set(1,2,0),this.set(1,3,0),this.set(2,0,0),this.set(2,1,0),this.set(2,2,(n+a)/d),this.set(2,3,2*a*n/d),this.set(3,0,0),this.set(3,1,0),this.set(3,2,-1),this.set(3,3,0),this}static fromPerspective(e,t,a,n,r){return void 0===r&&(r=new ve),r.fromPerspective(e,t,a,n)}static fromTranslation(e,t,a,n){return void 0===n?n=new ve:n.identity(),n.set(0,3,e),n.set(1,3,t),n.set(2,3,a),n}fromQuaternion(e){const t=2*e.x,a=2*e.y,n=2*e.z,r=e.x*t,i=e.y*a,o=e.z*n,s=e.x*a,d=e.x*n,c=e.y*n,l=e.w*t,p=e.w*a,u=e.w*n;return this.set(0,0,1-(i+o)),this.set(1,0,s+u),this.set(2,0,d-p),this.set(3,0,0),this.set(0,1,s-u),this.set(1,1,1-(r+o)),this.set(2,1,c+l),this.set(3,1,0),this.set(0,2,d+p),this.set(1,2,c-l),this.set(2,2,1-(r+i)),this.set(3,2,0),this.set(0,3,0),this.set(1,3,0),this.set(2,3,0),this.set(3,3,1),this}static fromQuaternion(e,t){return void 0===t&&(t=new ve),t.fromQuaternion(e)}fromRotation(e){return this.fromQuaternion(e),this}static fromRotation(e,t){return void 0===t&&(t=new ve),t.fromRotation(e)}fromCompose(e,t,a){return this.fromQuaternion(t),this.set(0,0,this.get(0,0)*a.x),this.set(1,0,this.get(1,0)*a.x),this.set(2,0,this.get(2,0)*a.x),this.set(0,1,this.get(0,1)*a.y),this.set(1,1,this.get(1,1)*a.y),this.set(2,1,this.get(2,1)*a.y),this.set(0,2,this.get(0,2)*a.z),this.set(1,2,this.get(1,2)*a.z),this.set(2,2,this.get(2,2)*a.z),this.set(0,3,e.x),this.set(1,3,e.y),this.set(2,3,e.z),this}static fromCompose(e,t,a,n){return void 0===n&&(n=new ve),n.fromCompose(e,t,a)}decompose(e,t,a){e.x=this.get(0,3),e.y=this.get(1,3),e.z=this.get(2,3),this.set(0,3,0),this.set(1,3,0),this.set(2,3,0);const n=new de(this.get(0,0),this.get(1,0),this.get(2,0)),r=new de(this.get(0,1),this.get(1,1),this.get(2,1)),i=new de(this.get(0,2),this.get(1,2),this.get(2,2)),o=n.len(),s=r.len(),d=i.len();a.x=o,a.y=s,a.z=d;const c=new ve(o,0,0,0,0,s,0,0,0,0,d,0,0,0,0,1);return this.mul(c.inv()),he.fromMatrix4(this,t),this}}var Te=effect.Amaz;class xe{constructor(e,t=void 0,a=void 0,n=void 0){this.owner=e,t&&(this.horizontal=t),a&&(this.depth=a),n&&(this.vertical=n)}setUniformWrapMode(e){this.horizontal=e,this.depth=e,this.vertical=e}get horizontal(){return this.owner.native?this.owner.native.wrapModeS:null}set horizontal(e){null!=e&&this.owner.native&&(this.owner.native.wrapModeS=e)}get depth(){return this.owner.native?this.owner.native.wrapModeR:null}set depth(e){null!=e&&this.owner.native&&(this.owner.native.wrapModeR=e)}get vertical(){return this.owner.native?this.owner.native.wrapModeT:null}set vertical(e){null!=e&&this.owner.native&&(this.owner.native.wrapModeT=e)}}class Me{constructor(e,t=void 0,a=void 0,n=void 0){this.owner=e,t&&(this.min=t),a&&(this.mag=a),n&&(this.mipMap=n)}get min(){return this.owner.native?this.owner.native.filterMin:null}set min(e){null!=e&&this.owner.native&&(this.owner.native.filterMin=e)}get mag(){return this.owner.native?this.owner.native.filterMag:null}set mag(e){null!=e&&this.owner.native&&(this.owner.native.filterMag=e)}get mipMap(){return this.owner.native?this.owner.native.filterMipmap:null}set mipMap(e){null!=e&&this.owner.native&&(this.owner.native.filterMipmap=e)}}class Se{constructor(e=void 0){if(this.name="no-name",this.native=null,this.wrapMode=new xe(this),this.filterMode=new Me(this),null!=e&&e.native){const t=e.native;this.fromNative(t)}else if(null!=e&&e.path){const a=null==e?void 0:e.path;this.native=null;try{var t;this.native=null==(t=zn.assets.loadSync(a))?void 0:t.resource}catch(t){console.error(t)}}else this.native=new Te.Texture;const a=null==e?void 0:e.options;a&&this.fromOptions(a)}fromNative(e){return e?void(this.native=e,this.width=e.width,this.height=e.height,this.depth=e.depth,this.wrapMode=new xe(this,e.wrapModeS,e.wrapModeR,e.wrapModeT),this.filterMode=new Me(this,e.filterMin,e.filterMag,e.filterMipmap)):void console.error("Amaz.Texture class is invalid")}fromOptions(e){e&&(e.width!==void 0&&(this.width=e.width),e.height!==void 0&&(this.height=e.height),e.depth!==void 0&&(this.depth=e.depth),e.horizontalWrap!==void 0&&(this.wrapMode.horizontal=e.horizontalWrap),e.verticalWrap!==void 0&&(this.wrapMode.vertical=e.verticalWrap),e.depthWrap!==void 0&&(this.wrapMode.depth=e.depthWrap),e.magFilter!==void 0&&(this.filterMode.mag=e.magFilter),e.minFilter!==void 0&&(this.filterMode.min=e.minFilter),e.mipMapFilter!==void 0&&(this.filterMode.mipMap=e.mipMapFilter))}getSize(){return{width:this.width,height:this.height}}get height(){return this.native?this.native.height:-1}set height(e){e&&this.native&&(this.native.height=e)}get width(){return this.native?this.native.width:-1}set width(e){e&&this.native&&(this.native.width=e)}get depth(){return this.native?this.native.depth:-1}set depth(e){e&&this.native&&(this.native.depth=e)}get internalFormat(){return this.native?this.native.internalFormat:null}set internalFormat(e){this.native&&null!=e&&(this.native.internalFormat=e)}get dataType(){return this.native?this.native.dataType:null}set dataType(e){this.native&&null!=e&&(this.native.dataType=e)}get enableMipMap(){return this.native?this.native.enableMipmap:null}set enableMipMap(e){this.native&&null!=e&&(this.native.enableMipmap=e)}get builtinType(){return this.native?this.native.builtinType:null}set builtinType(e){this.native&&null!=e&&(this.native.builtinType=e)}get maxAnisotropy(){return this.native?this.native.maxAnisotropy:-1}set maxAnisotropy(e){this.native&&(this.native.maxAnisotropy=e)}}var Fe=effect.Amaz;const Ce="gles2";class Ae{constructor(e=void 0){this.native=new Fe.RenderState,this.rasterizationState=new Fe.RasterizationState,this.depthStencilState=new Fe.DepthStencilState,this.colorBlendState=new Fe.ColorBlendState,this.colorBlendAttachmentState=new Fe.ColorBlendAttachmentState,this.native=e?e:new Fe.RenderState}}class Ie{constructor(e,t=""){this.native=new Fe.Shader,this._type=-1,this._source="",this.type=e,this.source=t}get type(){return this._type}set type(e){this._type=e,this.native.type=this._type}get source(){return this._source}set source(e){this._source=e,this.native.source=this._source}}class be{constructor(e){this.native=new Fe.XShader,this.vertexShader=new Ie(R.VERTEX),this.fragmentShader=new Ie(R.FRAGMENT),this.attributes=new Map([["a_Position",Fe.VertexAttribType.POSITION],["a_Normal",Fe.VertexAttribType.NORMAL],["a_Color",Fe.VertexAttribType.COLOR],["a_UV",Fe.VertexAttribType.TEXCOORD0]]),this.renderState=new Ae,this._cullMode=P.NONE,this._frontFace=E.COUNTER_CLOCKWISE,this._polygonMode=k.FILL,this._depthTestEnable=!1,this._depthWriteEnable=!0,this._stencilTestEnable=!1,this._depthCompareOp=L.LESS,this._srcColorBlendFactor=B.ONE,this._dstColorBlendFactor=B.ZERO,this._srcAlphaBlendFactor=B.ONE,this._dstAlphaBlendFactor=B.ZERO,this._colorBlendOp=O.ADD,this._alphaBlendOp=O.ADD,this._blendEnable=!0;const t=null==e?void 0:e.native;if(t)this.native=t,this.fromNative(t);else if(e&&null!=e&&e.path){var a;const t=null==e?void 0:e.path,n=null==(a=zn.assets.loadSync(t))?void 0:a.resource;this.fromNative(n);const r=null==e?void 0:e.options;r&&this.fromOptions(r)}else{const t=null==e?void 0:e.vertex;t&&(this.vertexShader.source=t);const a=null==e?void 0:e.fragment;a&&(this.fragmentShader.source=a);const n=null==e?void 0:e.attributes;if(n)for(const[e,t]of Object.entries(n))this.attributes.set(e,t);const r=null==e?void 0:e.options;if(r&&this.fromOptions(r),t)this.vertexShader.source=t;else throw new Error("vertex shader source is missing from shader");if(a)this.fragmentShader.source=a;else throw new Error("fragment shader source is missing from shader");const i=new Fe.Map;if(this.attributes.forEach((e,t)=>{i.insert(t,e)}),0>=this.vertexShader.source.length)throw new Error("Missing source for vertex shader");if(0>=this.fragmentShader.source.length)throw new Error("Missing source for fragment shader");const o=new Fe.Vector;o.pushBack(this.vertexShader.native),o.pushBack(this.fragmentShader.native);const s=new Fe.Map,d=null!=e&&e.language?null==e?void 0:e.language:Ce;s.insert(d,o),this.renderState.rasterizationState.cullMode=this.cullMode,this.renderState.rasterizationState.polygonMode=this.polygonMode,this.renderState.rasterizationState.frontFace=this.frontFace,this.renderState.native.rasterization=this.renderState.rasterizationState,this.renderState.depthStencilState.depthTestEnable=this.depthTestEnable,this.renderState.depthStencilState.depthWriteEnable=this.depthWriteEnable,this.renderState.depthStencilState.stencilTestEnable=this.stencilTestEnable,this.renderState.depthStencilState.depthCompareOp=this.depthCompareOp,this.renderState.native.depthstencil=this.renderState.depthStencilState,this.renderState.colorBlendAttachmentState.srcColorBlendFactor=this.srcColorBlendFactor,this.renderState.colorBlendAttachmentState.dstColorBlendFactor=this.dstColorBlendFactor,this.renderState.colorBlendAttachmentState.srcAlphaBlendFactor=this.srcAlphaBlendFactor,this.renderState.colorBlendAttachmentState.dstAlphaBlendFactor=this.dstAlphaBlendFactor,this.renderState.colorBlendAttachmentState.colorWriteMask=15,this.renderState.colorBlendAttachmentState.ColorBlendOp=this.colorBlendOp,this.renderState.colorBlendAttachmentState.AlphaBlendOp=this.alphaBlendOp,this.renderState.colorBlendAttachmentState.blendEnable=this.blendEnable;const c=new Fe.Vector;c.pushBack(this.renderState.colorBlendAttachmentState),this.renderState.colorBlendState.attachments=c,this.renderState.native.colorBlend=this.renderState.colorBlendState;const l=new Fe.Pass;l.semantics=i,l.shaders=s,l.renderState=this.renderState.native;const p=new Fe.Vector;p.pushBack(l),this.native=new Fe.XShader,this.native.passes=p}}fromNative(e){var t,a,n,r,i;if(this.native=e,0>=this.native.passes.size())return void console.error("Shader: does not have any passes. ");const o=this.native.passes.get(0),s=o.shaders,d=s.getVectorKeys();for(let t=0;t<d.size();++t){const e=d.get(t),a=s.get(e);for(let e=0;e<a.size();++e){const t=a.get(e);let n=t.source&&0<t.source.length?t.source:"";n=t.sourcePath&&0<t.sourcePath.length?t.sourcePath:n,t.type===R.VERTEX?this.vertexShader=new Ie(R.VERTEX,n):t.type===R.FRAGMENT&&(this.fragmentShader=new Ie(R.FRAGMENT,n))}}const c=o.semantics,l=c.getVectorKeys();for(let t=0;t<l.size();++t){const e=l.get(t),a=c.get(e);this.attributes.set(e,a)}const p=null==(t=o.renderState)?void 0:t.rasterization;p&&(this.cullMode=p.cullMode,this.polygonMode=p.polygonMode,this.frontFace=p.frontFace);const u=null==(a=o.renderState)?void 0:a.depthstencil;u&&(this.depthTestEnable=u.depthTestEnable,this.depthWriteEnable=u.depthWriteEnable,this.stencilTestEnable=u.stencilTestEnable,this.depthCompareOp=u.depthCompareOp);const g=null==(n=o.renderState)||null==(r=n.colorBlend)||null==(i=r.attachments)?void 0:i.get(0);g&&(this.srcColorBlendFactor=g.srcColorBlendFactor,this.dstColorBlendFactor=g.dstColorBlendFactor,this.srcAlphaBlendFactor=g.srcAlphaBlendFactor,this.dstAlphaBlendFactor=g.dstAlphaBlendFactor,this.colorBlendOp=g.ColorBlendOp,this.alphaBlendOp=g.AlphaBlendOp,this.blendEnable=g.blendEnable)}fromOptions(e){e&&(e.cullMode&&(this.cullMode=e.cullMode),e.frontFace&&(this.frontFace=e.frontFace),e.polygonMode&&(this.polygonMode=e.polygonMode),e.depthTestEnable&&(this.depthTestEnable=e.depthTestEnable),e.depthWriteEnable&&(this.depthWriteEnable=e.depthWriteEnable),e.stencilTestEnable&&(this.stencilTestEnable=e.stencilTestEnable),e.depthCompareOp&&(this.depthCompareOp=e.depthCompareOp),e.srcColorBlendFactor&&(this.srcColorBlendFactor=e.srcColorBlendFactor),e.dstColorBlendFactor&&(this.dstColorBlendFactor=e.dstColorBlendFactor),e.srcAlphaBlendFactor&&(this.srcAlphaBlendFactor=e.srcAlphaBlendFactor),e.dstAlphaBlendFactor&&(this.dstAlphaBlendFactor=e.dstAlphaBlendFactor),e.colorBlendOp&&(this.colorBlendOp=e.colorBlendOp),e.alphaBlendOp&&(this.alphaBlendOp=e.alphaBlendOp),e.blendEnable&&(this.blendEnable=e.blendEnable))}get cullMode(){return this._cullMode}set cullMode(e){this._cullMode=e,this.renderState.rasterizationState.cullMode=this._cullMode}get frontFace(){return this._frontFace}set frontFace(e){this._frontFace=e,this.renderState.rasterizationState.frontFace=this._frontFace}get polygonMode(){return this._polygonMode}set polygonMode(e){this._polygonMode=e,this.renderState.rasterizationState.polygonMode=this._polygonMode}get depthTestEnable(){return this._depthTestEnable}set depthTestEnable(e){this._depthTestEnable=e,this.renderState.depthStencilState.depthTestEnable=this._depthTestEnable}get depthWriteEnable(){return this._depthWriteEnable}set depthWriteEnable(e){this._depthWriteEnable=e,this.renderState.depthStencilState.depthWriteEnable=this._depthWriteEnable}get stencilTestEnable(){return this._stencilTestEnable}set stencilTestEnable(e){this._stencilTestEnable=e,this.renderState.depthStencilState.stencilTestEnable=this._stencilTestEnable}get depthCompareOp(){return this._depthCompareOp}set depthCompareOp(e){this._depthCompareOp=e,this.renderState.depthStencilState.depthCompareOp=this._depthCompareOp}get srcColorBlendFactor(){return this._srcColorBlendFactor}set srcColorBlendFactor(e){this._srcColorBlendFactor=e;const t=this.renderState.colorBlendState.attachments.front();t&&(t.srcColorBlendFactor=this._srcColorBlendFactor)}get dstColorBlendFactor(){return this._dstColorBlendFactor}set dstColorBlendFactor(e){this._dstColorBlendFactor=e;const t=this.renderState.colorBlendState.attachments.front();t&&(t.dstColorBlendFactor=this._dstColorBlendFactor)}get srcAlphaBlendFactor(){return this._srcAlphaBlendFactor}set srcAlphaBlendFactor(e){this._srcAlphaBlendFactor=e;const t=this.renderState.colorBlendState.attachments.front();t&&(t.srcAlphaBlendFactor=this._srcAlphaBlendFactor)}get dstAlphaBlendFactor(){return this._dstAlphaBlendFactor}set dstAlphaBlendFactor(e){this._dstAlphaBlendFactor=e;const t=this.renderState.colorBlendState.attachments.front();t&&(t.dstAlphaBlendFactor=this._dstAlphaBlendFactor)}get colorBlendOp(){return this._colorBlendOp}set colorBlendOp(e){this._colorBlendOp=e;const t=this.renderState.colorBlendState.attachments.front();t&&(t.ColorBlendOp=this._colorBlendOp)}get alphaBlendOp(){return this._alphaBlendOp}set alphaBlendOp(e){this._alphaBlendOp=e;const t=this.renderState.colorBlendState.attachments.front();t&&(t.AlphaBlendOp=this._alphaBlendOp)}get blendEnable(){return this._blendEnable}set blendEnable(e){this._blendEnable=e;const t=this.renderState.colorBlendState.attachments.front();t&&(t.blendEnable=this._blendEnable)}}var Re=effect.Amaz;class ze{constructor(e=void 0){this.name="no-name",this.uniforms=new Map;const t=null==e?void 0:e.native;if(t)this.native=t,this.frontNative(this.native),this.shader=new be({native:this.native.xshader});else{this.native=new Re.Material;const t=null==e?void 0:e.shader;t&&(this.shader=t);const a=null==e?void 0:e.uniforms;if(a)for(const[e,t]of Object.entries(a))this.uniforms.set(e,t);const n=null==e?void 0:e.macros;if(n)for(const[e,t]of Object.entries(n))this.addMacro(e,t)}this.uniforms&&this.uniforms.forEach((e,t)=>{this.setUniform(t,e)})}frontNative(e=void 0){if(!e)return;const t=e.properties,a=t.floatmap.getVectorKeys();for(let n=0;n<a.size();++n){const e=a.get(n);this.uniforms.set(e,t.getFloat(e))}const n=t.vec2map.getVectorKeys();for(let a=0;a<n.size();++a){const e=n.get(a),r=t.getVec2(e);this.uniforms.set(e,new Q(r))}const r=t.vec3map.getVectorKeys();for(let a=0;a<r.size();++a){const e=r.get(a),n=t.getVec3(e);this.uniforms.set(e,new de(n))}const o=t.vec4map.getVectorKeys();for(let a=0;a<o.size();++a){const e=o.get(a),n=t.getVec4(e);this.uniforms.set(e,new le(n))}const s=t.mat4map.getVectorKeys();for(let a=0;a<s.size();++a){const e=s.get(a),n=t.getMat4(e);this.uniforms.set(e,new ve(n))}const d=t.texmap.getVectorKeys();for(let a=0;a<d.size();++a){const e=d.get(a),n=t.getTex(e);this.uniforms.set(e,n)}}clone(){return new ze({native:this.native.instantiate()})}setUniform(e,t){if(this.uniforms.set(e,t),"number"==typeof t)this.native.setFloat(e,t);else if(t instanceof Q)this.native.setVec2(e,t.native);else if(t instanceof de)this.native.setVec3(e,t.native);else if(t instanceof le)this.native.setVec4(e,t.native);else if(t instanceof y){const a=new le(t.r,t.g,t.b,t.a).native;this.native.setVec4(e,a)}else t instanceof ve?this.native.setMat4(e,t.native):t instanceof Re.Texture?this.native.setTex(e,t):t instanceof Se&&(t.native?this.native.setTex(e,t.native):console.error("Texutre "+t.name+".native is null"))}addProperty(e,t){this.setUniform(e,t)}getUniform(e){if(this.uniforms.has(e)){const t=this.uniforms.get(e);if("number"==typeof t);else{if(t instanceof Q)return t;if(t instanceof de)return t;if(t instanceof le)return t;if(t instanceof y)return t;if(t instanceof ve)return t;if(t instanceof Re.Texture)return t;if(t instanceof Se)return t}}}removeUniform(e){this.uniforms.set(e,void 0)}addMacro(e,t){this.native.enableMacro(e,t)}removeMacro(e){this.native.disableMacro(e)}set shader(e){this.native.xshader=e.native}}var Pe=effect.Amaz;const Ee=["renderMode","pivot","flipX","flipY ","material","color"];class ke extends t{constructor(e,t){e?(super(e,"Sprite2DRenderer"),this.initialize(t,this.getProps())):super()}static register(){t.registerComponentType("Sprite",this.nativeClasses,ke),this.register=()=>void 0}static fromNative(e,t){const a=new ke;if(t instanceof Pe.Sprite2DRenderer)a.initWithNative(e,t,"Sprite2DRenderer");else throw new Error("Incorrect argument in SpriteComponent::fromNative");return a}getProps(){return Ee}get material(){if(!this._material){const e=this.native.material;e&&(this._material=new ze(e))}return this._material}set material(e){e&&(this._material=e,this.native.material=e.native)}get flipX(){return this.native.mirror}set flipX(e){this.native.mirror=e}get flipY(){return this.native.flip}set flipY(e){this.native.flip=e}get color(){return new y(this.native.color)}set color(e){this.native.color=e.native}get pivot(){return new Q(this.native.pivot)}set pivot(e){this.native.pivot=e.native}get renderMode(){return this.native.stretchMode}set renderMode(e){this.native.stretchMode=e}setBaseTexture(e,t,a){t===void 0&&(t=new le(1,1,0,0)),a===void 0&&(a=Pe.RotateType.ROTATE_0),this.native.setBaseTexture(e,t.native,a)}}ke.nativeClasses=["Sprite2DRenderer"],ke.register();var Le=effect.Amaz;const Be=["sequence","textureName","autoPlay","playMode"];class Oe extends t{constructor(e,t){e?(super(e,"AnimSeqComponent"),this.initialize(t,this.getProps())):super()}static register(){t.registerComponentType("SeqAnimation",this.nativeClasses,Oe),this.register=()=>void 0}static fromNative(e,t){const a=new Oe;if(t instanceof Le.AnimSeqComponent)a.initWithNative(e,t,"AnimSeqComponent");else throw new Error("Incorrect argument in SeqAnimationComponent::fromNative");return a}getProps(){return Be}play(){this.native.play()}stop(){this.native.stop()}pause(){this.native.pause()}resume(){this.native.play()}seek(e){this.native.seek(e)}get sequence(){return this.native.animSeq}set sequence(e){this.native.animSeq=e}get textureName(){return this.native.texName}set textureName(e){this.native.texName=e}get autoPlay(){return this.native.autoplay}set autoPlay(e){this.native.autoplay=e}get playMode(){return this.native.playmode}set playMode(e){this.native.playmode=e}}Oe.nativeClasses=["AnimSeqComponent"],Oe.register();const we=["touchEnabled"];class De extends t{constructor(e,t,a){if(!(e&&t))super();else if(e.screenTransform)super(e,t),this.initialize(a,this.getProps());else throw new Error("UIInteractComponent can only be added to an 2d sceneObject")}getProps(){return we}get touchEnabled(){return this.native.touchEnabled}set touchEnabled(e){this.native.touchEnabled=e}}const Ve=["enabled","normalFrame","pressedFrame","disabledFrame","normalColor","pressedColor","disabledColor"];class Ne extends De{constructor(e,t,a){e&&t?super(e,t,a):super()}getProps(){const e=super.getProps();return e.concat(Ve)}get enabled(){return this.native.enabled}set enabled(e){this.native.enabled=e}get normalFrame(){return this.native.normalSprite}set normalFrame(e){this.native.normalSprite=e}get pressedFrame(){return this.native.pressedSprite}set pressedFrame(e){this.native.pressedSprite=e}get disabledFrame(){return this.native.disabledSprite}set disabledFrame(e){this.native.disabledSprite=e}get normalColor(){return new y(this.native.normalColor)}set normalColor(e){this.native.normalColor=e.native}get pressedColor(){return new y(this.native.pressedColor)}set pressedColor(e){this.native.pressedColor=e.native}get disabledColor(){return new y(this.native.disabledColor)}set disabledColor(e){this.native.disabledColor=e.native}}var He;(function(e){e[e.TouchDown=1201]="TouchDown",e[e.TouchDownRepeat=1202]="TouchDownRepeat",e[e.DragInside=1204]="DragInside",e[e.DragOutside=1208]="DragOutside",e[e.DragEnter=1216]="DragEnter",e[e.DragExit=1232]="DragExit",e[e.TouchUpInside=1264]="TouchUpInside",e[e.TouchUpOutside=1328]="TouchUpOutside",e[e.TouchCancel=1456]="TouchCancel"})(He||(He={}));var Ue=effect.Amaz;const Ge=[];class je extends Ne{constructor(e,t){e?(super(e,"IFUIButton",t),this.registerCallbacks()):super()}static register(){t.registerComponentType("Button",this.nativeClasses,je),this.register=()=>void 0}destroy(){this.removeCallbacks(),super.destroy()}static fromNative(e,t){const a=new je;if(t instanceof Ue.IFUIButton)a.initWithNative(e,t,"IFButton2d");else throw new Error("Incorrect argument to ButtonComponent::fromNative");return a.registerCallbacks(),a}getProps(){const e=super.getProps();return e.concat(Ge)}registerCallbacks(){this.addListener(He.TouchDown,this.onClicked,this)}removeCallbacks(){this.removeListener(He.TouchDown,this.onClicked,this)}onClicked(){this.fire("click",this.sceneObject)}}je.nativeClasses=["IFUIButton"],je.register();var We=effect.Amaz;const Xe=["castShadow","mesh","material","materials"];class Ye extends t{constructor(e,t){super(e,"MeshRenderer"),this._materials=[],0>=this._materials.length&&this._materials.push(new ze),e&&this.initialize(t,Xe)}static register(){t.registerComponentType("Model",this.nativeClasses,Ye),this.register=()=>void 0}static fromNative(e,t){const a=new Ye;if(t instanceof We.MeshRenderer)a.initWithNative(e,t,"MeshRenderer");else throw new Error("Incorrect argument to ModelComponent::fromNative");return t.material&&0<a._materials.length&&(a._materials[0]=new ze({native:t.material})),a}get castShadow(){return this.native.castShadow}set castShadow(e){this.native.castShadow=e}get mesh(){return this.native.mesh}set mesh(e){this.native.mesh=e.native}get material(){return this._materials&&0<this._materials.length?this._materials[0]:void 0}set material(e){if(0>=this._materials.length)throw new Error("Model Component materials is empty! ");if(e){var t;this._materials[0]=e,this.native.material=null==(t=this.material)?void 0:t.native}}setMaterial(e,t){return e>=this._materials.length?void console.error("Index "+e+" is out of range"):void(this._materials[e]=t,this.native.materials.set(e,this._materials[e].native))}get materials(){return this._materials}set materials(e){if(e){this._materials=e;const t=this._materials.length;this.native.materials.clear();for(let e=0;e<t;++e)this.native.materials.pushBack(this._materials[e].native)}}}Ye.nativeClasses=["MeshRenderer"],Ye.register();var qe=effect.Amaz;const Ze=new Map([[exports.LightType.Directional,"DirectionalLight"],[exports.LightType.Point,"PointLight"],[exports.LightType.Spot,"SpotLight"]]);function Ke(e){if(!Ze.has(e))throw new Error("Unknown type of light");return Ze.get(e)}const Je=["type","color","intensity","castShadow","enableSoftShadow","shadowSoftness","shadowBias","camera","shadowResolution","attenuationRange"];class Qe extends t{constructor(e,t){if(e){const a=t&&t.hasOwnProperty("type")?t:{type:exports.LightType.Directional};super(e,Ke(a.type)),this.initialize(a,Je)}else super()}static register(){t.registerComponentType("Light",this.nativeClasses,Qe),this.register=()=>void 0}static fromNative(e,t){const a=new Qe;if(t instanceof qe.DirectionalLight)a.initWithNative(e,t,"DirectionalLight"),a.type=exports.LightType.Directional;else if(t instanceof qe.PointLight)a.initWithNative(e,t,"PointLight"),a.type=exports.LightType.Point;else if(t instanceof qe.SpotLight)a.initWithNative(e,t,"SpotLight"),a.type=exports.LightType.Spot;else throw new Error("Incorrect argument to LightComponent::fromNative");return a}get color(){const e=this.native.color;return new y(e.x,e.y,e.z,1)}set color(e){this.native.color=new de(e.r,e.g,e.b).native}get intensity(){return this.native.intensiy}set intensity(e){this.native.intensiy=e}get castShadow(){return this.native.shadowEnableNew}set castShadow(e){this.native.shadowEnableNew=e}get enableSoftShadow(){return this.native.useSoftShadow}set enableSoftShadow(e){this.native.useSoftShadow=e}get shadowSoftness(){return this.native.shadowSoftness}set shadowSoftness(e){this.native.shadowSoftness=e}get shadowBias(){return this.native.shadowBias}set shadowBias(e){this.native.shadowBias=e}get shadowResolution(){return new Q(this.native.shadowResolution)}set shadowResolution(e){this.native.shadowResolution=e.native}get attenuationRange(){if(this.type===exports.LightType.Point||this.type===exports.LightType.Spot)return this.native.attenuationRange;throw new Error("Light Type does not support attenuationRange!")}set attenuationRange(e){if(this.type===exports.LightType.Point||this.type===exports.LightType.Spot)this.native.attenuationRange=e;else throw new Error("Light Type does not support attenuationRange!")}get camera(){if(this.type===exports.LightType.Directional){var e,t,a,n;return null==(e=this.sceneObject)||null==(t=e.scene)?void 0:t.sceneObjectFromNative(null==(a=this.native)||null==(n=a.mainCamera)?void 0:n.entity)}}set camera(e){if(!(this.type===exports.LightType.Directional))throw new Error("Only directional light needs cameera for shadow optimization!");else if(e)if(e.native)this.native.mainCamera=e.native.getComponent("Transform");else throw new Error("Invalid camera!")}}Qe.nativeClasses=["DirectionalLight","PointLight","SpotLight"],Qe.register();var $e=effect.Amaz;const et=["autoSize","center","size"],tt=new Map([[exports.UIColliderType.Box,"IFBoxCollider"]]);function at(e){if(!tt.has(e))throw new Error("Unknown type of collider");return tt.get(e)}class nt extends t{constructor(e,t){if(!e)super();else if(e.screenTransform&&t&&t.hasOwnProperty("type"))super(e,at(t.type)),this.initialize(t,this.getProps());else throw new Error("UIColliderComponent can only be added to an 2d sceneObject with the type option specified")}static register(){t.registerComponentType("UICollider",this.nativeClasses,nt),this.register=()=>void 0}static fromNative(e,t){const a=new nt;if(t instanceof $e.IFBoxCollider)a.initWithNative(e,t,"IFBoxCollider"),a.type=exports.UIColliderType.Box;else throw new Error("Incorrect argument to UIColliderComponent::fromNative");return a}getProps(){return et}get autoSize(){return this.native.autoAdjustCollider}set autoSize(e){this.native.autoAdjustCollider=e}get center(){return new de(this.native.center)}set center(e){this.native.center=e.native}get size(){return new de(this.native.size)}set size(e){this.native.size=e.native}}nt.nativeClasses=["IFBoxCollider"],nt.register();var rt=effect.Amaz;const it=["text","textColor","fontPath","fontSize","fontType","alignment","fitType","spacing"];class ot extends ee{constructor(e,t){e?super(e,"IFUILabel",t):super()}static register(){t.registerComponentType("Label",this.nativeClasses,ot),this.register=()=>void 0}static fromNative(e,t){const a=new ot;if(t instanceof rt.IFUILabel)a.initWithNative(e,t,"IFUILabel");else throw new Error("Incorrect argument to LabelComponent::fromNative");return a}getProps(){const e=super.getProps();return e.concat(it)}get text(){return this.native.text}set text(e){this.native.text=e}get textColor(){return new y(this.native.textColor)}set textColor(e){this.native.textColor=e.native}get fontPath(){return this.native.fontPath}set fontPath(e){this.native.fontPath=e}get fontSize(){return this.native.fontSize}set fontSize(e){this.native.fontSize=e}get fontType(){return this.native.fontType}set fontType(e){this.native.fontType=e}get alignment(){return this.native.alignment}set alignment(e){this.native.alignment=e}get fitType(){return this.native.fitType}set fitType(e){this.native.fitType=e}get spacing(){return new Q(this.native.spacing)}set spacing(e){this.native.spacing=e.native}}ot.nativeClasses=["IFUILabel"],ot.register();var st=effect.Amaz;const dt=["type","sizeMode","gridMode","verticalDirection","horizontalDirection","sortMode","cellSize","paddingLeft","paddingRight","paddingTop","paddingBottom","horizontalSpace","verticalSpace","useScaledSize","excludeInvisible"];class ct extends t{constructor(e,t){if(!e)super();else if(e.screenTransform)super(e,"IFUIGrid"),this.initialize(t,this.getProps());else throw new Error("LayoutComponent can only be added to an 2d sceneObject")}static register(){t.registerComponentType("Layout",this.nativeClasses,ct),this.register=()=>void 0}static fromNative(e,t){const a=new ct;if(t instanceof st.IFUIGrid)a.initWithNative(e,t,"IFUIGrid");else throw new Error("Incorrect argument to LayoutComponent::fromNative");return a}getProps(){return dt}get type(){return this.native.type}set type(e){this.native.type=e}get sizeMode(){return this.native.resizeMode}set sizeMode(e){this.native.resizeMode=e}get gridMode(){return this.native.startAxis}set gridMode(e){this.native.startAxis=e}get verticalDirection(){return this.native.verticalDirection}set verticalDirection(e){this.native.verticalDirection=e}get horizontalDirection(){return this.native.horizontalDirection}set horizontalDirection(e){this.native.horizontalDirection=e}get sortMode(){return this.native.sortingType}set sortMode(e){this.native.sortingType=e}get cellSize(){return this.native.cellSize}set cellSize(e){this.native.cellSize=e}get paddingLeft(){return this.native.paddingLeft}set paddingLeft(e){this.native.paddingLeft=e}get paddingRight(){return this.native.paddingRight}set paddingRight(e){this.native.paddingRight=e}get paddingTop(){return this.native.paddingTop}set paddingTop(e){this.native.paddingTop=e}get paddingBottom(){return this.native.paddingBottom}set paddingBottom(e){this.native.paddingBottom=e}get horizontalSpace(){return this.native.horizontalSpace}set horizontalSpace(e){this.native.horizontalSpace=e}get verticalSpace(){return this.native.verticalSpace}set verticalSpace(e){this.native.verticalSpace=e}get useScaledSize(){return this.native.affectedByScale}set useScaledSize(e){this.native.affectedByScale=e}get excludeInvisible(){return this.native.filterInvisibleChildren}set excludeInvisible(e){this.native.filterInvisibleChildren=e}}ct.nativeClasses=["IFUIGrid"],ct.register();var lt=effect.Amaz;const pt=["animations"];class ut extends t{constructor(e,t){e?(super(e,"Animator"),this.initialize(t,this.getProps())):super()}static register(){t.registerComponentType("Animation",this.nativeClasses,ut),this.register=()=>void 0}static fromNative(e,t){const a=new ut;if(t instanceof lt.Animator)a.initWithNative(e,t,"Animator");else throw new Error("Incorrect argument in AnimationComponent::fromNative");return a}getProps(){return pt}play(e,t){const a={playMode:t&&t.playMode!==void 0?t.playMode:exports.AnimationPlayMode.Once,speed:t&&t.speed!==void 0?t.speed:1,fadeTime:t&&t.fadeTime!==void 0?t.fadeTime:0,startTime:t&&t.startTime!==void 0?t.startTime:0};this.native.play(e,a.playMode,a.speed,a.fadeTime,a.startTime)}stop(){this.native.stopAllAnimations()}pause(){this.native.pauseAnimator()}resume(){this.native.resumeAnimator()}get animations(){const e=[],t=this.native.animations;for(let a=0;a<t.size();a++)e.push(t.get(a));return e}set animations(e){const t=new lt.Vector;for(const a of e)t.pushBack(a);this.native.animations=t}}ut.nativeClasses=["Animator"],ut.register();var gt=effect.Amaz;const mt=["audio","autoPlay","loop"];class ft extends t{constructor(e,t){e?(super(e,"Audio"),this.initialize(t,this.getProps())):super()}static register(){t.registerComponentType("Audio",this.nativeClasses,ft),this.register=()=>void 0}static fromNative(e,t){const a=new ft;if(t instanceof gt.Audio)a.initWithNative(e,t,"Audio");else throw new Error("Incorrect argument in AudioComponent::fromNative");return a}getProps(){return mt}get audio(){return this.native.clip}set audio(e){this.native.clip=e}get autoPlay(){return this.native.playOnAwake}set autoPlay(e){this.native.playOnAwake=e}get loop(){return this.native.loop}set loop(e){this.native.loop=e}play(){this.native.play()}stop(){this.native.stop()}pause(){this.native.pause()}resume(){this.native.resume()}reset(){this.native.reset()}}ft.nativeClasses=["Audio"],ft.register();var ht=effect.Amaz;const _t=["position","rotation","scale","size","pivot","flipX","flipY"];class yt extends t{constructor(e,t){e?(super(e,"IFTransform2d"),this.initialize(t,this.getProps())):super()}static register(){t.registerComponentType("ScreenTransform",this.nativeClasses,yt),this.register=()=>void 0}static fromNative(e,t){const a=new yt;if(t instanceof ht.IFTransform2d)a.initWithNative(e,t,"IFTransform2d");else throw new Error("Incorrect argument in ScreenTransformComponent::fromNative");return a}getProps(){return _t}get position(){return new Q(this.native.position)}set position(e){this.native.position=e.native}get scale(){return new Q(this.native.scale)}set scale(e){this.native.scale=e.native}get rotation(){return this.native.rotation}set rotation(e){this.native.rotation=e}get size(){return new Q(this.native.size)}set size(e){this.native.size=e.native}get pivot(){return new Q(this.native.pivot)}set pivot(e){this.native.pivot=e.native}get flipX(){return this.native.flipX}set flipX(e){this.native.flipX=e}get flipY(){return this.native.flipY}set flipY(e){this.native.flipY=e}}yt.nativeClasses=["IFTransform2d"],yt.register();var vt=effect.Amaz,Tt;const xt=null==(Tt=h.get(exports.Feature.ObjectReferenceInScript))?"":Tt,Mt=s.doesSDKSupport(xt);class St extends t{constructor(){super(),this.serialzedProperties=[],this._hasInitialized=!1}static register(){t.registerComponentType("Script",this.nativeClasses,St),this.register=()=>void 0}static create(e,t){const a=e.native.addJsScriptComponent(null==t?void 0:t.scriptPath),n=a.getScript();if(n){const t=n.ref;if(t)return t.initWithNative(e,a,"JSScriptComponent"),t;throw new Error("ScriptComponent: Invalid script instance.")}else throw new Error("ScriptComponent: Invalid script object.")}onInit(){const e=this.entity.getComponents("JSScriptComponent");for(let t=0;t<e.size();t++){const a=e.get(t);if(null!==a&&void 0!==a&&null!==a.getScript()&&void 0!==a.getScript()&&a.getScript().handle===this.script.handle){this.native=a;break}}if(void 0===this.native)throw new Error("ScriptComponent: Initialization failed, native script not found.");for(const e of this.serialzedProperties)this.convertAmazToAmg(e);if(this.serialzedProperties=[],this.sceneObject=zn.scene.sceneObjectFromNative(this.native.entity),this.sceneObject)this.entity=this.sceneObject,this.sceneObject.registerComponent(this),this.scene=zn.scene,this.getComponent=this._getComponent,this._hasInitialized=!0;else throw new Error("ScriptComponent: Initialization failed, cannot find owner SceneObject.")}_getComponent(e){var t;return null==(t=this.sceneObject)?void 0:t.getComponent(e)}onPropertyChanged(e){this._hasInitialized?this.convertAmazToAmg(e):this.serialzedProperties.push(e)}convertAmazToAmg(e){const t=this[e];let a=!1;if(t instanceof vt.Entity)Mt?this[e]=zn.scene.sceneObjectFromNative(t):a=!0;else if(t instanceof vt.Component)if(Mt){const a=zn.scene.sceneObjectFromNative(t.entity);a&&(this[e]=a.getComponentFromNative(t))}else a=!0;a&&console.warn(`[Amazing JS]: current SDK version[${vt.VERSION}] is lower
        than the minimum required version[${xt}]
        for object reference module.`)}hasIntialized(){return this._hasInitialized}}St.nativeClasses=["JSScriptComponent"],St.register();var Ft=effect.Amaz;const Ct=["type","layer"];class At extends t{constructor(e,t){e?(super(e,"Raycaster"),this.initialize(t,this.getProps())):super()}static register(){t.registerComponentType("ScreenRaycaster",this.nativeClasses,At),this.register=()=>void 0}static fromNative(e,t){const a=new At;if(t instanceof Ft.Raycaster)a.initWithNative(e,t,"Raycaster");else throw new Error("Incorrect argument in ScreenRaycasterComponent::fromNative");return a}getProps(){return Ct}get type(){return this.native.raycasterType}set type(e){this.native.raycasterType=e}get layers(){const e=[];for(let t=0;t<D;++t)this.native.layer.test(t)&&e.push(t);return e}set layers(e){const t=new Ft.DynamicBitset(D,0);for(const a of e)if(0<=a&&a<D)t.set(a);else throw new Error("Invalid layer value!");this.native.layer=t}raycastOBB(e){var t;if(null!=(t=this.sceneObject)&&t.camera){const t=[],n=this.native.raycast3D(e.native);for(let e=0;e<n.size();e++){var a;const r=null==(a=this.sceneObject.scene)?void 0:a.sceneObjectFromNative(n.get(e).sceneObject);r&&t.push(r)}return t}throw new Error("No CameraComponent attached on the sceneObject!")}raycastUI(e){var t;if(null!=(t=this.sceneObject)&&t.camera){const t=[],n=this.native.raycastIF(e.native);for(let e=0;e<n.size();e++){var a;const r=null==(a=this.sceneObject.scene)?void 0:a.sceneObjectFromNative(n.get(e).sceneObject);r&&t.push(r)}return t}throw new Error("No CameraComponent attached on the sceneObject!")}raycastGeometricPlane(e,t){var a;if(null!=(a=this.sceneObject)&&a.camera){const a=new de(t.x,t.y,t.z),n=t.w,r=new de(this.native.viewPointHitPlane(e.native,a.native,n));let i=!0;return 9999<r.x&&9999<r.y&&9999<r.z&&(i=!1),{hit:i,hitpos:r}}throw new Error("No CameraComponent attached on the sceneObject!")}}At.nativeClasses=["Raycaster"],At.register();var It=effect.Amaz;class bt extends e{constructor(e,t){if(super(),this._components=new Map,e&&e instanceof zt&&t&&t instanceof It.Entity)this.scene=e,this.native=t,this._transform=this.native.getComponent("Transform"),this.scene.addSceneObjectToCache(this);else{var a;if(this.scene=null!=t&&t.scene?null==t?void 0:t.scene:zn.scene,!this.scene)throw new Error("No active scene found!");const n=e&&"string"==typeof e?e:"Untitled";this.native=this.scene.native.createEntity(n),t&&!(t instanceof It.Entity)&&(this.layer=t.layer?t.layer:0,this.tags=t.tags?t.tags:[]),this._transform=this.native.addComponent("Transform"),null==(a=this.scene)?void 0:a.addSceneObjectToCache(this)}}static fromNative(e,t){if(t instanceof It.Entity)return new bt(e,t);throw new Error("Incorrect argument to SceneObject::fromNative")}get name(){return this.native.name}set name(e){this.native.name=e}get parent(){var e;let t;return this._transform&&this._transform.parent&&(t=this._transform.parent.entity),null==(e=this.scene)?void 0:e.sceneObjectFromNative(t)}get enabled(){return this.native.selfvisible}set enabled(e){this.native.visible=e}get enabledInScene(){return this.native.visible}get layer(){return this.native.layer}set layer(e){if(0<=e&&e<D)this.native.layer=e;else throw new Error("Invalid layer value!")}get tags(){const e=[],t=this.native.tag;for(let a=0;a<w;++a)t&1<<a&&e.push(a);return e}set tags(e){let t=0;for(const a of e)if(0<=a&&a<w)t|=1<<a;else throw new Error(`Invalid tag value: ${a}`);this.native.tag=t}get screenTransform(){return this.getComponent("ScreenTransform")}get camera(){return this.getComponent("Camera")}get sprite(){return this.getComponent("Sprite")}get model(){return this.getComponent("Model")}get light(){return this.getComponent("Light")}get image(){return this.getComponent("Image")}get canvas(){return this.getComponent("Canvas")}get button(){return this.getComponent("Button")}get uiCollider(){return this.getComponent("UICollider")}get label(){return this.getComponent("Label")}get seqAnimation(){return this.getComponent("SeqAnimation")}get layout(){return this.getComponent("Layout")}get animation(){return this.getComponent("Animation")}get audio(){return this.getComponent("Audio")}get script(){return this.getComponent("Script")}get screenRaycaster(){return this.getComponent("ScreenRaycaster")}addComponent(e,t){const a=this._addComponent(e,t);return this.registerComponent(a)}registerComponent(e){if(e){const t=e.native.handle;if(!this._components.has(t))return this._components.set(t,e),e;else{const a=this._components.get(t);return a!==e&&(e.sceneObject=void 0,e.native=void 0,e.destroy()),a}}}_addComponent(e,t){switch(e){case"ScreenTransform":if(!this.getComponent(e)){this.native.removeComponent("Transform");const e=new yt(this,t);return this._transform=e.native,e}throw new Error(`SceneObject already has ScreenTransform component`);case"Camera":return new H(this,t);case"Model":return new Ye(this,t);case"Light":return new Qe(this,t);case"Sprite":return new ke(this,t);case"Image":return new ne(this,t);case"Canvas":return new oe(this,t);case"Button":return new je(this,t);case"UICollider":return new nt(this,t);case"Label":return new ot(this,t);case"SeqAnimation":return new Oe(this,t);case"Layout":return new ct(this,t);case"Animation":return new ut(this,t);case"Audio":return new ft(this,t);case"Script":return St.create(this,t);case"ScreenRaycaster":return new At(this,t);default:throw new Error(`Doesn't support component type: ${e}`);}}removeComponent(e){const t=this.getComponent(e);return!!t&&(this._components.delete(t.native.handle),t.destroy(),"ScreenTransform"===e&&(this._transform=this.native.addComponent("Transform")),!0)}addChild(e){this._transform&&this._transform.addTransform(e.native.getComponent("Transform"))}removeChild(e){this._transform&&this._transform.removeTransform(e.native.getComponent("Transform"))}findByName(e){let t;if(this.name===e)t=this;else for(const a of this.children)if(t=a.findByName(e),t)break;return t}findByTag(e){let t;if(this.hasTag(e))t=this;else for(const a of this.children)if(t=a.findByTag(e),t)break;return t}findAllByName(e){const t=[];this.name===e&&t.push(this);for(const a of this.children)t.push(...a.findAllByName(e));return t}findAllByTag(e){const t=[];this.hasTag(e)&&t.push(this);for(const a of this.children)t.push(...a.findAllByTag(e));return t}get position(){return new de(this._transform.localPosition)}set position(e){this._transform.localPosition=e.native}get scale(){return new de(this._transform.localScale)}set scale(e){this._transform.localScale=e.native}get rotation(){return new de(this._transform.localEulerAngle)}set rotation(e){this._transform.localEulerAngle=e.native}get rotationQuat(){return new he(this._transform.localOrientation)}set rotationQuat(e){this._transform.localOrientation=e.native}get worldPosition(){return new de(this._transform.worldPosition)}set worldPosition(e){this._transform.worldPosition=e.native}get worldScale(){return new de(this._transform.worldScale)}set worldScale(e){this._transform.worldScale=e.native}get worldRotation(){return new he(this._transform.worldOrientation)}set worldRotation(e){this._transform.worldOrientation=e.native}get worldEulerAngles(){return new de(this._transform.worldEulerAngle)}set worldEulerAngles(e){this._transform.worldEulerAngle=e.native}addTag(e){if(0<=e&&e<w)this.native.addTag(e);else throw new Error(`Invalid tag:[${e}] number when adding tag. (valid tag: 0-31)`)}hasTag(e){return this.native.hasTag(e)}destroy(){var e,t;for(const e of this._components.values())e.destroy();this._components.clear(),null==(e=this.scene)?void 0:e.removeSceneObjectToCache(this),null==(t=this.scene)?void 0:t.native.removeEntity(this.native),this.native=void 0,this.scene=void 0,this._transform=void 0}get children(){const e=[];for(let a=0;a<this._transform.children.size();++a){var t;const n=this._transform.children.get(a),r=null==(t=this.scene)?void 0:t.sceneObjectFromNative(n.entity);if(r)e.push(r);else throw new Error("SceneObject has invalid child!")}return e}getComponentFromNative(e){let a;if(this._components.has(e.handle))return this._components.get(e.handle);else{const n=t.getComponentFronNative(e);n&&(a=n.fromNative(this,e))}return a}getComponent(e){let a;const n=t.getComponentFromType(e);if(n)for(const t of n.nativeClasses){const r=this.native.getComponent(t);if(r){if(!this._components.has(r.handle)){const t=n.typeFromNative?n.typeFromNative(r):e;if(t===e&&n.fromNative)a=n.fromNative(this,r),this._components.set(r.handle,a);else throw new Error("SceneObject::Cannot get component "+n.nativeClasses)}else a=this._components.get(r.handle);break}}else{const t=this.native.getComponents(St.nativeClasses[0]);for(let n=0;n<t.size();++n){const r=t.get(n),i=r.getScript();if(null===i||void 0===i)continue;const o=i.className;if(o===e){if(!this._components.has(r.handle))throw new Error(`Invalid script:[${o}]: Unregistered user script.`);else a=this._components.get(r.handle);break}}}return a}getComponents(e){const a=[],n=t.getComponentFromType(e);if(n)for(const e of n.nativeClasses){const t=this.native.getComponents(e);for(let e=0;e<t.size();++e){const r=t.get(e);let i;this._components.has(r.handle)?i=this._components.get(r.handle):(i=n.fromNative(this,r),this._components.set(r.handle,i)),a.push(i)}}return a}hasComponent(e){let a=!1;const n=t.getComponentFromType(e);if(n)for(const e of n.nativeClasses)if(a=!!this.native.getComponent(e),a)break;return a}findByComponent(e){let t;if(this.hasComponent(e))t=this;else for(const a of this.children)if(t=a.findByComponent(e),t)break;return t}findAllByComponent(e){const t=[];this.hasComponent(e)&&t.push(this);for(const a of this.children)t.push(...a.findAllByComponent(e));return t}}var Rt=effect.Amaz;class zt{constructor(e){if(this.sceneObjects=new Map,this._physicsSystem=void 0,e&&e instanceof Rt.Scene){this.native=e;const t=this.native.entities,a=t.empty()?void 0:this.findRoot(t);this.root=a?this.sceneObjectFromNative(a):new bt("Root",{scene:this})}else this.native=new Rt.Scene,this.name="string"==typeof e?e:"Untitled",this.root=new bt("Root",{scene:this})}findRoot(e){let t=e.front().getComponent("Transform");for(;t.parent;)t=t.parent;return t.entity}get children(){const e=[];for(let t=0;t<this.native.entities.size();++t){const a=this.native.entities.get(t),n=a.getComponent("Transform");if(!n)throw new Error("Scene has invalid child sceneObject!");else if(!n.parent){const t=this.sceneObjectFromNative(a);if(t)e.push(t);else throw new Error("Scene has invalid child sceneObject!")}}return e}get name(){return this.native.name}set name(e){this.native.name=e}get visible(){return this.native.visible}set visible(e){this.native.visible=e}addSystem(e){this.native.addSystem(e)}addSceneObjectToCache(e){e.native.handle&&this.sceneObjects.set(e.native.handle,e)}removeSceneObjectToCache(e){e.native.handle&&this.sceneObjects.delete(e.native.handle)}sceneObjectFromNative(e){return e?e.handle&&this.sceneObjects.has(e.handle)?this.sceneObjects.get(e.handle):bt.fromNative(this,e):void 0}destroy(){this.sceneObjects.clear(),this.native.visible=!1}rayCast(e,t){const a=[],n=this.physicsSystem.rayTest(e.native,t.native);for(let r=0;r<n.size();++r){const e=n.get(r),t=this.sceneObjectFromNative(e.entity);t&&a.push(t)}return a}findByName(e){let t;for(let a=0;a<this.native.entities.size();++a){const n=this.sceneObjectFromNative(this.native.entities.get(a));if(n&&n.name===e){t=n;break}}return t}findByTag(e){let t;for(let a=0;a<this.native.entities.size();++a){const n=this.sceneObjectFromNative(this.native.entities.get(a));if(n&&n.hasTag(e)){t=n;break}}return t}findByComponent(e){let t;for(let a=0;a<this.native.entities.size();++a){const n=this.sceneObjectFromNative(this.native.entities.get(a));if(n&&n.hasComponent(e)){t=n;break}}return t}findAllByName(e){const t=[];for(let a=0;a<this.native.entities.size();++a){const n=this.sceneObjectFromNative(this.native.entities.get(a));n&&n.name===e&&t.push(n)}return t}findAllByTag(e){const t=[];for(let a=0;a<this.native.entities.size();++a){const n=this.sceneObjectFromNative(this.native.entities.get(a));n&&n.hasTag(e)&&t.push(n)}return t}findAllByComponent(e){const t=[];for(let a=0;a<this.native.entities.size();++a){const n=this.sceneObjectFromNative(this.native.entities.get(a));n&&n.hasComponent(e)&&t.push(n)}return t}get physicsSystem(){return void 0===this._physicsSystem&&(this._physicsSystem=this.native.getSystem("Physics3DSystem")),this._physicsSystem}}var Pt=effect.Amaz,Et;(function(e){e[e.TouchStart=0]="TouchStart",e[e.TouchMove=1]="TouchMove",e[e.TouchStationary=2]="TouchStationary",e[e.TouchEnd=3]="TouchEnd",e[e.TouchCancel=4]="TouchCancel"})(Et||(Et={}));class kt{constructor(e,t,a,n,r,i,o,s){this.identifier=-1,this.type=Et.TouchStart,this.x=0,this.y=0,this.force=0,this.size=0,this.time=0,this.count=0,this.valid=!1,e!==void 0&&(this.identifier=e,this.valid=!0),t!==void 0&&(this.type=t),a!==void 0&&(this.x=a),n!==void 0&&(this.y=n),r!==void 0&&(this.force=r),i!==void 0&&(this.size=i),o!==void 0&&(this.time=o),s!==void 0&&(this.count=s)}static fromNative(e){const t=new kt(e.pointerId,kt.convertTouchType(e.type),e.x,e.y,e.force,e.size,e.time,e.count);return t}static convertTouchType(e){return e===Pt.TouchType.TOUCH_BEGAN?Et.TouchStart:e===Pt.TouchType.TOUCH_MOVED?Et.TouchMove:e===Pt.TouchType.TOUCH_STATIONARY?Et.TouchStationary:e===Pt.TouchType.TOUCH_ENDED?Et.TouchEnd:e===Pt.TouchType.TOUCH_CANCELED?Et.TouchCancel:Et.TouchEnd}}class Lt extends e{constructor(e,t){super(),this._width=e,this._height=t}start(){}destroy(){}onEvent(e){if(e.type===Pt.EventType.TOUCH){const t=e.args.get(0),a=this.convertTouchEvent(t);switch(a.type){case Et.TouchStart:this.fire("touchstart",a);break;case Et.TouchMove:this.fire("touchmove",a);break;case Et.TouchEnd:this.fire("touchend",a);break;case Et.TouchCancel:this.fire("touchcancel",a);}}}convertTouchEvent(e){var t=Math.round;const a=t(e.x*this._width),n=this._height-t(e.y*this._height),r=kt.fromNative(e);return r.x=a,r.y=n,r}}var Bt=effect.Amaz;class Ot{constructor(e){const t=e.properties;this._flip=t.flip,this._inputTexture=t.inputTexture,this._renderTexture=zn.customAssets.getNativeObject(e.uuid),this._renderTexture.depth=1,this._renderTexture.filterMag=Bt.FilterMode.LINEAR,this._renderTexture.filterMin=Bt.FilterMode.LINEAR,this._renderTexture.filterMipmap=Bt.FilterMipmapMode.NONE,this._renderTexture.attachment=Bt.RenderTextureAttachment.NONE,this._renderTexture.width=Bt.AmazingManager.getSingleton("BuiltinObject").getInputTextureWidth(),this._renderTexture.height=Bt.AmazingManager.getSingleton("BuiltinObject").getInputTextureHeight();const a=i.createShaders({gles2:{vs:"\n    precision highp float;\n\n    attribute vec3 inPosition;\n    attribute vec2 inTexCoord;\n\n    varying vec2 v_TexCoord;\n\n    uniform mat4 u_Model;\n    uniform float u_FlipVertical;\n\n    void main() {\n      vec2 flipCoord = vec2(inTexCoord.x, 1. - inTexCoord.y);\n      v_TexCoord = mix(inTexCoord, flipCoord, u_FlipVertical);\n      gl_Position = u_Model * vec4(inPosition, 1.0);\n    }\n    ",fs:`
    precision highp float;

    varying vec2 v_TexCoord;

    uniform sampler2D u_CameraTex;

    void main() {
      gl_FragColor = texture2D(u_CameraTex, v_TexCoord);
    }
    `},metal:{vs:`
    #include <metal_stdlib>
    #include <simd/simd.h>
    
    using namespace metal;
    
    struct buffer_t
    {
        float u_FlipVertical;
        float4x4 u_Model;
    };
    
    struct main0_out
    {
        float2 v_TexCoord;
        float4 gl_Position [[position]];
    };
    
    struct main0_in
    {
        float3 inPosition [[attribute(0)]];
        float2 inTexCoord [[attribute(1)]];
    };
    
    vertex main0_out main0(main0_in in [[stage_in]], constant buffer_t& buffer)
    {
        main0_out out = {};
        float2 flipCoord = float2(in.inTexCoord.x, 1.0 - in.inTexCoord.y);
        out.v_TexCoord = mix(in.inTexCoord, flipCoord, float2(buffer.u_FlipVertical));
        out.gl_Position = buffer.u_Model * float4(in.inPosition, 1.0);
        out.gl_Position.z = (out.gl_Position.z + out.gl_Position.w) * 0.5;       // Adjust clip-space for Metal
        return out;
    }
    `,fs:`
    #include <metal_stdlib>
    #include <simd/simd.h>

    using namespace metal;

    struct main0_out
    {
        float4 gl_FragColor [[color(0)]];
    };

    struct main0_in
    {
        float2 v_TexCoord;
    };

    fragment main0_out main0(main0_in in [[stage_in]], texture2d<float> u_CameraTex [[texture(0)]], sampler u_CameraTexSmplr [[sampler(0)]])
    {
        main0_out out = {};
        out.gl_FragColor = u_CameraTex.sample(u_CameraTexSmplr, in.v_TexCoord);
        return out;
    }
    `}});this._screenMaterial=i.createScreenMaterial(a);const n=zn.assets.loadSync(this._inputTexture);this._screenMaterial.setTex("u_CameraTex",null==n?void 0:n.resource);const r=!0===this._flip?1:0;this._screenMaterial.setFloat("u_FlipVertical",r)}onStart(){}onUpdate(){const e=zn.customAssets.cmdBufferHelper;e.cmdBufferSetRenderTexture(this._renderTexture),e.cmdBufferDrawMesh(e.screenMesh,new ve,this._screenMaterial,0,0,new Bt.MaterialPropertyBlock)}onLateUpdate(){}onDestroy(){}}class wt{constructor(e){this._mgr=e,this._allTrackedIDs=new Map,this._allIDs=new Map}facePartHelper(e,t,a,n){for(let r=e;r<t;r++)n.pushBack(a.get(r));return n}update(){this._allIDs.clear(),this.onUpdate(this._allIDs);for(const[e,t]of this._allTrackedIDs.entries()){const a=this._allIDs.get(e);if(null!=a)for(const n of t.values())a.has(n)||this._mgr.setFaceState(!1,n,e);else console.error(`Can't find lastFaceIdSet with faceType ${exports.FaceType[e]}`)}this._allTrackedIDs.clear(),this._allIDs.forEach((e,t)=>this._allTrackedIDs.set(t,e))}}var Dt=effect.Amaz,Vt;(function(e){e[e.Human=0]="Human",e[e.Pet=1]="Pet"})(Vt||(Vt={}));const Nt=new Map([[exports.FaceType.Unknown,Vt.Human],[exports.FaceType.Human,Vt.Human],[exports.FaceType.Dog,Vt.Pet],[exports.FaceType.Cat,Vt.Pet]]);class Ht{constructor(){this.vertexes=new Dt.Vec3Vector,this.landmarks=new Dt.Vec3Vector,this.normals=new Dt.Vec3Vector,this.tangents=new Dt.Vec3Vector,this.mvp=new ve,this.modelMatrix=new ve,this.scale=0}}var Ut=effect.Amaz;class Gt{constructor(){this.type=exports.FaceType.Unknown,this.score=0,this.id=0,this.yaw=0,this.pitch=0,this.roll=0,this.transform=new ve,this.rect=new T,this.expression=exports.FaceExpression.Unknown,this.isValidFace=!1,this.action=exports.FaceAction.None,this.faceMesh=new Ht,this.contour=new Ut.Vec2Vector,this.landmarks106=new Ut.Vec2Vector,this.landmarks240EyeLeft=new Ut.Vec2Vector,this.landmarks240EyeRight=new Ut.Vec2Vector,this.landmarks240EyebrowLeft=new Ut.Vec2Vector,this.landmarks240EyebrowRight=new Ut.Vec2Vector,this.landmarks240Lip=new Ut.Vec2Vector,this.landmarks280LeftIris=new Ut.Vec2Vector,this.landmarks280RightIris=new Ut.Vec2Vector,this.landmarks3d=new Ut.Vec3Vector,this.landmarksPetV2=new Ut.Vec2Vector}isValid(){return this.isValidFace}hasAction(){return this.action!==exports.FaceAction.None}getPartLandmark(e,t,a){let n=new Ut.Vec2Vector;const r=a.get(e);if(r)for(let e=0;e<r.length;e++)n=this.facePartHelper(r[e][0],r[e][1],t,n);else return console.error(`${this.type} doesn't support ${e} yet`),null;return n}facePartHelper(e,t,a,n){for(let r=e;r<t;r++)n.pushBack(a.get(r));return n}}const jt=new Map([[exports.FacePart.LeftEye,[[52,58],[72,74],[104,105]]],[exports.FacePart.RightEye,[[58,64],[75,78],[105,106]]],[exports.FacePart.Nose,[[43,52],[80,84]]],[exports.FacePart.Mouth,[[84,104]]],[exports.FacePart.LeftEyeBrow,[[33,38],[64,68]]],[exports.FacePart.RightEyeBrow,[[38,43],[68,72]]]]),Wt=new Map([[exports.FacePart.LeftEye,[[64,72],[80,81]]],[exports.FacePart.RightEye,[[72,80],[81,82]]],[exports.FacePart.Nose,[[40,48]]],[exports.FacePart.Mouth,[[48,64]]],[exports.FacePart.LeftEar,[[0,1],[23,33]]],[exports.FacePart.RightEar,[[16,20],[33,40]]],[exports.FacePart.Contour,[[0,26]]]]),Xt=new Map([[exports.FacePart.LeftEye,[[58,66],[74,75]]],[exports.FacePart.RightEye,[[66,74],[75,76]]],[exports.FacePart.Nose,[[26,42]]],[exports.FacePart.Mouth,[[42,58]]],[exports.FacePart.LeftEar,[[0,1],[23,26],[76,83]]],[exports.FacePart.RightEar,[[16,20],[83,90]]],[exports.FacePart.Contour,[[0,26]]]]);class Yt extends Gt{constructor(){super()}getLandmarks(e,t){return t===exports.FaceLandmarkType.Face106?this.get106landmark(e):t===exports.FaceLandmarkType.Face240?this.get240landmark(e):t===exports.FaceLandmarkType.Face280?this.get280landmark(e):(console.log("getLandmarks null"),null)}get106landmark(e){return e==exports.FacePart.Whole?this.landmarks106:e==exports.FacePart.Contour?this.contour:this.getPartLandmark(e,this.landmarks106,jt)}get240landmark(e){switch(e){case exports.FacePart.Whole:let t=this.facePartHelper(0,this.landmarks240EyeLeft.size(),this.landmarks240EyeLeft,this.landmarks106);return t=this.facePartHelper(0,this.landmarks240EyeRight.size(),this.landmarks240EyeRight,t),t=this.facePartHelper(0,this.landmarks240EyebrowLeft.size(),this.landmarks240EyebrowLeft,t),t=this.facePartHelper(0,this.landmarks240EyebrowRight.size(),this.landmarks240EyebrowRight,t),t=this.facePartHelper(0,this.landmarks240Lip.size(),this.landmarks240Lip,t),t;case exports.FacePart.LeftEye:const a=this.getLandmarks(exports.FacePart.LeftEye,exports.FaceLandmarkType.Face106),n=this.facePartHelper(0,this.landmarks240EyeLeft.size(),this.landmarks240EyeLeft,a);return n;case exports.FacePart.RightEye:const r=this.getLandmarks(exports.FacePart.RightEye,exports.FaceLandmarkType.Face106),i=this.facePartHelper(0,this.landmarks240EyeRight.size(),this.landmarks240EyeRight,r);return i;case exports.FacePart.Nose:const o=this.getLandmarks(exports.FacePart.Nose,exports.FaceLandmarkType.Face106);return o;case exports.FacePart.Mouth:const s=this.getLandmarks(exports.FacePart.Mouth,exports.FaceLandmarkType.Face106),d=this.facePartHelper(0,this.landmarks240Lip.size(),this.landmarks240Lip,s);return d;case exports.FacePart.LeftEyeBrow:const c=this.getLandmarks(exports.FacePart.LeftEyeBrow,exports.FaceLandmarkType.Face106),l=this.facePartHelper(0,this.landmarks240EyebrowLeft.size(),this.landmarks240EyebrowLeft,c);return l;case exports.FacePart.RightEyeBrow:const p=this.getLandmarks(exports.FacePart.RightEyeBrow,exports.FaceLandmarkType.Face106),u=this.facePartHelper(0,this.landmarks240EyebrowRight.size(),this.landmarks240EyebrowRight,p);return u;case exports.FacePart.Contour:const g=this.getLandmarks(exports.FacePart.Contour,exports.FaceLandmarkType.Face106);return g;default:return console.error(`Head 240 doesn't support ${e} yet`),null;}}get280landmark(e){switch(e){case exports.FacePart.Whole:const t=this.getLandmarks(exports.FacePart.Whole,exports.FaceLandmarkType.Face240);let a=this.facePartHelper(0,this.landmarks280LeftIris.size(),this.landmarks280LeftIris,t);return a=this.facePartHelper(0,this.landmarks280RightIris.size(),this.landmarks280RightIris,a),a;case exports.FacePart.LeftEye:const n=this.getLandmarks(exports.FacePart.LeftEye,exports.FaceLandmarkType.Face240),r=this.facePartHelper(0,this.landmarks280LeftIris.size(),this.landmarks280LeftIris,n);return r;case exports.FacePart.RightEye:const i=this.getLandmarks(exports.FacePart.RightEye,exports.FaceLandmarkType.Face240),o=this.facePartHelper(0,this.landmarks280RightIris.size(),this.landmarks280RightIris,i);return o;case exports.FacePart.Nose:const s=this.getLandmarks(exports.FacePart.Nose,exports.FaceLandmarkType.Face240);return s;case exports.FacePart.Mouth:const d=this.getLandmarks(exports.FacePart.Mouth,exports.FaceLandmarkType.Face240);return d;case exports.FacePart.LeftEyeBrow:const c=this.getLandmarks(exports.FacePart.LeftEyeBrow,exports.FaceLandmarkType.Face240);return c;case exports.FacePart.RightEyeBrow:const l=this.getLandmarks(exports.FacePart.RightEyeBrow,exports.FaceLandmarkType.Face240);return l;case exports.FacePart.Contour:const p=this.getLandmarks(exports.FacePart.Contour,exports.FaceLandmarkType.Face240);return p;default:return console.error(`Head 280 doesn't support ${e} yet`),null;}}}var qt=effect.Amaz;class Zt extends wt{constructor(e){super(e),this._allTrackedIDs.set(exports.FaceType.Human,new Set)}getLandmark(e,t,a){return a===exports.FaceLandmarkType.Face106?this.get106landmark(e,t):a===exports.FaceLandmarkType.Face240?this.get240landmark(e,t):a===exports.FaceLandmarkType.Face280?this.get280landmark(e,t):a===exports.FaceLandmarkType.Face3d?this.get3dlandmark(e,t):(console.error(`Head doesn't support ${a} yet`),null)}get106landmark(e,t){switch(e){case exports.FacePart.Whole:return this._mgr.faces[t].landmarks106;case exports.FacePart.LeftEye:let a=new qt.Vec2Vector;return a=this.facePartHelper(52,58,this._mgr.faces[t].landmarks106,a),a=this.facePartHelper(72,74,this._mgr.faces[t].landmarks106,a),a=this.facePartHelper(104,105,this._mgr.faces[t].landmarks106,a),a;case exports.FacePart.RightEye:let n=new qt.Vec2Vector;return n=this.facePartHelper(58,64,this._mgr.faces[t].landmarks106,n),n=this.facePartHelper(75,78,this._mgr.faces[t].landmarks106,n),n=this.facePartHelper(105,106,this._mgr.faces[t].landmarks106,n),n;case exports.FacePart.Nose:let r=new qt.Vec2Vector;return r=this.facePartHelper(43,52,this._mgr.faces[t].landmarks106,r),r=this.facePartHelper(80,84,this._mgr.faces[t].landmarks106,r),r;case exports.FacePart.Mouth:let i=new qt.Vec2Vector;return i=this.facePartHelper(84,104,this._mgr.faces[t].landmarks106,i),i;case exports.FacePart.LeftEyeBrow:let o=new qt.Vec2Vector;return o=this.facePartHelper(33,38,this._mgr.faces[t].landmarks106,o),o=this.facePartHelper(64,68,this._mgr.faces[t].landmarks106,o),o;case exports.FacePart.RightEyeBrow:let s=new qt.Vec2Vector;return s=this.facePartHelper(38,43,this._mgr.faces[t].landmarks106,s),s=this.facePartHelper(68,72,this._mgr.faces[t].landmarks106,s),s;case exports.FacePart.Contour:return this._mgr.faces[t].contour;default:return console.error(`Head 106 doesn't support ${e} yet`),null;}}get240landmark(e,t){switch(e){case exports.FacePart.Whole:let a=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyeLeft.size(),this._mgr.faces[t].landmarks240EyeLeft,this._mgr.faces[t].landmarks106);return a=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyeRight.size(),this._mgr.faces[t].landmarks240EyeRight,a),a=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyebrowLeft.size(),this._mgr.faces[t].landmarks240EyebrowLeft,a),a=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyebrowRight.size(),this._mgr.faces[t].landmarks240EyebrowRight,a),a=this.facePartHelper(0,this._mgr.faces[t].landmarks240Lip.size(),this._mgr.faces[t].landmarks240Lip,a),a;case exports.FacePart.LeftEye:const n=this._mgr.getLandmarks(exports.FacePart.LeftEye,t,exports.FaceLandmarkType.Face106),r=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyeLeft.size(),this._mgr.faces[t].landmarks240EyeLeft,n);return r;case exports.FacePart.RightEye:const i=this._mgr.getLandmarks(exports.FacePart.RightEye,t,exports.FaceLandmarkType.Face106),o=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyeRight.size(),this._mgr.faces[t].landmarks240EyeRight,i);return o;case exports.FacePart.Nose:const s=this._mgr.getLandmarks(exports.FacePart.Nose,t,exports.FaceLandmarkType.Face106);return s;case exports.FacePart.Mouth:const d=this._mgr.getLandmarks(exports.FacePart.Mouth,t,exports.FaceLandmarkType.Face106),c=this.facePartHelper(0,this._mgr.faces[t].landmarks240Lip.size(),this._mgr.faces[t].landmarks240Lip,d);return c;case exports.FacePart.LeftEyeBrow:const l=this._mgr.getLandmarks(exports.FacePart.LeftEyeBrow,t,exports.FaceLandmarkType.Face106),p=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyebrowLeft.size(),this._mgr.faces[t].landmarks240EyebrowLeft,l);return p;case exports.FacePart.RightEyeBrow:const u=this._mgr.getLandmarks(exports.FacePart.RightEyeBrow,t,exports.FaceLandmarkType.Face106),g=this.facePartHelper(0,this._mgr.faces[t].landmarks240EyebrowRight.size(),this._mgr.faces[t].landmarks240EyebrowRight,u);return g;case exports.FacePart.Contour:return this._mgr.faces[t].contour;default:return console.error(`Head 240 doesn't support ${e} yet`),null;}}get280landmark(e,t){switch(e){case exports.FacePart.Whole:const a=this._mgr.getLandmarks(exports.FacePart.Whole,t,exports.FaceLandmarkType.Face240);let n=this.facePartHelper(0,this._mgr.faces[t].landmarks280LeftIris.size(),this._mgr.faces[t].landmarks280LeftIris,a);return n=this.facePartHelper(0,this._mgr.faces[t].landmarks280RightIris.size(),this._mgr.faces[t].landmarks280RightIris,n),n;case exports.FacePart.LeftEye:const r=this._mgr.getLandmarks(exports.FacePart.LeftEye,t,exports.FaceLandmarkType.Face240),i=this.facePartHelper(0,this._mgr.faces[t].landmarks280LeftIris.size(),this._mgr.faces[t].landmarks280LeftIris,r);return i;case exports.FacePart.RightEye:const o=this._mgr.getLandmarks(exports.FacePart.RightEye,t,exports.FaceLandmarkType.Face240),s=this.facePartHelper(0,this._mgr.faces[t].landmarks280RightIris.size(),this._mgr.faces[t].landmarks280RightIris,o);return s;case exports.FacePart.Nose:const d=this._mgr.getLandmarks(exports.FacePart.Nose,t,exports.FaceLandmarkType.Face240);return d;case exports.FacePart.Mouth:const c=this._mgr.getLandmarks(exports.FacePart.Mouth,t,exports.FaceLandmarkType.Face240);return c;case exports.FacePart.LeftEyeBrow:const l=this._mgr.getLandmarks(exports.FacePart.LeftEyeBrow,t,exports.FaceLandmarkType.Face240);return l;case exports.FacePart.RightEyeBrow:const p=this._mgr.getLandmarks(exports.FacePart.RightEyeBrow,t,exports.FaceLandmarkType.Face240);return p;case exports.FacePart.Contour:return this._mgr.faces[t].contour;default:return console.error(`Head 280 doesn't support ${e} yet`),null;}}get3dlandmark(e,t){return e===exports.FacePart.Whole?this._mgr.faces[t].landmarks3d:(console.error(`Head 3d doesn't support ${e} yet`),null)}onUpdate(e){const t=new Set,a=zn.algorithms.nativeResult;if(a&&a.getFaceCount){const n=a.getFaceCount();if(0<n)for(let e=0;e<n;e++){const n=a.getFaceBaseInfo(e),r=a.getFaceAttributeInfo(e),i=a.getFaceExtraInfo(e),o=a.getFaceMeshInfo(e),s=a.getFaceNewLandmarkInfo(e);if(null!=n){const e=new Yt;this._mgr.addFaceData(e);const a=n.ID;this._mgr.setFaceState(!0,a,exports.FaceType.Human),t.add(a),e.isValidFace=!0,e.type=exports.FaceType.Human,e.score=n.score,e.id=a,e.yaw=n.yaw,e.pitch=n.pitch,e.roll=n.roll,e.rect=new T(n.rect),e.action=n.action,e.landmarks106=n.points_array,null!=s&&(e.contour=s.points),null!=i&&(e.landmarks240EyeLeft=i.eye_left,e.landmarks240EyeRight=i.eye_right,e.landmarks240EyebrowLeft=i.eyebrow_left,e.landmarks240EyebrowRight=i.eyebrow_right,e.landmarks240Lip=i.lips,e.landmarks280LeftIris=i.left_iris,e.landmarks280RightIris=i.right_iris),null!=r&&(e.expression=r.exp_type),null!=o&&(e.landmarks3d=o.landmarks,e.faceMesh.vertexes=o.vertexes,e.faceMesh.normals=o.normals,e.faceMesh.tangents=o.tangents,e.faceMesh.scale=o.scale,e.faceMesh.mvp=new ve(o.mvp),e.faceMesh.modelMatrix=new ve(o.modelMatrix))}else console.error("Invalid face data:"+e)}e.set(exports.FaceType.Human,t)}}}class Kt extends Gt{constructor(){super()}getLandmarks(e){return e==exports.FacePart.Whole?this.landmarksPetV2:this.getPartLandmark(e,this.landmarksPetV2,Xt)}}class Jt extends Gt{constructor(){super()}getLandmarks(e){return e==exports.FacePart.Whole?this.landmarksPetV2:this.getPartLandmark(e,this.landmarksPetV2,Wt)}}var Qt=effect.Amaz;class $t extends wt{constructor(e){super(e),this._allTrackedIDs.set(exports.FaceType.Cat,new Set),this._allTrackedIDs.set(exports.FaceType.Dog,new Set)}getLandmark(e,t,a){if(a&&a!==exports.FaceLandmarkType.PetV2)console.error("Cannot get landmark for non-pet type.");else{const a=this._mgr.faces[t];if(a.type===exports.FaceType.Dog)return this.getLandmarkDog(e,a);if(a.type===exports.FaceType.Cat)return this.getLandmarkCat(e,a);console.error("Cannot get landmark for non-pet type.")}}getLandmarkDog(e,t){switch(e){case exports.FacePart.Whole:return t.landmarksPetV2;case exports.FacePart.LeftEye:let a=new Qt.Vec2Vector;return a=this.facePartHelper(58,66,t.landmarksPetV2,a),a=this.facePartHelper(74,75,t.landmarksPetV2,a),a;case exports.FacePart.RightEye:let n=new Qt.Vec2Vector;return n=this.facePartHelper(66,74,t.landmarksPetV2,n),n=this.facePartHelper(75,76,t.landmarksPetV2,n),n;case exports.FacePart.Nose:let r=new Qt.Vec2Vector;return r=this.facePartHelper(26,42,t.landmarksPetV2,r),r;case exports.FacePart.Mouth:let i=new Qt.Vec2Vector;return i=this.facePartHelper(42,58,t.landmarksPetV2,i),i;case exports.FacePart.LeftEar:let o=new Qt.Vec2Vector;return o=this.facePartHelper(0,1,t.landmarksPetV2,o),o=this.facePartHelper(23,26,t.landmarksPetV2,o),o=this.facePartHelper(76,83,t.landmarksPetV2,o),o;case exports.FacePart.RightEar:let s=new Qt.Vec2Vector;return s=this.facePartHelper(16,20,t.landmarksPetV2,s),s=this.facePartHelper(83,90,t.landmarksPetV2,s),s;case exports.FacePart.Contour:const d=new Qt.Vec2Vector;return this.facePartHelper(0,26,t.landmarksPetV2,d),d;default:return console.error(`Dog face doesn't support ${e} yet`),null;}}getLandmarkCat(e,t){switch(e){case exports.FacePart.Whole:return t.landmarksPetV2;case exports.FacePart.LeftEye:let a=new Qt.Vec2Vector;return a=this.facePartHelper(64,72,t.landmarksPetV2,a),a=this.facePartHelper(80,81,t.landmarksPetV2,a),a;case exports.FacePart.RightEye:let n=new Qt.Vec2Vector;return n=this.facePartHelper(72,80,t.landmarksPetV2,n),n=this.facePartHelper(81,82,t.landmarksPetV2,n),n;case exports.FacePart.Nose:let r=new Qt.Vec2Vector;return r=this.facePartHelper(40,48,t.landmarksPetV2,r),r;case exports.FacePart.Mouth:let i=new Qt.Vec2Vector;return i=this.facePartHelper(48,64,t.landmarksPetV2,i),i;case exports.FacePart.LeftEar:let o=new Qt.Vec2Vector;return o=this.facePartHelper(0,1,t.landmarksPetV2,o),o=this.facePartHelper(23,33,t.landmarksPetV2,o),o;case exports.FacePart.RightEar:let s=new Qt.Vec2Vector;return s=this.facePartHelper(16,20,t.landmarksPetV2,s),s=this.facePartHelper(33,40,t.landmarksPetV2,s),s;case exports.FacePart.Contour:const d=new Qt.Vec2Vector;return this.facePartHelper(0,26,t.landmarksPetV2,d),d;default:return console.error(`Cat face doesn't support ${e} yet`),null;}}getFaceType(e){return e===Qt.FacePetType.CAT?exports.FaceType.Cat:e===Qt.FacePetType.DOG?exports.FaceType.Dog:exports.FaceType.Human}onUpdate(e){const t=new Set,a=new Set,n=zn.algorithms.nativeResult;if(n&&n.getFacePetInfoCount){const r=n.getFacePetInfoCount();if(0<r)for(let e=0;e<r;e++){const r=n.getFacePetInfo(e);if(null!=r){const e=this.getFaceType(r.face_pet_type),n=r.Id;let i;e==exports.FaceType.Dog?(i=new Kt,a.add(n)):(i=new Jt,t.add(n)),this._mgr.addFaceData(i),this._mgr.setFaceState(!0,n,e),i.isValidFace=!0,i.type=e,i.score=r.score,i.id=n,i.yaw=-r.yaw,i.pitch=-r.pitch,i.roll=-r.roll,i.rect=new T(r.rect),i.action=r.action,i.landmarksPetV2=r.points_array}else console.error("Invalid face data:"+e)}e.set(exports.FaceType.Cat,t),e.set(exports.FaceType.Dog,a)}}}class ea extends e{constructor(){super(),this.faces=[],this._faceProviders=new Map,this._faceProviders.set(Vt.Human,new Zt(this)),this._faceProviders.set(Vt.Pet,new $t(this)),this.hasFaceMap=new Map,this.hasFaceMap.set(exports.FaceType.Human,new Map),this.hasFaceMap.set(exports.FaceType.Cat,new Map),this.hasFaceMap.set(exports.FaceType.Dog,new Map)}static getInstance(){return null==this._instance&&(this._instance=new ea),this._instance}static getLandmark(e,t,a){return this.getInstance().getLandmarks(e,t,a)}getLandmarks(e,t,a){const n=this.faces[t],r=Nt.get(n.type),i=this._faceProviders.get(r);return i?i.getLandmark(e,t,a):void console.error("Cannot get landmark data for face: "+t)}onUpdate(){this.resetFaceData();for(const e of this._faceProviders.values())e.update()}init(){}resetFaceData(){this.faces.length=0}addFaceData(e){this.faces.push(e)}static get faces(){return this.getInstance().faces}static getFacesByType(e){const t=this.faces.filter(t=>t.type===e);return t}static on(e,t,a){return this.getInstance().on(e,t,a)}static off(e,t,a){return this.getInstance().off(e,t,a)}setFaceState(e,t,a){const n=this.hasFaceMap.get(a);null==n?console.error(`There isn't a faceStatusMap for faceType: ${exports.FaceType[a]}`):(!n.has(t)&&n.set(t,!1),n.get(t)!==e&&(!0===e?this.fire(exports.FaceEvent.Detected,t,exports.FaceType[a]):this.fire(exports.FaceEvent.Lost,t,exports.FaceType[a]),n.set(t,e)))}}var ta=effect.Amaz;class aa{constructor(e){var t,a,n,r;const o=e.properties;this._initialized=!1,this._faceIndex=o.faceIndex,this._textureResScale=o.textureResScale,this._meshPath=o.meshPath,this._flipUv=o.flipUv,this._flipUVInVS=!(null!=(t=o.flipUVInVS))||t,this._renderTexture=zn.customAssets.getNativeObject(e.uuid),this._renderTexture.depth=1,this._renderTexture.width=640,this._renderTexture.height=360,this._renderTexture.filterMag=ta.FilterMode.NEAREST,this._renderTexture.filterMin=ta.FilterMode.NEAREST,this._renderTexture.filterMipmap=ta.FilterMipmapMode.NONE,this._renderTexture.attachment=ta.RenderTextureAttachment.NONE;const s=i.createShaders({gles2:{vs:"precision highp float;\n    attribute vec3 attPosition;\n    attribute vec2 attTexcoord0;\n    uniform mat4 u_Model;\n    uniform mat4 u_MVP;\n    uniform float u_flipUVInVS;\n    varying vec2 g_vary_uv0;\n    varying vec4 v_sampling_pos;\n    void main ()\n    {\n      vec4 homogeneous_pos = vec4(attPosition, 1.0);\n      g_vary_uv0 = attTexcoord0;\n      v_sampling_pos = u_MVP * homogeneous_pos;\n      if (u_flipUVInVS > 0.5) {\n        g_vary_uv0.y = 1. - g_vary_uv0.y;\n      }\n      vec2 uv_pos = g_vary_uv0.xy * 2.0 - vec2(1.0);\n      gl_Position = vec4(uv_pos, 0.0, 1.0);\n    }\n    ",fs:`precision highp float;
    uniform float u_flipUv;
    uniform sampler2D u_AlbedoTexture;
    varying vec4 v_sampling_pos;
    
    void main ()
    {
      vec2 sampling_uv = (v_sampling_pos.xy / v_sampling_pos.w) * 0.5 + 0.5;
      vec2 flipCoord = vec2(sampling_uv.x, 1. - sampling_uv.y);
      vec2 flip_uv = mix(sampling_uv, flipCoord, u_flipUv);
      vec4 textureColor = texture2D(u_AlbedoTexture, flip_uv);
      gl_FragColor = textureColor;
    }
    `},metal:{vs:`
    #include <metal_stdlib>
    #include <simd/simd.h>

    using namespace metal;

    struct buffer_t
    {
        float4x4 u_MVP;
        float u_flipUVInVS;
    };

    struct main0_out
    {
        float2 g_vary_uv0;
        float4 v_sampling_pos;
        float4 gl_Position [[position]];
    };

    struct main0_in
    {
        float3 attPosition [[attribute(0)]];
        float2 attTexcoord0 [[attribute(1)]];
    };

    vertex main0_out main0(main0_in in [[stage_in]], constant buffer_t& buffer)
    {
        main0_out out = {};
        float4 homogeneous_pos = float4(in.attPosition, 1.0);
        out.g_vary_uv0 = in.attTexcoord0;
        out.v_sampling_pos = buffer.u_MVP * homogeneous_pos;
        if (buffer.u_flipUVInVS > 0.5)
        {
            out.g_vary_uv0.y = 1.0 - out.g_vary_uv0.y;
        }
        float2 uv_pos = (out.g_vary_uv0 * 2.0) - float2(1.0);
        out.gl_Position = float4(uv_pos, 0.0, 1.0);
        out.gl_Position.z = (out.gl_Position.z + out.gl_Position.w) * 0.5;       // Adjust clip-space for Metal
        return out;
    }
    `,fs:`
    #include <metal_stdlib>
    #include <simd/simd.h>

    using namespace metal;

    struct main0_out
    {
        float4 gl_FragColor [[color(0)]];
    };

    struct main0_in
    {
        float4 v_sampling_pos;
    };

    fragment main0_out main0(main0_in in [[stage_in]], constant float& u_flipUv[[buffer(0)]], texture2d<float> u_AlbedoTexture [[texture(0)]], sampler u_AlbedoTextureSmplr [[sampler(0)]])
    {
        main0_out out = {};
        float2 sampling_uv = ((in.v_sampling_pos.xy / float2(in.v_sampling_pos.w)) * 0.5) + float2(0.5);
        if (u_flipUv > 0.5)
        {
          sampling_uv.y = 1.0 - sampling_uv.y;
        }
        float4 textureColor = u_AlbedoTexture.sample(u_AlbedoTextureSmplr, sampling_uv);
        //textureColor = float4(u_flipUv, u_flipUv, u_flipUv, 1.0);
        out.gl_FragColor = textureColor;
        return out;
    }
    `}});this._faceMaterial=this.createFaceTexMaterial(s);let d;Fa&&o.sourceTexture!==void 0?d=zn.assets.loadSync(o.sourceTexture):(d=zn.assets.loadSync("share://input.texture"),this._flipUv=!0),this._faceMaterial.setTex("u_AlbedoTexture",null==(a=d)?void 0:a.resource);const c=!0===this._flipUv?0:1;this._faceMaterial.setFloat("u_flipUv",c);const l=this._flipUVInVS?1:0;this._faceMaterial.setFloat("u_flipUVInVS",l),this._renderTexture.width=ta.AmazingManager.getSingleton("BuiltinObject").getOutputTextureWidth()*this._textureResScale,this._renderTexture.height=ta.AmazingManager.getSingleton("BuiltinObject").getOutputTextureHeight()*this._textureResScale,this._faceMesh=null==(n=zn.assets.loadSync(this._meshPath))||null==(r=n.resource)?void 0:r.native}onStart(){}onLateUpdate(){}onDestroy(){}onUpdate(){const e=zn.customAssets.cmdBufferHelper;if(this._initialized||(e.cmdBufferSetRenderTexture(this._renderTexture),e.cmdBufferClearRenderTexture(!0,!0,new ta.Color(0,0,0,0),0),this._initialized=!0),null!=this._faceMesh&&null!=this._faceMaterial){const t=ea.faces,a=t.length;if(a<=this._faceIndex)return;const n=t[this._faceIndex].faceMesh;if(null===n)return;const r=n.vertexes,i=n.normals;null!=r&&null!=i&&0<r.size()&&0<i.size()&&(this._faceMaterial.setMat4("u_MVP",n.mvp.native),this._faceMesh.setVertexArray(r),this._faceMesh.setNormalArray(i));const o=new ve;o.identity(),e.cmdBufferSetRenderTexture(this._renderTexture),e.cmdBufferDrawMesh(this._faceMesh,o,this._faceMaterial,0,0,new ta.MaterialPropertyBlock)}else null===this._faceMesh&&console.error("face texture asset: mesh not found!"),null===this._faceMaterial&&console.error("face texture asset: material not found!")}createFaceTexMaterial(e){const t=new ta.Pass;t.shaders=e,t.clearColor=new ta.Color(0,0,0,1),t.clearType=ta.CameraClearType.COLOR_DEPTH;const a=new ta.Map;a.insert("attColor",ta.VertexAttribType.COLOR),a.insert("attPosition",ta.VertexAttribType.POSITION),a.insert("attTexcoord0",ta.VertexAttribType.TEXCOORD0),t.semantics=a;const n=new ta.RenderState;n.viewport=new ta.ViewportState,n.viewport.rect=new ta.Rect(0,0,1,1),n.viewport.minDepth=0,n.viewport.maxDepth=1,n.rasterization=new ta.RasterizationState;const r=new ta.DepthStencilState;r.depthWriteEnable=!1,n.depthstencil=r;const o=new ta.ColorBlendState,s=new ta.ColorBlendAttachmentState;s.blendEnable=!0,s.srcColorBlendFactor=ta.BlendFactor.SRC_ALPHA,s.dstColorBlendFactor=ta.BlendFactor.ONE_MINUS_SRC_ALPHA,s.srcAlphaBlendFactor=ta.BlendFactor.SRC_ALPHA,s.dstAlphaBlendFactor=ta.BlendFactor.ONE_MINUS_SRC_ALPHA,s.ColorBlendOp=ta.BlendOp.ADD,s.AlphaBlendOp=ta.BlendOp.ADD,o.attachments.pushBack(s),n.colorBlend=o,t.renderState=n;const d=i.createMaterial(t);return d.renderQueue=1,d.setMat4("u_MVP",new ve().native),d}}var na=effect.Amaz;class ra{constructor(){this._segProviderMap=new Map,this._cmdBufferHelper=new o}static getInstance(){return null==this._instance&&(this._instance=new ra),this._instance}static getMask(e,t=0){return this.getInstance().getMask(e,t)}init(){this._segProviderMap.set(exports.SegmentationType.Body.toLowerCase(),new sa(this)),this._segProviderMap.set(exports.SegmentationType.Head.toLowerCase(),new ga(this)),this._segProviderMap.set(exports.SegmentationType.Sky.toLowerCase(),new da(this)),this._segProviderMap.set(exports.SegmentationType.Hair.toLowerCase(),new ua(this)),this._segProviderMap.set(exports.SegmentationType.Building.toLowerCase(),new la(this)),this._segProviderMap.set(exports.SegmentationType.Cloth.toLowerCase(),new ca(this)),this._segProviderMap.set(exports.SegmentationType.Ground.toLowerCase(),new pa(this)),this._segProviderMap.set(exports.SegmentationType.Hand.toLowerCase(),new ma(this))}get cmdBufferHelper(){return this._cmdBufferHelper}onUpdate(e){this._cmdBufferHelper.onPreUpdate();for(const t of this._segProviderMap.values())t.onUpdate(e);this._cmdBufferHelper.onPostUpdate()}createRenderTextureHelper(e){return new ia(i.createTexture2D(),i.createRenderTexture(),i.createScreenMaterial(e))}createNomralScreenShader(){return i.createShaders({gles2:{vs:"attribute vec3 inPosition;\n       attribute vec2 inTexCoord;\n       varying vec2 uv;\n       uniform mat4 u_Model;\n       void main() {\n       gl_Position = u_Model * vec4(inPosition, 1.0);\n       uv = inTexCoord;\n       }\n      ",fs:`precision lowp float;
       varying vec2 uv;
       uniform sampler2D tex;
       void main() {
        gl_FragColor = texture2D(tex, uv);
      }
      `},metal:{vs:`
      #include <metal_stdlib>
      #include <simd/simd.h>
  
      using namespace metal;
  
      struct buffer_t
      {
          float4x4 u_Model;
      };
  
      struct main0_out
      {
          float2 uv;
          float4 gl_Position [[position]];
      };
  
      struct main0_in
      {
          float3 inPosition [[attribute(0)]];
          float2 inTexCoord [[attribute(1)]];
      };
  
      vertex main0_out main0(main0_in in [[stage_in]], constant buffer_t& buffer)
      {
          main0_out out = {};
          out.gl_Position = buffer.u_Model * float4(in.inPosition, 1.0);
          out.uv = in.inTexCoord;
          out.gl_Position.z = (out.gl_Position.z + out.gl_Position.w) * 0.5;       // Adjust clip-space for Metal
          return out;
      }
       `,fs:`
      #include <metal_stdlib>
      #include <simd/simd.h>
      
      using namespace metal;
      
      struct main0_out
      {
          float4 gl_FragColor [[color(0)]];
      };
      
      struct main0_in
      {
          float2 uv;
      };
      
      fragment main0_out main0(main0_in in [[stage_in]], texture2d<float> tex [[texture(0)]], sampler texSmplr [[sampler(0)]])
      {
          main0_out out = {};
          out.gl_FragColor = tex.sample(texSmplr, in.uv);
          return out;
      }    
       `}})}getMask(e,t){const a=this._segProviderMap.get(e.toLowerCase());return a?a.getMask(t):(console.error(`Segmentation doesn't support ${e} yet`),null)}}class ia{constructor(e,t,a){this.texture=e,this.renderTexture=t,this.screenMaterial=a}}class oa{constructor(e){this._mgr=e,this._texture=null,this._emptyImage=new na.Image}}class sa extends oa{onUpdate(){if(null==this._texture)return;const e=zn.algorithms.nativeResult;if(!e||!e.getBgInfo)return;const t=e.getBgInfo(),a=this.getOrCreateTexture();null==t?a.storage(this._emptyImage):a.storage(t.bgMask)}getOrCreateTexture(){return null==this._texture&&(this._texture=new na.Texture2D),this._texture}getMask(){return this.getOrCreateTexture()}}class da extends oa{onUpdate(){if(null==this._texture)return;const e=zn.algorithms.nativeResult;if(!e||!e.getSkyInfo)return;const t=e.getSkyInfo(),a=this.getOrCreateTexture();null==t?a.storage(this._emptyImage):a.storage(t.skyMask)}getOrCreateTexture(){return null==this._texture&&(this._texture=new na.Texture2D),this._texture}getMask(){return this.getOrCreateTexture()}}class ca extends oa{onUpdate(){if(null==this._texture)return;const e=zn.algorithms.nativeResult;if(!e||!e.getClothesSegInfo)return;const t=e.getClothesSegInfo(),a=this.getOrCreateTexture();null==t?a.storage(this._emptyImage):a.storage(t.alphaMask)}getOrCreateTexture(){return null==this._texture&&(this._texture=new na.Texture2D),this._texture}getMask(){return this.getOrCreateTexture()}}class la extends oa{constructor(){super(...arguments),this._initialized=!1}onUpdate(){if(!this._initialized)return;const e=zn.algorithms.nativeResult;if(!e||!e.getBuildingSegInfo)return;const t=e.getBuildingSegInfo(),a=this.getOrCreateTexture();null==t?a.storage(this._emptyImage):a.storage(t.mask),this._screenMaterial.setTex("tex",a),this._mgr.cmdBufferHelper.cmdBufferSetRenderTexture(this._renderTexture),this._mgr.cmdBufferHelper.cmdBufferDrawMesh(this._mgr.cmdBufferHelper.screenMesh,new ve,this._screenMaterial,0,0,new na.MaterialPropertyBlock)}getOrCreateTexture(){return null==this._texture&&(this._texture=new na.Texture2D),this._texture}getMask(){return this.tryToInit(),this._renderTexture}tryToInit(){if(this._initialized)return;this._initialized=!0,this._renderTexture=i.createRenderTexture();const e=i.createShaders({gles2:{vs:"attribute vec3 inPosition;\n      attribute vec2 inTexCoord;\n      varying vec2 uv; \n      uniform mat4 u_Model;\n      void main() {\n        gl_Position = u_Model * vec4(inPosition, 1.0);\n        uv = inTexCoord;\n      }\n      ",fs:`precision lowp float;
      varying vec2 uv;
      uniform sampler2D tex;
      void main() {
        vec4 color = texture2D(tex, uv);
        gl_FragColor = vec4(color.g, color.g, color.g, 1.0);
      } 
      `},metal:{vs:`
      #include <metal_stdlib>
      #include <simd/simd.h>
      
      using namespace metal;
      
      struct buffer_t
      {
          float4x4 u_Model;
      };
      
      struct main0_out
      {
          float2 uv;
          float4 gl_Position [[position]];
      };
      
      struct main0_in
      {
          float3 inPosition [[attribute(0)]];
          float2 inTexCoord [[attribute(1)]];
      };
      
      vertex main0_out main0(main0_in in [[stage_in]], constant buffer_t& buffer)
      {
          main0_out out = {};
          out.gl_Position = buffer.u_Model * float4(in.inPosition, 1.0);
          out.uv = in.inTexCoord;
          out.gl_Position.z = (out.gl_Position.z + out.gl_Position.w) * 0.5;       // Adjust clip-space for Metal
          return out;
      }    
      `,fs:`
    #include <metal_stdlib>
    #include <simd/simd.h>

    using namespace metal;

    struct main0_out
    {
        float4 gl_FragColor [[color(0)]];
    };

    struct main0_in
    {
        float2 uv;
    };

    fragment main0_out main0(main0_in in [[stage_in]], texture2d<float> tex [[texture(0)]], sampler texSmplr [[sampler(0)]])
    {
        main0_out out = {};
        float4 color = tex.sample(texSmplr, in.uv);
        out.gl_FragColor = float4(color.y, color.y, color.y, 1.0);
        return out;
    }
      `}});this._screenMaterial=i.createScreenMaterial(e)}}class pa extends oa{onUpdate(){if(null==this._texture)return;const e=zn.algorithms.nativeResult;if(!e||!e.getGroundSegInfo)return;const t=e.getGroundSegInfo(),a=this.getOrCreateTexture();null==t?a.storage(this._emptyImage):a.storage(t.groundMask)}getOrCreateTexture(){return null==this._texture&&(this._texture=new na.Texture2D),this._texture}getMask(){return this.getOrCreateTexture()}}class ua extends oa{onUpdate(){if(null==this._texture)return;const e=zn.algorithms.nativeResult;if(!e||!e.getHairInfo)return;const t=e.getHairInfo(),a=this.getOrCreateTexture();null==t?a.storage(this._emptyImage):a.storage(t.mask)}getOrCreateTexture(){return null==this._texture&&(this._texture=new na.Texture2D),this._texture}getMask(){return this.getOrCreateTexture()}}class ga extends oa{constructor(e){super(e),this._rdMap=new Map}onUpdate(){const e=zn.algorithms.nativeResult;if(e&&e.getHeadSegInfoCount){for(let t=0;t<e.getHeadSegInfoCount();++t)this.getOrCreateRnderTextureHelper(t);for(const t of this._rdMap.keys())this.updateMask(e.getHeadSegInfo(t),this._rdMap.get(t))}}getMask(e){var t;return null==(t=this.getOrCreateRnderTextureHelper(e))?void 0:t.renderTexture}getOrCreateRnderTextureHelper(e){return this._rdMap.has(e)||this._rdMap.set(e,this._mgr.createRenderTextureHelper(this._mgr.createNomralScreenShader())),this._rdMap.get(e)}updateMask(e,t){if(null!=t&&(this._mgr.cmdBufferHelper.cmdBufferSetRenderTexture(t.renderTexture),this._mgr.cmdBufferHelper.cmdBufferClearRenderTexture(!0,!1,new na.Color(0,0,0,0),1),null!=e)){t.texture.storage(e.alpha);const a=e.width,n=e.height,r=e.srcWidth,i=e.srcHeight,o=e.matrix,s=o.get(0),d=o.get(1),c=o.get(2),l=o.get(3),p=o.get(4),u=o.get(5),g=new ve(s,l,0,0,d,p,0,0,0,0,1,0,c,u,0,1);g.inv();const m=new ve(a/2,0,0,0,0,n/2,0,0,0,0,1,0,a/2,n/2,0,1);g.mul(m);const f=new ve(2/r,0,0,0,0,2/i,0,0,0,0,1,0,-1,-1,0,1);f.mul(g),t.screenMaterial.setTex("tex",t.texture),this._mgr.cmdBufferHelper.cmdBufferDrawMesh(this._mgr.cmdBufferHelper.screenMesh,f,t.screenMaterial,0,0,new na.MaterialPropertyBlock)}}}class ma extends oa{constructor(e){super(e),this._handMap=new Map}onUpdate(){const e=zn.algorithms.nativeResult;if(e&&e.getHandCount){for(let t=0;t<e.getHandCount();++t)this.getOrCreateTexture(t);for(const n of this._handMap.keys())if(null==e.getHandInfo(n)){var t;null==(t=this._handMap.get(n))?void 0:t.storage(this._emptyImage)}else{var a;null==(a=this._handMap.get(n))?void 0:a.storage(e.getHandInfo(n).image)}}}getOrCreateTexture(e){return this._handMap.has(e)||this._handMap.set(e,new na.Texture2D),this._handMap.get(e)}getMask(e){return this.getOrCreateTexture(e)}}var fa=effect.Amaz;class ha{constructor(e){var t;const a=e.properties;this._segType=a.segmentationType.toLowerCase(),this._smoothness=a.smoothness,this._invert=a.invert,this._useCutoutTexture=a.useCutoutTexture,this._cutoutTexture=a.cutoutTexture,this._cutoutTextureInverseY=a.cutoutTextureInverseY,this._maskTextureInverseY=null!=(t=a.maskTextureInverseY)&&t,this._renderTexture=zn.customAssets.getNativeObject(e.uuid),this._renderTexture.depth=1,this._renderTexture.width=fa.AmazingManager.getSingleton("BuiltinObject").getInputTextureWidth(),this._renderTexture.height=fa.AmazingManager.getSingleton("BuiltinObject").getInputTextureHeight(),this._renderTexture.filterMag=fa.FilterMode.LINEAR,this._renderTexture.filterMin=fa.FilterMode.LINEAR,this._renderTexture.filterMipmap=fa.FilterMipmapMode.NONE,this._renderTexture.attachment=fa.RenderTextureAttachment.NONE;const n=i.createShaders({gles2:{vs:"attribute vec3 inPosition;\n    attribute vec2 inTexCoord;\n    varying vec2 uv;\n    uniform mat4 u_Model;\n    void main() {\n      gl_Position = u_Model * vec4(inPosition, 1.0);\n      uv = inTexCoord;\n    }\n    ",fs:`precision highp float;
    varying vec2 uv;
    uniform sampler2D u_mask;
    uniform float u_smoothness;
    uniform float u_invert;
    uniform float u_useCutoutTexture;
    uniform float u_cutoutTextureInverseY;
    uniform float u_maskTextureInverseY;
    uniform sampler2D u_cutoutTex;
    uniform sampler2D u_mask2;
    uniform float u_useMask2;
    void main() {
      vec2 maskUV = uv;
      if (u_maskTextureInverseY > 0.5) {
        maskUV = vec2(uv.x, 1.0 - uv.y);
      } 
      float maskAlpha = texture2D(u_mask, maskUV).r;
      if (u_useMask2 > 0.5) {
        maskAlpha += texture2D(u_mask2, maskUV).r;
      }
      maskAlpha = smoothstep(0.0 + (u_smoothness),1.0,maskAlpha);
      if(u_invert > 0.5) {
        maskAlpha = 1.0 - maskAlpha;
      }
      if (u_useCutoutTexture > 0.5) {
        if (u_cutoutTextureInverseY > 0.5) {
          gl_FragColor = texture2D(u_cutoutTex, vec2(uv.x, 1.0 - uv.y));
        } else {
          gl_FragColor = texture2D(u_cutoutTex, uv);
        }
        gl_FragColor.a = maskAlpha;
      } else {
        gl_FragColor = vec4(maskAlpha, maskAlpha, maskAlpha, 1.0);
      }
    }
    `},metal:{vs:`
    #include <metal_stdlib>
    #include <simd/simd.h>

    using namespace metal;

    struct buffer_t
    {
        float4x4 u_Model;
    };

    struct main0_out
    {
        float2 uv;
        float4 gl_Position [[position]];
    };

    struct main0_in
    {
        float3 inPosition [[attribute(0)]];
        float2 inTexCoord [[attribute(1)]];
    };

    vertex main0_out main0(main0_in in [[stage_in]], constant buffer_t& buffer)
    {
        main0_out out = {};
        out.gl_Position = buffer.u_Model * float4(in.inPosition, 1.0);
        out.uv = in.inTexCoord;
        out.gl_Position.z = (out.gl_Position.z + out.gl_Position.w) * 0.5;       // Adjust clip-space for Metal
        return out;
    }
    `,fs:`
    #include <metal_stdlib>
    #include <simd/simd.h>

    using namespace metal;

    struct buffer_t
    {
        float u_useMask2;
        float u_smoothness;
        float u_invert;
        float u_useCutoutTexture;
        float u_cutoutTextureInverseY;
        float u_maskTextureInverseY;
    };

    struct main0_out
    {
        float4 gl_FragColor [[color(0)]];
    };

    struct main0_in
    {
        float2 uv;
    };

    fragment main0_out main0(main0_in in [[stage_in]], constant buffer_t& buffer, texture2d<float> u_mask [[texture(0)]], texture2d<float> u_mask2 [[texture(1)]], texture2d<float> u_cutoutTex [[texture(2)]], sampler u_maskSmplr [[sampler(0)]], sampler u_mask2Smplr [[sampler(1)]], sampler u_cutoutTexSmplr [[sampler(2)]])
    {
        main0_out out = {};
        float2 maskUV = in.uv;
        if (buffer.u_maskTextureInverseY > 0.5) {
          maskUV = float2(in.uv.x, 1.0 - in.uv.y);
        } 
        float maskAlpha = u_mask.sample(u_maskSmplr, maskUV).x;
        if (buffer.u_useMask2 > 0.5)
        {
            maskAlpha += u_mask2.sample(u_mask2Smplr, maskUV).x;
        }
        maskAlpha = smoothstep(0.0 + buffer.u_smoothness, 1.0, maskAlpha);
        if (buffer.u_invert > 0.5)
        {
            maskAlpha = 1.0 - maskAlpha;
        }
        if (buffer.u_useCutoutTexture > 0.5)
        {
            if (buffer.u_cutoutTextureInverseY > 0.5)
            {
                out.gl_FragColor = u_cutoutTex.sample(u_cutoutTexSmplr, float2(in.uv.x, 1.0 - in.uv.y));
            }
            else
            {
                out.gl_FragColor = u_cutoutTex.sample(u_cutoutTexSmplr, in.uv);
            }
            out.gl_FragColor.w = maskAlpha;
        }
        else
        {
            out.gl_FragColor = float4(maskAlpha, maskAlpha, maskAlpha, 1.0);
        }
        return out;
    }
    `}});if(this._screenMaterial=i.createScreenMaterial(n),this._screenMaterial.setTex("u_mask",ra.getMask(this._segType)),this._screenMaterial.setFloat("u_smoothness",.9*(1-this._smoothness)),this._screenMaterial.setFloat("u_invert",!0===this._invert?1:0),this._screenMaterial.setFloat("u_maskTextureInverseY",!0===this._maskTextureInverseY?1:0),!0===this._useCutoutTexture){const e=zn.assets.loadSync(this._cutoutTexture);null!=e&&(this._useCutoutTexture=!0,this._screenMaterial.setTex("u_cutoutTex",e.resource),this._screenMaterial.setFloat("u_cutoutTextureInverseY",!0===this._cutoutTextureInverseY?1:0))}this._screenMaterial.setFloat("u_useCutoutTexture",!0===this._useCutoutTexture?1:0),this._segType===exports.SegmentationType.Head.toLocaleLowerCase()||this._segType===exports.SegmentationType.Hand.toLocaleLowerCase()?(this._screenMaterial.setFloat("u_useMask2",1),this._screenMaterial.setTex("u_mask2",ra.getMask(this._segType,1))):this._screenMaterial.setFloat("u_useMask2",0)}onUpdate(){const e=zn.customAssets.cmdBufferHelper;e.cmdBufferSetRenderTexture(this._renderTexture),e.cmdBufferDrawMesh(e.screenMesh,new ve,this._screenMaterial,0,0,new fa.MaterialPropertyBlock)}get type(){return exports.AssetSubType.Segmentation}onDestroy(){}onLateUpdate(){}onStart(){}}var _a=effect.Amaz;class ya{constructor(e){const t=e.properties;if(this._builtinObject=_a.AmazingManager.getSingleton("BuiltinObject"),this._outputTexture=zn.customAssets.getNativeObject(e.uuid),this._outputTexture.depth=1,this._outputTexture.filterMag=_a.FilterMode.LINEAR,this._outputTexture.filterMin=_a.FilterMode.LINEAR,this._outputTexture.filterMipmap=_a.FilterMipmapMode.NONE,this._outputTexture.attachment=_a.RenderTextureAttachment.NONE,this._textureKey=t.textureKey,t.defaultImagePath){var a;this._defaultTexture=null==(a=zn.assets.loadSync(t.defaultImagePath))?void 0:a.resource,this._defaultTexture||console.error("Image Picker default texture load failure")}}updateOutputTexture(){const e=zn.customAssets.cmdBufferHelper,t=this._builtinObject.getUserTexture(this._textureKey);t?(this._outputTexture.width=t.width,this._outputTexture.height=t.height,e.cmdBufferBlit(t,this._outputTexture)):this._defaultTexture&&(this._outputTexture.width=this._defaultTexture.width,this._outputTexture.height=this._defaultTexture.height,e.cmdBufferBlit(this._defaultTexture,this._outputTexture))}onUpdate(){this.updateOutputTexture()}onStart(){this.updateOutputTexture()}onLateUpdate(){}onDestroy(){}}var va=effect.Amaz;class Ta{constructor(e){this._renderTexture=zn.customAssets.getNativeObject(e.uuid),this._renderTexture.depth=1,this._renderTexture.filterMag=va.FilterMode.LINEAR,this._renderTexture.filterMin=va.FilterMode.LINEAR,this._renderTexture.filterMipmap=va.FilterMipmapMode.NONE,this._renderTexture.attachment=va.RenderTextureAttachment.NONE;const t=va.AmazingManager.getSingleton("BuiltinObject");this._renderTexture.width=t.getInputTextureWidth(),this._renderTexture.height=t.getInputTextureHeight();const a=e.properties;this._flip=a.flip;const n=i.createShaders({gles2:{vs:"\n    precision highp float;\n\n    attribute vec3 inPosition;\n    attribute vec2 inTexCoord;\n\n    varying vec2 v_TexCoord;\n\n    uniform mat4 u_Model;\n    uniform float u_FlipVertical;\n\n    void main() {\n      vec2 flipCoord = vec2(inTexCoord.x, 1. - inTexCoord.y);\n      v_TexCoord = mix(inTexCoord, flipCoord, u_FlipVertical);\n      gl_Position = u_Model * vec4(inPosition, 1.0);\n    }\n    ",fs:`
    precision highp float;

    varying vec2 v_TexCoord;

    uniform sampler2D u_CameraTex;

    void main() {
      gl_FragColor = texture2D(u_CameraTex, v_TexCoord);
    }
    `},metal:{vs:`
    #include <metal_stdlib>
    #include <simd/simd.h>
    
    using namespace metal;
    
    struct buffer_t
    {
        float u_FlipVertical;
        float4x4 u_Model;
    };
    
    struct main0_out
    {
        float2 v_TexCoord;
        float4 gl_Position [[position]];
    };
    
    struct main0_in
    {
        float3 inPosition [[attribute(0)]];
        float2 inTexCoord [[attribute(1)]];
    };
    
    vertex main0_out main0(main0_in in [[stage_in]], constant buffer_t& buffer)
    {
        main0_out out = {};
        float2 flipCoord = float2(in.inTexCoord.x, 1.0 - in.inTexCoord.y);
        out.v_TexCoord = mix(in.inTexCoord, flipCoord, float2(buffer.u_FlipVertical));
        out.gl_Position = buffer.u_Model * float4(in.inPosition, 1.0);
        out.gl_Position.z = (out.gl_Position.z + out.gl_Position.w) * 0.5;       // Adjust clip-space for Metal
        return out;
    }
    `,fs:`
    #include <metal_stdlib>
    #include <simd/simd.h>

    using namespace metal;

    struct main0_out
    {
        float4 gl_FragColor [[color(0)]];
    };

    struct main0_in
    {
        float2 v_TexCoord;
    };

    fragment main0_out main0(main0_in in [[stage_in]], texture2d<float> u_CameraTex [[texture(0)]], sampler u_CameraTexSmplr [[sampler(0)]])
    {
        main0_out out = {};
        out.gl_FragColor = u_CameraTex.sample(u_CameraTexSmplr, in.v_TexCoord);
        return out;
    }
    `}});this._sceneOutputRT=zn.scene.native.getOutputRenderTexture(),this._screenMaterial=i.createScreenMaterial(n),this._screenMaterial.setTex("u_CameraTex",this._sceneOutputRT);const r=!0===this._flip?1:0;this._screenMaterial.setFloat("u_FlipVertical",r)}onStart(){}onUpdate(){const e=zn.scene.native.getOutputRenderTexture();this._sceneOutputRT.equals(e)||(this._sceneOutputRT=e,this._screenMaterial.setTex("u_CameraTex",e));const t=zn.customAssets.cmdBufferHelper,a=va.AmazingManager.getSingleton("BuiltinObject");return this._renderTexture.width=a.getInputTextureWidth(),this._renderTexture.height=a.getInputTextureHeight(),t.cmdBufferSetRenderTexture(this._renderTexture),void t.cmdBufferDrawMesh(t.screenMesh,new ve,this._screenMaterial,0,0,new va.MaterialPropertyBlock)}onLateUpdate(){}onDestroy(){}}class xa{constructor(e){const t=e.properties;this._faceIndex=t.faceIndex,this._path=t.path,this._faceMesh=zn.customAssets.getNativeObject(e.uuid);const a=zn.assets.loadSync(this._path);if(null!==a){const e=a.resource.native.clone();this._faceMesh.assetMgr=e.assetMgr,this._faceMesh.name=e.name,this._faceMesh.boundingBox=e.boundingBox,this._faceMesh.instanceData=e.instanceData,this._faceMesh.instanceDataStride=e.instanceDataStride,this._faceMesh.materialIndex=e.materialIndex,this._faceMesh.morphers=e.morphers,this._faceMesh.skin=e.skin,this._faceMesh.submeshes=e.submeshes,this._faceMesh.vertexAttribs=e.vertexAttribs,this._faceMesh.vertices=e.vertices,this._faceMesh.seqMesh=e.seqMesh,this._faceMesh.originalVertices=e.originalVertices,this._faceMesh.clearAfterUpload=e.clearAfterUpload,this._faceMesh.setVertexCount(e.getVertexCount()),0!==e.getVertexArray(0,0).size()&&this._faceMesh.setVertexArray(e.getVertexArray(0,0),0,0,!0),0!==e.getNormalArray(0,0).size()&&this._faceMesh.setNormalArray(e.getNormalArray(0,0),0,0),0!==e.getTangentArray(0,0).size()&&this._faceMesh.setTangentArray(e.getTangentArray(0,0),0,0),0!==e.getColorArray(0,0).size()&&this._faceMesh.setColorArray(e.getColorArray(0,0),0,0),0!==e.getUvArray(0,0,0).size()&&this._faceMesh.setUvArray(0,e.getUvArray(0,0,0),0,0),0!==e.getUv3DArray(0,0,0).size()&&this._faceMesh.setUv3DArray(0,e.getUv3DArray(0,0,0),0,0),0!==e.getUserDefineArray(0,0,0).size()&&this._faceMesh.setUserDefineArray(0,e.getUserDefineArray(0,0,0),0,0),this.setUpMorpher(this._faceMesh,!1)}else console.error("face mesh asset: mesh not found!")}onDestroy(){}onStart(){}onUpdate(){if(null!==this._faceMesh){const e=ea.faces,t=e.length;if((0>this._faceIndex||5<this._faceIndex)&&(this._faceIndex=0),t<=this._faceIndex)return;const a=e[this._faceIndex].faceMesh;if(null===a)return;const n=a.vertexes,r=a.normals;null!==n&&null!==r&&0<n.size()&&0<r.size()&&(this._faceMesh.setVertexArray(n),this._faceMesh.setNormalArray(r),this.setUpMorpher(this._faceMesh,!0))}}onLateUpdate(){}setUpMorpher(e,t){if(null!==e){const a=zn.scene.native,n=a.entities;for(let a=0;a<n.size();a++){const r=n.get(a),i=r.getComponent("MorpherComponent");if(null!==i&&i.basemesh.handle===e.handle)if(!t){const t=i.channelWeights.clone(),a=t.getVectorKeys(),n=i.channelAmplifiers.clone(),r=n.getVectorKeys();i.basemesh=null,i.basemesh=e;const o=i.channelWeights,s=i.channelAmplifiers;for(let e=0;e<t.size();e++)o.set(a.get(e),t.get(a.get(e)));for(let e=0;e<n.size();e++)s.set(r.get(e),n.get(r.get(e)))}else i.basemesh=e}}}}var Ma;const Sa=null==(Ma=h.get(exports.Feature.RenderChainEvent))?"":Ma,Fa=s.doesSDKSupport(Sa),Ca=new Map([[exports.AssetSubType.CameraInput.toLowerCase(),Ot],[exports.AssetSubType.Face.toLowerCase(),aa],[exports.AssetSubType.Segmentation.toLowerCase(),ha],[exports.AssetSubType.ImagePicker.toLowerCase(),ya]]);function Aa(){Fa&&Ca.set(exports.AssetSubType.CaptureFrame.toLowerCase(),Ta)}const Ia=new Map([[exports.AssetSubType.Face.toLowerCase(),xa]]),ba=new Map([[exports.AssetType.Texture.toLowerCase(),Ca],[exports.AssetType.Mesh.toLowerCase(),Ia]]);Aa();var Ra=effect.Amaz;function za(e,t){const a=e.entities;let n=0<a.size()?a.get(0):void 0,r=Number.MIN_VALUE,o=Number.MAX_VALUE,s;for(let d=0;d<a.size();++d){const e=a.get(d),i=e.getComponent("EffectNode");i instanceof Ra.EffectNode&&(i.renderOrder>t&&i.renderOrder<o&&(o=i.renderOrder,s=e),r<i.renderOrder&&(r=i.renderOrder,n=e))}return s===void 0?n:s}function Pa(e){const t=new Uint8Array(e);return String.fromCharCode.apply(null,t)}class Ea{constructor(){this._resEntryMap=new Map,this._assets=new Map,this._nativeObjMap=new Ra.Map,this._cmdBufferHelper=new o,this._renderOrders=new Map,this._renderOrderSet=new Set([])}addListener(e,t){const a=za(e,t),n=null==a?void 0:a.getComponent("EffectNode"),r=this._assets.get(t),i=null==r?void 0:r.updateFunction;return!!(r&&a&&n&&i)&&(zn.addNativeListener(n,Ra.EffectNodeEvent.BEFORE_RENDER,i,this),r.effectNodeComponent=n,this._assets.set(t,r),!0)}removeListener(e){var t;if(0===e)return!0;const a=this._assets.get(e),n=null==a?void 0:a.effectNodeComponent,r=null==(t=this._assets.get(e))?void 0:t.updateFunction;return!!(a&&n&&void 0!==r)&&(zn.removeNativeListener(n,Ra.EffectNodeEvent.BEFORE_RENDER,r,this),a.effectNodeComponent=void 0,this._assets.set(e,a),!0)}getNativeObject(e){return this._nativeObjMap.get(e)}init(){const e=zn.scene.native;if(null==e)return;const t=e.assetMgr.rootDir+"customAssets.json",a=fs.accessSync(t,0);if(!a)return void console.log("No customAssets.json found");const n=fs.readFileSync(t);if(this._assetsConfig=JSON.parse(Pa(n)),null!=this._assetsConfig){this._nativeObjMap=e.assetMgr.getAllScriptCustomAssets();for(const e of this._assetsConfig){var r,i;this._resEntryMap.set(e.uuid,e),this._renderOrders.set(e.uuid,null==(r=null==(i=e.properties)?void 0:i.captureOrder)?0:r)}const t=this.analyzeAssetsDependency();for(const e of t){const t=this._resEntryMap.get(e),a=this.createCustomAsset(t),n=this._renderOrders.get(t.uuid);if(void 0!==n&&a)if(this._renderOrderSet.add(n),this._assets.has(n)){var o;null==(o=this._assets.get(n))?void 0:o.assets.push(a)}else this._assets.set(n,{assets:[a],updateFunction:()=>{this.render(n)},effectNodeComponent:void 0})}if(Fa)for(const t of this._renderOrderSet)if(0!==t){const a=this.addListener(e,t);a||console.error("Custom-asset of renderOrder: "+t+" failed to be added")}}}get cmdBufferHelper(){return this._cmdBufferHelper}update(){this.render(0)}render(e){var t;this._cmdBufferHelper.onPreUpdate();const a=null==(t=this._assets.get(e))?void 0:t.assets;if(a)for(const e of a)null==e?void 0:e.onUpdate();this._cmdBufferHelper.onPostUpdate()}start(){for(const e of this._assets){const t=e[1].assets;for(const e of t)e.onStart()}}destroy(){if(Fa)for(const e of this._renderOrderSet){const t=this.removeListener(e);t||console.error("Custom-asset of renderOrder: "+e+" failed to be removed")}for(const e of this._assets){const t=e[1].assets;for(const e of t)e.onDestroy()}}lateUpdate(e){for(const t of this._assets){const a=t[1].assets;for(const t of a)t.onLateUpdate(e)}}createCustomAsset(e){const t=ba.get(e.type.toLowerCase());if(null===t||void 0===t)return console.error(`Custom asset doesn't support asset type: [${e.type}]`),null;const a=null==t?void 0:t.get(e.subType.toLowerCase());return null===a||void 0===a?(console.error(`[${e.type}] custom asset doesn't support asset subtype: [${e.subType}]`),null):new a(e)}analyzeAssetsDependency(){var e=Math.max;let t=[];const a=new Map,n=new Map,r="custom://";let i=0;for(const e of this._assetsConfig)i+=1,n.set(e.uuid,0);for(const e of this._assetsConfig){const t=e.uuid;if(e.properties)for(const i in e.properties){const o=e.properties[i];if("string"==typeof o&&o.startsWith(r)){const e=o.substr(r.length);console.log(`custom assets: [${t}] depends on [${e}]`),n.set(e,n.get(e)+1),a.has(t)||a.set(t,[]),a.get(t).push(e)}}}const o=[];for(const e of n.keys())0===n.get(e)&&o.push(e);for(;0<o.length;){const e=o.shift();if(t.push(e),a.has(e))for(const t of a.get(e))n.set(t,n.get(t)-1),0===n.get(t)&&o.push(t)}if(t.length===i)t.reverse();else{console.error("Found circular dependency in custom assets"),t=[];for(const e of this._assetsConfig)t.push(e.uuid)}if(Fa)for(const n of t){const t=a.get(n);null==t?void 0:t.forEach(t=>{var a,r;this._renderOrders.set(n,e(null==(a=this._renderOrders.get(n))?0:a,null==(r=this._renderOrders.get(t))?0:r))})}return t}}class ka extends e{constructor(){super(),this.hands=[],this._handProvider=new Ba(this)}static getInstance(){return null==this._instance&&(this._instance=new ka),this._instance}static get hands(){return this.getInstance().hands}static on(e,t,a){return this.getInstance().on(e,t,a)}static off(e,t,a){return this.getInstance().off(e,t,a)}onUpdate(){this._handProvider.onUpdate()}init(){}setHandState(e,t){e?this.fire(exports.HandEvent.Detected,t):this.fire(exports.HandEvent.Lost,t)}setHandActionState(e,t){t!==exports.HandStaticGesture.None&&t!==exports.HandStaticGesture.Unknown&&this.fire(exports.HandEvent.StaticGesture,e,t)}setHandSeqActionState(e,t){t!==exports.HandDynamicGesture.None&&this.fire(exports.HandEvent.DynamicGesture,e,t)}}class La{constructor(){this._handInfo=null}getKeyPoint2D(e){return 1===this._handInfo.key_points_is_detect.get(e)?new Q(this._handInfo.key_points_xy.get(e)):null}getKeyPointOffset3D(e){return 1===this._handInfo.key_points_3d_is_detect.get(e)?new de(this._handInfo.key_points_3d.get(e)):null}get isLeftProbability(){return this._handInfo.left_prob}get isLeft(){return!(.5>this.isLeftProbability)}get id(){return this._handInfo.ID}get scale(){return this._handInfo.scale}get rotation(){const e=this.getKeyPoint2D(9),t=this.getKeyPoint2D(12);if(null==t||null==e)return 0;const a=t.x-e.x,n=t.y-e.y,r=Math.sqrt(a*a+n*n);return 180*(-a/Math.abs(a)*Math.acos(n/r))/Math.PI}get staticGesture(){return this._handInfo.action}get dynamicGesture(){return this._handInfo.seq_action}}class Ba{constructor(e){this._mgr=e,this.lastHandIdSet=new Set,this.ActIDMap=new Map,this.SeqActIDMap=new Map}onUpdate(){const e=zn.algorithms.nativeResult;if(e&&e.getHandCount){const t=e.getHandCount();this._mgr.hands=Array(t);const a=new Set;if(0<t){for(let n=0;n<t;n++){const t=e.getHandInfo(n),r=new La;this._mgr.hands[n]=r,null!=t&&(r._handInfo=t,!this.lastHandIdSet.has(r.id)&&this._mgr.setHandState(!0,r.id),this.ActIDMap.has(r.id)?this.ActIDMap.get(r.id)!==r.staticGesture&&(this._mgr.setHandActionState(r.id,r.staticGesture),this.ActIDMap.set(r.id,r.staticGesture)):(this.ActIDMap.set(r.id,r.staticGesture),this._mgr.setHandActionState(r.id,r.staticGesture)),this.SeqActIDMap.has(r.id)?this.SeqActIDMap.get(r.id)!==r.dynamicGesture&&(this._mgr.setHandSeqActionState(r.id,r.dynamicGesture),this.SeqActIDMap.set(r.id,r.dynamicGesture)):(this.SeqActIDMap.set(r.id,r.dynamicGesture),this._mgr.setHandSeqActionState(r.id,r.dynamicGesture)),a.add(r.id))}for(const e of this.lastHandIdSet.values())a.has(e)||this._mgr.setHandState(!1,e);for(const e of this.ActIDMap.keys())a.has(e)||this.ActIDMap.delete(e);for(const e of this.SeqActIDMap.keys())a.has(e)||this.SeqActIDMap.delete(e);this.lastHandIdSet.clear(),a.forEach(e=>this.lastHandIdSet.add(e))}else{this.ActIDMap.clear(),this.SeqActIDMap.clear();for(const e of this.lastHandIdSet.values())this._mgr.setHandState(!1,e);this.lastHandIdSet.clear()}}}}class Oa extends e{constructor(){super(),this.bodies=[],this._body2dProvider=new Da(this)}static getInstance(){return null==this._instance&&(this._instance=new Oa),this._instance}static get bodies(){return this.getInstance().bodies}static on(e,t,a){return this.getInstance().on(e,t,a)}static off(e,t,a){return this.getInstance().off(e,t,a)}onUpdate(){this._body2dProvider.onUpdate()}init(){}setBodyState(e,t){e?this.fire(exports.BodyEvent.Detected,t):this.fire(exports.BodyEvent.Lost,t)}setBodyActionState(e,t){-1!==t&&this.fire(exports.BodyEvent.Action,e,t)}}class wa{constructor(){this._skeletonInfo=null,this._actionRecognitionInfo=null}get rect(){return new T(this._skeletonInfo.rect)}get id(){return this._skeletonInfo.ID}get keyPointDetected(){return this._skeletonInfo.key_points_detected}get keyPointsScore(){return this._skeletonInfo.key_points_score}get keyPoints(){return this._skeletonInfo.key_points_xy}get isActionValid(){var e,t;return null!=(e=null==(t=this._actionRecognitionInfo)?void 0:t.isValid)&&e}get actionLabel(){var e,t;return null==(e=null==(t=this._actionRecognitionInfo)?void 0:t.actionLabel)?-1:e}get actionScore(){var e,t;return null==(e=null==(t=this._actionRecognitionInfo)?void 0:t.actionScore)?0:e}}class Da{constructor(e){this._mgr=e,this.lastSkeletonIdSet=new Set,this.ActIDMap=new Map}onUpdate(){const e=zn.algorithms.nativeResult;if(e&&e.getSkeletonCount){const t=e.getSkeletonCount();this._mgr.bodies=Array(t);const a=new Set;if(0<t){for(let n=0;n<t;n++){const t=e.getSkeletonInfo(n);let r=null;e.getActionRecognitionInfo&&(r=e.getActionRecognitionInfo(n));const i=new wa;this._mgr.bodies[n]=i,null!=t&&(i._skeletonInfo=t,!this.lastSkeletonIdSet.has(i.id)&&this._mgr.setBodyState(!0,i.id),null!=r&&(i._actionRecognitionInfo=r,this.ActIDMap.has(i.id)?this.ActIDMap.get(i.id)!==i.actionLabel&&(this._mgr.setBodyActionState(i.id,i.actionLabel),this.ActIDMap.set(i.id,i.actionLabel)):(this.ActIDMap.set(i.id,i.actionLabel),this._mgr.setBodyActionState(i.id,i.actionLabel))),a.add(i.id))}for(const e of this.lastSkeletonIdSet.values())a.has(e)||this._mgr.setBodyState(!1,e);for(const e of this.ActIDMap.keys())a.has(e)||this.ActIDMap.delete(e);this.lastSkeletonIdSet.clear(),a.forEach(e=>this.lastSkeletonIdSet.add(e))}else{this.ActIDMap.clear();for(const e of this.lastSkeletonIdSet.values())this._mgr.setBodyState(!1,e);this.lastSkeletonIdSet.clear()}}}}class Va extends e{constructor(){super(),this._trackingMode=!1,this.bodies=[],this._Body3dProvider=new Ha(this)}static getInstance(){return null==this._instance&&(this._instance=new Va),this._instance}static get bodies(){return this.getInstance().bodies}static on(e,t,a){return this.getInstance().on(e,t,a)}static off(e,t,a){return this.getInstance().off(e,t,a)}static get trackingMode(){return this.getInstance()._trackingMode}onUpdate(){this._Body3dProvider.onUpdate()}init(){}setBodyState(e,t){e?this.fire(exports.BodyEvent.Detected,t):this.fire(exports.BodyEvent.Lost,t)}}class Na{constructor(){this._avatar3DInfo=null}get id(){return this._avatar3DInfo.tracking_id}get root(){return new de(this._avatar3DInfo.root)}get focalLength(){return this._avatar3DInfo.focal_length}get isDetected(){return this._avatar3DInfo.detected}get jointRotations(){return this._avatar3DInfo.quaternion}get jointPositions(){return this._avatar3DInfo.joints}get imageHeight(){return this._avatar3DInfo.imageHeight}get imageWidth(){return this._avatar3DInfo.imageWidth}}class Ha{constructor(e){this._mgr=e,this.lastAvatar3dIdSet=new Set}onUpdate(){const e=zn.algorithms.nativeResult;if(e&&e.getAvatar3DInfoTracking){this._mgr._trackingMode=e.getAvatar3DInfoTracking();const t=e.getAvatar3DInfoCount();this._mgr.bodies=Array(t);const a=new Set;if(0<t){for(let n=0;n<t;n++){const t=e.getAvatar3DInfo(n),r=new Na;this._mgr.bodies[n]=r,null!=t&&(r._avatar3DInfo=t,!this.lastAvatar3dIdSet.has(r.id)&&this._mgr.setBodyState(!0,r.id),a.add(r.id))}for(const e of this.lastAvatar3dIdSet.values())a.has(e)||this._mgr.setBodyState(!1,e);this.lastAvatar3dIdSet.clear(),a.forEach(e=>this.lastAvatar3dIdSet.add(e))}else{for(const e of this.lastAvatar3dIdSet.values())this._mgr.setBodyState(!1,e);this.lastAvatar3dIdSet.clear()}}}}class Ua extends e{constructor(){super(),this.faces=[],this._AvatarDriveProvider=new ja(this)}static getInstance(){return null==this._instance&&(this._instance=new Ua),this._instance}static get faces(){return this.getInstance().faces}static on(e,t,a){return this.getInstance().on(e,t,a)}static off(e,t,a){return this.getInstance().off(e,t,a)}onUpdate(){this._AvatarDriveProvider.onUpdate()}init(){}setAvatarDriveState(e,t){e?this.fire(exports.AvatarDriveEvent.Detected,t):this.fire(exports.AvatarDriveEvent.Lost,t)}}class Ga{constructor(){this._avatarDriveInfo=null}get id(){return this._avatarDriveInfo.ID}get isTracking(){return!(1!==this._avatarDriveInfo.succ)}get channels(){return this._avatarDriveInfo.beta}}class ja{constructor(e){this._mgr=e,this.lastAvatarDriveIdSet=new Set}onUpdate(){const e=zn.algorithms.nativeResult;if(e&&e.getAvatarDriveCount){const t=e.getAvatarDriveCount();this._mgr.faces=Array(t);const a=new Set;if(0<t){for(let n=0;n<t;n++){const t=e.getAvatarDriveInfo(n),r=new Ga;this._mgr.faces[n]=r,null!=t&&(r._avatarDriveInfo=t,!this.lastAvatarDriveIdSet.has(r.id)&&this._mgr.setAvatarDriveState(!0,r.id),a.add(r.id))}for(const e of this.lastAvatarDriveIdSet.values())a.has(e)||this._mgr.setAvatarDriveState(!1,e);this.lastAvatarDriveIdSet.clear(),a.forEach(e=>this.lastAvatarDriveIdSet.add(e))}else{for(const e of this.lastAvatarDriveIdSet.values())this._mgr.setAvatarDriveState(!1,e);this.lastAvatarDriveIdSet.clear()}}}}class Wa{constructor(){this._plugins={}}bufferToStr(e){const t=new Uint8Array(e),a=t.length,n=Array(a);for(let r=0;r<a;r++)n[r]=String.fromCharCode.call(null,t[r]);return n.join("")}start(){for(const e in this.loadPlugins(),this._plugins){const t=this._plugins[e];"function"==typeof t.onStart&&t.onStart()}}loadPlugins(){const e=zn.scene.native.assetMgr.rootDir,t=e+"js/plugins.json",a=fs.accessSync(t,0);if(a){const e=fs.readFileSync(t);if(null!=e)try{const t=this.bufferToStr(e),a=JSON.parse(t),n=a.plugins;for(const e in n){const t=n[e];this.initPlugin(t,e)}}catch(t){console.error("Failed to load plugins.json"),console.error(t)}}}initPlugin(e,t){if(0>=t.length)return null;const a=r.toPascalCase(t),n=require(a)[a],i=new n;return this._plugins[t]=i,i.init(zn.scene,e.config),i}update(e){for(const t in this._plugins){const a=this._plugins[t];"function"==typeof a.onUpdate&&a.onUpdate(e)}}lateUpdate(e){for(const t in this._plugins){const a=this._plugins[t];"function"==typeof a.onLateUpdate&&a.onLateUpdate(e)}}destroy(){for(const e in this._plugins){const t=this._plugins[e];"function"==typeof t.onDestroy&&t.onDestroy()}}event(e){for(const t in this._plugins){const a=this._plugins[t];"function"==typeof a.onEvent&&this._plugins[t].onEvent(e)}}get plugins(){return this._plugins}}var Xa=effect.Amaz;class Ya{constructor(e,t){if(this._supportMemoryMapping=s.doesSDKSupport(p),e instanceof Xa.AABB)this._native=e;else if(e instanceof de&&t instanceof de){var a,n;this._native=new Xa.AABB(null==(a=e.native)?new Xa.Vector3f:a,null==(n=t.native)?new Xa.Vector3f:n)}else this._native=new Xa.AABB;this._supportMemoryMapping?(this._minVectorValues=new Float32Array(this._native.getMinVectorBuffer()),this._maxVectorValues=new Float32Array(this._native.getMaxVectorBuffer())):(this._minVectorValues=new Float32Array,this._maxVectorValues=new Float32Array)}static fromNative(e){return new Ya(e)}static eq(e,t){return t&&e&&e.minX===t.minX&&e.minY===t.minY&&e.minZ===t.minZ&&e.maxX===t.maxX&&e.maxY===t.maxY&&e.maxZ===t.maxZ}get native(){return this._native}get minX(){return this._supportMemoryMapping?this._minVectorValues[Ya.X]:this._native.min_x}set minX(e){this._supportMemoryMapping?this._minVectorValues[Ya.X]=Math.fround(e):this._native.min_x=e}get minY(){return this._supportMemoryMapping?this._minVectorValues[Ya.Y]:this._native.min_y}set minY(e){this._supportMemoryMapping?this._minVectorValues[Ya.Y]=Math.fround(e):this._native.min_y=e}get minZ(){return this._supportMemoryMapping?this._minVectorValues[Ya.Z]:this._native.min_z}set minZ(e){this._supportMemoryMapping?this._minVectorValues[Ya.Z]=Math.fround(e):this._native.min_z=e}get maxX(){return this._supportMemoryMapping?this._maxVectorValues[Ya.X]:this._native.max_x}set maxX(e){this._supportMemoryMapping?this._maxVectorValues[Ya.X]=Math.fround(e):this._native.max_x=e}get maxY(){return this._supportMemoryMapping?this._maxVectorValues[Ya.Y]:this._native.max_y}set maxY(e){this._supportMemoryMapping?this._maxVectorValues[Ya.Y]=Math.fround(e):this._native.max_y=e}get maxZ(){return this._supportMemoryMapping?this._maxVectorValues[Ya.Z]:this._native.max_z}set maxZ(e){this._supportMemoryMapping?this._maxVectorValues[Ya.Z]=Math.fround(e):this._native.max_z=e}eq(e){return e&&this.minX===e.minX&&this.minY===e.minY&&this.minZ===e.minZ&&this.maxX===e.maxX&&this.maxY===e.maxY&&this.maxZ===e.maxZ}toString(){return`AABB(min: ${this.minX.toFixed(5)}, ${this.minY.toFixed(5)}, ${this.minZ.toFixed(5)},\n     max: ${this.maxX.toFixed(5)}, ${this.maxY.toFixed(5)}, ${this.maxZ.toFixed(5)})`}copy(e){return this.minX=e.minX,this.minY=e.minY,this.minZ=e.minZ,this.maxX=e.maxX,this.maxY=e.maxY,this.maxZ=e.maxZ,this}clone(){return new Ya(this._native)}}Ya.X=0,Ya.Y=1,Ya.Z=2;var qa=effect.Amaz;class Za{constructor(e=void 0){this.native=new qa.SubMesh,this.name="no-name",this._primitive=C.TRIANGLES,this._mesh=void 0,e?this.native=e:(this.native=new qa.SubMesh,this.native.primitive=this.primitive)}setIndices(e){e.forEach(e=>{this.native.indices16.pushBack(e)}),this.native.indicesCount=this.native.indices16.size()}get primitive(){return this._primitive}set primitive(e){this._primitive=e,this.native.primitive=this._primitive}get mesh(){return this._mesh?this._mesh:void 0}set mesh(e){e&&(this._mesh=e,this.native.mesh=e.native)}}class Ka{constructor(){this.vertexAttributeMapped=0,this._attributeCount=0,this.vertexAttributeMapped=0}setAttribute(e,t){this.hasAttribute(e)===t||(!0===t?this.attributeCount++:this.attributeCount--,this.vertexAttributeMapped|=+t<<+e)}hasAttribute(e){return 0<(this.vertexAttributeMapped&1<<e)}reset(){this.vertexAttributeMapped=0,this.attributeCount=0}get attributeCount(){return this._attributeCount}set attributeCount(e){this._attributeCount=e}}var Ja=effect.Amaz;class Qa{constructor(){this.mask=new Ka,this.native=new Ja.Mesh,this.name="no name",this._submeshses=[]}addSubMesh(e){var t;return null==(t=this.submeshes)?void 0:t.push(e),this.submeshes[this.submeshes.length-1].mesh=this,this.native.addSubMesh(e.native),this.submeshes[this.submeshes.length-1]}setSubMeshPrimitive(e,t){return e>=this.submeshes.length||0>e?void console.error("Index: "+e+" is out of range"):void(this.submeshes[e].primitive=t)}getSubMesh(e){return e>=this.submeshes.length?void console.error("Index: "+e+" is out of range"):this.submeshes[e]}getSubMeshCount(){return this.submeshes.length}clearVertexData(){this.mask.reset()}get submeshes(){return this._submeshses}set submeshes(e){if(e){this._submeshses=e,this.native.submeshes.clear();for(let t=0;t<e.length;++t)this.native.submeshes.pushBack(e[t].native)}}}var $a=effect.Amaz.VertexAttribType,en=effect.Amaz;class tn extends Qa{constructor(e,t){if(super(),this._aabb=new Ya,e instanceof en.Mesh)this.native=e;else{const a=e;this.populateVertexDesc(a);const n=a.positions;if(n&&0<n.length){const e=new en.Vec3Vector;n.forEach(t=>{e.pushBack(new en.Vector3f(t.x,t.y,t.z))}),this.native.setVertexArray(e,0,e.size(),!1)}const r=a.colors;if(r&&0<r.length){const e=new en.Vec4Vector;r.forEach(t=>{e.pushBack(new en.Vector4f(t.r,t.g,t.b,t.a))}),this.native.setColorArray(e,0,e.size())}const i=a.uvs;if(i&&0<i.length){const e=new en.Vec2Vector;i.forEach(t=>{e.pushBack(new en.Vector2f(t.x,t.y))}),this.native.setUvArray(0,e,0,e.size())}const o=a.uv3ds;if(o&&0<o.length){const e=new en.Vec3Vector;o.forEach(t=>{e.pushBack(new en.Vector3f(t.x,t.y,t.z))}),this.native.setUv3DArray(0,e,0,e.size())}const s=a.normals;if(s&&0<s.length){const e=new en.Vec3Vector;s.forEach(t=>{e.pushBack(new en.Vector3f(t.x,t.y,t.z))}),this.native.setNormalArray(e,0,e.size())}const d=t;let c=!1,l=C.TRIANGLES,p=0,u=this.native.getVertexCount();if(d&&(c=!!d.customIndices&&d.customIndices,l=d.primitive?d.primitive:C.TRIANGLES,p=d.offset?d.offset:0,u=d.vertCount?d.vertCount:u),l===C.TRIANGLES||c){if(null!=e&&e.submeshes&&Array.isArray(null==e?void 0:e.submeshes[0])){const t=null==e?void 0:e.submeshes;for(let e=0;e<t.length;++e){const a=this.addSubMesh(new Za);for(let n=0;n<t[e].length;++n)a.native.indices16.pushBack(t[e][n]);a.native.indicesCount=a.native.indices16.size(),a.primitive=l}}else if(null!=e&&e.submeshes&&Array.isArray(null==e?void 0:e.submeshes)){const t=null==e?void 0:e.submeshes,a=this.addSubMesh(new Za);for(let e=0;e<t.length;++e)a.native.indices16.pushBack(t[e]);a.native.indicesCount=a.native.indices16.size(),a.primitive=l}}else if(l===C.TRIANGLE_FAN||l===C.TRIANGLE_STRIP){const e=this.addSubMesh(new Za);for(let t=p,a=0;a<u;++t,++a)e.native.indices16.pushBack(t);e.native.indicesCount=e.native.indices16.size(),e.primitive=l}a.calculateTangents&&this.calculateTangents();const g=a.tangents;if(g&&0<g.length){const e=new en.Vec4Vector;g.forEach(t=>{e.pushBack(new en.Vector4f(t.x,t.y,t.z,t.w))}),this.native.setTangentArray(e,0,e.size())}this.calculateAABB()}}populateVertexDesc(e){const t=new en.Vector;if(e.positions&&0<e.positions.length){const e=new en.VertexAttribDesc;e.semantic=$a.POSITION,this.mask.setAttribute(e.semantic,!0),t.pushBack(e)}if(e.colors&&0<e.colors.length){const e=new en.VertexAttribDesc;e.semantic=$a.COLOR,this.mask.setAttribute(e.semantic,!0),t.pushBack(e)}if(e.uvs&&0<e.uvs.length){const e=new en.VertexAttribDesc;e.semantic=$a.TEXCOORD0,this.mask.setAttribute(e.semantic,!0),t.pushBack(e)}if(e.uv3ds&&0<e.uv3ds.length){const e=new en.VertexAttribDesc;e.semantic=$a.TEXCOORD0,t.pushBack(e)}if(e.normals&&0<e.normals.length){const e=new en.VertexAttribDesc;e.semantic=$a.NORMAL,this.mask.setAttribute(e.semantic,!0),t.pushBack(e)}if(e.tangents&&0<e.tangents.length||e.calculateTangents){const e=new en.VertexAttribDesc;e.semantic=$a.TANGENT,this.mask.setAttribute(e.semantic,!0),t.pushBack(e)}this.native.vertexAttribs=t}calculateAABB(){var e=Number.MAX_VALUE,t=Number.MIN_VALUE,a=Math.min,n=Math.max;const r=this.native.getVertexCount(),o=this.native.getVertexArray(0,r);if(this.aabb&&0<o.size()){this.aabb.minX=e,this.aabb.minY=e,this.aabb.minZ=e,this.aabb.maxX=t,this.aabb.maxY=t,this.aabb.maxZ=t;for(let e=0;e<o.size();++e){const t=o.get(e);this.aabb.minX=a(t.x,this.aabb.minX),this.aabb.minY=a(t.y,this.aabb.minY),this.aabb.minZ=a(t.z,this.aabb.minZ),this.aabb.maxX=n(t.x,this.aabb.maxX),this.aabb.maxY=n(t.y,this.aabb.maxY),this.aabb.maxZ=n(t.z,this.aabb.maxZ)}}}calculateTangents(){if(!this.mask.hasAttribute($a.TANGENT))return console.error("Mesh did not have a tangents vertex attribute"),[];if(!this.mask.hasAttribute($a.POSITION))return console.error("Mesh did not have a position vertex attribute"),[];if(!this.mask.hasAttribute($a.NORMAL))return console.error("Mesh did not have a normals vertex attribute"),[];if(!this.mask.hasAttribute($a.TEXCOORD0))return console.error("Mesh did not have a uvs vertex attribute"),[];const e=new en.Vec4Vector,t=this.native.getVertexCount();for(let a=0;a<t;++a)e.pushBack(new en.Vector4f(0,0,0,0));this.native.setTangentArray(e,0,e.size()),this.native.reCalculateTangents();const a=[],n=this.native.getTangentArray(0,t);for(let e=0;e<n.size();++e){const t=n.get(e);a.push(new le(t.x,t.y,t.z,t.w))}return a}get aabb(){return this._aabb}set aabb(e){this._aabb=e,this.native.boundingBox=this._aabb.native}}class an{constructor(e,t){this.name=e,this.resource=t}}class nn{constructor(){this._registry={x:""}}static getInstance(){return null==this._instance&&(this._instance=new nn),this._instance}bufferToStr(e){const t=new Uint8Array(e),a=t.length,n=Array(a);for(let r=0;r<a;r++)n[r]=String.fromCharCode.call(null,t[r]);return n.join("")}init(){try{const e=this.bufferToStr(fs.readFileSync(zn.scene.native.assetMgr.rootDir+"resourceMap.json"));this._registry=JSON.parse(e)}catch(t){console.warn("Unable to load resource map")}}getAssetUri(e){const t=this._registry[e];return t}}var rn=effect.Amaz;class on{destroy(){}get rootDir(){return zn.scene.native.assetMgr.rootDir}loadSync(e){if(!e.startsWith("share://")&&!e.startsWith("custom://")&&!fs.accessSync(this.rootDir+e,0))return console.error(`Cannot find asset at: ${e}`),null;let t=zn.scene.native.assetMgr.SyncLoad(e);if(t){t instanceof rn.Material?t=new ze({native:t}):t instanceof rn.Mesh&&(t=new tn(t));const a=r.getFilename(e);t=new an(a,t)}else console.error(`Failed to load: ${e}`);return t}loadResource(e){const t=nn.getInstance().getAssetUri(e),a=t?this.loadSync(t):this.loadSync(e);return a}}var sn=effect.Amaz;class dn{constructor(){this._nativeAlgoResult=null,this._nativeAlgoMgr=sn.AmazingManager.getSingleton("Algorithm")}get nativeResult(){return this._nativeAlgoResult}update(){var e;const t=null==(e=this._nativeAlgoMgr)?void 0:e.getAEAlgorithmResult();if(null==t)return void(this._nativeAlgoResult=null);const a=()=>null;"function"!=typeof t.getHandInfo&&(t.getHandInfo=a),"function"!=typeof t.getAvatar3DInfo&&(t.getAvatar3DInfo=a),"function"!=typeof t.getSkeletonInfo&&(t.getSkeletonInfo=a),"function"!=typeof t.getActionRecognitionInfo&&(t.getActionRecognitionInfo=a),"function"!=typeof t.getAvatar3DInfoCount&&(t.getAvatar3DInfoCount=()=>0),"function"!=typeof t.getFaceMeshInfo&&(t.getFaceMeshInfo=a),"function"!=typeof t.getFaceBaseInfo&&(t.getFaceBaseInfo=a),"function"!=typeof t.getFaceAttributeInfo&&(t.getFaceAttributeInfo=a),"function"!=typeof t.getFaceExtraInfo&&(t.getFaceExtraInfo=a),"function"!=typeof t.getFaceNewLandmarkInfo&&(t.getFaceNewLandmarkInfo=a),"function"!=typeof t.getAvatarDriveInfo&&(t.getAvatarDriveInfo=a),this._nativeAlgoResult=t}}class cn extends e{constructor(e,t){super(),this._type=e,this._state=exports.GestureRecognizerState.Possible,this._touchGesture=t}get type(){return this._type}get state(){return this._state}set state(e){this._state=e,(e===exports.GestureRecognizerState.Began||e===exports.GestureRecognizerState.Ended||e===exports.GestureRecognizerState.Changed)&&this._touchGesture.fire(this._type,this)}reset(){}update(){}handleTouch(){}}var ln=effect.Amaz;class pn extends cn{constructor(e){super(exports.GestureType.Tap,e),this._tp1Pos=new ln.Vector2f(0,0),this._tp1Time=0,this._touchPos=new ln.Vector2f(0,0),this._maxDuration=.5,this._maxDeltaMovement=.02}get position(){return new Q(this._touchPos)}reset(){this._tp1Pos=new ln.Vector2f(0,0),this._tp1Time=0,this._touchPos=new ln.Vector2f(0,0)}handleTouch(e){if(this.state!==exports.GestureRecognizerState.Failed){const t=e.type;if(t===ln.TouchType.TOUCH_BEGAN)1!==e.count&&(this.state=exports.GestureRecognizerState.Failed),this.state!==exports.GestureRecognizerState.Failed&&(this._tp1Pos=new ln.Vector2f(e.x,e.y),this._tp1Time=e.time);else if(t===ln.TouchType.TOUCH_MOVED){const t=new ln.Vector2f(e.x,e.y),a=this._tp1Pos;(e.time-this._tp1Time>1e6*this._maxDuration||t.distance(a)>this._maxDeltaMovement)&&(this.state=exports.GestureRecognizerState.Failed)}else if(t===ln.TouchType.TOUCH_ENDED||t===ln.TouchType.TOUCH_CANCELED){const t=new ln.Vector2f(e.x,e.y),a=this._tp1Pos;e.time-this._tp1Time<1e6*this._maxDuration&&t.distance(a)<this._maxDeltaMovement?(this._touchPos=t,this.state=exports.GestureRecognizerState.Ended):this.state=exports.GestureRecognizerState.Failed}}}}var un=effect.Amaz;class gn extends cn{constructor(e){super(exports.GestureType.Pan,e),this._initPos=new un.Vector2f(0,0),this._curPos=new un.Vector2f(0,0)}get initPosition(){return new Q(this._initPos)}get currentPosition(){return new Q(this._curPos)}get offset(){const e=new Q(this._curPos);return e.sub(new Q(this._initPos))}reset(){this._initPos=new un.Vector2f(0,0),this._curPos=new un.Vector2f(0,0)}handleTouch(e){if(this.state!==exports.GestureRecognizerState.Failed){const t=e.type;t===un.TouchType.TOUCH_BEGAN?(1!==e.count&&(this.state=exports.GestureRecognizerState.Failed),this.state!==exports.GestureRecognizerState.Failed&&(this._initPos=new un.Vector2f(e.x,e.y),this.state=exports.GestureRecognizerState.Began)):t===un.TouchType.TOUCH_MOVED?(this.state===exports.GestureRecognizerState.Began||this.state===exports.GestureRecognizerState.Changed)&&(this._curPos=new un.Vector2f(e.x,e.y),this.state=exports.GestureRecognizerState.Changed):(t===un.TouchType.TOUCH_ENDED||t===un.TouchType.TOUCH_CANCELED)&&(this.state===exports.GestureRecognizerState.Changed?this.state=exports.GestureRecognizerState.Ended:this.state=exports.GestureRecognizerState.Failed)}}}var mn=effect.Amaz;class fn extends cn{constructor(e){super(exports.GestureType.Rotation,e),this._tp1Id=99,this._tp1Pos=new mn.Vector2f(0,0),this._tp2Id=99,this._tp2Pos=new mn.Vector2f(0,0),this._initDir=new mn.Vector2f(0,0),this._lastYaw=0,this._deltaYaw=0,this._yaw=0}reset(){this._tp1Id=99,this._tp1Pos=new mn.Vector2f(0,0),this._tp2Id=99,this._tp2Pos=new mn.Vector2f(0,0),this._initDir=new mn.Vector2f(0,0),this._lastYaw=0,this._deltaYaw=0,this._yaw=0}get rotation(){return this._yaw}get delta(){return this._deltaYaw}handleTouch(e){const t=e.type;if(this.state!==exports.GestureRecognizerState.Failed)if(t===mn.TouchType.TOUCH_BEGAN){if(2<e.count)return void(this.state=exports.GestureRecognizerState.Failed);99===this._tp1Id?(this._tp1Id=e.pointerId,this._tp1Pos=new mn.Vector2f(e.x,e.y)):99!==this._tp1Id&&this._tp1Id!==e.pointerId&&99===this._tp2Id&&(this._tp2Id=e.pointerId,this._tp2Pos=new mn.Vector2f(e.x,e.y),this._initDir=this._tp1Pos.copy(),this._initDir.sub(this._tp2Pos),this.state=exports.GestureRecognizerState.Began)}else if(t!==mn.TouchType.TOUCH_MOVED)(t===mn.TouchType.TOUCH_ENDED||t===mn.TouchType.TOUCH_CANCELED)&&(this.state===exports.GestureRecognizerState.Began||99!==this._tp1Id&&99===this._tp2Id?this.state=exports.GestureRecognizerState.Failed:this.state===exports.GestureRecognizerState.Changed&&(this.state=exports.GestureRecognizerState.Ended));else if(this._tp1Id===e.pointerId?this._tp1Pos=new mn.Vector2f(e.x,e.y):this._tp2Id===e.pointerId&&(this._tp2Pos=new mn.Vector2f(e.x,e.y)),this.state===exports.GestureRecognizerState.Began||this.state===exports.GestureRecognizerState.Changed){const e=this._tp1Pos.copy();e.sub(this._tp2Pos);const t=this._initDir;let a=e.angle(t);const n=t.x*e.y-t.y*e.x;0<n&&(a=-a),this._deltaYaw=a-this._lastYaw,this._yaw+=this._deltaYaw,this._lastYaw=a,this.state=exports.GestureRecognizerState.Changed}}}var hn=effect.Amaz;class _n extends cn{constructor(e){super(exports.GestureType.Pinch,e),this._tp1Id=99,this._tp1Pos=new hn.Vector2f(0,0),this._tp2Id=99,this._tp2Pos=new hn.Vector2f(0,0),this._scale=1,this._deltaScale=0,this._initDis=1,this._lastScale=1}get scale(){return this._scale}get delta(){return this._deltaScale}reset(){this._tp1Id=99,this._tp1Pos=new hn.Vector2f(0,0),this._tp2Id=99,this._tp2Pos=new hn.Vector2f(0,0),this._scale=1,this._initDis=1,this._deltaScale=0,this._lastScale=1}handleTouch(e){const t=e.type;if(this.state!==exports.GestureRecognizerState.Failed)if(t===hn.TouchType.TOUCH_BEGAN){if(2<e.count)return void(this.state=exports.GestureRecognizerState.Failed);99===this._tp1Id?(this._tp1Id=e.pointerId,this._tp1Pos=new hn.Vector2f(e.x,e.y)):99!==this._tp1Id&&this._tp1Id!==e.pointerId&&99===this._tp2Id&&(this._tp2Id=e.pointerId,this._tp2Pos=new hn.Vector2f(e.x,e.y),this._initDis=this._tp1Pos.distance(this._tp2Pos),this.state=exports.GestureRecognizerState.Began)}else t===hn.TouchType.TOUCH_MOVED?(this._tp1Id===e.pointerId?this._tp1Pos=new hn.Vector2f(e.x,e.y):this._tp2Id===e.pointerId&&(this._tp2Pos=new hn.Vector2f(e.x,e.y)),(this.state===exports.GestureRecognizerState.Began||this.state===exports.GestureRecognizerState.Changed)&&(this._lastScale=this._scale,this._scale=this._tp1Pos.distance(this._tp2Pos)/(this._initDis+1e-7),this._deltaScale=this._scale-this._lastScale,this.state=exports.GestureRecognizerState.Changed)):(t===hn.TouchType.TOUCH_ENDED||t===hn.TouchType.TOUCH_CANCELED)&&(this.state===exports.GestureRecognizerState.Began||99!==this._tp1Id&&99===this._tp2Id?this.state=exports.GestureRecognizerState.Failed:this.state===exports.GestureRecognizerState.Changed&&(this.state=exports.GestureRecognizerState.Ended))}}var yn=effect.Amaz;class vn extends cn{constructor(e){super(exports.GestureType.LongPress,e),this._tp1Pos=new yn.Vector2f(0,0),this._tp1Time=0,this._touchPos=new yn.Vector2f(0,0),this._minDuration=.501,this._maxDeltaMovement=.02}get position(){return new Q(this._touchPos)}reset(){this._tp1Pos=new yn.Vector2f(0,0),this._tp1Time=0,this._touchPos=new yn.Vector2f(0,0)}handleTouch(e){if(this.state!==exports.GestureRecognizerState.Failed){const t=e.type;if(t===yn.TouchType.TOUCH_BEGAN)1!==e.count&&(this.state=exports.GestureRecognizerState.Failed),this.state!==exports.GestureRecognizerState.Failed&&(this._tp1Pos=new yn.Vector2f(e.x,e.y),this._tp1Time=e.time);else if(t===yn.TouchType.TOUCH_MOVED){const t=new yn.Vector2f(e.x,e.y),a=this._tp1Pos;t.distance(a)>this._maxDeltaMovement&&(this.state=exports.GestureRecognizerState.Failed)}else if(t===yn.TouchType.TOUCH_ENDED||t===yn.TouchType.TOUCH_CANCELED){const t=new yn.Vector2f(e.x,e.y),a=this._tp1Pos;e.time-this._tp1Time>1e6*this._minDuration&&t.distance(a)<this._maxDeltaMovement?(this._touchPos=t,this.state=exports.GestureRecognizerState.Ended):this.state=exports.GestureRecognizerState.Failed}}}}var Tn=effect.Amaz;class xn extends cn{constructor(e){super(exports.GestureType.DoubleTap,e),this._tp1Pos=new Tn.Vector2f(0,0),this._tp1Time=0,this._tp1leaveTime=0,this._touchPos=new Tn.Vector2f(0,0),this._maxDuration=.5,this._maxInterval=.2,this._maxDeltaMovement=.02,this._firstReady=!1,this._curTime=0}get position(){return new Q(this._touchPos)}reset(){this._tp1Pos=new Tn.Vector2f(0,0),this._tp1Time=0,this._tp1leaveTime=0,this._touchPos=new Tn.Vector2f(0,0),this._firstReady=!1}update(e){this._curTime+=e,this._firstReady&&this._curTime>this._maxInterval&&(this.state=exports.GestureRecognizerState.Failed,this._firstReady=!1,this._curTime=0)}handleTouch(e){if(this._curTime=0,this.state!==exports.GestureRecognizerState.Failed){const t=e.type;if(t===Tn.TouchType.TOUCH_BEGAN){if(1!==e.count&&(this.state=exports.GestureRecognizerState.Failed),this.state!==exports.GestureRecognizerState.Failed){if(this._firstReady&&e.time-this._tp1leaveTime>1e6*this._maxInterval)return void(this.state=exports.GestureRecognizerState.Failed);this._tp1Pos=new Tn.Vector2f(e.x,e.y),this._tp1Time=e.time,this._touchPos=new Tn.Vector2f(e.x,e.y)}}else if(t===Tn.TouchType.TOUCH_MOVED){const t=new Tn.Vector2f(e.x,e.y),a=this._tp1Pos;(e.time-this._tp1Time>1e6*this._maxDuration||t.distance(a)>this._maxDeltaMovement)&&(this.state=exports.GestureRecognizerState.Failed)}else if(t===Tn.TouchType.TOUCH_ENDED||t===Tn.TouchType.TOUCH_CANCELED){const t=new Tn.Vector2f(e.x,e.y),a=this._tp1Pos;if(e.time-this._tp1Time<1e6*this._maxDuration&&t.distance(a)<this._maxDeltaMovement){if(this._firstReady)return void(this.state=exports.GestureRecognizerState.Ended);this._tp1leaveTime=e.time,this._firstReady=!0}else this.state=exports.GestureRecognizerState.Failed}}}}var Mn=effect.Amaz;class Sn extends e{constructor(){super(),this._currentTouchNum=0,this._mockPoint=[],this._gestureRecognizers=new Map,this._gestureRecognizers.set(exports.GestureType.Tap,new pn(this)),this._gestureRecognizers.set(exports.GestureType.Pan,new gn(this)),this._gestureRecognizers.set(exports.GestureType.Rotation,new fn(this)),this._gestureRecognizers.set(exports.GestureType.Pinch,new _n(this)),this._gestureRecognizers.set(exports.GestureType.LongPress,new vn(this)),this._gestureRecognizers.set(exports.GestureType.DoubleTap,new xn(this))}start(){}destroy(){}get tap(){return this._gestureRecognizers.get(exports.GestureType.Tap)}get pan(){return this._gestureRecognizers.get(exports.GestureType.Pan)}get rotation(){return this._gestureRecognizers.get(exports.GestureType.Rotation)}get pinch(){return this._gestureRecognizers.get(exports.GestureType.Pinch)}get longPress(){return this._gestureRecognizers.get(exports.GestureType.LongPress)}get doubleTap(){return this._gestureRecognizers.get(exports.GestureType.DoubleTap)}pushMockTouch(e){this._mockPoint.push(e.native)}popMockTouch(){this._mockPoint.pop()}update(e){for(const t of this._gestureRecognizers.keys()){const a=this._gestureRecognizers.get(t);a.update(e)}}_reset(){for(const e of this._gestureRecognizers.keys()){const t=this._gestureRecognizers.get(e);t.state=exports.GestureRecognizerState.Possible,t.reset()}}_countTouch(e){e.type===Mn.TouchType.TOUCH_BEGAN?this._currentTouchNum++:(e.type===Mn.TouchType.TOUCH_ENDED||e.type===Mn.TouchType.TOUCH_CANCELED)&&this._currentTouchNum--}_needReset(){for(const e of this._gestureRecognizers.keys()){const t=this._gestureRecognizers.get(e);if(t.state===exports.GestureRecognizerState.Possible)return!1}return!0}_handleTouch(e){0>=this._currentTouchNum&&this._needReset()&&(this._currentTouchNum=0,this._reset()),this._countTouch(e);for(const t of this._gestureRecognizers.keys()){const a=this._gestureRecognizers.get(t);a.handleTouch(e)}}_handleMockTouch(e){for(let t=0;t<this._mockPoint.length;t++){const a=this._mockPoint[t],n=new Mn.TouchPointer;n.x=a.x,n.y=a.y,n.type=e.type,n.pointerId=e.pointerId+t+1,n.time=e.time,n.size=e.size,n.force=e.force,n.count=e.count+t+1,this._handleTouch(n)}}onEvent(e){if(e.type===Mn.EventType.TOUCH){const t=e.args.get(0);this._handleTouch(t),this._handleMockTouch(t)}}}class Fn{constructor(e,t,a){this._type=e,this._caster=t,this._sceneObjects=a}get type(){return this._type}get caster(){return this._caster}get sceneObjects(){return this._sceneObjects}}var Cn=effect.Amaz;class An extends e{constructor(){super(...arguments),this._raycasterComps=new Map([[exports.ScreenRaycasterType.UI,[]],[exports.ScreenRaycasterType.TwoD,[]],[exports.ScreenRaycasterType.ThreeD,[]],[exports.ScreenRaycasterType.Other,[]],[exports.ScreenRaycasterType.AR,[]]]),this._respondOrder=[exports.ScreenRaycasterType.UI,exports.ScreenRaycasterType.TwoD,exports.ScreenRaycasterType.ThreeD,exports.ScreenRaycasterType.Other,exports.ScreenRaycasterType.AR],this._curTouchNum=0,this._touched=!1,this._fireEndedDirty=!1,this._respondType=exports.TouchRespondType.Once}get type(){return this._respondType}set type(e){this._respondType=e}get order(){return this._respondOrder}set order(e){this._respondOrder=e}start(){const e=zn.scene.findAllByComponent("ScreenRaycaster");for(let a=0;a<e.length;a++){var t;const n=e[a],r=n.getComponent("ScreenRaycaster");null==(t=this._raycasterComps.get(r.type))?void 0:t.push(r)}}destroy(){}update(){this._fireEndedDirty&&(this.fire(exports.ScreenRespondType.Ended),this._fireEndedDirty=!1)}_fireRespondEvent(e){for(const t of this._respondOrder){if(!this._raycasterComps.has(t))continue;const a=this._raycasterComps.get(t);for(let n=0;n<a.length;n++){const r=a[n];let i;if(i=t===exports.ScreenRaycasterType.UI?r.raycastUI(new Q(e.x,1-e.y)):r.raycastOBB(new Q(e.x,1-e.y)),0<i.length){const e=new Fn(r.type,r,i);this.fire(exports.ScreenRespondType.Respond,e),this._touched=!0}}}}onEvent(e){if(e.type===Cn.EventType.TOUCH){const t=e.args.get(0);if(t.type===Cn.TouchType.TOUCH_BEGAN){if(0>=this._curTouchNum&&(this._curTouchNum=0,this.fire(exports.ScreenRespondType.Began)),this._curTouchNum++,this._touched&&this._respondType===exports.TouchRespondType.Once)return;this._fireRespondEvent(new Q(t.x,t.y))}else t.type===Cn.TouchType.TOUCH_MOVED?this._respondType===exports.TouchRespondType.Continuous&&this._fireRespondEvent(new Q(t.x,t.y)):(t.type===Cn.TouchType.TOUCH_ENDED||t.type===Cn.TouchType.TOUCH_CANCELED)&&(this._curTouchNum--,0>=this._curTouchNum&&(this._curTouchNum=0,this._fireEndedDirty=!0,this._touched=!1))}}}class In extends e{constructor(e){super(),this._native=e}instantiate(e,t){let a;if(a=t?this._native.instantiateToEntity(t.native.scene,t.native,e):this._native.instantiateToScene(zn.scene.native,e),a)return zn.scene.sceneObjectFromNative(a);throw new Error("Cannot instantiate instance from prefab.")}get root(){return zn.scene.sceneObjectFromNative(this._native.getRootEntity())}}class bn extends e{constructor(){super(),this.prefabManager=effect.Amaz.AmazingManager.getSingleton("PrefabManager")}load(e){const t=this.prefabManager.loadPrefab(zn.assets.rootDir,e);return new In(t)}}var Rn=effect.Amaz;class zn extends e{constructor(e,t){super(),s.doesSDKSupport(c)||console.error(`[Amazing JS]: current SDK version[${Rn.VERSION}] is lower than the minimum required version[${c}]. Amazing JS might not be able run properly.`),this._algorithms=new dn,this._scene=new zt(e);const a=t.script;if(a instanceof Rn.JSScript){this._systemScript=a;const e=this._systemScript.ref;e._onObjectEvent=this._onObjectEvent}else throw new Error("Incorrect/ missing system script is not passed in amg.Engine.init(). Please pass this as second argument");this._assets=new on,this._customAssets=new Ea;const n=e.getOutputRenderTexture();this._touch=new Lt(n.width,n.height),this._plugins=new Wa,s.doesSDKSupport(l)?(this._touchRespond=new An,this._touchGesture=new Sn):(this._touchRespond=null,this._touchGesture=null,console.warn(`[Amazing JS]: current SDK version[${Rn.VERSION}] is lower than the minimum required version[${l}] for touch gesture module.`)),this._prefabs=new bn,zn._engine=this}static get sdkVersion(){return effect.Amaz.VERSION}static getFeatureMinSDKVersion(e){var t;return null==(t=h.get(e))?"":t}static get minRequiredSDKVersion(){return c}static get version(){return d}static get engine(){return this._engine}static get scene(){return this._engine._scene}static get plugins(){return this._engine._plugins}static get customAssets(){return this._engine._customAssets}static get touch(){return this._engine._touch}static get assets(){return this._engine._assets}static get algorithms(){return this._engine._algorithms}static get touchRespond(){return this._engine._touchRespond}static get touchGesture(){return this._engine._touchGesture}static get prefabs(){return this._engine._prefabs}static get systemScript(){return this._engine._systemScript}static init(e,t){if(void 0!==this._engine)return void console.warn("Engine already initialized");if(!e)throw new Error;this._engine=new zn(e,t),this._engine.initModules()}clear(){this._systemScript=void 0}static getObjectEvent(e,t){return void 0===t?"":e.handle.toString()+":"+t.toString()}_onObjectEvent(e,t,a){var n;const r=zn.getObjectEvent(e,a);null==(n=zn.engine)?void 0:n.fire(r,t,a)}static addNativeListener(e,t,a,n){var r;const i=zn.getObjectEvent(e,t);if(!(null!=(r=zn.engine)&&r.hasEvent(i))&&this.systemScript){var o;this.systemScript.addScriptListener(e,t,"_onObjectEvent",e),null==(o=zn.engine)?void 0:o.on(i,a,n)}}static removeNativeListener(e,t,a,n){var r;const i=zn.getObjectEvent(e,t);if(null!=(r=zn.engine)&&r.hasEvent(i)&&this.systemScript){var o;this.systemScript.removeScriptListener(e,t,"_onObjectEvent",e),null==(o=zn.engine)?void 0:o.off(i,a,n)}}initModules(){ra.getInstance().init(),ea.getInstance().init(),ka.getInstance().init(),Oa.getInstance().init(),Va.getInstance().init(),Ua.getInstance().init(),nn.getInstance().init(),this._customAssets.init()}static start(){var e,t;this.touch.start(),null==(e=this.touchRespond)?void 0:e.start(),null==(t=this.touchGesture)?void 0:t.start(),this.customAssets.start(),this.plugins.start();const a=this.plugins.plugins;for(const e in a)this._engine[e]=a[e];this._engine.fire("start")}static update(e){var t,a;this.algorithms.update(),ra.getInstance().onUpdate(e),ea.getInstance().onUpdate(),ka.getInstance().onUpdate(),Oa.getInstance().onUpdate(),Va.getInstance().onUpdate(),Ua.getInstance().onUpdate(),null==(t=this.touchRespond)?void 0:t.update(e),null==(a=this.touchGesture)?void 0:a.update(e),this.customAssets.update(),this.plugins.update(e)}static lateUpdate(e){this.customAssets.lateUpdate(e),this.plugins.lateUpdate(e)}static destroy(){var e,t,a,n;this.plugins.destroy(),this.customAssets.destroy(),this.assets.destroy(),null==(e=this.touch)?void 0:e.destroy(),null==(t=this.scene)?void 0:t.destroy(),null==(a=this.touchRespond)?void 0:a.destroy(),null==(n=this.touchGesture)?void 0:n.destroy(),this._engine&&this._engine.clear(),zn._engine=void 0}static event(e){this.touch&&this.touch.onEvent(e),this.touchRespond&&this.touchRespond.onEvent(e),this.touchGesture&&this.touchGesture.onEvent(e),this.plugins.event(e)}}zn._engine=void 0;class Pn extends e{constructor(){super(),this.hasGyroStarted=!1,this.hasGyroStarted=!1}destroy(){}start(){this.hasGyroStarted=!0}get hasStarted(){return this.hasGyroStarted}}var En=effect.Amaz.VertexAttribType,kn=effect.Amaz;class Ln extends Qa{populateVertexDesc(e){const t=new kn.Vector;if(e.positions&&0<e.positions.length){const e=new kn.VertexAttribDesc;e.semantic=En.POSITION,this.mask.setAttribute(e.semantic,!0),t.pushBack(e)}if(e.colors&&0<e.colors.length){const e=new kn.VertexAttribDesc;e.semantic=En.COLOR,t.pushBack(e)}this.native.vertexAttribs=t}constructor(e,t){if(super(),e instanceof kn.Mesh)this.native=e;else{const a=e;this.populateVertexDesc(a);const n=a.positions;if(n){const e=new kn.Vec3Vector;n.forEach(t=>{e.pushBack(new kn.Vector3f(t.x,t.y,t.z))}),this.native.setVertexArray(e,0,e.size(),!1)}const r=a.colors;if(r){const e=new kn.Vec4Vector;r.forEach(t=>{e.pushBack(new kn.Vector4f(t.r,t.g,t.b,t.a))}),this.native.setColorArray(e,0,e.size())}const i=t;let o=!1,s=C.LINES,d=0,c=this.native.getVertexCount();if(i&&(o=!!i.customIndices&&i.customIndices,s=i.primitive?i.primitive:C.LINES,d=i.offset?i.offset:0,c=i.vertCount?i.vertCount:c),s===C.LINES||o){if(null!=e&&e.submeshes&&Array.isArray(e.submeshes[0])){const t=null==e?void 0:e.submeshes;for(let e=0;e<t.length;++e){const a=this.addSubMesh(new Za);for(let n=0;n<t[e].length;++n)a.native.indices16.pushBack(t[e][n]);a.native.indicesCount=a.native.indices16.size(),a.primitive=s}}else if(null!=e&&e.submeshes&&Array.isArray(e.submeshes)){const t=null==e?void 0:e.submeshes,a=this.addSubMesh(new Za);for(let e=0;e<t.length;++e)a.native.indices16.pushBack(t[e]);a.native.indicesCount=a.native.indices16.size(),a.primitive=s}}else if(s===C.LINE_LOOP||s===C.LINE_STRIP){const e=this.addSubMesh(new Za);for(let t=d,a=0;a<c;++t,++a)e.native.indices16.pushBack(t);e.native.indicesCount=e.native.indices16.size(),e.primitive=s}}}}var Bn=effect.Amaz.DrawTexture,On=effect.Amaz;class wn extends Se{constructor(e=void 0,t=0,a=0,n=0,r=void 0,i=void 0){super(),this._attachment=F.NONE,this._inputTexture=new Se,this._massMode=S.NONE,this._colorFormat=M.RGBA8Unorm,this._realColorFormat=M.RGBA8Unorm,this._depthTexture=new Bn,this._stencilTexture=new Bn,this.native=new On.RenderTexture,e?e instanceof On.RenderTexture&&(this.native=e):(this.height=t,this.width=a,this.depth=n,r&&(this.wrapMode=r),i&&(this.filterMode=i),this.native.attachment=this.attachment,this.inputTexture.native&&(this.native.inputTexture=this.inputTexture.native),this.native.massMode=this.massMode,this.native.colorFormat=this.colorFormat,this.native.realColorFormat=this.realColorFormat,this.native.depthTexture=this.depthTexture,this.native.stencilTexture=this.stencilTexture)}get attachment(){return this._attachment}set attachment(e){this._attachment=e,this.native.attachment=this._attachment}get inputTexture(){return this._inputTexture}set inputTexture(e){this._inputTexture=e,this._inputTexture.native&&(this.native.inputTexture=this._inputTexture.native)}get massMode(){return this._massMode}set massMode(e){this._massMode=e,this.native.massMode=this._massMode}get colorFormat(){return this._colorFormat}set colorFormat(e){this._colorFormat=e,this.native.colorFormat=this._colorFormat}get realColorFormat(){return this._realColorFormat}set realColorFormat(e){this._realColorFormat=e,this.native.realColorFormat=this._realColorFormat}get depthTexture(){return this._depthTexture}set depthTexture(e){this._depthTexture=e,this.native.depthTexture=this._depthTexture}get stencilTexture(){return this._stencilTexture}set stencilTexture(e){this._stencilTexture=e,this.native.stencilTexture=this._stencilTexture}}exports.AABB=Ya,exports.AbstractMesh=Qa,exports.AnimationComponent=ut,exports.AudioComponent=ft,exports.AvatarDrive=Ua,exports.BlendFactor=B,exports.BlendOp=O,exports.Body2D=Oa,exports.Body3D=Va,exports.ButtonComponent=je,exports.CameraComponent=H,exports.CanvasComponent=oe,exports.Color=y,exports.CompareOp=L,exports.CullFace=P,exports.DoubleTapGestureRecognizer=xn,exports.Engine=zn,exports.Entity=bt,exports.EntityLayerMax=64,exports.EntityTagMax=32,exports.EventHandler=e,exports.FeatureMinSDKVersion=h,exports.FilterMode=Me,exports.FrontFace=E,exports.Gyroscope=Pn,exports.Hand=ka,exports.Head=ea,exports.ImageComponent=ne,exports.ImagePixelFormat=M,exports.LabelComponent=ot,exports.LayoutComponent=ct,exports.LightComponent=Qe,exports.LineMesh=Ln,exports.LongPressGestureRecognizer=vn,exports.MSAAMode=S,exports.Mat3=me,exports.Mat4=ve,exports.Material=ze,exports.Mesh=tn,exports.ModelComponent=Ye,exports.PanGestureRecognizer=gn,exports.PinchGestureRecognizer=_n,exports.PolygonMode=k,exports.Prefab=In,exports.Primitive=C,exports.Quat=he,exports.Rect=T,exports.RenderTexture=wn,exports.RenderTextureAttachment=F,exports.RendererType=z,exports.RotationGestureRecognizer=fn,exports.Scene=zt,exports.SceneObject=bt,exports.ScreenHitInfo=Fn,exports.ScreenRaycasterComponent=At,exports.ScreenTransformComponent=yt,exports.ScriptComponent=St,exports.Segmentation=ra,exports.SeqAnimationComponent=Oe,exports.ShaderType=R,exports.SpriteComponent=ke,exports.SubMesh=Za,exports.TapGestureRecognizer=pn,exports.Texture=Se,exports.TextureFilterMipMapMode=b,exports.TextureFilterMode=I,exports.TextureWrapMode=A,exports.TouchDevice=Lt,exports.TouchGesture=Sn,exports.TouchRespond=An,exports.UIColliderComponent=nt,exports.Vec2=Q,exports.Vec3=de,exports.Vec4=le,exports.WrapMode=xe,exports.XShader=be;