"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.JSAssetScriptBase=exports.RenderingUtil=exports.IsRenderChainEventSupported=exports.JSAssetType=exports.MeshUtil=void 0;const APJS=require('amazingpro.js');class MeshUtil{static createQuadMesh(){const e=new APJS.Mesh,t=new APJS.VertexAttribDesc;t.semantic=APJS.VertexAttribType.POSITION;const r=new APJS.VertexAttribDesc;r.semantic=APJS.VertexAttribType.TEXCOORD0;const n=new APJS.Vector;n.pushBack(t),n.pushBack(r),e.vertexAttribs=n;const s=[1,1,0,1,1,1,-1,0,1,0,-1,-1,0,0,0,-1,1,0,0,1],i=new APJS.FloatVector;for(let e=0;e<s.length;++e)i.pushBack(s[e]);e.vertices=i;const a=new APJS.SubMesh;a.primitive=APJS.Primitive.TRIANGLES;const o=[0,2,1,2,0,3],c=new APJS.UInt16Vector;for(let e=0;e<o.length;++e)c.pushBack(o[e]);return a.indices16=c,a.mesh=e,e.addSubMesh(a),e}}var JSAssetType;let isRenderChainEventSupportedFlag;function IsRenderChainEventSupported(){if(void 0!==isRenderChainEventSupportedFlag)return isRenderChainEventSupportedFlag;let e=APJS.getEngineVersion();e=e.replace(/\./g,""),console.log(e);const t=parseInt(e),r=parseInt("1400");return console.log(t),console.log(r),isRenderChainEventSupportedFlag=t>=r,isRenderChainEventSupportedFlag?console.log("true"):console.log("false"),isRenderChainEventSupportedFlag}exports.MeshUtil=MeshUtil,function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.ExampleJSAssetTexture=1]="ExampleJSAssetTexture"}(JSAssetType=exports.JSAssetType||(exports.JSAssetType={})),exports.IsRenderChainEventSupported=IsRenderChainEventSupported;class RenderingUtil{static createShaderPass(e,t){const r=new APJS.Pass;r.shaders=e;const n=new APJS.Map;return n.insert("inPosition",APJS.VertexAttribType.POSITION),n.insert("inTexCoord",APJS.VertexAttribType.TEXCOORD0),r.semantics=n,r.renderState=t,r}static createScreenMaterial(e){const t=new APJS.RenderState;t.viewport=new APJS.ViewportState,t.viewport.rect=new APJS.Rect(0,0,1,1),t.viewport.minDepth=0,t.viewport.maxDepth=1;const r=this.createShaderPass(e,t);return this.createMaterial(r)}static createMaterial(e){const t=new APJS.XShader;t.passes.pushBack(e);const r=new APJS.Material;r.xshader=t;const n=new APJS.PropertySheet;return r.properties=n,r}static createRenderTexture(){const e=new APJS.RenderTextureCreateDesc;return e.depth=1,e.width=640,e.height=360,e.filterMag=APJS.FilterMode.Linear,e.filterMin=APJS.FilterMode.Linear,e.filterMipmap=APJS.FilterMipmapMode.None,e.attachment=APJS.RenderTextureAttachment.NONE,APJS.TextureUtils.createRenderTexture(e)}static createRenderTexturePlus(e,t,r,n){const s=new APJS.RenderTextureCreateDesc;return s.builtinType=APJS.BuiltInTextureType.NORAML,s.internalFormat=APJS.InternalFormat.RGBA8,s.dataType=APJS.DataType.U8norm,s.depth=1,s.attachment=APJS.RenderTextureAttachment.DEPTH24,s.filterMag=n,s.filterMin=n,s.filterMipmap=APJS.FilterMipmapMode.None,s.width=e,s.height=t,s.colorFormat=r,APJS.TextureUtils.createRenderTexture(s)}static createScreenRenderTexture(){const e=new APJS.ScreenTextureCreateDesc;return e.builtinType=APJS.BuiltInTextureType.NORAML,e.internalFormat=APJS.InternalFormat.RGBA8,e.dataType=APJS.DataType.U8norm,e.depth=1,e.attachment=APJS.RenderTextureAttachment.DEPTH24,e.filterMag=APJS.FilterMode.Linear,e.filterMin=APJS.FilterMode.Linear,e.filterMipmap=APJS.FilterMipmapMode.None,e.pecentX=1,e.pecentY=1,e.colorFormat=APJS.PixelFormat.RGBA8Unorm,APJS.TextureUtils.createScreenTexture(e)}static createTexture2D(){const e=new APJS.Texture2DCreateDesc;return e.filterMin=APJS.FilterMode.Linear,e.filterMag=APJS.FilterMode.Linear,APJS.TextureUtils.createTexture2D(e)}static createShaders(e){const t=new APJS.Map;for(const r in e){const n=new APJS.Shader;n.type=APJS.ShaderType.VERTEX,n.source=e[r].vs;const s=new APJS.Shader;s.type=APJS.ShaderType.FRAGMENT,s.source=e[r].fs;const i=new APJS.Vector;i.insert(0,n),i.insert(1,s),t.insert(r,i)}return t}static createEmptyMaterial(){const e=new APJS.Material,t=new APJS.XShader;e.xshader=t;const r=new APJS.PropertySheet;return e.properties=r,e}static addPassToMaterial(e,t,r,n=!1){const s=new APJS.Pass,i=new APJS.Map;for(const e in t){const r=new APJS.Shader;r.type=APJS.ShaderType.VERTEX,r.source=t[e].vs;const n=new APJS.Shader;n.type=APJS.ShaderType.FRAGMENT,n.source=t[e].fs;const s=new APJS.Vector;s.pushBack(r),s.pushBack(n),i.insert(e,s)}s.shaders=i;const a=new APJS.Map;a.insert("inPosition",APJS.VertexAttribType.POSITION),a.insert("inTexCoord",APJS.VertexAttribType.TEXCOORD0),s.semantics=a;const o=new APJS.DepthStencilState;o.depthTestEnable=!1;const c=new APJS.RenderState;if(c.depthstencil=o,r){o.stencilTestEnable=!0;const e=new APJS.StencilOpState;e.compareOp=APJS.CompareOp.EQUAL,e.reference=42,e.writeMask=0,o.stencilFront=e,o.stencilBack=e}if(n){const e=new APJS.Vector,t=new APJS.ColorBlendAttachmentState;t.blendEnable=n,t.srcColorBlendFactor=APJS.BlendFactor.SRC_ALPHA,t.dstColorBlendFactor=APJS.BlendFactor.ONE_MINUS_SRC_ALPHA,t.srcAlphaBlendFactor=APJS.BlendFactor.SRC_ALPHA,t.dstAlphaBlendFactor=APJS.BlendFactor.ONE_MINUS_SRC_ALPHA,t.ColorBlendOp=APJS.BlendOp.ADD,t.AlphaBlendOp=APJS.BlendOp.ADD,e.pushBack(t),c.colorBlend=new APJS.ColorBlendState,c.colorBlend.attachments=e}return s.renderState=c,e.xshader.passes.pushBack(s),s}}function deserializeJsonObject(e){return e&&void 0!==e.x&&void 0!==e.y?void 0!==e.width&&void 0!==e.height?new APJS.Rect(e.x,e.y,e.width,e.height):new APJS.Vector2f(e.x,e.y):e}exports.RenderingUtil=RenderingUtil;class JSAssetScriptBase{get screenMesh(){if(!this._screenMesh&&this.getMgrInstanceFunc){const e=this.getMgrInstanceFunc();this._screenMesh=null==e?void 0:e.getDefaultScreenMesh()}return this._screenMesh}get cmdBufferHelper(){if(!this._cmdBufferHelper&&this.getMgrInstanceFunc){const e=this.getMgrInstanceFunc();this._cmdBufferHelper=null==e?void 0:e.getDefaultCmdBufferHelper()}return this._cmdBufferHelper}constructor(){this._isRunTime=!1,this.getMgrInstanceFunc=void 0,this._instantiatedObjectsNum=0,this._canBeRemovedDynamically=!1,this._uuid=void 0}get uuid(){return this._uuid}set uuid(e){this._uuid=e}get isRunTime(){return this._isRunTime}set isRunTime(e){this._isRunTime=e}get canBeRemovedDynamically(){return this._canBeRemovedDynamically}set canBeRemovedDynamically(e){this._canBeRemovedDynamically=e}get scene(){return this._scene}set scene(e){this._scene=e}get mainObject(){return this._mainObject}set mainObject(e){this._mainObject=e}get instantiatedObjectsNum(){return this._instantiatedObjectsNum}init(e){}loadFromConfig(e){var t;const r=null===(t=this.scene)||void 0===t?void 0:t.assetManager,n=e.properties,s=e.preloadProperties;let i=0;if(void 0!==s&&(i=s.length),n&&r)for(const t in n){let a=!1;for(let e=0;e<i;e++){if(t===s[e]){a=!0;break}}const o=deserializeJsonObject(n[t]);if("string"==typeof o){const n=r.rootDir+o;if(fs.accessSync(n,0)){let n=null;!1===a?n=r.SyncLoad(o):void 0!==r.getCustomAssetsPreloadProperty&&(n=r.getCustomAssetsPreloadProperty(e.uuid,t)),n&&(this[t]=n);continue}}this[t]=o}this._uuid=e.uuid?e.uuid:"undefined",this.init()}instantiate(){}isEditorEnv(){var e,t,r,n;return!0===(null===(n=null===(r=null===(t=null===(e=this.scene)||void 0===e?void 0:e.assetManager)||void 0===t?void 0:t.getAllCustomAssetsProperty())||void 0===r?void 0:r.get(this.uuid))||void 0===n?void 0:n.get("EditorEnv"))}onStart(){}onUpdate(e,t=void 0){}onLateUpdate(e){}onEvent(e){}onRelease(){}onDestroy(){}}exports.JSAssetScriptBase=JSAssetScriptBase;