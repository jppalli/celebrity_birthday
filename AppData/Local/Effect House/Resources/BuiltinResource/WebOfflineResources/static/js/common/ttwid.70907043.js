(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"091686055a39f1e69fd3":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i;(function(e){e[e["COOKIE_READ_DEFAULT"]=0]="COOKIE_READ_DEFAULT";e[e["COOKIE_READ_TEA_PRIOR"]=1]="COOKIE_READ_TEA_PRIOR"})(i=t.CookieReadConfigEnum||(t.CookieReadConfigEnum={}))},ec9f764078180f66e201:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r("98bae3dbabd51089d613");var n=i.__importDefault(r("bd183afcc37eabd79225"));var a=i.__importDefault(r("d9a38932efea6caf6459"));r("81b4624b326fa6b3e5fb");var s=r("091686055a39f1e69fd3");var o=3e3;var u={timeout:o,withCredentials:true,headers:{"content-type":"application/x-www-form-urlencoded"}};var c={apiKey:"AIzaSyCuM3x-qGZoez2mBUq1_RcNrRFysHdRxfY",authDomain:"byted-ucenter.firebaseapp.com",databaseURL:"https://byted-ucenter.firebaseio.com",projectId:"byted-ucenter",storageBucket:"byted-ucenter.appspot.com",messagingSenderId:"995120244681",appId:"1:995120244681:web:d175caeb43de4353deea18"};var d=function(){function e(e){var t=this;this.host="";this.installations=null;this.fid="";if("undefined"===typeof e.union)e.union=true;if("undefined"===typeof e.needFid)e.needFid=true;if(e.host)this.host=e.host;this.options=e;try{if(e.needFid){var r=a.default.initializeApp(c,"byted-webapp-register");var i=r.installations();if(i){this.installations=i;i.getId().then((function(e){if(void 0===e)e="";t.fid=e}))}}}catch(n){}}e.prototype.checkWebId=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r,a,o,c,d,f,_,_,h,l;return i.__generator(this,(function(p){switch(p.label){case 0:p.trys.push([0,14,,15]);t=e||s.CookieReadConfigEnum.COOKIE_READ_DEFAULT;r="";if(!this.options.needFid)return[3,3];a=this.fid;if(a)return[3,2];return[4,this.getInstanceId()];case 1:a=p.sent();p.label=2;case 2:r=a;p.label=3;case 3:return[4,n.default.post(this.host+"/ttwid/check/",i.__assign(i.__assign({},this.options),{fid:r,migrate_priority:t}),u)];case 4:o=p.sent();c=o.data,d=void 0===c?null:c;if(!(d&&d.status_code>1001))return[3,12];f=d.migrate_info;p.label=5;case 5:p.trys.push([5,10,,11]);if(!this.options.union)return[3,7];return[4,this.registerUnionWebId({migrate_info:f,fid:r})];case 6:_=p.sent();return[2,_];case 7:return[4,this.registerOpenWebId({migrate_info:f,fid:r})];case 8:_=p.sent();return[2,_];case 9:return[3,11];case 10:h=p.sent();return[2,d||o];case 11:return[3,13];case 12:return[2,d||o];case 13:return[3,15];case 14:l=p.sent();throw l;case 15:return[2]}}))}))};e.prototype.checkWebIdFromTea=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t,r,n,a,o,u;return i.__generator(this,(function(i){switch(i.label){case 0:i.trys.push([0,2,,3]);e=localStorage&&localStorage.getItem("__tea_cache_tokens_"+this.options.aid)||"";t=e&&JSON.parse(e)||{};r=t.web_id,n=void 0===r?"":r;if(n){a=new Date(Date.now()+24*60*60*1e3).toUTCString();document.cookie="_tea_web_id="+n+"; expires="+a+"; path=/;"}return[4,this.checkWebId(s.CookieReadConfigEnum.COOKIE_READ_TEA_PRIOR)];case 1:o=i.sent();return[2,o];case 2:u=i.sent();throw u;case 3:return[2]}}))}))};e.prototype.registerUnionWebId=function(e,t){return i.__awaiter(this,void 0,void 0,(function(){var r,a,s,o,c,d,f,_,h,l,p,b;return i.__generator(this,(function(v){switch(v.label){case 0:v.trys.push([0,6,,7]);r=this.options,a=r.unionHost,s=void 0===a?"":a,o=r.cbUrlProtocol,c=void 0===o?"":o;return[4,n.default.post(s+"/ttwid/union/register/",i.__assign(i.__assign({},this.options),e),u)];case 1:d=v.sent();f=d.data,_=void 0===f?null:f;if(!(_&&_.redirect_url))return[3,5];v.label=2;case 2:v.trys.push([2,4,,5]);h=_.redirect_url;if(c&&h)h=h.replace(/^https?/,c);return[4,n.default.get(h,u)];case 3:l=v.sent();if(t)return[2,t(null,l.data||{})];return[2,l.data||{}];case 4:p=v.sent();if(t)return[2,t(p,_||{})];return[2,_];case 5:if(t)return[2,t(new Error("ttwid union register error"))];throw new Error("ttwid union register error");case 6:b=v.sent();if(t)return[2,t(b)];throw b;case 7:return[2]}}))}))};e.prototype.registerOpenWebId=function(e){return i.__awaiter(this,void 0,void 0,(function(){var t,r;return i.__generator(this,(function(a){switch(a.label){case 0:a.trys.push([0,2,,3]);return[4,n.default.post(this.host+"/ttwid/register/",i.__assign(i.__assign({},this.options),e),u)];case 1:t=a.sent();return[2,t.data];case 2:r=a.sent();throw r;case 3:return[2]}}))}))};e.prototype.getInstanceId=function(){return i.__awaiter(this,void 0,void 0,(function(){var e=this;return i.__generator(this,(function(t){if(this.installations)return[2,new Promise((function(t,r){return i.__awaiter(e,void 0,void 0,(function(){var e,r;return i.__generator(this,(function(i){switch(i.label){case 0:setTimeout((function(){t("")}),2e3);i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this.installations.getId()];case 2:e=i.sent();this.fid=e||"";t(e||"");return[3,4];case 3:r=i.sent();this.fid="";throw r;case 4:return[2]}}))}))}))];return[2,""]}))}))};e.prototype.deleteInstallation=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){try{this.installations&&this.installations.delete()}catch(t){throw t}return[2]}))}))};return e}();t.TtWid=d},efda4e481a0822267562:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r("98bae3dbabd51089d613");var n=i.__importDefault(r("a1c8a05eb561659fd014"));n.default.polyfill();var a=r("ec9f764078180f66e201");t.TtWid=a.TtWid}}]);
//# sourceMappingURL=ttwid.70907043.js.map